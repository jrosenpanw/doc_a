## Threat management

### Enable prompt log collection in Azure

The following steps are necessary to enable prompt log collection in
Microsoft Azure:

1.  [Configure the Azure Event Hub
    collection](#UUIDb663dd1bcdd17a18ea25b063349cc3ed).

2.  [Set up prompt logging in
    Azure](#UUID7c7cd225f9eaaff4ba018be9ef2ed754).

3.  [Configure logging of HTTP
    data](#UUID71ceeb45183c8183936726045e64cafa).

4.  [Configure diagnostic
    settings](#UUID8c1a5893b4a17ac7a8dabf8e36ad895d).

### Detection rules

#### What are detection rules?

Cortex XSIAM uses rules to detect the threats in your network and to
generate issues. You can add specific detection rules for which you want
Cortex XSIAM to generate issues. The following are the different types
of rules available:

- **Indicators of compromise (IOCs)**: IOCs are used to alert for known
  artifacts that are considered malicious or suspicious. IOCs are
  static, simple, and based on the detection of criteria such as SHA256
  hashes, IP addresses and domains, file names, and paths. You create
  IOC rules based on information you gather from various
  threat-intelligence feeds or as a result of an investigation within
  Cortex XSIAM. For example, if you find out that a certain ransomware
  uses a certain file hash, you can add the file hash as an IOC and
  generate an issue if it is detected.

- **Behavioral indicators of compromise (BIOCs)**: BIOCs detect
  suspicious behavior. As you identify specific activities (network,
  process, file, registry, etc) that indicate a threat, you create BIOCs
  that can alert you when the behavior is detected. If you enable
  **Cortex XSIAM Analytics**, Cortex XSIAM can use [Analytics
  BIOCs](#UUID578040170eedd671f44abf8c5f42d484) (ABIOCs) to establish
  baseline behavior and detect any deviation from this behavior.

- **Correlation Rules**: Correlation rules help you analyze the
  relationship between multiple events from multiple sources by using
  the Cortex Query Language (XQL) based engine.

##### What\'s an IOC?

Indicators of compromise (IOCs) enable Cortex XSIAM to generate issues
about known malicious objects on endpoints across the organization. You
can load collections of IOCs from threat-intelligence sources into
Cortex XSIAM or define them individually.

> **Note**
>
> Cortex XSIAM supports a maximum of 4,000,000 IOCs.

You can define the following types of IOCs:

- Full path

- File name

- Domain

- Destination IP address

- MD5 hash

- SHA256 hash

After you load or define IOCs, the tenant checks for matches in the
xdr_data dataset that contains all the information collected about the
endpoints and the network. Cortex XSIAM looks for IOC matches in all
data collected in the past and continues to evaluate any new data it
receives in the future.

Issues for IOCs are identified by the source type of the IOC.

###### IOC rule details

In the Threat Management \> Detection Rules \> IOC page, you can view
all configured or uploaded indicators of compromise (IOCs). To view the
number of IOC rules, filter by one or more fields in the IOC rules
table. You can also manage or clone existing rules.

The following table describes the fields that are available for each IOC
rule in alphabetical order.

+-----------------------------------+-----------------------------------+
| Field                             | Description                       |
+===================================+===================================+
| **# OF ISSUES**                   | The number of issues generated by |
|                                   | this indicator.                   |
+-----------------------------------+-----------------------------------+
| **BACKWARDS SCAN STATUS**         | Status of the Cortex XSIAM search |
|                                   | for the first 10,000 matches when |
|                                   | the IOC rule was created or       |
|                                   | edited. Status can be:            |
|                                   |                                   |
|                                   | - Done                            |
|                                   |                                   |
|                                   | - Failed                          |
|                                   |                                   |
|                                   | - Pending                         |
|                                   |                                   |
|                                   | - Queued                          |
+-----------------------------------+-----------------------------------+
| **BACKWARDS SCAN TIMESTAMP**      | Timestamp of the Cortex XSIAM     |
|                                   | search for the first 10,000       |
|                                   | matches in your Cortex XSIAM when |
|                                   | the IOC rule was created or       |
|                                   | edited.                           |
+-----------------------------------+-----------------------------------+
| **BACKWARDS SCAN RETRIES**        | Number of times Cortex XSIAM      |
|                                   | searched for the first 10,000     |
|                                   | matches in your Cortex XSIAM when |
|                                   | the IOC rule was created or       |
|                                   | edited.                           |
+-----------------------------------+-----------------------------------+
| **CLASS**                         | The IOC\'s class. For example,    |
|                                   | \'Malware\'.                      |
|                                   |                                   |
|                                   | > **Note**                        |
|                                   | >                                 |
|                                   | > Field cannot exceed 36          |
|                                   | > characters.                     |
+-----------------------------------+-----------------------------------+
| **COMMENT**                       | Free-form comments specified when |
|                                   | the IOC was created or modified.  |
+-----------------------------------+-----------------------------------+
| **EXPIRATION DATE**               | The date and time at which the    |
|                                   | IOC will be removed               |
|                                   | automatically.                    |
+-----------------------------------+-----------------------------------+
| **INDICATOR**                     | The indicator value itself. For   |
|                                   | example, if the indicator type is |
|                                   | a destination IP address, this    |
|                                   | could be an IP address such as    |
|                                   | 1.1.1.1.                          |
+-----------------------------------+-----------------------------------+
| **INSERTION DATE**                | Date and time when the IOC was    |
|                                   | created.                          |
+-----------------------------------+-----------------------------------+
| **MODIFICATION DATE**             | Date and time when the IOC was    |
|                                   | last modified.                    |
+-----------------------------------+-----------------------------------+
| **RELIABILITY**                   | Indicator\'s reliability level:   |
|                                   |                                   |
|                                   | - A - Completely Reliable         |
|                                   |                                   |
|                                   | - B - Usually Reliable            |
|                                   |                                   |
|                                   | - C - Fairly Reliable             |
|                                   |                                   |
|                                   | - D - Not Usually Reliable        |
|                                   |                                   |
|                                   | - E - Unreliable                  |
+-----------------------------------+-----------------------------------+
| **REPUTATION**                    | Indicator\'s reputation level.    |
|                                   | One of Unknown, Good, Bad, or     |
|                                   | Suspicious.                       |
+-----------------------------------+-----------------------------------+
| **RULE ID**                       | Unique identification number for  |
|                                   | the rule.                         |
+-----------------------------------+-----------------------------------+
| **SEVERITY**                      | IOC severity that was defined     |
|                                   | when the IOC was created.         |
+-----------------------------------+-----------------------------------+
| **SOURCE**                        | User who created this IOC, or the |
|                                   | file name from which it was       |
|                                   | created, or Public API.           |
|                                   |                                   |
|                                   | Public API indicates that the     |
|                                   | indicator was uploaded using the  |
|                                   | *Insert Simple Indicators, CSV*   |
|                                   | or                                |
|                                   | *Insert Simple Indicators, JSON*  |
|                                   | REST APIs.                        |
+-----------------------------------+-----------------------------------+
| **STATUS**                        | Enabled or Disabled.              |
+-----------------------------------+-----------------------------------+
| **TYPE**                          | Type of indicator: Full path,     |
|                                   | File name, Host name, Destination |
|                                   | IP, MD5 hash.                     |
+-----------------------------------+-----------------------------------+
| **VENDORS**                       | A list of threat intelligence     |
|                                   | vendors from which this IOC was   |
|                                   | obtained.                         |
+-----------------------------------+-----------------------------------+

###### Create an IOC rule

Create new indicator of compromise (IOC) rules and optionally define
rule expiration for all IOC rules. You can create an IOC rule either by
configuring a single one or by uploading a file that contains multiple
IOCs.

> **Note**
>
> To ensure your IOC rules generate issues efficiently and do not
> overcrowd your Issues table, Cortex XSIAM automatically does the
> following:

- > Disables any IOC rules that reach 5000 or more hits over 24 hours.

- > Creates a rule exception based on the PROCESS SHA256 field for IOC
  > rules that hit more than 100 endpoints over 72 hours.

> If you have the Threat Intel Management add-on included in your
> license, create an indicator detection rule for File, Domain, and IP
> Address indicators rather than creating an IOC. For more information,
> see [Generate issues from indicators using indicator rules for
> prevention and detection](#UUID24f89287b06a73f19a2775e2739df832).

1.  In Threat Management \> Detection Rules \> IOC, select
    **+ Add IOC**.

2.  Configure the IOC criteria.

- Configure a single IOC
  After investigating a threat, if you identify a malicious artifact,
  you can generate an issue for the **Single IOC** right away.

  1.  Configure the **INDICATOR** value on which you want to match.

  2.  Configure the IOC **TYPE**. Options are **Full Path**,
      **File Name**, **Domain**, **Destination IP**, and MD5 or SHA256
      **Hash**.

  3.  Configure the **SEVERITY** you want to associate with the issue
      for the IOC.

  4.  (*Optional*) Enter a comment that describes the IOC.

  5.  (*Optional*) Configure the IOC\'s **REPUTATION** and its
      **RELIABILITY**.

  6.  (*Optional*) Configure the **EXPIRATION** settings for this IOC.
      **Default**, **Specific Expiration Date**, **No Expiration**.

  7.  Click **Save**.

  Upload multiple IOCs
  If you want to match multiple indicators, you can upload the criteria
  in a CSV file. You can upload IOCs using REST APIs in either CSV or
  JSON format.

  Upload a file, one IOC per line, that contains up to 20,000 IOCs. For
  example, you can upload multiple file paths and MD5 hashes for an IOC
  rule. To help you format the upload file in the syntax that Cortex
  XSIAM accepts, you can download the example file.

  1.  Select **Upload File**.

  2.  Drag and drop the CSV file containing the IOC criteria in the drop
      area of the **Upload File** dialog or **Browse** for the file.

  - Cortex XSIAM supports files with multiple IOCs in a pre-configured
    format. For help in determining the format syntax, download the
    example text file.

  3.  Configure the **SEVERITY** you want to associate with the issue
      for the IOCs.

  4.  Define the **DATA FORMAT** of the IOCs in the CSV file. Options
      are **Mixed**, **Full Path**, **File Name**, **Domain**,
      **Destination IP**, and MD5 or SHA256 **Hash**.

  5.  (*Optional*) Configure the IOC\'s **REPUTATION** and its
      **RELIABILITY**.

  6.  (*Optional*) Enter an **EXPIRATION** for the IOC. **Default**,
      **Specific Expiration Date**, **No Expiration**.

  7.  Click **Upload**.

3.  (*Optional*) Define any expiration criteria for your IOC rules.

- You can also configure additional expiration criteria per IOC type to
  apply to all IOC rules of that type. In most cases, IOC types like
  Destination IP or Host Name are considered malicious only for a short
  period of time since they are soon cleaned and then used by legitimate
  services, from which time they only cause false positives. For these
  types of IOCs, you can set a defined expiration period. The expiration
  criteria you define for an IOC type will apply to all existing rules
  and additional rules that you create in the future. By default, Cortex
  XSIAM does not apply an expiration date set on IOCs.

  a.  Select **Default Rule Expiration**.

  b.  Set the expiration for any relevant IOC type. Options are
      **Never**, **7 Days**, **30 days**, **90 days**, or **180 days**.

  c.  Click **Save**.

##### What\'s a BIOC?

Behavioral indicators of compromise (BIOCs) enable you to alert and
respond to behaviors---tactics, techniques, and procedures. Instead of
hashes and other traditional indicators of compromise, BIOC rules detect
behavior related to processes, registry, files, and network activity.

To benefit from the latest threat research, the Cortex XSIAM tenant
automatically receives pre-configured rules from Palo Alto Networks.
These global rules are delivered to all tenants with content updates.
When you need to override a global BIOC rule, you can disable it or set
a rule exception. As you investigate threats on your network and
endpoints, you can also configure additional BIOC rules. BIOC rules are
highly customizable; you can create a BIOC rule that is simple or quite
complex.

As soon as you create or enable a BIOC rule, the tenant begins to
monitor input feeds for matches. It also analyzes historical data
collected in the tenant. When there is a match on a BIOC rule, Cortex
XSIAM generates an issue.

To further enhance the BIOC rule capabilities, you can also configure
BIOC rules as custom prevention rules and incorporate them with your
Restrictions profiles. The tenant can then generate behavioral threat
prevention issues based on your custom prevention rules in addition to
the BIOC detection issues.

###### BIOC rule details

Manage your behavioral indicator of compromise (BIOC) rules in Threat
Management \> Detection Rules \> BIOC.

If you are assigned a role that enables Investigation \> Rules
privileges, you can view all user-defined and preconfigured rules for
behavioral indicators of compromise (BIOCs).

If you have Cortex XSIAM Analytics enabled, you can also view Analytics
BIOCs (ABIOCs) on a separate page. To access this page, click
**Analytics BIOC Rules** next to the refresh icon at the top of the
page.

Each page displays fields that are relevant to the specific rule type.

####### BIOC rule fields

By default, the **BIOC Rules** page displays all enabled rules. To
search for a specific rule, use the filters above the results table to
narrow the results. You can also manage existing rules using the
right-click pivot menu.

The following table describes the fields that are available for each
BIOC rule in alphabetical order.

+-----------------------------------+-----------------------------------+
| Field                             | Description                       |
+===================================+===================================+
| **# OF ISSUES**                   | The number of incidents generated |
|                                   | by this rule.                     |
+-----------------------------------+-----------------------------------+
| **BACKWARDS SCAN STATUS**         | Status of the Cortex XSIAM search |
|                                   | for the first 10,000 matches when |
|                                   | the BIOC rule was created or      |
|                                   | edited. Status can be:            |
|                                   |                                   |
|                                   | - Done                            |
|                                   |                                   |
|                                   | - Failed                          |
|                                   |                                   |
|                                   | - Pending                         |
|                                   |                                   |
|                                   | - Queued                          |
+-----------------------------------+-----------------------------------+
| **BACKWARDS SCAN TIMESTAMP**      | Timestamp of the Cortex XSIAM     |
|                                   | search for the first 10,000       |
|                                   | matches in your Cortex XSIAM when |
|                                   | the BIOC rule was created or      |
|                                   | edited.                           |
+-----------------------------------+-----------------------------------+
| **BACKWARDS SCAN RETRIES**        | Number of times Cortex XSIAM      |
|                                   | searched for the first 10,000     |
|                                   | matches in your Cortex XSIAM when |
|                                   | the BIOC rule was created or      |
|                                   | edited.                           |
+-----------------------------------+-----------------------------------+
| **BEHAVIOR**                      | A schematic of the behavior of    |
|                                   | the rule.                         |
+-----------------------------------+-----------------------------------+
| **COMMENT**                       | Free-form comments specified when |
|                                   | the BIOC was created or modified. |
+-----------------------------------+-----------------------------------+
| **EXCEPTIONS**                    | Exceptions to the BIOC rule. When |
|                                   | there\'s a match on the           |
|                                   | exception, the event will not     |
|                                   | generate an incident.             |
+-----------------------------------+-----------------------------------+
| **GLOBAL RULE ID**                | Unique identification number      |
|                                   | assigned to rules created by Palo |
|                                   | Alto Networks.                    |
+-----------------------------------+-----------------------------------+
| **INSERTION DATE**                | Date and time when the BIOC rule  |
|                                   | was created.                      |
+-----------------------------------+-----------------------------------+
| **MITRE ATT&CK TACTIC**           | Displays the type of MITRE ATT&CK |
|                                   | tactic the BIOC rule is           |
|                                   | attempting to trigger on.         |
+-----------------------------------+-----------------------------------+
| **MITRE ATT&CK TECHNIQUE**        | Displays the type of MITRE ATT&CK |
|                                   | technique and sub-technique the   |
|                                   | BIOC rule is attempting to        |
|                                   | trigger on.                       |
+-----------------------------------+-----------------------------------+
| **MODIFICATION DATE**             | Date and time when the BIOC was   |
|                                   | last modified.                    |
+-----------------------------------+-----------------------------------+
| **NAME**                          | Unique name that describes the    |
|                                   | rule. Global BIOC rules defined   |
|                                   | by Palo Alto Networks are         |
|                                   | indicated with a blue dot and     |
|                                   | cannot be modified or deleted.    |
+-----------------------------------+-----------------------------------+
| **RULE ID**                       | Unique identification number for  |
|                                   | the rule.                         |
+-----------------------------------+-----------------------------------+
| **TYPE**                          | Type of BIOC rule:                |
|                                   |                                   |
|                                   | - Collection                      |
|                                   |                                   |
|                                   | - Credential Access               |
|                                   |                                   |
|                                   | - Dropper                         |
|                                   |                                   |
|                                   | - Evasion                         |
|                                   |                                   |
|                                   | - Execution                       |
|                                   |                                   |
|                                   | - Evasive                         |
|                                   |                                   |
|                                   | - Exfiltration                    |
|                                   |                                   |
|                                   | - File Privilege Manipulation     |
|                                   |                                   |
|                                   | - File Type Obfuscation           |
|                                   |                                   |
|                                   | - Infiltration                    |
|                                   |                                   |
|                                   | - Lateral Movement                |
|                                   |                                   |
|                                   | - Other                           |
|                                   |                                   |
|                                   | - Persistence                     |
|                                   |                                   |
|                                   | - Privilege Escalation            |
|                                   |                                   |
|                                   | - Reconnaissance                  |
|                                   |                                   |
|                                   | - Tampering                       |
+-----------------------------------+-----------------------------------+
| **SEVERITY**                      | BIOC severity that was defined    |
|                                   | when the BIOC was created.        |
+-----------------------------------+-----------------------------------+
| **SOURCE**                        | User who created this BIOC, the   |
|                                   | file name from which it was       |
|                                   | created, or Palo Alto Networks if |
|                                   | delivered through content         |
|                                   | updates.                          |
+-----------------------------------+-----------------------------------+
| **STATUS**                        | - Enabled                         |
|                                   |                                   |
|                                   | - Partially Enabled (Agent        |
|                                   |   Disabled)                       |
|                                   |                                   |
|                                   | - Partially Enabled (Server       |
|                                   |   Disabled)                       |
|                                   |                                   |
|                                   | - Disabled                        |
|                                   |                                   |
|                                   | When you hover over a rule        |
|                                   | that\'s disabled, a pop-up        |
|                                   | message appears to provide more   |
|                                   | information about the Disable     |
|                                   | action.                           |
+-----------------------------------+-----------------------------------+
| **USED IN PROFILES**              | Displays if the BIOC rule is      |
|                                   | associated with a Restriction     |
|                                   | profile.                          |
+-----------------------------------+-----------------------------------+

####### Analytics BIOC rule fields

By default, the **Analytics BIOC Rules** page displays all enabled
rules. To search for a specific rule, use the filters above the results
table to narrow the results. You can also disable and enable rules using
the right-click pivot menu.

The following table describes the fields that are available for each
Analytics BIOC rule in alphabetical order.

+-----------------------------------+-----------------------------------+
| Field                             | Description                       |
+===================================+===================================+
| **Activation Prerequisites**      | Displays a description of the     |
|                                   | prerequisites Cortex XSIAM        |
|                                   | requires in order to activate the |
|                                   | rule.                             |
+-----------------------------------+-----------------------------------+
| **Description**                   | Description of the behavior that  |
|                                   | will generate the issue.          |
+-----------------------------------+-----------------------------------+
| **# OF HITS**                     | The number of hits (matches) on   |
|                                   | this rule.                        |
+-----------------------------------+-----------------------------------+
| **NAME**                          | Unique name that describes the    |
|                                   | rule. New rules are identified    |
|                                   | with a blue badge icon.           |
+-----------------------------------+-----------------------------------+
| **SEVERITY**                      | BIOC severity that was defined    |
|                                   | when the BIOC rule was created.   |
|                                   | Severity levels can be **Low**,   |
|                                   | **Medium**, **High**,             |
|                                   | **Critical**, and **Multiple**.   |
|                                   |                                   |
|                                   | **Multiple** severity BIOC rules  |
|                                   | can generat incidents with        |
|                                   | different severity levels. Hover  |
|                                   | over the flag to see the          |
|                                   | severities defined for the rule.  |
+-----------------------------------+-----------------------------------+
| **STATUS**                        | Displays whether the rule is      |
|                                   | **Enabled**, **Disabled**, or     |
|                                   | **Pending Activation**.           |
|                                   |                                   |
|                                   | Rules that are                    |
|                                   | **Pending Activation** are in the |
|                                   | process of collecting the data    |
|                                   | required to enable the rule.      |
|                                   | Hover over the field to view how  |
|                                   | much data has already been        |
|                                   | collected within a certain period |
|                                   | of time.                          |
+-----------------------------------+-----------------------------------+
| **TAGS**                          | Filter the results according to   |
|                                   | **Detector Tags**. This tag       |
|                                   | enables you to filter for         |
|                                   | specific detectors such as        |
|                                   | Identity Threat, Identity         |
|                                   | Analytics, and others.            |
+-----------------------------------+-----------------------------------+

###### Create a BIOC rule

When you identify a threat and its characteristics, you can configure
rules for behavioral indicators of compromise (BIOCs) for this threat.

You can create a BIOC rule either by configuring a single one or by
uploading a file that contains multiple BIOCs.

After you create a BIOC rule, Cortex XSIAM searches for the first 10,000
matches in your tenant and generates an issue if a match is detected.
After the initial scan, Cortex XSIAM generates issues every time a new
match is detected.

You can also use BIOC rules to create prevention rules that terminate
the causality chain of a malicious process and generate Cortex XSIAM
Agent behavioral prevention type issues.

> **Note**
>
> To ensure your BIOC rules generate issues efficiently and do not
> overcrowd your Issues table, Cortex XSIAM automatically does the
> following:

- > Disables BIOC rules that reach 5000 or more hits over a 24-hour
  > period.

- > Creates a rule exception based on the PROCESS SHA256 field for BIOC
  > rules that hit more than 100 endpoints over a 72 hour period.

####### Create a BIOC rule from scratch

You can create a new BIOC rule in a similar way as you create a search
with Query Builder or by building the rule query with [XQL
Search](#UUID5f5b967337c3cb75a413d47e8b461681). In both methods, use
Cortex Query Language (XQL) to define the rule using XQL syntax. The XQL
query must at a minimum filter on the `event_type` field in order for it
to be a valid BIOC rule. In addition, you can create BIOC rules using
the `xdr_data` and `cloud_audit_log` datasets and presets for these
datasets.

> **Note**

- > A `cloud_audit_log` dataset requires a **Cortex XDR Pro per GB**
  > license.

- > Currently, you cannot create a BIOC rule on customized datasets and
  > only the `filter` stage, `alter` stage, and functions without any
  > aggregations are supported for XQL queries that define a BIOC.

- > For BIOC rules, the field values in XQL are evaluated as case
  > insensitive (`config case_sensitive = false`).

The following is an example of creating a BIOC rule in XQL.

    dataset = xdr_data 
    | filter event_type = PROCESS and 
             event_sub_type = PROCESS_START and 
             action_process_image_name ~= ".*?\.(?:pdf|docx)\.exe" 

The following describes the `event_type` values for which you can create
a BIOC rule.

- `FILE`---Events relating to file create, write, read, and rename
  according to the file name and path.

- `INJECTION`---Events related to process injections.

- `LOAD_IMAGE`---Events relating to module IDs of processes.

- `NETWORK`---Events relating to incoming and outgoing network, filed IP
  addresses, port, host name, and protocol.

- `PROCESS`---Events relating to execution and injection of a process
  name, hash, path, and CMD.

- `REGISTRY`---Events relating to registry write, rename and delete
  according to registry path.

- `STORY`---Events relating to a combination of firewall and endpoint
  logs over the network.

- `EVENT_LOG`---Events relating to Windows event logs and Linux system
  authentication logs.

To create a BIOC rule:

1.  Select Threat Management \> Detection Rules \> BIOC.

2.  Select **+ Add BIOC**.

3.  Configure your BIOC criteria using one of the following methods.

- Build the BIOC rule query with XQL Search.
  1.  Click **XQL Search**.

  2.  The XQL query field is where you define the parameters of your
      query for the BIOC rule. To help you create an effective XQL
      query, the search field provides suggestions as you type. The XQL
      query must at a minimum filter on the `event_type` field in order
      for it to be a valid BIOC rule. In addition, you can create BIOC
      rules using the `xdr_data` and `cloud_audit_log` datasets and
      presets for these datasets. Currently, you cannot create a BIOC
      rule on customized datasets and only the `filter` stage, `alter`
      stage, and functions without any aggregations are supported for
      XQL queries that define a BIOC. For BIOC rules, the field values
      in XQL are evaluated as case insensitive
      (`config case_sensitive = false`). After configuring the XQL query
      for your BIOC rule and the syntax is valid, a
      ![](media/rId2922.png){width="0.71875in"
      height="0.20833333333333334in"} indication is displayed, and it is
      possible to add the BIOC rule.

  3.  Click **Test BIOC**. Rules that you do not refine enough can
      generate thousands of issues. It is highly recommended that you
      test the behavior of a new or edited BIOC rule before you save it.

  - When you test the rule, Cortex XSIAM immediately searches for rule
    matches across all your Cortex XSIAM tenant data. The results are
    displayed in the **Query Results** tab underneath the XQL query
    field. Adjust any rule definition as needed.

    > **Note**

    > To demonstrate the expected behavior of the rule before you save
    > it, Cortex XSIAM tests the BIOC on historical logs. After you save
    > a BIOC rule, it will operate both on historical logs (up to 10,000
    > hits) and on new data received from your log sensors.

  4.  (*Optional*) Use the **Schema** tab to view schema information for
      every field found in the result set. This information includes the
      field name, data type, descriptive text (if available), and the
      dataset that contains the field. In order for a field to appear in
      the **Schema** tab, it must contain a non-NULL value at least once
      in the result set.

  5.  **Add as BIOC** the new query rule configured.

  Build the BIOC rule query through a specific entity.
  1.  Select an entity icon. Define any relevant activity or
      characteristics for the entity type. Create a new BIOC rule in the
      same way that you create a search with the Query Builder. You use
      XQL to define the rule. The XQL query must filter on an
      `event_type` in order for it to be a valid BIOC rule.

  2.  **Test** your BIOC rule. Rules that you do not refine enough can
      generate thousands of issues. It is highly recommended that you
      test the behavior of a new or edited BIOC rule before you save it.

  - When you test the rule, Cortex XSIAM immediately searches for rule
    matches across all your Cortex XSIAM Cortex XSIAM tenant data.
    Adjust any rule definition as needed.

    > **Note**

    > To demonstrate the expected behavior of the rule before you save
    > it, Cortex XSIAM tests the BIOC on historical logs. After you save
    > a BIOC rule, it will operate on both historical logs (up to 10,000
    > hits) and new data received from your log sensors.

  3.  **Save** the BIOC rule.

4.  Define the following parameters.

    a.  **Name**---Specify a description or leave the default name which
        is automatically populated using the format
        **XQL-BIOC-\<rule number\>**.

    b.  **Type**---Select a rule **TYPE** that describes the activity.

    c.  **Severity**---Specify the **Severity** you want to associate
        with an issue generated based on this rule.

    d.  (*Optional*) Select the **MITRE Technique** and **MITRE Tactic**
        you want to associate with the issue. You can select up to 3
        MITRE Techniques/Sub-Techniques and MITRE Tactics.

    e.  (*Optional*) Select the **+\<number\> more global exceptions**
        to view the **EXCEPTIONS** associated with this BIOC rule.

    f.  (*Optional*) **Comment**---Specify any additional comments, such
        as why you created the BIOC.

    g.  Click **OK**.

####### Import multiple BIOC rules

To match multiple indicators, you can upload the criteria in a CSV file.
You can upload BIOCs using REST APIs in either CSV or JSON format. Your
file can be a list of BIOCs from external feeds or a file that you
previously exported from Cortex XSIAM. The export/import capability is
useful for rapid copying of BIOCs across different Cortex XSIAM
instances.

Upload a file, one BIOC per line, that contains up to 20,000 BIOCs. For
example, you can upload multiple file paths and MD5 hashes for a BIOC
rule. To help you format the upload file in the syntax that Cortex XSIAM
accepts, you can download the example file.

> **Note**
>
> You can only import files that were exported from Cortex XSIAM. You
> can not edit an exported file.

1.  Select Threat Management \> Detection Rules \> BIOC.

2.  Select **Import Rules**.

3.  Drag and drop the file on the import rules dialog or **browse** to a
    file.

4.  Click **Import**.

- Cortex XSIAM loads any BIOC rules. This process may take a few minutes
  depending on the size of the file.

5.  Refresh the BIOC Rules page to view matches (# of Hits) in your
    historical data.

6.  To investigate any matches, view the **Issues** page and filter the
    **Issue Name** by the name of the BIOC rule.

####### Configure a custom prevention rule

> **Note**
>
> Custom prevention rules are supported on Cortex XSIAM agent 7.2 and
> later versions and enable you to configure and apply user-defined BIOC
> rules to Restriction profiles deployed on your Windows, Mac, and Linux
> endpoints.

By using the BIOC rules, you can configure custom prevention rules to
terminate the causality chain of a malicious process according to the
Action Mode defined in the associated Restrictions Security Profile and
generate Cortex XSIAM Agent behavioral prevention type issues in
addition to the BIOC rule detection issues.

For example, if you configure a custom prevention rule for a BIOC
Process event, apply it to the Restrictions profile with an action mode
set to Block, the Cortex XSIAM agent:

- Blocks a process at the endpoint level according to the defined rule
  properties.

- Generates a behavioral prevention issue that you can monitor and
  investigate in the **Issues** table.

Before you configure a BIOC rule as a custom prevention rule, create a
Restriction Profile for each type of operating system (OS) that you want
to deploy your prevention rules.

To configure a BIOC rule as a prevention rule:

1.  In Threat Management \> Detection Rules \> BIOC, from the
    **BIOC Rule** table, filter the **Source** field to locate a
    user-defined rule you want to apply as a custom prevention rule. You
    can only apply a BIOC rule that you created either from scratch or a
    Cortex XSIAM global rule template that meets the following criteria.

    - The user-defined BIOC rule does not include the following field
      configurations.

      - All Events---Host Name

      - File Event---Device Type, Device Serial Number

      - Process Event---Device Type, Device Serial Number

      - Network Event---Country, Raw Packet

    - BIOC rules with OS scope definitions must align with the
      Restrictions profile OS.

    - When defining the Process criteria for a user-defined BIOC rule
      event type, you can select to run only on actor, causality, and OS
      actor on Windows, and causality and OS actor on Linux and Mac.

2.  **Test** your BIOC rule.

- Rules that you do not refine enough can generate thousands of issues.
  As a result, it is highly recommended that you test the behavior of a
  new or edited BIOC rule before you save it. Cortex XSIAM automatically
  disables BIOC rules that reach 5000 or more hits over a 24-hour
  period.

3.  Right-click and select **Add to restrictions profile**.

- If the rule is already referenced by one or more profiles, select
  **See profiles** to view the profile names.

4.  In the **Add to Restrictions Profile** pop-up:

    - Ensure the rule you selected is compatible with the type of
      endpoint operating system.

    - Select the Restriction Profile name you want to apply the BIOC
      rule to for each of the operating systems. BIOC event rules of
      type Event Log and Registry are only supported by Windows OS.

    <!-- -->

    - > **Note**

      > You can only add to existing profiles you created, **Cortex
      > XSIAM Default** profiles will not appear as an option.

5.  **Add** the BIOC rule to the selected profiles.

- The BIOC rule is now configured as a custom prevention rule and
  applied to your Restriction profiles. After the Restriction profile is
  pushed to your endpoints, the custom prevention rule can start
  generating behavioral prevention-type issues.

6.  Review and edit your custom prevention rules.

    a.  Navigate to Endpoints \> Policy Management \> Profiles.

    b.  Locate the Restrictions Profile to which you applied the BIOC
        rule. In the **Summary** field, **Custom Prevention Rules**
        appears as **Enabled**.

    c.  Right-click and select **Edit**.

    d.  In the **Custom Prevention Rules** section, you can review and
        modify the following:

        - **Action Mode**---Select to **Enable** or **Disable** the BIOC
          prevention rules.

        - **Auto-disable**---Select if to auto-disable a BIOC prevention
          rule if it triggers after a defined number of times during a
          defined duration.

        <!-- -->

        - > **Note**

          > Auto-disable will turn off both the BIOC rule detection and
          > the BIOC prevention rule.

        <!-- -->

        - **Prevention BIOC Rules** table---**Filter** and maintain the
          BIOC rules applied to this specific Restriction Profile.
          Right-click to **Delete** a rule or **Go to BIOC Rules**
          table.

    e.  **Save** your changes if necessary.

    f.  Investigate the BIOC prevention rules issues.

        - Select Cases & Issues \> Issues.

        - Filter the fields as follows:

          - **Issue Source**: `XDR Agent`

          - **Action**: `Prevention (<profile action mode>)`

          - **Issue Name**: `Behavioral Threat`

        - In the **Description** field, you can see the rule name that
          generated the prevention issue.

###### Manage Global BIOC Rules

Global BIOC rules are detection rules created by Cortex and distributed
to the tenants. Cortex XSIAM checks automatically for the latest update
of global BIOC rules and applies them. If there are no new global BIOC
rules, Cortex XSIAM displays a content status of `Content up to date`
next to the BIOC rules table heading. A dot to the left of the rule name
indicates a global BIOC rule.

To see which rules are pushed by Palo Alto Networks, display the
optional **Source** field.

Retrieve the latest global BIOC rules

1.  Navigate to Threat Management \> Detection Rules \> BIOC.

2.  To view the content details, hover over the status
    **Content up to date**, to show the global rules version number and
    the date the global rules were checked.

- The content status displays the date when the content was last
  updated, either automatically or manually by an administrator.

3.  If the status displays **Could not check update**, click the status
    to check for updates manually.

- The last updated date changes when the download is successful.

Copy global BIOC rules

You cannot directly modify a global rule, but you can copy global rules
to use as a template to create new rules.

1.  Locate a Palo Alto Networks **Source** type rule, right-click and
    select **Save as New**.

2.  Review and modify the BIOC properties.

3.  Select **OK** to save the rule.

- The rule appears in the BIOC Rules table as a user-defined **Source**
  type rule that you can edit.

Add an exception to global BIOC rules

You cannot edit global rules, but you can add exceptions to the rule.
For more information about rule exceptions, see [Add a rule
exception](/document/preview/1044600#UUID-a8651ca5-083e-a9af-e303-09f0ecd84c8e).

##### What\'s a correlation rule?

Correlation rules help you analyze correlations of multi-events from
multiple sources by using the Cortex Query Language (XQL) based engine
for creating scheduled rules. Issues are then generated based on these
correlation rules with a defined time frame and set schedule, including
every X minutes, once a day, once a week, or a custom time.

After you configure your correlation rules, you can manage them in
Threat Management \> Detection Rules \> Correlations, and view and
analyze the generated issues in **Cases** and the **Issues Table**. In
addition, issues generated by correlation rules are factored into the
number of cases displayed in the dashboards.

###### Correlation rule details

If you are assigned a role that enables Investigation \> Rules
privileges, you can manage all user-defined Correlation Rules from
Threat Management \> Detection Rules \> Correlations.

By default, the **Correlation Rules** page displays all enabled rules.
To search for a specific rule, use the filters above the results table
to narrow the results. From the **Correlation Rules** page, you can
manage existing rules using the right-click pivot menu. You can also
import and export rules in JSON format, which can help you to transfer
your configurations between environments for onboarding, migration,
backup, and sharing. You can bulk export and import multiple rules at a
time.

In addition, the **Correlation Rules** page enables you to easily
identify and resolve correlation rules errors. The number of errors is
indicated at the top of the page in red using the format
**\<number\> errors found**. You can change the view to only display the
correlation rules with errors by selecting **Show Errors Only**. The
**LAST EXECUTION** column in the table indicates a correlation rule with
an error by displaying the last execution time in a red font and
providing a description of the correlation rule error when hovering over
the field. The following error messages are displayed in the applicable
scenarios.

- Invalid query

- Query timeout

- Dependency correlation did not complete

- Unknown error

- Delayed rule---This rule is running past its scheduled time, which can
  cause delayed results.

- Dataset does not exist: \<name of dataset\>

<!-- -->

- > **Note**

  > Only an administrator can create and view queries built with an
  > unknown dataset that currently does not exist in Cortex XSIAM .

A notification is also displayed in Cortex XSIAM to indicate these
correlation rules errors.

> **Note**
>
> For more information on troubleshooting server errors in scheduled
> correlation rules, [Troubleshoot server errors in scheduled
> correlation rules](#UUID35e12af3e197b9b4a888986c761b42f6).

Correlation rule fields in alphabetical order

> **Note**
>
> Certain fields are exposed and hidden by default. An asterisk (\*) is
> beside every field that is exposed by default.

+-----------------------------------+-------------------------------------------+
| Field                             | Description                               |
+===================================+===========================================+
| **# OF ISSUES**\*                 | The number of issues generated by this    |
|                                   | rule.                                     |
+-----------------------------------+-------------------------------------------+
| **ALERT CATEGORY**\*              | Type of issue as configured when creating |
|                                   | the rule.                                 |
|                                   |                                           |
|                                   | - Collection                              |
|                                   |                                           |
|                                   | - Credential Access                       |
|                                   |                                           |
|                                   | - Dropper                                 |
|                                   |                                           |
|                                   | - Evasion                                 |
|                                   |                                           |
|                                   | - Execution                               |
|                                   |                                           |
|                                   | - Evasive                                 |
|                                   |                                           |
|                                   | - Exfiltration                            |
|                                   |                                           |
|                                   | - File Privilege Manipulation             |
|                                   |                                           |
|                                   | - File Type Obfuscation                   |
|                                   |                                           |
|                                   | - Infiltration                            |
|                                   |                                           |
|                                   | - Lateral Movement                        |
|                                   |                                           |
|                                   | - Persistence                             |
|                                   |                                           |
|                                   | - Privilege Escalation                    |
|                                   |                                           |
|                                   | - Reconnaissance                          |
|                                   |                                           |
|                                   | - Tampering                               |
|                                   |                                           |
|                                   | - Other                                   |
+-----------------------------------+-------------------------------------------+
| **DATASET**\*                     | The text displayed here depends on the    |
|                                   | resulting action configured for the       |
|                                   | correlation rule when the rule was        |
|                                   | created.                                  |
|                                   |                                           |
|                                   | - **alerts**---When your resulting action |
|                                   |   for the rule was configured to          |
|                                   |   **Generate issue**.                     |
|                                   |                                           |
|                                   | - Dataset name---When your resulting      |
|                                   |   action for the rule was configured to   |
|                                   |   **Save to dataset**.                    |
+-----------------------------------+-------------------------------------------+
| **DESCRIPTION**\*                 | The description for the Correlation Rule  |
|                                   | that was configured when the rule was     |
|                                   | created.                                  |
+-----------------------------------+-------------------------------------------+
| **DRILL-DOWN QUERY**              | Displays the **Drill-Down Query** that    |
|                                   | you configured for additional information |
|                                   | about the issue for further investigation |
|                                   | using Cortex Query Language (XQL) when    |
|                                   | you created the rule. If you did not      |
|                                   | configure one, the field is left empty.   |
|                                   |                                           |
|                                   | After configuration, any issue generated  |
|                                   | for the Correlation Rule has a            |
|                                   | right-click pivot menu                    |
|                                   | **Open Drilldown Query** option, an       |
|                                   | **Open drilldown query** link after you   |
|                                   | investigate any contributing events, and  |
|                                   | a quick action **Open Drilldown Query**   |
|                                   | icon                                      |
|                                   | (![](media/rId2937.png){width="0.15625in" |
|                                   | height="0.20833333333333334in"}) that is  |
|                                   | accessible in the **Issues** page, which  |
|                                   | opens a new browser tab in XQL Search to  |
|                                   | run this query. If you do not define a    |
|                                   | **Drill-Down Query**, no right-click menu |
|                                   | option, link, or icon is displayed.       |
|                                   |                                           |
|                                   | The **Drill-Down Query Time Frame** can   |
|                                   | be configured as either.                  |
|                                   |                                           |
|                                   | - **Generated Issue**---Uses the time     |
|                                   |   frame of the issue that is generated,   |
|                                   |   which is the first event and last event |
|                                   |   timestamps for the issue (default       |
|                                   |   option).                                |
|                                   |                                           |
|                                   | - **XQL Search**---Uses the time frame    |
|                                   |   from when the Correlation Rule was run  |
|                                   |   in XQL Search.                          |
+-----------------------------------+-------------------------------------------+
| **FAILURE REASON**                | For a Correlation Rule with an error,     |
|                                   | displays the error message, which can be  |
|                                   | one of the following.                     |
|                                   |                                           |
|                                   | - Invalid query                           |
|                                   |                                           |
|                                   | - Query timeout                           |
|                                   |                                           |
|                                   | - Dependency correlation did not complete |
|                                   |                                           |
|                                   | - Unknown error                           |
|                                   |                                           |
|                                   | - Delayed rule---This rule is running     |
|                                   |   past its scheduled time, which can      |
|                                   |   cause delayed results.                  |
|                                   |                                           |
|                                   | - Dataset does not exist: \<name of       |
|                                   |   dataset\>                               |
|                                   |                                           |
|                                   | <!-- -->                                  |
|                                   |                                           |
|                                   | - > **Note**                              |
|                                   |                                           |
|                                   |   > Only an administrator can create and  |
|                                   |   > view queries built with an unknown    |
|                                   |   > dataset that currently does not exist |
|                                   |   > in Cortex XSIAM.                      |
+-----------------------------------+-------------------------------------------+
| **INSERTION DATE**                | Date and time when the Correlation Rule   |
|                                   | was created.                              |
+-----------------------------------+-------------------------------------------+
| **LAST EXECUTION**\*              | Date and time when the correlation rule   |
|                                   | was last executed. Indicates a            |
|                                   | correlation rule with an error by         |
|                                   | displaying the last execution time in a   |
|                                   | red font and providing a description of   |
|                                   | the correlation rule Error when hovering  |
|                                   | over the field. Indicates Real-time in    |
|                                   | the case of Real Time Correlation Rules.  |
+-----------------------------------+-------------------------------------------+
| **MITRE ATT&CK TACTIC**\*         | Displays the type of MITRE ATT&CK tactic  |
|                                   | the correlation rule is attempting to     |
|                                   | trigger.                                  |
+-----------------------------------+-------------------------------------------+
| **MITRE ATT&CK TECHNIQUE**\*      | Displays the type of MITRE ATT&CK         |
|                                   | technique and sub-technique the           |
|                                   | correlation rule is attempting to         |
|                                   | trigger.                                  |
+-----------------------------------+-------------------------------------------+
| **MODIFICATION DATE**\*           | Date and time when the correlation rule   |
|                                   | was last modified.                        |
+-----------------------------------+-------------------------------------------+
| **NAME**\*                        | Unique name that describes the rule.      |
+-----------------------------------+-------------------------------------------+
| **RULE ID**                       | Unique identification number for the      |
|                                   | rule.                                     |
+-----------------------------------+-------------------------------------------+
| **SCHEDULE**\*                    | Displays the Time Schedule for the        |
|                                   | frequency of running the XQL Search       |
|                                   | definition set for the correlation rule   |
|                                   | when the rule was created. The options    |
|                                   | displayed are one of the following.       |
|                                   |                                           |
|                                   | - **Every 10 Minutes**                    |
|                                   |                                           |
|                                   | - **Every 20 Minutes**                    |
|                                   |                                           |
|                                   | - **Every 30 Minutes**                    |
|                                   |                                           |
|                                   | - **Hourly **                             |
|                                   |                                           |
|                                   | - **Daily**                               |
|                                   |                                           |
|                                   | - Displays the Time Schedule as Cron      |
|                                   |   Expression fields.                      |
+-----------------------------------+-------------------------------------------+
| **SEVERITY**\*                    | Correlation rule severity that was        |
|                                   | defined when the correlation rule was     |
|                                   | created. Severity levels can be           |
|                                   | **Informational**, **Low**, **Medium**,   |
|                                   | **High**, **Critical**, and               |
|                                   | **Customized**.                           |
|                                   |                                           |
|                                   | If a generated issue has severity         |
|                                   | **Medium** or above, a case is            |
|                                   | automatically opened. Low severity issues |
|                                   | generated by correlation rules are not    |
|                                   | grouped into cases.                       |
+-----------------------------------+-------------------------------------------+
| **SOURCE**\*                      | User who created this correlation rule.   |
+-----------------------------------+-------------------------------------------+
| **STATUS**                        | Rule status: Enabled or Disabled.         |
+-----------------------------------+-------------------------------------------+
| **SUPPRESSION DURATION**\*        | The duration time for how long to ignore  |
|                                   | other events that match the issue         |
|                                   | suppression criteria that was configured  |
|                                   | when the rule was created. This is        |
|                                   | required to configure.                    |
+-----------------------------------+-------------------------------------------+
| **SUPPRESSION FIELDS**\*          | The fields that the issue suppression is  |
|                                   | based on, which was configured when the   |
|                                   | rule was created. The fields listed are   |
|                                   | based on the XQL query result set for the |
|                                   | rule. This is optional to configure.      |
+-----------------------------------+-------------------------------------------+
| **SUPPRESSION STATUS**\*          | Displays the Suppression Status as either |
|                                   | Enabled or Disabled as configured when    |
|                                   | the rule was created.                     |
+-----------------------------------+-------------------------------------------+
| **TIME FRAME**\*                  | Displays the time frame for running a     |
|                                   | query, which can be up to 7 days as       |
|                                   | configured when the rule was created.     |
+-----------------------------------+-------------------------------------------+
| **TIMEZONE**                      | Displays the Timezone when the Time       |
|                                   | Schedule for the frequency of running the |
|                                   | XQL Search definition set for the         |
|                                   | correlation rule is set to run daily or   |
|                                   | using a cron expression. Otherwise, this  |
|                                   | field is left empty.                      |
+-----------------------------------+-------------------------------------------+
| **XQL SEARCH**                    | Displays the XQL definition for the       |
|                                   | correlation rule that was configured in   |
|                                   | XQL Search when the rule was created.     |
+-----------------------------------+-------------------------------------------+

###### Create a correlation rule

> **Prerequisite**
>
> To enable pivots from issues to a third-party source system, ensure
> that you know the dataset field name which contains the URL of the
> source system. Some vendors already provide this URL as part of their
> API, and you can find it in the third-party product dataset. If there
> is no URL, you cannot enable this feature.

You can create a new correlation rule from either the Threat Management
\> Detection Rules \> Correlation Rules page or when building a query in
XQL Search. You can also import a number of correlation rules.

When setting up correlation rules, you have the following capabilities:

- Specify whether the correlation rule is Scheduled, or scans the data
  in Real Time, as it's ingested.

- Define when the correlation rule runs.

- Define whether issues generated by the correlation rule are suppressed
  by a duration time and field.

- Set the resulting action for the correlation rule, which includes any
  of the following:

  - Generate an issue: You can also define the issue settings, which
    include the Issues Field Mapping for incident enrichment, Issue
    domain, Issue Severity, MITRE Attack Tactics and Techniques, and
    other issue settings.

  - Save data to a dataset: Use this option to test and fine-tune new
    rules before initiating issues and applying correlation of
    correlation use cases.

  - Add data to a lookup dataset

  - Remove data from a lookup dataset

> **Note**

- > When creating a Real Time Correlation Rule, you can only generate an
  > issue as the resulting action for the Correlation Rule. All other
  > options are disabled.

- > To ensure your Correlation rules generate issues efficiently and do
  > not overcrowd your Issues table, Cortex XSIAM automatically disables
  > Correlation rules that reach 5000 or more hits over a 24-hour
  > period.

Create a correlation rule from scratch

1.  Open the **New Correlation Rule** editor.

- You can do this in two ways:

  - From the **Correlation Rules** page.

    1.  Select Threat Management \> Detection Rules \> Correlations.

    2.  Select **+Add Correlation**.

  - From **XQL Search**.

    1.  Select Investigation & Response \> Search \> Query Builder \>
        XQL Search.

    2.  In the XQL query field, define the parameters for your
        Correlation Rule.

    3.  Select Save as \> Correlation Rule.

    - The **New Correlation Rule** editor is displayed where the
      **XQL Search** section is populated with the query you already set
      in the XQL query field.

2.  Configure the **General** settings.

    - Specify a descriptive **Name** to identify the correlation rule.

    - (*Optional*) Specify a **Description** for the correlation rule.

3.  Use XQL to define the correlation rule in **XQL Search** field.

- Define the correlation rule in the **XQL Search** field. After writing
  at least one line in XQL, you can **Open full query mode** to display
  the query in XQL Search. You can **Test** the XQL definition for the
  rule whenever you want.

  > **Tip**

  > When creating your correlation rule, you can use predefined values
  > for different fields in the editor, such as **Alert Name**,
  > **Alert Description**, and **Drill-Down Query**. For more
  > information, [Field replacement syntax in correlation
  > rules](#UUID82d17255deb7d7f825a682b1997de432).

  > **Note**

  - > When you open the **New Correlation Rule** editor from XQL Search,
    > this **XQL Search** field is already populated with the XQL query
    > that you defined.

  - > An administrator can create and view queries built with an unknown
    > dataset that currently does not exist in Cortex XSIAM . All other
    > users can only create and view queries built with an existing
    > dataset.

  When you finish writing the XQL for the Correlation Rule definition,
  select **Continue editing rule** to bring you back to the
  **New Correlation Rule** editor, and the complete query you set is
  added to the **XQL Search** field.

  > **Note**

  - > The XQL features for `call`, `top`, and wildcards in datasets
    > (`dataset in (<dataset prefix>_*)`) are currently not supported in
    > Correlation Rules. If you add them to the XQL definition, you will
    > not be able to **Create** or **Save** the Correlation Rule.

  - > The XQL features for `transaction` in datasets
    > (`dataset in (<dataset prefix>_*)`) are currently not supported in
    > Real Time correlation rules.

  - > The XQL `tag` stage is currently not supported in correlation
    > rules.

  - > Using the `current_time()` function in your XQL query for a
    > correlation rule can yield unexpected results when there are lags
    > or during downtime. This happens if the correlation rule doesn't
    > run exactly at the time of the data inside the timeframe, for
    > example when a rule is dependent on another rule, or when a rule
    > is stuck due to an error, and then runs in recovery mode. Instead,
    > we recommend using the `time_frame_end()` function, which returns
    > the timestamp at the end of the time frame in which the rule is
    > executed.

4.  Select to run the Correlation Rule in **Real Time** or
    **Scheduled**.

    - Real Time Correlation Rules scan the data as it's ingested.

    - You can run Real Time Correlation Rules on Cortex XSIAM issues,
      Cloud audit logs, third party datasets, and Data Models.

    - When you start typing a Correlation Rule, Cortex XSIAM can detect
      that the query can be run in Real Time and recommend that you
      select **Real Time**.

    - Real Time Correlation Rules only support the following XQL stages:
      `dataset`,`datamodel`, `filter`, `alter`, `fields`, and
      `config case_sensitive`. A Real Time Correlation Rule must include
      an XQL `filter` stage. For more information on these XQL stages,
      see the Cortex XSIAM XQL Language Reference Guide.

    - The following XQL functions are not supported in a Real Time
      Correlation Rule: `json_extract_scalar_array`, `parse_epoch`, and
      `time_frame_end`.

    - Dataset views are not supported in Real Time Correlation Rules.

5.  If the Correlation Rule is **Scheduled**, configure the **Timing**
    settings.

    - **Time Schedule**: Select the **Time Schedule** for the frequency
      of running the **XQL Search** definition set for the Correlation
      Rule as one of the following.

      - **Every 10 Minutes**: Runs every rounded 10 minutes at preset 10
        minute intervals from the beginning of the hour, such as 10:10
        AM, 10:20 AM, and 10:30 AM.

      - **Every 20 Minutes**: Runs every rounded 20 minutes at preset 20
        minute intervals from the beginning of the hour, such as 10:20
        AM, 10:40 AM, and 11:00 AM.

      - **Every 30 Minutes**: Runs every rounded 30 minutes at preset 30
        minute intervals from the beginning of the hour, such as 10:30
        AM, 11:00 AM, and 11:30 AM.

      - **Hourly**: Runs at the beginning of the hour, such as 1:00 AM
        or 2:00 AM.

      - **Daily**: Runs at midnight, where you can set a particular
        **Timezone**.

      - **Custom**: Displays the **Time Schedule as Cron Expression**
        fields, where you can set the cron expression in each time field
        to define the schedule frequency for running the **XQL Search**.
        The minimum query frequency is every 10 minutes and is already
        configured. You can also set a particular **Timezone**.

    <!-- -->

    - By default, the query is set to run once an hour (**1 Hour/s**).

    <!-- -->

    - **Timezone** (*Optional*): You can only set the **Timezone** when
      the **Time Schedule** is set to **Daily** or **Custom**.
      Otherwise, the option is disabled.

    - **Query time frame**: Set the time frame for running a query,
      which can be up to 7 days. Specify a number in the field and in
      the other field select either **Minute/s**, **Hour/s**, or
      **Day/s**.

6.  (*Optional*) Configure **Issue Suppression** settings.

- Define whether the issues generated by the Correlation Rule are
  suppressed by a duration time, field, or both.

  - **Enable issues suppression**: Select this checkbox to
    **Enable issue suppression**. By default, this checkbox is clear and
    the issues of the Correlation Rule are configured to not be
    suppressed.

  - **Duration time**: Set the **Duration time** for how long to ignore
    other events that match the issue suppression criteria, which are
    based on the **Fields** listed. Specify a number in the field and in
    the other field select either **Minute/s**, **Hour/s**, or
    **Day/s**. By default, the generated issues are configured to be
    suppressed by 1 hour (**1 Hour/s**). The **Duration time** can be
    configured for a maximum of 1 day.

  - **Fields** (*Optional*): Select the fields that the issue
    suppression is based on. The fields listed are based on the XQL
    query result set. You can perform the following.

    - Select multiple fields from the list.

    - **Select all** to configure all the fields for suppression. This
      means that all the fields must match for the issuesto be
      suppressed. This option will generate multiple issues during the
      suppression period.

    - **Search** for a particular field, which narrows the available
      options as you begin typing.

    - Do not set any **Fields** by leaving the field empty only 1 issue
      is generated during the suppression period.

7.  Configure the resulting **Action** for the Correlation Rule.

- You can select one of the following resulting actions to occur, where
  the configuration settings change depending on your selection:

  Generate issue
  Generates a **Correlation** type of issue according to the configured
  settings in the **New Correlation Rule** editor (default). When this
  option is selected a number of new sections are opened to configure
  the issue.

  Issue Settings
  - **Issue Name**: Specify a name. You can incorporate a variable based
    on a query output field in the format `$fieldName`.

  - **Issue Domain**: Select the domain to which you want to assign any
    generated issues.

  <!-- -->

  - > **Note**

    - > The incident that contains the issues will also be assigned to
      > the selected domain. For more information, see [Case and issue
      > domains](#UUID60c4e95d81e3f8730530e920dfd698e5).

    - > If you want to generate a health issue, choose the Health
      > domain. For more information about health issues, see [About
      > health issues](#UUIDdfd48b778b41de7955182409372663e9).

  <!-- -->

  - **Severity**: Select the severity type whenever an issue is
    generated for this Correlation Rule as one of the following:

    - **Informational**

    - **Low**

    - **Medium**

    - **High**

    - **Critical**

    - **User Defined**: Select fields from inside the query.

  <!-- -->

  - > **Note**

    - > If a generated issue has severity **Medium** or above, a case is
      > automatically opened.

    - > Low severity issues generated by correlation rules are not
      > grouped into cases.

  <!-- -->

  - **Category**: Select the type of issue that is generated. The list
    of categories reflects the selected domain.

  - **Issue Description** (*Optional*): Specify a description of the
    behavior that will raise the issue. You can include dollar signs
    (`$`), which represent the fields names (i.e. output columns) in XQL
    Search.

  <!-- -->

  - For example.

        The user $user_name has made $count failed login requests to $dest in a 24 hours period

    Output.

        The user lab_admin has made 234 failed login requests to 10.10.32.44 in a 24 hours period

    > **Note**

    > There is no validation or auto complete for these parameters and
    > the values can be null or empty. In these scenarios, Cortex XSIAM
    > does not display the null or empty values, but adds the text
    > `NULL` or `EMPTY` in the descriptions.

  <!-- -->

  - **Drill-Down Query** (*Optional*): You can configure a
    **Drill-Down Query** for additional information about the issue for
    further investigation using XQL. This XQL query can accept
    parameters from the issue output for the Correlation Rule. Yet, keep
    in mind that when you create the Correlation Rule, Cortex XSIAM does
    not know in advance if the parameters exist or contain the correct
    values. As a result, Cortex XSIAM enables you to save the query, but
    the query can fail when you try and run it. You can also refer to
    field names using dollar signs (`$`) as explained in the Issue
    Description.

  <!-- -->

  - Once configured any issue generated for the Correlation Rule has a
    right-click pivot menu **Open Drilldown Query** option, an
    **Open drilldown query** link after you investigate a contributing
    event, and a quick action **Open Drilldown Query** icon
    (![](media/rId2937.png){width="0.15625in"
    height="0.20833333333333334in"}) that is accessible in the
    **Issues** page, which opens a new browser tab in XQL Search to run
    this query. If you do not define a **Drill-Down Query**, no
    right-click pivot menu option, link, or icon is displayed.

  <!-- -->

  - **Drill-Down Query Time Frame**: Select the time frame used to run
    the Drill-Down Query from one of the following options, which
    provides more informative details about the issue generated by the
    Correlation Rule.

    - **Generated Issue**: Uses the time frame of the issue that is
      generated, which is the first event and last event timestamps for
      the issue (default option). If there is only one event, the event
      timestamp is the time frame used for the query.

    - **XQL Search**: Uses the time frame from when the Correlation Rule
      was run in XQL Search.

  - **MITRE ATT&CK** (*Optional*): Select the MITRE Tactics and MITRE
    Techniques you want to associate with the issue using the
    **MITRE ATT&CK** matrix.

    1.  You can access the matrix by selecting the **MITRE ATT&CK** bar
        or **Open complete MITRE matrix** link underneath the bar on the
        right.

    2.  Select the MITRE Tactics listed in the first row of the matrix
        and the applicable MITRE techniques and Sub-Techniques, which
        are listed in the other rows in the table. You can select either
        MITRE Tactics only, MITRE techniques and Sub-Techniques only, or
        a combination of both.

    3.  Click **Select** and the matrix window closes and the
        **MITRE ATT&CK** section in the **New Correlation Rule** editor
        lists the number of **Tactics** and **Techniques** configured,
        which is also listed in the bar. For example, in the following
        image, there are **3 Tactics and 4 Techniques** configured. The
        three MITRE Tactics are **Resource Development** with 2
        Techniques configured, **Credential Access** with 1 Technique
        configured, and **Discovery** with 1 Technique configured.

  Issues Fields Mappings
  You can map the issue fields to display the mapped fields in the
  **Issues** page to provide important information in analyzing your
  issues. In addition, mapping the fields helps to improve incident
  grouping logic and enables Cortex XSIAM to list the artifacts and
  assets based on the map fields in the incident. The options available
  can change depending on your Correlation Rule definitions in
  **XQL Search**. Each preconfigured field that is automatically mapped
  is clearly displayed. There are two ways to map the issue fields.

  - **Use the preconfigured Cortex XSIAMIssue field mapping**

  <!-- -->

  - Select this option if you want Cortex XSIAM to automatically map the
    fields for you. This checkbox only displays when your Correlation
    Rule can be configured to use Cortex XSIAM incident enrichment and
    then it is set as the default option. We recommend using this option
    whenever it is available to you.

    When creating a Correlation Rule that runs on the Cortex Data Model
    (XDM), we recommend that this checkbox is selected. Cortex XSIAM
    automatically maps the XDM fields to issue fields as listed in the
    table below. This means that these XDM field values are displayed in
    the **Issues** page.

    > **Note**

    > When more than one XDM field is listed, Cortex XSIAM looks for the
    > field value according to the order of the fields listed.

    You can edit the source mapped to preconfigured fields to customize
    the mapping to your needs. Click the Edit icon next to a field value
    to select one of the other values.

    Manually map the issue fields by selecting the fields that you want
    to map. When you create the Correlation Rule, Cortex XSIAM does not
    detect whether the issue fields that you mapped manually are valid.
    If the fields are invalid according to your mapping, null values are
    assigned to those fields.

    > **Note**

    > When more than one XDM field is listed, Cortex XSIAM looks for the
    > field value according to the order of the fields listed.

    XDM fields mapped to issue fields

  ------------------------------------------------------------------------------------
  XDM Fields                                       Cortex XSIAM Issue Fields
  ------------------------------------------------ -----------------------------------
  xdm.source.host.fqdn                             Domain

  xdm.event.type                                   Event Type

  xdm.target.file.filename,                        File name
  xdm.target.module.filename,                      
  xdm.email.attachment.filename                    

  xdm.target.file.sha256,                          File SHA256
  xdm.target.module.sha256,                        
  xdm.email.attachment.sha256                      

  xdm.source.host.ipv4_addresses                   Host IP

  xdm.source.host.hostname                         Host Name

  xdm.source.host.os_family                        Host OS

  xdm.source.process.executable.filename,          Initiated By
  xdm.source.process.name                          

  xdm.source.process.command_line                  Initiator CMD

  xdm.source.process.executable.path               Initiator path

  xdm.source.process.executable.sha256             Initiator SHA256

  xdm.source.process.executable.signature_status   Initiator signature

  xdm.source.process.executable.signer             Initiator signer

  xdm.source.ipv4, xdm.source.host.ipv4_addresses  Local IP

  xdm.target.process.executable.signature_status   Process execution signature

  xdm.target.process.executable.signer             Process execution signer

  xdm.target.host.hostname                         Remote Host

  xdm.target.ipv4, xdm.target.host.ipv4_addresses  Remote IP

  xdm.target.port                                  Remote port

  xdm.target.process.command_line                  Target process CMD

  xdm.target.process.executable.filename,          Target Process Name
  xdm.target.process.name                          

  xdm.target.process.executable.path               Target Process Path

  xdm.target.process.executable.sha256             Target process SHA256

  xdm.target.url                                   URL

  xdm.source.user.username                         User name
  ------------------------------------------------------------------------------------

- User Defined Fields
  You can add more fields to the current preconfigured listing. To do
  so, under **User Defined Fields**, click **Add field** and select from
  the options. When Cortex XSIAM adds a new preconfigured destination
  field, if you have already defined this destination field, your
  selection overrides the out-of-the-box mapping to that destination.

<!-- -->

- Manually map the issue fields by selecting the fields that you want to
  map. When you create the Correlation Rule, Cortex XSIAM does not
  detect whether the issue fields that you mapped manually are valid. If
  the fields are invalid according to your mapping, null values are
  assigned to those fields.

<!-- -->

- > **Note**

  > When **Use the Cortex XSIAM default incident enrichment** is not
  > selected and you have not mapped any issue fields, the issue is
  > dispatched into a new incident.

  (Optional)
  **Set fields as default for new Security Domain correlations** - saves
  the custom issue fields that are configured for this rule for all
  users. When a user next creates an incident for the same domain, these
  fields are automatically configured instead of the default field set.

  To restore the system defaults, click
  **Restore default system fields**.

<!-- -->

- (Optional) To enable pivots from issues to a third-party source
  system, in the **Issues Fields Mapping** section, click **+Add field**
  and select the **External URL** option. For this field, search for and
  select the dataset field which stores the third-party URL.

<!-- -->

- Save to dataset
  Use to save the data generated from the Correlation Rule to a separate
  **Target Dataset**. This option is helpful when you are fine-tuning
  and testing a rule before promoting the rule to production. You can
  also save a rule to a dataset as a building block for the next
  Correlation Rule, which will be based on the results of the first
  Correlation Rule instead of building too complex XQL queries.

  You can either create a new **Target Dataset** by specifying the name
  for the dataset in the field or select a preexisting
  **Target Dataset** that was created for a different Correlation Rule.
  The list only displays the datasets configured when creating a
  Correlation Rule. Different Correlation Rules can be saved to the same
  dataset and Cortex XSIAM will expand the dataset schema as needed. The
  dataset you configure for the Correlation Rule contains the following
  additional fields:

  - `_rule_id`

  - `_rule_name`

  - `_insert_time`

  Add to lookup
  Use to add data to a specified lookup dataset. After selecting this
  option, perform the following:

  1.  In the **Target Dataset** field, select an existing lookup dataset
      to add the data.

  - In the displayed mapping, Cortex XSIAM lists fields from the lookup
    schema in the **KEY** column to enayou to map fields from the query
    to an entry in the lookup.

  2.  In the **VALUE** column, map at least one field from the query to
      an entry in the lookup dataset (**KEY** column).

  3.  (optional) You can set a single field or multiple fields as unique
      by selecting the checkbox in the **UNIQUE** column. A unique field
      means these fields are designated as a key to update existing
      entries as opposed to creating a new entry. If multiple fields are
      selected, these fields together are used to identify existing
      entries. If several existing entries meet the condition, all these
      entries are updated. If no existing entries meet the condition,
      the entry is added as a new one. If no field is marked as unique,
      records are added as new.

  > **Important**

  > The maximum size of a lookup dataset is 50 MB. If the data exceeds
  > this limit, the add to lookup action fails.

  Remove from lookup
  Removes data from a specified lookup dataset. After selecting this
  option, perform the following:

  1.  In the **Target Dataset** field, select an existing lookup dataset
      to remove data.

  - In the displayed mapping, Cortex XSIAM lists fields from the lookup
    schema in the **KEY** column to enable you to map fields from the
    query to an entry in the lookup.

  2.  In the **VALUE** column, map at least one field from the query to
      an entry in the lookup dataset (**KEY** column). All rows (lookup
      entries) matching these field mapping values (filtering condition)
      will be deleted. If several existing entries meet the condition,
      all these entries are deleted. If no existing entries meet the
      condition, no entries are deleted.

8.  (*Optional*) Disable the Correlation Rule.

- Select Disable \> Create if you want to finish configuring your
  Correlation Rule at a different time, but do not want to lose your
  settings. The **Create** button is only enabled when you have
  configured all the mandatory fields in the **New Correlation Rule**
  editor. Once configured, your Correlation Rule is listed in the
  **Correlation Rules** page, but is disabled. You can edit or enable
  the rule at any time by right-clicking the rule and selecting
  **Edit Rule** or **Enable**.

9.  **Create** the correlation rule.

- The rule is added to the table in the **Correlation Rules** page as an
  active rule and a notification is displayed.

Import correlation rules from a file

You can import a number of correlation rules from a JSON file. This
facilitates the sharing of correlation rules between tenants.

To import a file containing correlation rules, select Threat Management
\> Detection Rules \> Correlations and click **Import** at the top right
corner of the page.

###### Field replacement syntax in correlation rules

When creating correlation rules, it\'s possible to use predefined values
for different fields in the editor, such as **Alert Name**,
**Alert Description**, and **Drill-Down Query**. These predefined values
follow a certain syntax and are dependent on the Cortex Query Language
(XQL) query for the correlation rule that you build in the
**XQL Search** and **Drill-Down Query** areas in the editor. For
example, if you define the **Alert Name** to be something, such as
`Alerts based on $agent_name`, the XQL query defining the correlation
rule must have the `agent_name` field defined in the logic of the query;
otherwise, this field won\'t be replaced.

Standard field replacement

Syntax

    $<field>

The following text is added to the **Alert Description** field in the
correlation rule editor, which uses a regular field:

`The user's registered email is: $Email`

Example Results:

If the `Email` field is a saved value containing `john.doe@example.com`,
the output of the Alert Description is:

`The user's registered email is: john.doe@example.com`

The following text is added to the **Alert Description** field in the
correlation rule editor, using an XDM field:

`The user's registered email is: $xdm.email.recipient`

Example Results:

If the `xdm.email.recipient` field is a saved value
containing`john.doe@example.com`, the output is:

`The user's registered email is: john.doe@example.com`

Keep in mind the following:

- `<field>` identifiers must consist exclusively of alphanumeric
  characters (a-z, A-Z, 0-9) and underscores (`_`).

- Cortex Data Model (XDM) fields can include dot (`.`) characters.

- While `<field>` identifiers can begin with a numeric character, the
  fields cannot be composed solely of numeric characters. For example,
  `$123_data` is permissible, whereas `$456` is not.

- Text enclosed with double quotes (`"<text>"`) is treated as a literal
  string and will not undergo field replacement.

<!-- -->

- The following text is added to the **Alert Description** field in the
  correlation rule editor:

  `The user's registered email is: "$Email"`

  Example Results:

  Since the syntax is invalid, it\'s ignored and the same text is
  displayed:

  `The user's registered email is: "$Email"`

Fields with special characters

When field names contain characters that are not permitted in the
standard `$<field>` syntax, such as spaces, hyphens, or special symbols,
the field name must be enclosed within backticks (``` `` ```)

Syntax

    $`<field>`

The following text is added to the **Alert Description** field in the
correlation rule editor, using a field containing characters that are
not permitted:

`` Report Title: $`Annual Sales Report - Q1 2025` ``

Example Results:

If the Annual Sales Report - Q1 2025 field is a saved value containing
`Executive Summary`, the output is:

`Report Title: Executive Summary`

###### Manage correlation rules

View and manage your correlation rules in Threat Management \> Detection
Rules \> Correlations. To manage a Correlation Rule, right-click the
Correlation Rule and select an action.

You can also monitor your correlation rule executions with the
`correlations_auditing` data set. For more information, see [Monitor
correlation rules](#UUID545b82d0905f32a2b38ce3c75a487bcb).

Right-click actions for managing correlation rules

- **View related issues:** View the issues generated by this correlation
  rule in the **Issues** page. You can **Show issues in new tab** or
  **Show issues in same tab**.

- **Open in XQL:** View the XQL results for the correlation rule in XQL
  Search. You can **Show results in new tab** or
  **Show results in same tab**.

- **Execute Rule:** Run the rule now without waiting for the scheduled
  time.

<!-- -->

- > **Note**

  > Execute Rule is not available for real time correlation rules.

<!-- -->

- **Preview Rule:** View the rule before it\'s executed.

- **Save as new:** Duplicate the correlation rule and save it as a new
  correlation rule.

- **Export:** Select one or more rules to export to a JSON file.

- **Disable** the selected correlation rule. This option is only
  available on an active rule.

- **Enable** the selected correlation rule. This option is only
  available on an inactive rule.

- **Edit Rule**: Edit the rule parameters configured in the
  **Edit Correlation Rule** editor.

- **Delete** the correlation rule.

- **Copy entire row** to copy the text from all the fields in a row of a
  correlation rule.

- **Show rows with '\<field value\>'** to filter the correlation rules
  list to only display the correlation rules with a specific field value
  that you select in the table. On certain fields that are null, this
  option does not display.

- **Hide rows with '\<Rule Description\>':** Filter the correlation
  rules list to hide the correlation cules with a specific field value
  that you select in the table. On certain fields that are null, this
  option does not display.

###### Monitor correlation rules

Cortex XSIAM audits all correlation rule executions in the
`correlations_auditing` dataset. The dataset records the query
initiation times, end times, retry attempts, failure reasons, and other
useful metrics. You can use this dataset to monitor your correlation
executions. Cortex XSIAM also provides OOTB health issues that are
generated when a correlation rule completes with errors. For more
information, see [About health
issues](#UUIDdfd48b778b41de7955182409372663e9).

In the `correlations_auditing` dataset, audit entries are added as
follows:

- The rule starts executing. This is audited with the status of
  **Initiated** or **Initiated Manually**.

- The rule completes successfully. This is audited as **Completed**.

- The rule completes with errors. This is audited as **Error**.

> **Note**
>
> In the dataset, the **Query start time** and **Query end time**
> indicate the time frame of the data that was queried. The actual start
> and end times of the correlation rule execution are recorded in the
> **\_time** field for the **Initiated** and **Completed** entries.

####### Field descriptions for the correlations_auditing dataset

The following table describes the fields in the correlations_auditing
dataset:

+-----------------------------------+-----------------------------------+
| Field                             | Description                       |
+===================================+===================================+
| \_time                            | Timestamp of the audit.           |
|                                   |                                   |
|                                   | For entries with an **Initiated** |
|                                   | or **Initiated Manually** status, |
|                                   | this is the start time of the     |
|                                   | correlation rule execution. For   |
|                                   | entries with a **Completed** or   |
|                                   | **Error** status, this is the end |
|                                   | time of the rule execution.       |
+-----------------------------------+-----------------------------------+
| \_id                              | Unique identifier of the audit    |
|                                   | entry.                            |
+-----------------------------------+-----------------------------------+
| Rule ID                           | Unique identification number for  |
|                                   | the correlation rule.             |
+-----------------------------------+-----------------------------------+
| Name                              | Correlation rule name.            |
+-----------------------------------+-----------------------------------+
| Status                            | The status of the correlation     |
|                                   | rule query.                       |
|                                   |                                   |
|                                   | Possible values are Initiated,    |
|                                   | Initiated Manually, Completed,    |
|                                   | and Error.                        |
+-----------------------------------+-----------------------------------+
| Query start time                  | The start time of the query time  |
|                                   | frame.                            |
+-----------------------------------+-----------------------------------+
| Query end time                    | The end time of the query time    |
|                                   | frame.                            |
+-----------------------------------+-----------------------------------+
| Time frame                        | Time frame for the query.         |
+-----------------------------------+-----------------------------------+
| Failure reason                    | For correlation rules with        |
|                                   | errors, this field displays the   |
|                                   | error message.                    |
+-----------------------------------+-----------------------------------+
| Retry attempts                    | Number of retry attempts before   |
|                                   | the query initiated or failed to  |
|                                   | run.                              |
+-----------------------------------+-----------------------------------+
| Schedule                          | Scheduled frequency to execute    |
|                                   | the correlation rule.             |
+-----------------------------------+-----------------------------------+
| Rule creation time                | Date and time that the            |
|                                   | correlation rule was created.     |
+-----------------------------------+-----------------------------------+
| Rule modification time            | Date and time that the            |
|                                   | correlation rule was last         |
|                                   | modified.                         |
+-----------------------------------+-----------------------------------+
| Description                       | Description of the correlation    |
|                                   | rule.                             |
+-----------------------------------+-----------------------------------+
| Severity                          | Defined severity of the           |
|                                   | correlation rule.                 |
+-----------------------------------+-----------------------------------+
| Dataset                           | Target data set, as defined in    |
|                                   | the correlation rule              |
+-----------------------------------+-----------------------------------+
| Suppression status                | Whether issue suppression is      |
|                                   | Enabled or Disabled.              |
+-----------------------------------+-----------------------------------+
| Suppression duration              | Duration for which to ignore      |
|                                   | additional events that match the  |
|                                   | issue suppression criteria.       |
+-----------------------------------+-----------------------------------+
| Suppression fields                | Fields on which the issue         |
|                                   | suppression is based.             |
+-----------------------------------+-----------------------------------+
| Timezone                          | Timezone on which the scheduled   |
|                                   | frequency is based.               |
+-----------------------------------+-----------------------------------+
| MITRE ATT&CK Tactic               | MITRE ATT&CK tactic that the      |
|                                   | correlation rule attempted to     |
|                                   | generate.                         |
+-----------------------------------+-----------------------------------+
| MITRE ATT&CK Technique            | MITRE ATT&CK technique that the   |
|                                   | correlation rule attempted to     |
|                                   | generate.                         |
+-----------------------------------+-----------------------------------+
| Alert category                    | Category of issue as configured   |
|                                   | when creating the rule.           |
+-----------------------------------+-----------------------------------+
| Source                            | Source of the correlation rule.   |
+-----------------------------------+-----------------------------------+
| XQL search                        | XQL query for the correlation     |
|                                   | rule.                             |
+-----------------------------------+-----------------------------------+
| Drill-down query                  | XQL query configured for further  |
|                                   | investigation.                    |
+-----------------------------------+-----------------------------------+
| Alert name                        | Name of the issue that the        |
|                                   | correlation rule will generate.   |
+-----------------------------------+-----------------------------------+

###### Troubleshoot server errors in scheduled correlation rules

When you encounter any server errors in scheduled correlation rules,
there are some steps you can perform to address the issues depending on
the type of error. Follow the steps below to help troubleshoot the
issue.

Errors related to the query

Error messages

- A server error occurred while running the query.

- This rule did not run because resources were exceeded during query execution.

Steps to perform

These errors indicate that the Cortex Query Language (XQL) query for the
scheduled correlations rule is complex, broad, or exceeding resource
limits. To fix the query, perform the following:

1.  Run the query for the scheduled correlation rule in the Query
    Builder to identify syntax issues or logic errors introduced by any
    recent changes.

2.  Review your query and decide which actions you can perform to fix
    the query:

    - Simplify the query by removing any fields that are not essential
      for the required results.

    - If the query covers an extended period, reduce the time frame.

    - If real-time correlation rules are supported and being used,
      consider converting your query to this mode.

    - When queries involve complex operations, such as `comp`, precede
      these with a `fields` stage to set only the necessary fields
      required to include in the query results.

    - Divide overly complex or data-heavy queries into multiple, simpler
      correlation rules.

    - If the scheduled correlation rule includes a `datamodel` stage, in
      certain cases, it may be beneficial to apply filters, joins, and
      computations directly on the original dataset fields, rather than
      on the normalized Cortex Data Model (XDM) fields.

Error related to the alert

Error message

    A server error occurred while generating the alert.

Steps to perform

This error typically points to issues with the output alert
configuration\'s complexity or content. Consider taking the following
actions:

- Simplify the query output by excluding non-essential fields and any
  fields that may contain excessively large data.

- In some cases, the size of the query output can include fields that
  are too large to allow alerts to be generated successfully. To avoid
  this, we recommend setting boundaries that improve the chances of the
  correlation rule running successfully over time by performing the
  following:

  - Limit the length of the calculated array fields by using the
    `arrayrange()` function. For more information, see
    [arrayrange](#UUID6e89a29ea6b3f39a3365dab0b37588b3).

  <!-- -->

  - Limits the length of the calculated `array_field` field to return
    only the first 1000 elements:

        arrayrange(array_field, 0, 1000)

  <!-- -->

  - Limit the length of string fields set to an unlimited length using
    the `trim` function. For more information, see [ltrim, rtrim,
    trim](#UUIDc26ba83dd495000766b65404b8e9d686).

  <!-- -->

  - Limits the length of the `string_field` field, which is set to an
    unlimited length, to return the first 1000 characters:

        rtrim(string_field, len(string_field) - 1000)

- Reduce the length and complexity of the **Alert Name**,
  **Description**, and any associated **Drill-Down Query**.

- Temporarily remove any mapped fields from the alert configuration.

- If present, verify the existence of the fields within the table.
  Temporarily remove suppression fields from the alert configuration.

- Use Static Severity: If dynamic severity is in use, switch to static.

When to contact support team

If the steps explained above don\'t resolve the issue, contact our
support team and provide the following details:

- The exact error message received.

- The actions which led to the error.

- A list of the troubleshooting steps you\'ve already attempted from the
  list provided above.

##### Manage IOC and BIOC rules

After you create an indicator rule, you can take the following actions:

> **Note**
>
> For Analytics BIOC rules, you can only disable and enable rules.

###### View issues generated by a rule

As your IOC and BIOC rules generate issues, Cortex XSIAM displays the
total **# OF ALERTS** generated by the rule in the the BIOC or IOC rules
page. For rules with a high, medium, or low severity that have generated
one or more issues, you can quickly pivot to a filtered view of those
issues generated by the indicator:

1.  Select Threat Management \> Detection Rules and the type of rule
    (**BIOC** or **IOC**).

2.  Right-click anywhere in a rule, and then select
    **View associated issues**.

- You can view a filtered query of issues associated with the Rule ID.

###### Use a BIOC rule as the basis of a query

1.  Select Detection & Threat Intel \> Detection Rules and the type of
    rule (**BIOC** or **IOC**).

2.  Right-click anywhere in the rule, and then select
    **Open in query builder**.

- Cortex XSIAM populates a query using the criteria of the BIOC rule.

3.  Add or change the query criteria as required.

4.  (Optional) **Test** your query to see the sample results.

5.  If you are satisfied with the query, **Save** it.

- For more information, see [Edit and run queries in Query
  Center](#UUID974b478c9f704ef03a37f626c33f61cb).

###### Edit a rule

After you create a rule, it may be necessary to tweak or change the rule
settings. You can open the rule configuration from the Rules page or
from the pivot menu of an issue generated by the rule. To edit the rule
from the Rules page:

1.  Select Threat Management \> Detection Rules and the type of rule
    (**BIOC** or **IOC**).

2.  Locate the rule you want to edit.

3.  Right-click anywhere in the rule and select **Edit**.

4.  Edit the rule settings as needed, and then click **OK**.

- If you make any changes, **Test** and then **Save** the rule.

###### Export a rule (BIOC only)

1.  Select Threat Management \> Detection Rules \> BIOC.

2.  Select the rules that you want to export.

3.  Right-click any of the rows, and select **Export selected**.

- The exported file is not editable, however, you can use it as a source
  to import rules at a later date.

###### Copy a BIOC rule

You can use an existing rule as a template to create a new one. Global
BIOC rules cannot be deleted or altered, but you can copy a global rule
and edit the copy.

1.  Select Threat Management \> Detection Rules and then **BIOC**.

2.  Locate the rule you want to copy.

3.  Right-click anywhere in the rule row and then select **Save as New**
    to create a duplicate rule.

###### Disable or remove a rule

If you no longer need a rule you can temporarily disable or permanently
remove it.

> **Note**
>
> You cannot delete global BIOCs delivered with content updates.

1.  Select Threat Management \> Detection Rules and the type of rule
    (**BIOC** or **IOC**).

2.  Locate the rule that you want to change.

3.  Right-click anywhere in the rule row and then select **Remove** to
    permanently delete the rule, or **Disable** to temporarily stop the
    rule. If you disable a rule you can later return to the rule page to
    **Enable** it.

###### Partially disable or re-enable a BIOC rule

You can disable one or more BIOC rules on the agent, on the server, or
on both. This provides you more granularity for managing the prevention
actions generated by the BIOC Rules.

1.  Navigate to Threat Management \> Detection Rules \> BIOC.

2.  Select the rules you want to disable.

3.  Right-click any of the rules and select to disable the rules on the
    agent, on the server, or on both.

- > **Note**

  > For BIOC rules that are applied to prevention profiles:

  - > If you disable a rule only on the agent, detection on the server
    > works as usual.

  <!-- -->

  - > If you disable a rule only on the server, prevention on the agent
    > works as usual.

4.  We recommend you supply a reason for disabling the rule.

> **Note**
>
> When a BIOC rule is disabled automatically by Cortex XSIAM, for
> example due to the server anti flooding mechanism, prevention on the
> agent works as before.

You can re-enable a rule granularly for detection, prevention, or both
in the same way.

### Analytics

Analytics uses the Analytics engine, sensors, and rules to keep your
network safe.

Safeguarding your network requires a defense-in-depth strategy which
utilizes current and patched software and hardware to keep unwanted
users out of the network. Most available strategies are designed to stop
intrusion attempts at the network perimeter, defending only against
known threats. For example, systems scanning for malicious software rely
on previously identified MD5 signature databases. However, attackers
constantly modify virus signatures to circumvent virus scanners. Your
network defense-in-depth strategy must include software and processes
designed to detect and respond to intruders that may have already
penetrated your systems.

Cortex XSIAM efficiently and automatically identifies abnormal activity
on your network, while providing you with the exact information you need
to rapidly evaluate, isolate and remove potential threats.

#### Analytics engine

Cortex XSIAM uses its Analytics Engine to examine logs and data
retrieved from your sensors on the Cortex XSIAM tenants to build an
activity baseline, and recognize abnormal activity when it occurs. The
Analytics engine accesses your logs as they are streamed to the Cortex
XSIAM tenant, including any firewall data, and analyzes the information
as soon as it arrives. Cortex XSIAM triggers an Analytics issue when the
Analytics Engine determines an anomaly.

The Analytics Engine examines traffic and data from a variety of sources
such as network activity from firewall logs, VPN logs (from Prisma
Access from the Panorama plugin), endpoint activity data, Active
Directory or a combination of these sources, to identify the endpoints
and users on your network. After identifying the endpoints and the
users, the Analytics Engine collects relevant details about each asset
based on the information it obtains from the logs to create profiles.
The Analytics Engine can detect threats from only network data or only
endpoint data, but for more context when investigating an issue, we
recommend using a combination of data sources.

An enhanced Analytics Activation mechanism is available as a Beta
feature. This mechanism improves resilience to baseline shifts, enhances
detection accuracy, and reduces false positives and noise when
integrating new data sources that may impact analytics detector
baselines. When you integrate a new data source, the enhanced mechanism
initiates a targeted soak period for each detector. During the soak
period, detections on the new source are temporarily withheld while the
Analytics engine learns and adjusts baselines, whereas detections from
existing sources remain unaffected. This ensures a smooth adaptation
process which maintains analytics integrity and accuracy.

Cortex XSIAM also enables analytics to run on all mapped network and
authentication data. For more information, see
[MODEL](#UUIDafdf6badf4a75dd79aa1d38d85bf277d).

The Analytics Engine creates and maintains profiles to view the activity
of the endpoint or user in context by comparing it to similar endpoints
or users. The large number of profile types can generally be placed into
one of three categories.

- Peer Group profiles: A statistical analysis of an entity or an entity
  relation that compares activities from multiple entities in a peer
  group. For example, a domain can have a cross-organization popularity
  profile or per peer group popularity profile.

- Temporal profiles: A statistical analysis of an entity or an entity
  relation that compares the same entity to itself over time. For
  example, a host can have a profile depending on the number of ports it
  accessed in the past.

- Entity classification: A model detecting the role of an entity. For
  example, users can be classified as service accounts, and hosts as
  domain controllers.

#### Analytics sensors

To detect anomalous behavior, Cortex XSIAM can analyze logs and data
from a variety of sensors.

+-----------------------------------+-----------------------------------+
| Sensor                            | Description                       |
+===================================+===================================+
| **Palo Alto Networks sensors**    |                                   |
+-----------------------------------+-----------------------------------+
| Firewall traffic logs             | Palo Alto Networks firewalls      |
|                                   | perform traditional and           |
|                                   | next-generation firewall          |
|                                   | activities. The Cortex XSIAM      |
|                                   | Analytics engine can analyze Palo |
|                                   | Alto Networks firewall logs to    |
|                                   | obtain intelligence about the     |
|                                   | traffic on your network. A Palo   |
|                                   | Alto Networks firewall can also   |
|                                   | enforce Security policies based   |
|                                   | on IP addresses and domains       |
|                                   | associated with Analytics issues  |
|                                   | with external dynamic lists.      |
+-----------------------------------+-----------------------------------+
| Enhanced application logs (EAL)   | To provide greater coverage and   |
|                                   | accuracy, you can enable enhanced |
|                                   | application logging on your Palo  |
|                                   | Alto Networks firewalls. Enhanced |
|                                   | Application Logs (EAL) are        |
|                                   | collected by the firewall to      |
|                                   | increase visibility into network  |
|                                   | activity for Palo Alto Networks   |
|                                   | apps and services, like Cortex    |
|                                   | XSIAM.                            |
|                                   |                                   |
|                                   | Types of data collected by EAL    |
|                                   | include, amongst others, records  |
|                                   | of DNS queries, the HTTP header   |
|                                   | User Agent field that specifies   |
|                                   | the web browser or tool used to   |
|                                   | access a URL, and information     |
|                                   | about DHCP automatic IP address   |
|                                   | assignment. For example, with     |
|                                   | DHCP information, Cortex XSIAM    |
|                                   | can generate an issue when it     |
|                                   | detects unusual activity based on |
|                                   | hostname instead of IP address.   |
|                                   | This enables the security analyst |
|                                   | to meaningfully assess whether    |
|                                   | the user's activity is within the |
|                                   | scope of their role, and if not,  |
|                                   | to stop the activity.             |
+-----------------------------------+-----------------------------------+
| GlobalProtect and Prisma Access   | If you use GlobalProtect or       |
| logs                              | Prisma Access to extend your      |
|                                   | firewall security coverage to     |
|                                   | your mobile users, Cortex XSIAM   |
|                                   | can analyze VPN traffic to detect |
|                                   | anomalous behavior on mobile      |
|                                   | endpoints.                        |
+-----------------------------------+-----------------------------------+
| Firewall URL logs (part of        | Palo Alto Networks firewalls can  |
| firewall threat logs)             | log threat log entries when       |
|                                   | traffic matches one of the        |
|                                   | Security Profiles attached to a   |
|                                   | security rule on the firewall.    |
|                                   | Cortex XSIAM can analyze entries  |
|                                   | for Tthreat logs relating to URLs |
|                                   | and generate issues that indicate |
|                                   | malicious behavior such as        |
|                                   | command and control, and          |
|                                   | exfiltration.                     |
+-----------------------------------+-----------------------------------+
| Cortex XSIAM agent endpoint data  | With a Cortex XSIAM Pro per       |
|                                   | Endpoint license, you can deploy  |
|                                   | Cortex XDR agents on your         |
|                                   | endpoints to protect them from    |
|                                   | malware and software exploits.    |
|                                   | The Analytics engine can also     |
|                                   | analyze the EDR data collected by |
|                                   | the agent to generate issues. To  |
|                                   | collect EDR data, you must        |
|                                   | install Cortex XDR agent 6.0 or a |
|                                   | later release on your Windows     |
|                                   | endpoints (Windows 7 SP1 or       |
|                                   | later).                           |
|                                   |                                   |
|                                   | The Cortex XSIAM Analytics engine |
|                                   | can analyze activity and traffic  |
|                                   | based solely on endpoint activity |
|                                   | data sent from Cortex XDR agents. |
|                                   | For increased coverage and        |
|                                   | greater insight during            |
|                                   | investigations, use a combination |
|                                   | of Cortex XDR agent data and      |
|                                   | firewalls to supply activity logs |
|                                   | for analysis.                     |
+-----------------------------------+-----------------------------------+
| Pathfinder data collector         | In a firewall-only deployment     |
|                                   | where the Cortex XDR agent is not |
|                                   | installed on your endpoints, you  |
|                                   | can use Pathfinder to monitor     |
|                                   | endpoints. Pathfinder scans       |
|                                   | unmanaged hosts, servers, and     |
|                                   | workstations for malicious        |
|                                   | activity. The Analytics engine    |
|                                   | can also analyze the Pathfinder   |
|                                   | data collector in combination     |
|                                   | with other data sources to        |
|                                   | increase coverage of your network |
|                                   | and endpoints, and to provide     |
|                                   | more context when investigating   |
|                                   | issues.                           |
+-----------------------------------+-----------------------------------+
| Directory Sync logs               | If you use the Cloud Identity     |
|                                   | Engine to provide Cortex XSIAM    |
|                                   | with Active Directory data, the   |
|                                   | Analytics engine can also         |
|                                   | generate issues on your Active    |
|                                   | Directory logs.                   |
+-----------------------------------+-----------------------------------+
| **External sensors**              |                                   |
+-----------------------------------+-----------------------------------+
| Third-party firewall logs         | If you use non-Palo Alto Networks |
|                                   | firewalls - Check Point,          |
|                                   | Fortinet, Cisco ASA - in addition |
|                                   | to or instead of Palo Alto        |
|                                   | Networks firewalls, you can set   |
|                                   | up a syslog collector to          |
|                                   | facilitate log and issue          |
|                                   | ingestion. By sending your        |
|                                   | firewall logs to Cortex XSIAM,    |
|                                   | you can increase detection        |
|                                   | coverage and take advantage of    |
|                                   | Cortex XSIAM analysis             |
|                                   | capabilities. When Cortex XSIAM   |
|                                   | analyzes your firewall logs and   |
|                                   | detects anomalous behavior, it    |
|                                   | generates an issue.               |
+-----------------------------------+-----------------------------------+
| Third-party authentication        | If you use an authentication      |
| service logs                      | service---Microsoft Azure AD,     |
|                                   | Okta, or PingOne---you can set up |
|                                   | log collection to ingest          |
|                                   | authentication logs and data into |
|                                   | authentication stories.           |
+-----------------------------------+-----------------------------------+
| Windows Event Collector logs      | The Windows Event Collector (WEC) |
|                                   | runs on the Broker VM collecting  |
|                                   | event logs from Domain            |
|                                   | Controllers (DCs). The Analytics  |
|                                   | engine can analyze these event    |
|                                   | logs to generate issues such as   |
|                                   | for credential access and defense |
|                                   | evasion.                          |
+-----------------------------------+-----------------------------------+

#### Coverage of MITRE Attack tactics

Network attacks follow predictable patterns. If you interfere with any
portion of this pattern, you can neutralize the attack. The adversarial
behaviors making up these patterns are collected in a universally
accessible, continuously updated knowledge base called the [MITRE
ATT&CK™ knowledge base of tactics](https://attack.mitre.org/).

![](media/rId2993.png){width="5.833333333333333in"
height="2.8935181539807524in"}

The Analytics Engine can generate an issue for any of the following
attack tactics as defined in the MITRE Attack database.

+-----------------------------------+-----------------------------------+
| Tactic                            | Description                       |
+===================================+===================================+
| Execution                         | After attackers gain a foothold   |
|                                   | in your network, they can use     |
|                                   | various techniques to execute     |
|                                   | malicious code on a local or      |
|                                   | remote endpoint.                  |
|                                   |                                   |
|                                   | Cortex XSIAM detects malware and  |
|                                   | grayware on your network using a  |
|                                   | combination of network activity,  |
|                                   | Pathfinder data collector of your |
|                                   | unmanaged endpoints, endpoint     |
|                                   | data from your Cortex XDR agents, |
|                                   | and evaluation of suspicious      |
|                                   | files using the WildFire cloud    |
|                                   | service.                          |
+-----------------------------------+-----------------------------------+
| Persistence                       | To carry out a malicious action,  |
|                                   | an attacker can try techniques    |
|                                   | that maintain access in a network |
|                                   | or on an endpoint. An attacker    |
|                                   | can initiate configuration        |
|                                   | changes---such as a system        |
|                                   | restart or failure---that require |
|                                   | the endpoint to restart a remote  |
|                                   | access tool or open a back door   |
|                                   | that allows the attacker to       |
|                                   | regain access on the endpoint.    |
+-----------------------------------+-----------------------------------+
| Discovery                         | When an attacker has access to a  |
|                                   | part of your network, they use    |
|                                   | discovery techniques to explore   |
|                                   | and identify subnets, servers and |
|                                   | services that are hosted on those |
|                                   | endpoints. They aim to identify   |
|                                   | vulnerabilities within your       |
|                                   | network.                          |
|                                   |                                   |
|                                   | Cortex XSIAM detects these        |
|                                   | tactics by looking for indicators |
|                                   | in your internal network traffic  |
|                                   | such as changes in connectivity   |
|                                   | patterns, including increased     |
|                                   | rates of connections, failed      |
|                                   | connections, and port scans.      |
+-----------------------------------+-----------------------------------+
| Lateral Movement                  | To expand the footprint inside    |
|                                   | your network, an attacker uses    |
|                                   | lateral movement techniques to    |
|                                   | obtain credentials for additional |
|                                   | access to more data in the        |
|                                   | network.                          |
|                                   |                                   |
|                                   | The Analytics Engine detects      |
|                                   | attacks during this phase by      |
|                                   | examining administrative          |
|                                   | operations (such as SSH, RDP, and |
|                                   | HTTP), file share access, and     |
|                                   | user credential usage that is     |
|                                   | beyond the norm for your network. |
|                                   | Cortex XSIAM looks for indicators |
|                                   | like increased administrative     |
|                                   | activity, SMB usage, and remote   |
|                                   | code execution.                   |
+-----------------------------------+-----------------------------------+
| Command and Control               | The command and control tactic    |
|                                   | allows an attacker to remotely    |
|                                   | issue commands to an endpoint and |
|                                   | receive information from it. The  |
|                                   | Analytics Engine identifies       |
|                                   | intruders using this tactic by    |
|                                   | looking for anomalies in outbound |
|                                   | connections, DNS lookups, and     |
|                                   | endpoint processes with bound     |
|                                   | ports. Cortex XSIAM detects       |
|                                   | unexplained changes in the        |
|                                   | periodicity of connections and    |
|                                   | failed DNS lookups, changes in    |
|                                   | random DNS lookups, and other     |
|                                   | indicators that suggest an        |
|                                   | attacker has gained initial       |
|                                   | control of a system.              |
+-----------------------------------+-----------------------------------+
| Exfiltration                      | Exfiltration tactics are          |
|                                   | techniques used to retrieve data  |
|                                   | from a network, such as valuable  |
|                                   | enterprise data. Cortex XSIAM     |
|                                   | identifies this type of attack by |
|                                   | examining outbound connections    |
|                                   | with a focus on the volume of     |
|                                   | data being transferred. Increases |
|                                   | in this volume are an important   |
|                                   | symptom of data exfiltration.     |
+-----------------------------------+-----------------------------------+

#### Review MITRE ATT&CK framework coverage

You can see a comprehensive overview of the Cortex XSIAM content and
capabilities in context with the MITRE ATT&CK framework on the
**MITRE ATT&CK Framework Coverage** dashboard. Access the dashboard from
the drop-down menu in the dashboard header.

On this dashboard you can see a breakdown of the protection modules and
detection rules in place for each MITRE tactic and technique. You can
use the dashboard to review the elements that affect your coverage, and
identify coverage gaps in your framework.

You can see the following information:

- **Number of detection rules per tactic:** Review the detection rules
  that are available for each MITRE tactic.

- **MITRE ATT&CK framework coverage:** Review the MITRE matrix detailing
  the available coverage for each tactic and technique. By default,
  covered methods are displayed. Click on a tactic or technique for
  details about the available prevention and detection methods. Note
  that the Protection numbers represent modules, which are a grouping of
  several protections.

- **Contributing data source types:** Review the connectivity status of
  the data sources that are contributing to a specific data source type
  on your system.

<!-- -->

- > **Note**

  > When a contributing data source type is active, it does not imply
  > that all the rules and detectors associated with the data source
  > type are active. Rule applicability is dependent on the data
  > source\'s context and configuration. To enable an active status,
  > data source types require the following setup:

  - > **Endpoint:** Installed Cortex XDR agent.

  - > **Network:** A contributing network device that is configured to
    > ingest logs as Cortex XSIAM network connection stories.

  - > **Cloud:** A data source that is contributing the required cloud
    > related information.

  - > **Identity:** An identity application that is supported in IA
    > (Identity Analytics) and the ITM (Identity Threat Module).

In addition, if you are working with reports, you can use the
**MITRE Coverage Report** widget, which summarizes coverage for each
tactic.

#### Analytics detection time intervals

The Cortex XSIAM Analytics Engine retrieves logs from the Cortex XSIAM
tenant to create a baseline so that it can generate issues when abnormal
activity occurs. This analysis is highly sophisticated and performed on
more than a thousand dimensions of data. Internally, Cortex XSIAM
organizes its analytics activity into algorithms called detectors. Each
detector is responsible for generating an issue when suspicious behavior
is detected.

To generate issues, each detector compares the recent past behavior to
the expected baseline by examining the data found in your logs. A
certain amount of log file time is required to establish a baseline and
then a certain amount of recent log file time is required to identify
what is currently happening in your environment.

There are several meaningful time intervals for Cortex XSIAM Analytics
detectors:

+-----------------------------------+-----------------------------------+
| Time interval                     | Description                       |
+===================================+===================================+
| Activation period                 | The shortest amount of log file   |
|                                   | time before the app can generate  |
|                                   | an issue. This is typically the   |
|                                   | period between the time a         |
|                                   | detector first starts running and |
|                                   | the time you see an issue.        |
|                                   | However, in some cases, detectors |
|                                   | pause after an upgrade as they    |
|                                   | enter a new activation period.    |
|                                   |                                   |
|                                   | Most but not all detectors start  |
|                                   | running after the activation      |
|                                   | period ends. The activation       |
|                                   | period provides the detector      |
|                                   | enough data to establish a        |
|                                   | baseline, which in turn helps to  |
|                                   | avoid false positives.            |
|                                   |                                   |
|                                   | The activation period is also     |
|                                   | called the profiling or waiting   |
|                                   | period and is informally referred |
|                                   | to as soak time.                  |
+-----------------------------------+-----------------------------------+
| Test period                       | The amount of logging time that a |
|                                   | detector uses to determine if     |
|                                   | unusual activity is occurring on  |
|                                   | your network. The detector        |
|                                   | compares test period data to the  |
|                                   | baseline created during the       |
|                                   | training period, and uses that    |
|                                   | comparison to identify abnormal   |
|                                   | behavior.                         |
+-----------------------------------+-----------------------------------+
| Training period                   | The amount of logging time that   |
|                                   | the detector requires to          |
|                                   | establish a baseline, and to      |
|                                   | identify the behavioral limits    |
|                                   | beyond which an issue is          |
|                                   | generated. Because your network   |
|                                   | is not static in terms of its     |
|                                   | topology or usage, detectors are  |
|                                   | constantly updating the baselines |
|                                   | that they require for their       |
|                                   | analytics. For this update        |
|                                   | process, the training period is   |
|                                   | how far back in time the detector |
|                                   | goes to update and tune the       |
|                                   | baseline.                         |
|                                   |                                   |
|                                   | This period is also referred to   |
|                                   | as the baseline period.           |
|                                   |                                   |
|                                   | > **Note**                        |
|                                   | >                                 |
|                                   | > When establishing a baseline,   |
|                                   | > detectors compute limits beyond |
|                                   | > which network activity will     |
|                                   | > require an issue. In some       |
|                                   | > cases, detectors do not compute |
|                                   | > baseline limits; instead they   |
|                                   | > are predetermined by Cortex     |
|                                   | > XSIAM engineers. The engineers  |
|                                   | > determine the values used for   |
|                                   | > predetermined limits using      |
|                                   | > statistical analysis of         |
|                                   | > malicious activity recorded     |
|                                   | > worldwide. The engineers        |
|                                   | > routinely perform this          |
|                                   | > statistical analysis and update |
|                                   | > the predetermined limits as     |
|                                   | > needed with each release of     |
|                                   | > Cortex XSIAM.                   |
+-----------------------------------+-----------------------------------+
| Deduplication period              | The amount of time in which       |
|                                   | additional issues for the same    |
|                                   | activity or behavior are          |
|                                   | suppressed before Cortex XSIAM    |
|                                   | generates another Analytics       |
|                                   | issue.                            |
+-----------------------------------+-----------------------------------+

These time periods are different for every Cortex XSIAM Analytics
detector. The actual amount of logging data (measured in time) required
to generate any given Cortex XSIAM Analytics issue is specified in the
Cortex XDR Analytics Alert Reference Guide.

#### Analytics issues and Analytics BIOCs

The Cortex XSIAM Analytics engine generates an issue when it detects
suspicious activity, composed of multiple events, that deviates from the
behavior baseline it establishes over time. To ensure the Analytics
detectors generates issues efficiently and do not overcrowd your Issues
table, Cortex XSIAM automatically disables issues from detectors that
reach 5000 or more matches over a 24 hour period.

In addition to standard Analytics issues, there is another category of
issues generated by Analytics behavioral indicators of compromise
(ABIOCs). In contrast to standard Analytics issues, Analytics BIOCs
(ABIOCs)---indicate a single event of suspicious behavior with an
identified chain of causality. To identify the context and chain of
causality, ABIOCs leverage user, endpoint, and network profiles. The
profile is generated by the Analytics Engine and can be based on a
simple statistical profile or a more complex machine-learning profile.
Cortex XSIAM tailors each ABIOC to your specific environment after
analyzing your logs and data sources and continually tunes and delivers
new ABIOCs with content updates.

#### View and manage Analytics rules

The Analytics Rules page offers a consolidated view of all Analytics
BIOC and XDR Analytics rules which are crucial to your organization\'s
security posture. Designed to provide complete transparency, this
centralized hub enables EDR experts and SOC analysts to gain a
comprehensive understanding of every Analytics rule that could generate
an issue and take action accordingly. For more information, see
[Analytics issues and Analytics
BIOCs](#UUID578040170eedd671f44abf8c5f42d484).

Within the unified Analytics rules table, you can leverage powerful
capabilities to manage and investigate Analytics rules effectively.

- Get an understanding of all the rules that generated an issue in one
  place.

- Filter rules by name or description for seamless integration with
  issue investigations.

- Filter rules by any column, including \"Variant Severities\" to
  quickly locate rule variants associated with specific severity
  criteria.

- Order by any column, enabling you to prioritize and evaluate issues
  based on severity, name, modification time, and other critical
  factors.

- Fine-tune your XDR Analytics rules by disabling or enabling specific
  ones.

- View more information for a selected analytics rule, including all its
  variants, and pivot to the [Cortex Analytics
  Reference](https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM/Cortex-XSIAM-Analytics-Alert-Reference-by-Alert-name/Cortex-XSIAM-Analytics-Alert-Reference)
  for the specific rule.

The **Analytics Rules** page is under Threat Management \> Detection
Rules.

The page displays the following properties of Analytics rules:

- Modification Time: When the rule was last changed.

- Name

- Severity: Severity of the basic variant.

- Severity Variations: Number of different variants for the rule,
  including their respective severities.

- Status

- Type: XDR Analytics or XDR Analytics BIOC

- Tags: Detector tag

- Description

- Mitre Att&ck Tactic

- Mitre Att&ck Technique

- \# of Issues: Number of issues generated by the rule in all its
  variants.

- Activation Prerequisites

- Creation Time

- Global Rule ID

Use the right click menu for the following actions:

- Disable or enable a rule to customize issue generation based on the
  Analytics rule.

- Show or hide all rows with a specific rule.

- View the rule with all its variants, including their respective
  descriptions, tags, and severities in the **View Analytics Rule**
  screen.

  - For more information about the MITRE ATT&amp;CK techniques and
    tactics, click the tag to display its explanation in the MITRE
    ATT&amp;amp;CK database.

  - For more information about the rule, click **View Rule**, and click
    **More information** to display the Analytics Alert Reference.

#### Identity Analytics

Cortex XSIAM enables you to investigate suspicious user activity
information using Identity Analytics. When enabled, Identity Analytics
aggregates and displays user profile information, activity, and issues
associated with a user-based Analytics type issue and Analytics BIOC
rule.

To easily track the issues and Analytics BIOC rules, Cortex XSIAM
displays an **Identity Analytics** tag in the **Issues** table \>
**Issue Name** field and **Analytics BIOC Rules** table \> **Name**
field. In the **Analytics Issue View**, when selecting the **User**
node, Cortex XSIAM details the active directory group, organizational
unit, role, logins, hosts, alerts, and process executions associated
with the user.

To enable Identity Analytics, you must first:

- Set Up Could Identity Engine(formally Directory Sync Services (DSS))

- Activate Cortex XSIAM Analytics

After configuring your Cloud Identity Engine instance and Cortex XSIAM
Analytics, select Settings
(![](media/rId3002.png){width="0.20833333333333334in"
height="0.20833333333333334in"}) \> Configurations \> Cortex XSIAM -
Analytics, and in the **Featured in Analytics** section, **Enable**
Identity Analytics.

#### Identity Threat Module (ITDR)

The Identity Threat module provides superior coverage for stealthy
identity threat vectors, including compromised accounts and insider
threats. The module is available as an add-on and includes the following
UI features.

- Automated and customizable [Asset
  Role](#UUID12671c6f88cc38b27085a5018738ac85) classification based on
  constant analysis of the users and host in your network. You can edit
  and manage the [User Asset
  Roles](#UUID6533030077f2c79f5550169a76b4c012) and [Host Asset
  Roles](#UUID105a6c4cb84c9581211c871e8d8bc7d7) to meet the needs of
  your organization.

- The Behavioral Analytics tab in the Issue Panel view that displays
  background information for quicker triaging and investigation. This
  enables you to analyze the deviation that generated the issue against
  the backdrop of baseline behavior.

- [Risk Management dashboard](#UUIDf653abffde9e95ed7b64bdea77e15c6f) for
  reviewing the risk posture of the organization and enabling faster
  decision making. The dashboard contains a number of Metrics widgets
  that present statistical risk information for your organization.

- [User Risk View](#UUID70e8fbdbe74c1470fc4e32ea1b6b5288) and [Host Risk
  View](#UUIDf95f4a92dc31d0dfb919e960a321a94f) which provide additional
  information about the asset, including score trend timeline, notable
  events, peer comparison, and additional asset-associated issues and
  insights for easy uncovering of hidden threats.

- ITDR Issues and Insights link for quickly reviewing all ITDR-related
  issues, including INFO, at a glance, with filtering, sorting, and
  other options. The link is under Modules \> Identity Security \> ITDR
  Issues and Insights.

#### AI Detection & Response in Cortex XSIAM (Beta)

As organizations increasingly integrate AI into their operations, they
become vulnerable to new threats such as model tampering or prompt
injection. Traditional security tools lack the context and precision
needed to detect and respond to AI-specific threats. In line with
comprehensive security strategies, enterprises should incorporate a
combination of preventive and responsive actions to safely enable
adoption of AI technologies.

Cortex AI Detection & Response (AIDR) is a new module available in Beta
that allows companies to:

- Gain visibility into AI usage in the cloud

- Identify AI-specific threats

- Respond and remediate these threats

##### Enable AIDR

> **Prerequisite**
>
> To enable AIDR, you must have one of the following user roles:
> Instance Admin or Account Admin.

In order to use the AIDR feature, you must enable it as follows:

1.  Navigate to Settings \> Configurations \> Cortex - Analytics.

2.  In the **AI Detection & Response** box, click
    **Beta Evaluation Agreement** to read and accept the evaluation
    agreement.

3.  After you have accepted the agreement, enable the AIDR feature.

##### Data sources and supported services

AIDR uses multiple data sources to gain visibility into AI usage in the
cloud and identify AI-specific threats. Cloud audit logs are used for
infra-level detections, such as model theft, denial of ML service, and
training data poisoning. Cloud audit logs can be collected using
existing data collectors. Prompt logs are used for detection of threats
specific to generative AI, such as abnormal prompts, prompt injection,
and insecure output.

See [Collect prompt logs](#UUID6e91a2e9b411f0244d26d487635ffec2) for
instructions on configuring prompt log collection.

The following AI/ML managed services are supported:

- AWS: Amazon Bedrock, SageMaker

- Azure: Open AI

- GCP: VertexAI

##### AI Detection & Response Dashboard

The AI Detection & Response dashboard is now available as a new
predefined dashboard. You can select it in the dropdown menu of the
dashboard header.

The AI Detection & Response dashboard provides visibility into how AI is
being used in the cloud, displaying managed AI services, event trend,
identities accessing AI services and more. It also presents the top
alerts identified by the AIDR module, and incidents containing these
alerts.

The AI Detection & Response dashboard provides visibility into how AI is
being used in the cloud, displaying managed AI services, event trend,
identities accessing AI services and more. It also presents the top
issues identified by the AIDR module, and cases containing these issues.

##### Collect prompt logs

Cortex XSIAM collects prompt logs from your cloud accounts using
existing data collectors. Currently AWS and Azure are supported by
Cortex XSIAM for prompt log collection. At this time, GCP does not have
a storage solution for AI prompts that allows Cortex XSIAM to ingest
them.

For details on dataset retention, see [Cortex XSIAM license
plans](https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM/Get-started-with-Cortex-XSIAM/Cortex-Cloud-Cortex-XDR-and-Cortex-XSIAM-license-plans).

For details on dataset retention, see [License retention in XSIAM
Premium](https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM/Cortex-XSIAM-Premium-Documentation/License-retention-in-Cortex-XSIAM#).

Follow these procedures to enable prompt log collection in AWS and
Azure:

- [Prompt log collection in AWS](#UUID345b0e89171b4211c09d1b256c6837f7)

- [Prompt log collection in
  Azure](#UUID7a2354fc4319f78d315bdd4a5e9d3302)

###### Prompt log collection in AWS

Amazon Bedrock allows you to save prompt logs to Amazon S3 or Amazon
CloudWatch. For details on how to configure invocation logging using
CloudWatch Logs or Amazon S3, see the AWS documentation: [Model
invocation
logging](https://docs.aws.amazon.com/bedrock/latest/userguide/model-invocation-logging.html).

####### Ingest prompt logs from Amazon S3

For instructions on ingesting prompt logs from Amazon S3, see [Ingest
generic logs from Amazon
S3](https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM/Cortex-XSIAM-Documentation/Ingest-generic-logs-from-Amazon-S3).
In step 7, select **Prompt logs** as the log type.

For instructions on ingesting prompt logs from Amazon S3, see [Ingest
generic logs from Amazon
S3](https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM/Cortex-XSIAM-Premium-Documentation/Ingest-generic-logs-from-Amazon-S3)
. In step 7, select **Prompt logs** as the log type.

####### Ingest prompt logs from Amazon CloudWatch

For instructions on ingesting prompt logs from Amazon CloudWatch, see
[Ingest logs from Amazon
CloudWatch](http://https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM/Cortex-XSIAM-Documentation/Ingest-logs-from-Amazon-CloudWatch).
In step 1.d, select **Prompt logs** as the log type.

For instructions on ingesting prompt logs from Amazon CloudWatch, see
[Ingest logs from Amazon
CloudWatch](https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM/Cortex-XSIAM-Premium-Documentation/Ingest-logs-from-Amazon-CloudWatch).
In step 1.d, select **Prompt logs** as the log type.

###### Enable prompt log collection in Azure

The following steps are necessary to enable prompt log collection in
Microsoft Azure:

1.  [Configure the Azure Event Hub
    collection](#UUIDb663dd1bcdd17a18ea25b063349cc3ed).

2.  [Set up prompt logging in
    Azure](#UUID7c7cd225f9eaaff4ba018be9ef2ed754).

3.  [Configure logging of HTTP
    data](#UUID71ceeb45183c8183936726045e64cafa).

4.  [Configure diagnostic
    settings](#UUID8c1a5893b4a17ac7a8dabf8e36ad895d).

####### Configure the Azure Event Hub collection in Cortex XSIAM

For instructions on ingesting prompt logs from Microsoft Azure Event
Hub, see [Ingest logs from Microsoft Azure Event
Hub](https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM/Cortex-XSIAM-Documentation/Ingest-Logs-from-Microsoft-Azure-Event-Hub?tocId=kdBiMvtdaJTAWsaoShdYHQ).

For instructions on ingesting prompt logs from Microsoft Azure Event
Hub, see [Ingest logs from Microsoft Azure Event
Hub](https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM/Cortex-XSIAM-Premium-Documentation/Ingest-logs-from-Microsoft-Azure-Event-Hub?tocId=ADzG94N0ph~z7srNslul8w).

####### Set up prompt logging

1.  In the Azure portal, [create a new Azure API Management
    instance](https://learn.microsoft.com/en-us/azure/api-management/get-started-create-service-instance).

2.  [Create and deploy an Azure OpenAI
    resource](https://learn.microsoft.com/en-us/azure/ai-services/openai/how-to/create-resource?pivots=web-portal).

3.  [Import an Azure OpenAI
    API](https://learn.microsoft.com/en-us/azure/api-management/azure-openai-api-from-specification).

####### Log HTTP data

Configure logging request and response payloads in Azure API Management.

1.  In your Azure API Management instance, navigate to APIs \> Select an
    API.

2.  In the **Settings** tab, under **Diagnostics Settings**, select
    **Azure Monitor** and select **Enable**.

3.  In **Advanced Options** select the following: **Backend Request**
    and **Backend Response**.

4.  For **Backend Request**, enter the following headers:

    - Authorization

    - Api-key

    - User-Agent

    - Referer

    - Host

5.  In **Number of payload bytes to log**, enter: `8192`. Click
    **Save**.

6.  For **Backend Response**, enter the following headers:

    - apim-request-id

    - x-ms-rai-invoked

7.  In **Number of payload bytes to log**, enter: `8192`. Click
    **Save**.

![](media/rId3027.png){width="5.833333333333333in"
height="5.411783683289589in"}

####### Configure diagnostic settings:

1.  In your Azure API Management instance, navigate to APIs \> Select an
    API.

2.  Navigate to Monitoring \> Diagnostic settings.

3.  Click **Add diagnostic settings**.

4.  Under **Logs**, select **audit**. Under **Destination details**,
    select **Stream to an event hub**.

![](media/rId3031.png){width="5.833333333333333in"
height="4.181314523184602in"}

### Threat Intel Management

Enhance your investigation with Threat Intel Management (TIM), which
utilizes Unit 42 Intel.

#### Get started with Threat Intel Management

Before diving in, you should understand the Cortex XSIAM Threat
Intelligence Management\'s functionality and how it integrates with your
needs. Review the use cases and key details to optimize your Cortex
XSIAM experience from the start. Threat Intel management includes the
following features:

- Access Unit 42 Intel data

- Investigate files using sample analysis

- Submit Sessions and Submissions

<!-- -->

- > **Note**

  > By default, the Palo Alto Networks Wildfire Reports integration,
  > which is used as part of the sample analysis feature, is installed
  > and configured. The Palo Alto Networks Wildfire v2 integration, for
  > dynamic malware analysis, is also installed, but you must add an
  > integration instance. No API key is required.

<!-- -->

- Manage Indicator Relationships

- Deep dive into an indicator on the **XSIAM Indicators** page.

> **Note**

##### What is Threat Intel Management?

The Cortex XSIAM native threat intel management capabilities allow you
to unify the core components of threat intel, including threat intel
aggregation, scoring, and sharing. Cortex XSIAM automates threat intel
management by ingesting and processing indicator sources, such as feeds
and lists, and exporting the enriched intelligence data to SIEMs,
firewalls, and any other system that can benefit from the data. These
capabilities enable you to sort through millions of indicators daily and
take automated steps to make those indicators actionable.

> **Note**

You can do the following:

- Import from integrations (such as third-party feeds and WildFire)

- Create indicators during investigations

- Create issue rules (such as IP, Domain, and File indicators)

- Push indicators to the XDR agent for prevention (SHA256 and MD5
  indicators)

- Export indicators through a feed

###### Why Threat Intel Management?

- Powerful native centralized threat intel

<!-- -->

- Supercharge investigations with instant access to a large repository
  of built-in, high-fidelity Palo Alto Networks threat intelligence
  crowdsourced from the largest footprint of network, endpoint, and
  cloud intel sources.

<!-- -->

- Indicator relationships

<!-- -->

- Indicator connections enable structured relationships between threat
  intelligence sources and issues. These relationships surface important
  context for security analysts on new threat actors and attack
  techniques.

<!-- -->

- Hands-free automated playbooks with extensible integrations

<!-- -->

- Take automated action to shut down threats across over 600 third-party
  products with purpose-built playbooks based on proven SOAR
  capabilities.

<!-- -->

- Granular indicator scoring and management

<!-- -->

- Take charge of your threat intel with playbook-based indicator
  lifecycle management and transparent scoring that can be easily
  extended and customized.

<!-- -->

- Automated, multi-source feed aggregation

<!-- -->

- Eliminate manual tasks with automated playbooks to aggregate, parse,
  prioritize, and distribute relevant indicators in real-time to
  security controls for continuous protection.

<!-- -->

- Most comprehensive marketplace

<!-- -->

- The largest community of integrations with content packs that are
  prebuilt bundles of integrations, playbooks, dashboards, field
  subscription services, and all the dependencies needed to support
  specific security orchestration use cases.

###### Threat Intel with Security orchestration

Security orchestration, automation, and response (SOAR) solutions have
been developed to weave threat intelligence management into workflows by
combining TIM capabilities with case management, orchestration, and
automation capabilities. SOAR solutions weave threat intelligence into a
more unified and automated workflow. It matches issues both to their
sources and to compiled threat intelligence data and can automatically
execute an appropriate response.

As part of the extensible Cortex XSIAM platform, TIM unifies threat
intelligence aggregation, scoring, and sharing with playbook-driven
automation. It empowers security leaders with instant clarity into
high-priority threats to drive the right response across the entire
enterprise.

Cortex XSIAM provides a common platform for cases and threat
information, where there is no disconnect between external threat data
and your environment. Automated data enrichment of indicators provides
analysts with relevant threat data to make smarter decisions.

Integrated case management allows for real-time collaboration, boosts
operational efficiencies across teams, and automates playbooks to speed
response across security use cases.

![](media/rId3040.png){width="5.833333333333333in"
height="3.0697911198600174in"}

Cortex XSIAM collects data from sources such as issues, Unit 42, and
external threat intel feeds. After the data is ingested, Threat Intel
playbooks examine the data proactively. The data gets deduped,
normalized, and stored in the Threat Intel database so that a Threat
Intel analyst can start a threat analysis. The analyst can then send
that information to firewalls, share it with other stakeholders, and
take remedial action as necessary.

##### Threat Intel Management use cases

The following examples illustrate typical use cases for Threat Intel
Management analysts.

###### Dynamic allow lists for business-critical SaaS apps

In this example, Firewall Admins are responsible for ensuring employees
can always access SaaS applications such as Zoom and Office 365. They
need to manage a stream of inbound change requests from the security
team and other business units. Regardless of these daily changes,
critical apps must always be allowed. The network infrastructure of SaaS
applications is constantly changing/rotating IP addresses and Domains.

Indicator prioritization. Cortex XSIAM can ingest phishing issues from
email inboxes through integrations. Once an issue is ingested, a
playbook is triggered and can have any combination of automated or
manual actions that users desire. The playbooks can have filters and
conditions that execute different branches depending on certain values.

![](media/rId3045.png){width="5.833333333333333in"
height="2.398957786526684in"}

1.  Configure a feed integration such as Office 365, Amazon AWS, or Unit
    42.

    1.  Go to Settings \> Configurations \> Data Collections \>
        Automation & Feed Integrations and in the **Category** field,
        select **Threat Intel Feeds**.

    2.  Locate the relevant integration and select **Add Instance**.

    - In this example, add the AWS feed.

    3.  Set up the instance. In the Indicator Reputation field, select
        **Benign**.

    4.  Test and save the instance.

2.  (Optional) Configure a playbook to filter indicators according to
    your requirements.

3.  Go to the Indicators page and run the following search to return IP,
    IPv6 or IPv6CIDR results:

- `sourceBrands:"AWS Feed" and expirationStatus:active and type:IP or type:IPv6 or type:IPv6CIDR`

4.  Configure the Generic Export Indicator Service integration.

    1.  On the **Automation & Feed Integrations** page, search for
        Generic Export Indicators Service and **Add instance**.

    2.  In the **Indicator Query** field, add the query in step 3.

    3.  Add the remaining fields, test, and save.

5.  Test the EDL by running the cURL command:
    `curl -v-u- user:pass https://ext-<tenant>crtx<region>.paloaltonetworks.com/xsoar/instance/execute/<instance-name>`

###### Proactive blocking of known threats

The security team needs to leverage threat intelligence to block or
alert on known bad domains, IPs, hashes, etc. (indicators). The
indicators are collected from many sources, which need to be normalized,
scored, and analyzed before pushing to security devices such as
firewalls for alerting. Detection tools can only handle limited amounts
of threat intelligence data and need to constantly re-prioritize
indicators.

![](media/rId3049.png){width="5.833333333333333in" height="2.625in"}

**Solution**

Indicator prioritization. Cortex XSIAM can ingest phishing issues from
email inboxes through integrations. Once an issue is ingested, a
playbook is triggered and can have any combination of automated or
manual actions that users desire. The playbooks can have filters and
conditions that execute different branches depending on certain values.

1.  Configure feed integrations such as Unit 42 ATOMs feed, TAXII feed,
    etc.

    1.  Go to Settings \> Configurations \> Data Collections \>
        Automation & Feed Integrations and in the **Category** field,
        select **Threat Intel Feeds**.

    2.  Locate the relevant integration and select **Add Instance**.

    3.  Set up the instance.

    - In the Indicator Reputation field, blank.

    4.  Test and save the instance,

2.  (Optional) Configure a playbook to filter indicators according to
    your requirements.

3.  Go to the **XSIAM Indicators** page and run the following search to
    return IP addresses with the verdict malicious with high
    reliability:

- `expirationStatus:active and type:IP and verdict:malicious and aggregatedReliablitiy:A - Completely reliable`

4.  Configure the Generic Export Indicator Service integration.

    1.  On the **Automation & Feed Integrations** page, search for
        Generic Export Indicators Service and **Add instance**.

    2.  In the **Indicator Query** field, add the query in step 3.

    3.  Add the remaining fields, test, and save.

5.  Test the EDL by running the cURL command:
    `curl -v-u- user:pass https://ext-<tenant>crtx<region>.paloaltonetworks.com/xsoar/instance/execute/<instance-name>`

- You can use this URL in your Next-Generation Firewall.

###### Issue enrichment

Case Responders receive an endless stream of issues, usually with little
to no context of the external threat. Enriching issues with curated
threat intelligence from Unit 42 enables analysts to see the bigger
picture and make more informed decisions when responding to issues,
ensuring comprehensive containment of the threat.

Most tools that Security Operations Centers and Case Response teams use
to respond to issues are very generic. There is little correlation
between network data and understanding of threats and attacker
movements. There is often a dump of information, including bad IP
addresses or domains, and someone has to be assigned to manually resolve
to figure out false positives. There is also a lack of understanding of
malicious families, hacking tools, and their patterns of attacks.

![](media/rId3053.png){width="5.833333333333333in"
height="2.5156244531933507in"}

Accelerate issue response with TIM and issue enrichment using threat
intelligence data. The case enrichment workflow in Cortex XSIAM
leverages threat intelligence from our centralized threat intelligence
library, including information on:

- Data from Unit 42 Intel to learn about known malware campaigns or
  families

- IPs and domains with WHOIS data

- Passive DNS data

- Web categorization data

When investigating an issue, you can see information, such as affected
hosts, affected users, and detailed information about the source and
destination. You can deep dive into the indicator by clicking the
indicator to see the verdict, sources, related issues, file details, and
relationships. If the indicator originated from Unit 42, in the Unit 42
Intel tab you can see additional information, such as static and dynamic
analysis for a file.

##### Roles and responsibilities in Threat Intel Management

A Threat Intel Management (TIM) analyst may have a different persona in
the SOC. In some organizations, the TIM analyst is part of the SOC
analyst's definition of work, but they have different workflows and use
cases. The daily work of SOC analysts and TIM analysts are different.

+-----------------------------------+-----------------------------------+
| Roles                             | Responsibility                    |
+===================================+===================================+
| Security Analyst (SOC Tier-1)     | - Triage Specialist               |
|                                   |                                   |
|                                   | - Monitor, manage, and configure  |
|                                   |   security tools                  |
|                                   |                                   |
|                                   | - Review cases to assess their    |
|                                   |   urgency                         |
|                                   |                                   |
|                                   | - Escalate cases when necessary   |
+-----------------------------------+-----------------------------------+
| Threat Intel Analyst (SOC Tier    | - Case responders and threat      |
| 2-3)                              |   hunters                         |
|                                   |                                   |
|                                   | - Remediation of escalated cases  |
|                                   |   from Tier 1 - investigation,    |
|                                   |   response, and assessments       |
|                                   |                                   |
|                                   | - Proactive work to remove        |
|                                   |   infrastructure weaknesses       |
+-----------------------------------+-----------------------------------+

##### Indicator concepts

Before you start customizing and investigating you should be familiar
with the following terms

**Indicators of Compromise**

Indicators of compromise (Indicators) are artifacts that can signal a
security breach has occurred and are associated with security issues.
They help correlate issues, create hunting operations, and enable you to
easily analyze issues and reduce Mean Time to Response (MTTR). They are
an essential part of the case management and remediation process.
Indicators can include:

- IP addresses: Unusual or foreign IP address accessing your network

- Hashes: Unique identifiers for files or malware

- Domain names: Suspicious or malicious domains

- Registry entries: Changes to the system registry

**Fetch indicators**

Cortex XSIAM includes integrations that fetch indicators from a
vendor-specific source, such as TAXII, or a generic source, such as a
CSV or JSON file. For more information about how to set up a Threat
Intel feed integration to fetch indicators, see [Configure Threat
Intelligence feed integrations](#UUID7531f220b2bd6784c9161c82fa44a259).

**Indicator ingestion**

Cortex XSIAM automates threat intel management by ingesting and
processing indicator sources, such as feeds and lists, and exporting the
enriched intelligence data to SIEMs, firewalls, and any other system
that can benefit from the data. These capabilities enable you to sort
through millions of indicators daily and take automated steps to make
those indicators actionable in your security posture.

> **Note**
>
> You can store up to 100,000,000 indicators.

Indicators are added to Cortex XSIAM via the following methods:

+-----------------------+------------------------+-------------------------------------------------------------+
| Method                | Description            | Classification and Mapping                                  |
+=======================+========================+=============================================================+
| Integration           | Feed integrations:     | Indicator classification and mapping is done in the [Feed   |
|                       | Fetch indicators from  | Integration](https://xsoar.pan.dev/docs/integrations/feeds) |
|                       | a feed, for example,   | and not in the Cortex XSIAM Settings \> Configurations \>   |
|                       | TAXII, Office 365, and | Object Setup \> Indicators \> Classification & Mapping tab. |
|                       | Unit 42 ATOMS Feed.    |                                                             |
+-----------------------+------------------------+-------------------------------------------------------------+
| Indicator extraction  | If you have enabled    | Only the value of an indicator is extracted, so no          |
|                       | system-wide indicator  | classification or mapping is needed.                        |
|                       | extraction, indicators |                                                             |
|                       | are extracted from all |                                                             |
|                       | issues in Cortex       |                                                             |
|                       | XSIAM.                 |                                                             |
+-----------------------+------------------------+-------------------------------------------------------------+
| Manual                | - Command line         | Data is inserted manually via the UI so no classification   |
|                       |                        | or mapping is needed.                                       |
|                       | - Mark: The user marks |                                                             |
|                       |   a piece of data as   | If importing a STIX file, mapping is done via the STIX      |
|                       |   an indicator.        | parser code.                                                |
|                       |                        |                                                             |
|                       | - STIX file: Manually  |                                                             |
|                       |   upload a STIX file   |                                                             |
|                       |   on the               |                                                             |
|                       |   **XSIAM Indicators** |                                                             |
|                       |   page.                |                                                             |
+-----------------------+------------------------+-------------------------------------------------------------+

**Common indicator data model**

When indicators are ingested, regardless of their source, they have a
unified, common set of indicator fields, including traffic light
protocol (TLP), expiration, verdict, and tags.

**Indicator smart merge**

The same indicator can originate from multiple sources and be enriched
with multiple methods (such as integrations, scripts, and
playbooks). Cortex XSIAM implements a smart merge logic to make sure
indicators are accurately scored (verdict) and aggregated.
Indicator fields are merged according to the source reliability
hierarchy. When there are two different values for a
single indicator field, the field is populated with the value provided
by the source with the highest reliability score. For multi-select and
tag fields, new values are appended, rather than replacing the original
values.

**Indicators enrichment cache (Insightcache)**

To avoid exceeding API quotas for third-party services, indicators are
only updated after the cache expiration period. By default, the cache
expires 4,320 minutes (3 days) after an indicator is updated, and cannot
be cleared manually. The cache expiration can be set in
the indicator type parameters. Indicator enrichment cache expiration
only applies to automatic enrichment, triggered by
the`enrichIndicators` command, and does not apply when you run
reputation commands such as `!ip`.

**Indicator timeline**

The indicator timeline displays an indicator's complete history, such as
the first-seen and last-seen timestamp and changes made
to indicator fields.

**Indicator expiration**

When ingesting and processing many indicators daily, it's important to
control whether or not they are active or expired and to define how and
when indicators are expired. Cortex XSIAM offers multiple options to set
indicator expiration. To configure how to expire an indicator, see
[Configure indicator expiration](#UUID6626ec9c2e6a5d97f43baad13728a39e).

**Exclusion list**

Indicators added to the exclusion list are disregarded by the system and
are not created or involved in automated flows such
as indicator extraction. For more information, see [Delete and exclude
indicators](#UUID4144b24a6a01c03aaeb76110cb2faeec).

**Jobs**

Administrators can define a job to trigger a playbook when the specified
feed or feeds finish a fetch operation that includes a modification to
the list. The modification can be a new indicator, a modified indicator,
or a removed indicator. To create a job to process indicators, see
[/document/preview/1159291#UUID-1a6d947c-627d-a127-b8b4-36d1e4a0f85d](/document/preview/1159291#UUID-1a6d947c-627d-a127-b8b4-36d1e4a0f85d).

##### Indicator lifecycle

Indicators are text-based artifacts associated with issues, such as IP
addresses, URLs, and email addresses, and are an essential part of the
case management and remediation process. They help correlate issues,
create hunting operations, and enable you to easily analyze cases and
reduce Mean Time to Response (MTTR).

The following diagram explains the indicator lifecycle in Cortex XSIAM.

![](media/rId3062.png){width="5.833333333333333in"
height="3.4197911198600175in"}

+-----------------------------------+-----------------------------------------------------+
| Step                              | Details                                             |
+===================================+=====================================================+
| 1\. Identify the indicator type   | Cortex XSIAM analyzes the text-based artifact and   |
| and value                         | if it matches the indicator type profile. The       |
|                                   | indicator value is extracted, based on the          |
|                                   | indicator profile definition. Indicator extraction  |
|                                   | identifies indicators from various sources within   |
|                                   | Cortex XSIAM, such as email headers, IP addresses,  |
|                                   | email addresses, and file hashes in file            |
|                                   | attachments. For more information about indicator   |
|                                   | extraction, see [Indicator                          |
|                                   | extraction](#UUID5428bf3967d9a59a695b824dd270a6ac). |
|                                   |                                                     |
|                                   | You can create or customize existing indicator      |
|                                   | types and fields for your use case. For more        |
|                                   | information, see [Customize indicator fields and    |
|                                   | types](#UUID758d9133ce208ac454cc82b8aaacfbb3).      |
+-----------------------------------+-----------------------------------------------------+
| 2\. Formatting and validation     | Formatting and validation of the indicator are done |
|                                   | using a formatting script that validates the data   |
|                                   | that represents the indicator\'s value and          |
|                                   | determines how we want the data to appear in Cortex |
|                                   | XSIAM. For example, the URL indicator type uses the |
|                                   | **FormatURL** script, which defangs URLs. For more  |
|                                   | information, see [Formatting                        |
|                                   | scripts](#UUIDd28a00ace72c1c6ecda19e004639a815).    |
+-----------------------------------+-----------------------------------------------------+
| 3\. Create or update an indicator | If the indicator is not known to Cortex XSIAM, an   |
|                                   | indicator is created or you can create your own. If |
|                                   | already known, it is updated with any new data      |
|                                   | including last seen dates. If the indicator is in   |
|                                   | an expired state but new data is received, it       |
|                                   | changes to active status.                           |
+-----------------------------------+-----------------------------------------------------+
| 4\. Gather reputation and         | You can run reputation commands and enhancement     |
| enrichment information            | script commands on indicator values. You need to    |
|                                   | set them to run in the indicator type. The          |
|                                   | enhancement script also runs on the indicator type. |
|                                   | Both determine the indicator\'s verdict. For more   |
|                                   | information, see [Enhancement                       |
|                                   | scripts](#UUID256501ccf23b2fd281318f67ebfc8d22).    |
|                                   |                                                     |
|                                   | When a reputation command/enhancement script is     |
|                                   | run, the verdict gets added to the issue context,   |
|                                   | when attached to an issue. Generally, the           |
|                                   | information is found under the Dbot Score key, the  |
|                                   | specific Indicator type, and specific vendor        |
|                                   | information.                                        |
|                                   |                                                     |
|                                   | > **Note**                                          |
|                                   | >                                                   |
|                                   | > To run enhancement scripts and reputation         |
|                                   | > commands, you must configure a relevant           |
|                                   | > enrichment integration, such as VirusTotal,       |
|                                   | > IPinfo v2, etc.                                   |
+-----------------------------------+-----------------------------------------------------+
| 5\. Reputation scripts            | Reputation scripts can be used if you want to       |
|                                   | override existing reputation commands with custom   |
|                                   | logic. For those indicator types without reputation |
|                                   | commands, a custom reputation script can be         |
|                                   | applied. Use it to customize verdicts and DBotScore |
|                                   | context entry. For more information, see            |
|                                   | [Reputation                                         |
|                                   | scripts](#UUIDf2fdfebe108e043d358583861e0377bc).    |
+-----------------------------------+-----------------------------------------------------+
| 6\. Map indicator fields          | After your indicator is enriched, you can map       |
|                                   | fields. Some indicator fields are automatically     |
|                                   | mapped by Cortex XSIAM to contain the relevant      |
|                                   | values. The default settings can be changed for     |
|                                   | each indicator type. You can create and associate   |
|                                   | any custom fields with indicators. For more         |
|                                   | information, see [Indicator classification and      |
|                                   | mapping](#UUIDe61deb7f0dbfab0b31bcb1b78a5a5ed9).    |
+-----------------------------------+-----------------------------------------------------+
| 7\. Expiration                    | Many indicators have expiration dates as threats    |
|                                   | are dynamic. IP addresses may change, systems may   |
|                                   | be fixed, etc. When configuring an indicator type,  |
|                                   | you can set it never to expire or after a time      |
|                                   | interval. For more information, see [Configure      |
|                                   | indicator                                           |
|                                   | expiration](#UUID6626ec9c2e6a5d97f43baad13728a39e). |
|                                   |                                                     |
|                                   | > **Tip**                                           |
|                                   | >                                                   |
|                                   | > We recommend defining your policy for handling    |
|                                   | > expired indicators.                               |
+-----------------------------------+-----------------------------------------------------+

#### Indicator configuration

Customize your indicators to your specific needs. Edit existing
indicator types and fields, add scripts, and configure tailored
extraction and expiration settings for optimal insights.

##### Customize indicator fields and types

Cortex XSIAM provides out-of-the-box indicator types and fields.
However, your use case may require indicator customization, either by
editing existing indicator types and fields or by creating new ones to
help investigate and respond to potential security threats specific to
your organization.

Custom indicators can provide more accurate and efficient identification
of potential cyber security threats. For example, you can customize
indicators to monitor and detect unusual activity within your
organization\'s internal network. This can include creating indicators
to flag unauthorized access attempts or unusual data transfers, or
identifying insider threats or compromised accounts.

Before customizing an indicator, review the ingested indicator and then
customize it as needed. After ingesting issues and indicators, check the
indicator information associated with your issue. From an issue, review
the context data. If there is information in the context data that you
don\'t see in the indicator, map it into indicator fields and display it
in the layout.

You can customize the following:

  -------------------------------------------------------------------------------------
  Option                              Description
  ----------------------------------- -------------------------------------------------
  Indicator type                      Customize an indicator type by setting the
                                      relevant fields, scripts to run, and reputation
                                      command for the indicator type. You can create a
                                      new indicator type or you can edit an
                                      out-of-the-box indicator type. For more
                                      information, see [Creating new indicator
                                      types](#UUID57247787fe73e44ec3b917878652df23).

  Indicator fields                    Custom indicator fields add specific details or
                                      attributes to indicators, helping to better
                                      classify and understand the nature of potential
                                      security threats. You can edit an existing
                                      indicator field or create a new one. After
                                      creating a new indicator field, map the field to
                                      the relevant context data. You can add the field
                                      to an indicator type and view it in an indicator
                                      layout. For more information, see [Create an
                                      indicator
                                      field](#UUID61358fd9590372f75f718bfa1380c4b2) and
                                      [Map custom indicator
                                      fields](#UUIDc62ed734e8ddd01c8a8f91546a16d09a).
  -------------------------------------------------------------------------------------

###### Create an indicator type

Indicators are categorized by indicator type, which determines the
indicator layout and fields that are displayed and which scripts are run
on indicators of that type. Cortex XSIAM includes several out-of-the-box
indicator types, such as:

- IP Address

- Domain

- URL

- File

<!-- -->

- For more information about file indicators and how to configure the
  file hash, see [File
  indicators](#UUIDd823c0bebc9418da3f36879c70830527).

When you create a new indicator type, you define its properties,
including whether and how to format the indicator data and how the
verdict is calculated.

1.  Go to Settings \> Configurations \> Object Setup \> Indicators \>
    Types.

2.  Click **New**.

3.  In the **Settings** tab, add the required indicator profile, such as
    name and Regex.

- For more information, see [Indicator type
  profile](#UUIDadaa1c76c55c0be097e03f2126acf604).

4.  In the **Custom Fields** tab, map the fields, as required.

- For more information, see [Map custom indicator
  fields](#UUIDc62ed734e8ddd01c8a8f91546a16d09a).

Create a company email indicator type

The following example describes how to create a new indicator type to
manage employee emails, for example for resource management or inside
threat investigation.

Create a new indicator type for the employee email addresses which
contain the "our_company.com" company domain.

1.  Under Settings \> Configurations \> Object Setup \> Indicators \>
    Types \> New, in the **Settings** tab, define the following.

    - Name:  Company email

    - Regex: `.*?@our_company.com` (simplified to capture all the email
      addresses using the our_company.com domain).

    - Reputation command: Not relevant for this example, since we don\'t
      want any external enrichment.

    - Formatting script: If more formatting is needed, you can use a
      formatting script to edit the saved value.

    - Reputation script: If needed, you can create a reputation script
      to affect the DBot score given to the new custom indicator.

2.  In the **Custom Fields** tab, map custom fields for the new
    indicator type.

- You can map fields returned using an integration such as Active
  Directory to obtain more data about the actual user to whom the email
  belongs. You can also collect data using integrations such as Okta
  (MFA, SSO), SIEM, and email security. Fields such as **Username**,
  **Full name**, and various groups the user is part of as well as other
  identifiers are returned to context and mapped into the indicator
  using the custom fields.

  ![](media/rId3067.png){width="5.833333333333333in"
  height="3.1427077865266844in"}

  > **Note**

  > If you miss mapping any field, you can create additional new
  > indicator fields and either relate them to all indicator types, or
  > relate them only to the new indicator type (recommended).

####### Indicator type profile

Each indicator type has its own profile that enables Cortex XSIAM to
recognize it across the platform. During the indicator extraction flow,
the order of execution is regex, formatting script, reputation command,
and reputation script. You can update the following fields when updating
an indicator type.

+-----------------------------------+-------------------------------------------------------+
| Field                             | Description                                           |
+===================================+=======================================================+
| Name                              | A meaningful name for the indicator type.             |
+-----------------------------------+-------------------------------------------------------+
| Reputation script                 | The output of the reputation script is a verdict      |
|                                   | score, which is used as the basis for the indicator   |
|                                   | verdict. Reputation scripts must be tagged            |
|                                   | **reputation** to appear in the list for the          |
|                                   | indicator type. For more information, see [Reputation |
|                                   | scripts](#UUIDf2fdfebe108e043d358583861e0377bc)       |
|                                   |                                                       |
|                                   | The results of reputation scripts do not print to the |
|                                   | War Room in the extraction flow.                      |
+-----------------------------------+-------------------------------------------------------+
| Formatting script                 | Modifies how the indicator displays in Cortex XSIAM.  |
|                                   |                                                       |
|                                   | Formatting scripts must be tagged                     |
|                                   | **indicator-format** to appear in the list for the    |
|                                   | indicator type. For more information, see [Formatting |
|                                   | scripts](#UUIDd28a00ace72c1c6ecda19e004639a815).      |
+-----------------------------------+-------------------------------------------------------+
| Enhancement script                | The enhancement script is not part of the indicator   |
|                                   | extraction flow and is run manually on the indicator  |
|                                   | type. Examples of enhancement scripts include an      |
|                                   | enrichment script and a script that runs a search in  |
|                                   | an SIEM for the indicator.                            |
|                                   |                                                       |
|                                   | After indicators are identified, you can go to the    |
|                                   | **Indicator Quick View** page, click the **Actions**  |
|                                   | button, and run an enhancement script directly on an  |
|                                   | indicator. For these scripts to be available in the   |
|                                   | menu, they need the **enhancement** tag. For more     |
|                                   | information, see [Enhancement                         |
|                                   | scripts](#UUID256501ccf23b2fd281318f67ebfc8d22).      |
|                                   |                                                       |
|                                   | When you run an enhancement script, it is the         |
|                                   | equivalent of running the script in the CLI. The      |
|                                   | script can write to context, return an entry, etc.    |
+-----------------------------------+-------------------------------------------------------+
| Reputation command                | Calculates the reputation of indicators of this type. |
|                                   | The verdict (reputation) is only associated with the  |
|                                   | specific indicator value on which it's run (not the   |
|                                   | indicator type). The command returns the reputation   |
|                                   | of the indicator value as an entry with entry context |
|                                   | and in some cases also returns context values that    |
|                                   | can be mapped to the indicator type custom fields.    |
|                                   |                                                       |
|                                   | The results of the reputation command do not print to |
|                                   | the War Room in the indicator extraction flow. For    |
|                                   | more information, see [Reputation                     |
|                                   | commands](#UUID97c2629d4cd2e8c06f1ae1df26930bad).     |
+-----------------------------------+-------------------------------------------------------+
| Regex                             | The regular expression (regex) to identify indicators |
|                                   | for this indicator type.                              |
+-----------------------------------+-------------------------------------------------------+
| Layout                            | Select the indicator layout to use.                   |
+-----------------------------------+-------------------------------------------------------+
| Exclude these integrations for    | Integrations to exclude when calculating the verdict, |
| the reputation command            | evaluating, and enriching indicators of this          |
|                                   | indicator type. This only applies to the indicator    |
|                                   | extraction and enrichment mechanism and does not      |
|                                   | apply when directly running reputation commands such  |
|                                   | as `!ip`, `!url`, `!domain`, etc.                     |
+-----------------------------------+-------------------------------------------------------+
| Indicator Expiration Method       | The method by which to expire indicators of this      |
|                                   | type. The expiration method that you select is the    |
|                                   | default expiration method for indicators of this      |
|                                   | indicator type.                                       |
|                                   |                                                       |
|                                   | The expiration can also be assigned when configuring  |
|                                   | a feed integration instance, which overrides the      |
|                                   | default method.                                       |
|                                   |                                                       |
|                                   | - Never Expire: indicators of this type never expire. |
|                                   |                                                       |
|                                   | - Time Interval: indicators of this type expire after |
|                                   |   the specified number of days or hours. For more     |
|                                   |   information, see [Configure indicator               |
|                                   |   expiration](#UUID6626ec9c2e6a5d97f43baad13728a39e). |
+-----------------------------------+-------------------------------------------------------+
| Context path for verdict value    | When an indicator is extracted, the entry data from   |
| (*Advanced*)                      | the command is mapped to the issue context. This path |
|                                   | defines where in context the data is mapped.          |
+-----------------------------------+-------------------------------------------------------+
| Context value of verdict          | The value of this field defines the actual data that  |
| (*Advanced*)                      | is mapped to the context path.                        |
+-----------------------------------+-------------------------------------------------------+
| Cache expiration in minutes       | The amount of time (in minutes) after which the cache |
| (*Advanced*)                      | for indicators of this type expire. The default is    |
|                                   | 4,320 minutes (three days). The cache enables you to  |
|                                   | limit API requests by only updating indicators after  |
|                                   | a specific time period has passed. The cache cannot   |
|                                   | be cleared manually.                                  |
|                                   |                                                       |
|                                   | > **Note**                                            |
|                                   | >                                                     |
|                                   | > Indicator cache expiration rules only apply to      |
|                                   | > standard enrichment (for example, running the       |
|                                   | > `enrichIndicators` command). If you run a           |
|                                   | > reputation command, such as `!ip`, the commands     |
|                                   | > executes even if the cache has not expired.         |
+-----------------------------------+-------------------------------------------------------+

####### File indicators

Cortex XSIAM uses a single **File** indicator for file objects. As a
result, files that appear with their SHA256 hash and all other hashes
associated with the file, (MD5, SHA1, and SSDeep) are listed as
properties of the same indicator. In addition, when ingesting an issue
through an integration, all file information is presented as one object.

When investigating an issue, in the **Indicators** section, click a
**File** indicator. You can see additional information for that
indicator, including:

- SHA256

- MD5

- SHA1

- SSDeep

- Associated File Names

<!-- -->

- The `File.Name` values associated with the indicator hash, based on
  `File` context objects created in Cortex XSIAM (automatically
  populated).

<!-- -->

- Modified

<!-- -->

- The date and time the **File** indicator was last modified.

<!-- -->

- First Seen

<!-- -->

- The date and time the file was first seen in Cortex XSIAM.

If the file appears in a different issue with a different name and has
any of the same hash values, it automatically associates with the
original indicator.

> **Note**
>
> A new **File** indicator only affects new indicators ingested to the
> Cortex XSIAM platform. Indicators that were already in Cortex XSIAM
> continue to appear as their respective hash-related indicators.

######## Configure each file hash to appear as a separate indicator

By default, Cortex XSIAM uses a single file indicator for file objects.
As a result, files that appear with their SHA256 hash and all other
hashes associated with the file, (MD5, SHA1, and SSDeep) are listed as
properties of the same indicator. In addition, when ingesting an issue
through an integration, all file information is presented as one object.

If the file appears in a different issue with a different name, and has
any of the same hash values, it automatically associates with the
original indicator.

If you want to have each file hash appear as its own indicator, do the
following:

1.  Go to Settings \> Configurations \> Object Setup \> Indicators \>
    Types.

2.  Select the **File** indicator and click **Disable**.

3.  Select the following required hashes:

    - File SHA-256

    - File SHA-1

    - File MD5

    - SSDeep

4.  Click **Enable**.

######## The file indicator merging method

When a file is created in the system, whether from a feed, indicator
extraction or manually added, its original value is created as the
indicator's value, while its complementing hashes are saved as fields.

For example, if a SHA256 indicator is extracted from an email and
enriched, an indicator with the SHA256 hash as the value will be
created, and any other hash that is found in the enrichment phase (such
as MD5, SHA1) will be added as a field. If in the future a file
indicator with the same MD5 is created in the system, Cortex XSIAM
automatically identifies it and merges the two indicators together into
one.

For example, the executable cmd.exe's SHA256
`FF79D3C4A0B7EB191783C323AB8363EBD1FD10BE58D8BCC96B07067743CA81D5` was
found in an issue and extracted. It also went through enrichment, which
provided the information that the file's MD5 is
`D7AB69FAD18D4A643D84A271DFC0DBDF`.

The file indicator includes:

    ID: 1
    Type: File
    Value: FF79D3C4A0B7EB191783C323AB8363EBD1FD10BE58D8BCC96B07067743CA81D5
    SHA256: FF79D3C4A0B7EB191783C323AB8363EBD1FD10BE58D8BCC96B07067743CA81D5
    MD5: D7AB69FAD18D4A643D84A271DFC0DBDF

Afterwards, through a custom feed, the cmd.exe's MD5
`D7AB69FAD18D4A643D84A271DFC0DBDF` hash is brought in, and Cortex XSIAM
creates an indicator of type File with the MD5 hash as its value.

A new file indicator is created:

    ID: 2
    Type: File
    Value: D7AB69FAD18D4A643D84A271DFC0DBDF
    MD5: D7AB69FAD18D4A643D84A271DFC0DBDF

The automatic merging flow for the File indicator type identifies that
the two indicators are the same file and merges them together.

The final file indicator is a consolidation of the two, and is the same
as the first example above:

    ID: 1
    Type: File
    Value: FF79D3C4A0B7EB191783C323AB8363EBD1FD10BE58D8BCC96B07067743CA81D5
    SHA256: FF79D3C4A0B7EB191783C323AB8363EBD1FD10BE58D8BCC96B07067743CA81D5
    MD5: D7AB69FAD18D4A643D84A271DFC0DBDF

####### Formatting scripts

A formatting script has the following main functions:

- Validate inputs, for example, to check that the top-level domain (TLD)
  is valid.

- Modify how the indicator appears in Cortex XSIAM such as the War Room.

After indicator values are extracted according to the defined regex, the
formatting script can be used to modify how the indicator value appears
in the War Room and reports. For example, the IP indicator type uses the
`UnEscapeIPs` formatting script, which removes any defanged characters
from an IP address, so `127[.]0[.]0[.]1` is formatted to `127.0.0.1`.
When you click the IP address in the War Room, you see the formatted IP
address. This extracted indicator value is then added to the Threat
Intel database.

######## Out-of-the-box Formatting Scripts

You can create a new script, or you can use an out-of-the-box formatting
script on the **Scripts** page, for example:

- `UnEscapeIPs:` Removes escaping characters from IP addresses. For
  example, 127\[.\]0\[.\]0\[.\]1 transforms to 127.0.0.1.

- `ExtractDomainAndFQDNFromUrlAndEmail:` Extracts domains and FQDNs from
  URLs and emails, used by the Domain indicator. It removes prefixes
  such as proofpoint or safelinks, removes escaped URLs, and extracts
  the FQDN.

- `ExtractEmailV2:` Verifies that an email address is valid and only
  returns the address if it is valid.

######## Formatting Script example

In the following example, the RemoveEmpty script removes empty items,
entries, or nodes from an array.

    // pack version: 1.2.30
    const EMPTY_TOKENS = argToList(args.empty_values);

    function toBoolean(value) {
        if (typeof(value) === 'string') {
            if (['yes', 'true'].indexOf(value.toLowerCase()) != -1) {
                return true;
            } else if (['no', 'false'].indexOf(value.toLowerCase()) != -1) {
                return false;
            }
            throw 'Argument does not contain a valid boolean-like value';
        }
        return value ? true : false;
    }

    function isObject(o) {
        return o instanceof Object && !(o instanceof Array);
    }

    function isEmpty(v) {
        return (v === undefined) ||
               (v === null) ||
               (typeof(v) == 'string' && (!v || EMPTY_TOKENS.indexOf(v) !== -1)) ||
               (Array.isArray(v) && v.filter(x => !isEmpty(x)).length === 0) ||
               (isObject(v) && Object.keys(v).length === 0);
    }

    function removeEmptyProperties(obj) {
        Object.keys(obj).forEach(k => {
            var ov = obj[k];
            if (isObject(ov)) {
                removeEmptyProperties(ov);
            } else if (Array.isArray(ov)) {
                ov.forEach(av => isObject(av) && removeEmptyProperties(av));
                obj[k] = ov.filter(x => !isEmpty(x));
            }
            if (isEmpty(ov)) {
                delete obj[k];
            }
        });
    }

    var vals = Array.isArray(args.value) ? args.value : [args.value];

    if (toBoolean(args.remove_keys)) {
        vals.forEach(v => isObject(v) && removeEmptyProperties(v));
    }
    return vals.filter(x => !isEmpty(x));

######## Formatting Script input

The formatting script requires a single input argument named `input`
that accepts a single indicator value or an array of indicator values.
The input argument should be an array to accept multiple inputs and
return an entry-result per input.

+-----------------------------------+------------------------------------+
| Argument                          | Description                        |
+===================================+====================================+
| `input`                           | Accepts a string or array of       |
|                                   | strings representing the indicator |
|                                   | value(s) to be formatted. Will be  |
|                                   | accessed within the script using   |
|                                   | `demisto.args().get(‘input’, [])`. |
|                                   |                                    |
|                                   | In the script settings, the        |
|                                   | **Is Array **checkbox must be      |
|                                   | selected (see screenshot           |
|                                   | below).The script code must be     |
|                                   | able to handle a single indicator  |
|                                   | value (as string), multiple        |
|                                   | indicator values in CSV format (as |
|                                   | string) and an array of single     |
|                                   | indicator values (array).          |
+-----------------------------------+------------------------------------+

![](media/rId3078.png){width="2.3333333333333335in" height="1.12875in"}

######## Formatting Script outputs

The indicators appear in a human-readable format in Cortex XSIAM. The
output should be an array of formatted indicators or an array of entry
results (an entry result per indicator to be created). The entry result
per input can be a JSON array to create multiple indicators. If the
entry result is an empty string, it is ignored and no indicator is
created.

Use the `return_results` function to generate the script output. For
more information, see
<https://xsoar.pan.dev/docs/integrations/code-conventions#return_results>.

Single-value result:

    results = CommandResults(
        outputs_prefix='VirusTotal.IP',
        outputs_key_field='Address',
        outputs={
            'Address': '8.8.8.8',
            'ASN': 12345
        }
    )
    return_results(results)

Multiple-value results:

    results = [
        CommandResults(
            outputs_prefix='VirusTotal.IP',
            outputs_key_field='Address',
            outputs={
                'Address': '8.8.8.8',
                'ASN': 12345
            }
        ), 
        CommandResults(
            outputs_prefix='VirusTotal.IP',
            outputs_key_field='Address',
            outputs={
                'Address': '1.1.1.1',
                'ASN': 67890
            }
        )]
    return_results(results)

######## Add a Formatting Script to an indicator type

1.  Go toSettings \> Configurations \> Object Setup \> Indicators \>
    Types.

2.  Select the indicator type and click **Edit**.

3.  Select the desired formatting script.

- > **Note**

  > Formatting scripts must have the `indicator-format` tag to appear in
  > the list.

> **Note**
>
> Formatting scripts for out-of-the-box indicator types are
> system-level, which means that the formatting scripts for these
> indicator types are not configurable. To create a formatting script
> for an out-of-the-box indicator type, you need to disable the existing
> indicator type and create a new (custom) indicator type. If you
> configured a formatting script before this change and updated your
> content, this configuration reverts to content settings (empty).

######## Run a Formatting script in the CLI

You can run out-of-the-box or custom formatting scripts in the CLI to
check the extracted indicator data is properly formatted.

The following are examples of the syntax for running the out-of-the-box
`UnEscapeIPs` formatting script in the CLI.

- `!UnEscapeIPs !UnEscapeIPs input=127.0.0[.]1`

- `!UnEscapeIPs input=127.0.0[.]1,8.8.8[.]8`

- `!UnEscapeIPs input=${contextdata.indicators}` (where the key
  `contextdata.indicators` in the context object is an array)

####### Enhancement scripts

Enhancement scripts enable you to gather additional data about the
highlighted entry in the War Room. They can enrich indicators, search a
SIEM for a specific indicator, write indicator details to context, and
return entries to the War Room.

Enhancement scripts are run manually from the **Indicator Quick View**
window or the CLI after indicators are extracted to allow you to collect
additional information about an indicator. If you have an issue that
contains an IP indicator and you want to run one or more enhancement
scripts, go to Indicator Quick View \> Actions and under
**Run Scripts**, select the desired script.

> **Note**
>
> Enhancement scripts are different from reputation commands. A
> reputation command runs every integration that has that command within
> it, to enrich the indicator. The reputation command `ip` , for
> example, runs every IP integration command in your enabled
> integrations, to collect data from multiple sources. An enhancement
> script is manually run after the initial extraction and enrichment for
> the indicator type is complete.

######## Enhancement script input

The enhancement script requires the indicator value as the input
argument.

  -----------------------------------------------------------------------
  Argument                            Description
  ----------------------------------- -----------------------------------
  The value of the indicator          For example `ip`, `email`,
                                      `url`.The argument name should
                                      match the indicator type in lower
                                      case. For example, the
                                      `IPReputation` script requires the
                                      `ip` input. For an
                                      `EmailReputation` script the input
                                      is `email`.

  -----------------------------------------------------------------------

In the following example, the `DomainReputation` script uses `domain` as
the input.

![](media/rId3088.png){width="2.3333333333333335in"
height="1.0908333333333333in"}

######## Enhancement script outputs

The enhancement script output depends on its input because the script is
run manually. If you want the output to be added to indicator enrichment
or the Threat Intelligence screen, it should follow the DBotScore
convention in the content output as described in
<https://xsoar.pan.dev/docs/integrations/dbot>.

    output =
       {
           'Type': entryTypes['note'],
           'ContentsFormat': formats['json'],
           'Contents': ‘this is the enrichment data’,
           'EntryContext': {
               'Email': ‘xsoar@test.com’, 
               ‘DBotScore’: {}},
       }

    return_results(output)

######## Add an enhancement script to an indicator type

1.  Go to Settings \> Configurations \> Object Setup \> Indicators \>
    Types

2.  Select the indicator type and click **Edit**.

3.  Select one or more desired enhancement scripts.

- > **Note**

  > Enhancement scripts must have the `enhancement` tag applied to
  > appear in the list.

######## Run an enhancement script in the CLI

You can run out-of-the-box or custom enhancement scripts in the CLI to
enrich specific indicator values.

The following are examples of the syntax for running the out-of-the-box
`IPReputation` and `URLReputation` enhancement scripts in the CLI.

- `!IPReputation ip=8.8.8.8`

- `!URLReputation url=cardcom.com`

####### Reputation scripts

Reputation scripts are used to assess and assign reputation scores to
indicators. These scripts integrate external threat intelligence or
internal data sources to evaluate the reputation of indicators (such as
IP addresses, URLs, or file hashes). Reputation scripts enable you to
implement custom logic and algorithms for determining the reputation of
indicators.

Reputation scripts return the verdict of an indicator as a number. The
number overrides the verdict returned from the reputation command but
does not override a manually set verdict. The reliability of the score
from a reputation script is by default `A++ - Reputation script`.

> **Note**
>
> The Reputation script overrides any default settings for the indicator
> that relates to the verdict.

**Out-of-the-box reputation scripts**

You can create a new reputation script, or you can use an out-of-the-box
reputation script in the **Scripts** page, for example:

- `CertificateReputation`

- `cveReputation`

- `MaliciousRatioReputation`

- `SSDeepReputation`

######## Reputation Script input

The reputation requires a single input argument named `input` that
accepts an indicator value.

  -----------------------------------------------------------------------
  Argument                            Description
  ----------------------------------- -----------------------------------
  `input`                             The indicator value.

  -----------------------------------------------------------------------

![](media/rId3098.png){width="2.3333333333333335in"
height="1.0908333333333333in"}

######## Reputation Script outputs

Either a number or a
[dbotScore](https://xsoar.pan.dev/docs/integrations/dbot). It can either
be a raw number which is the score, or a full entry with DBotScore.

    from CommonServerPython import *


    def main():
        url_list = argToList(demisto.args().get('input'))
        entry_list = []

        for url in url_list:
            entry_list.append({
                'Type': entryTypes['note'],
                'ContentsFormat': formats['json'],
                'Contents': 2,
                'EntryContext': {
                    'DBotScore': {
                        'Indicator': url,
                        'Type': 'Onion URL',
                        'Score': 2,  # suspicious
                        'Vendor': 'DBot'
                    }
                }
            })

        demisto.results(entry_list)


    if __name__ in ('__main__', 'builtin', 'builtins'):
        main()

######## Values for Common.DbotScore

  -----------------------------------------------------------------------
  Constant                            Value
  ----------------------------------- -----------------------------------
  Common.DbotScore.NONE               NONE = 0

  Common.DbotScore.GOOD               GOOD = 1

  Common.DbotScore.SUSPICIOUS         SUSPICIOUS = 2

  Common.DbotScore.BAD                BAD = 3
  -----------------------------------------------------------------------

######## Add a Reputation Script to an indicator type

1.  Go to Settings \> Configurations \> Object Setup \> Indicators \>
    Types.

2.  Select the indicator type and click **Edit**.

3.  Select the relevant reputation script.

- > **Note**

  > Reputation scripts must have the **reputation** tag applied to
  > appear in the list.

######## Run a Reputation Script in the CLI

You can run out-of-the-box or custom reputation scripts in the CLI to
set the verdict for a specific indicator.

The following are examples for running the out-of-the-box
`CertificateReputation` and `MalicioiusRationReputation` reputation
scripts in the CLI.

- `!CertificateReputation input=<value of the indicator>`

- `!MalicioiusRationReputation input=<value of the indicator>`

####### Reputation commands

Reputation commands are built-in or custom commands that use
integrations such as Unit 42 to provide predefined functionalities for
obtaining an indicator verdict for specific indicator types. These
commands simplify the process of fetching reputation data from external
services or threat intelligence feeds without requiring extensive
scripting. Reputation commands come with preconfigured parameters and
settings for commonly used threat intelligence sources.

You can set an indicator type to run reputation commands. The command
returns the verdict of the indicator as an entry with entry context and
may also return context values that can be mapped to the custom fields
of the indicator.

> **Note**
>
> Running a reputation command directly (such as `!ip`) might not apply
> the result to an indicator, nor does it use the enrichment cache. To
> ensure an indicator is enriched, and to take advantage of caching, use
> the `enrichIndicators` command or the **Enrich** button in the UI.
> This runs the appropriate reputation command/script based on the
> indicator type settings. Note that extracted indicators are enriched
> in the same way.

**Out-of-the-box reputation commands**

You can create a new reputation command, or you can use an
out-of-the-box reputation command, for example:

- `ip`

- `file`

- `url`

- `email`

- `domain`

For more details on using out-of-the-box reputation commands or
developing new reputation commands, see [Generic Commands
Reputation](https://xsoar.pan.dev/docs/integrations/generic-commands-reputation).

######## Reputation command input

The reputation command uses the indicator value as the input argument.

+-----------------------------------+------------------------------------+
| Arguments                         | Description                        |
+===================================+====================================+
| The value of the indicator        | For example `ip`, `email`, `url`.  |
|                                   | Inputs are based on different      |
|                                   | integrations. Basic inputs are     |
|                                   | common to all reputation commands. |
|                                   | For example, the `!ip` command has |
|                                   | the following basic inputs:        |
|                                   |                                    |
|                                   |     - name: ip                     |
|                                   |        arguments:                  |
|                                   |        - name: ip                  |
|                                   |          default: true             |
|                                   |          description: List of IPs. |
|                                   |          isArray: true             |
+-----------------------------------+------------------------------------+

In this example, the `ip` script uses `ip`, as the input, with the
`is array` field checked.

![](media/rId3110.png){width="2.3333333333333335in"
height="0.9741666666666666in"}

######## Reputation command output

Outputs return a
[dbotScore](https://xsoar.pan.dev/docs/integrations/dbot).

######## Run a Reputation command in the CLI

The following are examples of the syntax for running the `ip` ,
`domain`, and `file` reputation commands in the CLI.

- `!ip ip=<value of the indicator>`

- `!domain domain=<value of the indicator>`

- `!file file=<value of the indicator>`

####### Map custom indicator fields

Indicator mapping enables you to automatically update the value of an
indicator field without having to manually change it. For example, the
IP indicator automatically maps the Country field. If it was not mapped,
each time the IP address changes country the analyst would have to
update the country every time that indicator type is ingested.

The value of an indicator field is determined by the value of the key in
context data the field is mapped to in Cortex XSIAM.

When you start ingesting indicators, the incoming fields are
automatically mapped to the relevant indicator fields. Sometimes you may
want to change the default settings or map custom indicator fields to
specific context data. Before you map custom indicator fields, you need
to create the indicator field and add it to the relevant indicator type
layout.

> **Note**
>
> Some integrations have indicator mappers and classifiers, such as AWS.
> If you want to use an integration mapper or classifier, see [Indicator
> classification and mapping](#UUIDe61deb7f0dbfab0b31bcb1b78a5a5ed9).

To map custom fields to the indicator type, you need to enrich the
indicator either by using the `!enrichindicators`  command in the CLI,
in a playbook, or by opening an indicator and
click **Enrich indicator**. Enrichment returns an entry, with
the `EntryContext` property as the source of the mapping process. When
editing an indicator type, in the **Custom Fields** tab, type the name
of the indicator exactly how it appears (in the **XSIAM Indicators**
page) and click **Load**.

For the enrichment data to be considered valid, `EntryContext` must
include a `DBotScore` with the fields: `Indicator`, `Score`, `Vendor` ,
and `Type`. If `DBotScore` has those fields, all the data of
`EntryContext` is used as the source for the mapping, and not only the
data under `EntryContext.DBotScore`.

**How to map indicator fields**

1.  Go to Settings \> Configurations \> Object Setup \> Indicators \>
    Types.

2.  Select the indicator type and click **Edit**.

3.  Click the **Custom Fields** tab.

- The custom fields associated with this indicator type are listed in
  the table. If you do not see a custom field in the list, verify that
  you associated the custom field with this indicator type.

4.  (*Optional*) In the **Indicator Sample** panel, enter an indicator
    relevant to the indicator type to load sample data.

5.  Click **Choose data path** to map the custom field to a data path.

    a.  (*Optional*) Click the curly brackets to map the field to a
        context path.

    b.  (*Optional*) From the **Indicator Sample** panel, select a
        context key to map to the field.

6.  Save the indicator type.

###### Create an indicator field

Indicator fields are used to add specific indicator information to
issues. When you create an indicator field, you can associate the field
to a specific indicator type or all indicator types.

> **Note**
>
> Cortex XSIAM IOC fields are based on the STIX 2.1 specifications. For
> more information, see [Indicator field
> structure](#UUIDd10edd6366668ae1737a5a9217d71e6b).

####### Field types

+-----------------------------------+-----------------------------------+
| Field type                        | Description                       |
+===================================+===================================+
| Boolean                           | Checkbox                          |
+-----------------------------------+-----------------------------------+
| Date picker                       | Adds the date to the field.       |
+-----------------------------------+-----------------------------------+
| Grid (table)                      | Include an interactive, editable  |
|                                   | grid as a field type for selected |
|                                   | indicator types or all indicator  |
|                                   | types.                            |
|                                   |                                   |
|                                   | When you select Grid (table) you  |
|                                   | can format the table and          |
|                                   | determine if the user can add     |
|                                   | rows.                             |
+-----------------------------------+-----------------------------------+
| HTML                              | Create and view HTML content,     |
|                                   | which can be used in any type of  |
|                                   | indicator.                        |
|                                   |                                   |
|                                   | > **Note**                        |
|                                   | >                                 |
|                                   | > The following HTML tags are not |
|                                   | > permitted: `blockquote`, `del`, |
|                                   | > `dd`, `div`, `dl`, `dt`,        |
|                                   | > `fieldset`, `form`, `h1`, `h2`, |
|                                   | > `h3`, `h4`, `h5`, `h6`, `hr`,   |
|                                   | > `iframe`, `ins`, `li`, `math`,  |
|                                   | > `noscript`, `ol`, `pre`, `p`,   |
|                                   | > `script`, `style`, `table`,     |
|                                   | > `ul`, `address`, `article`,     |
|                                   | > `aside`, `canvas`, `details`,   |
|                                   | > `dialog`, `figcaption`,         |
|                                   | > `figure`, `footer`, `header`,   |
|                                   | > `hgroup`, `main`, `nav`,        |
|                                   | > `output`, `progress`,           |
|                                   | > `section`, `video`.             |
|                                   | >                                 |
|                                   | > The following CSS tags are not  |
|                                   | > permitted: `background-color`,  |
|                                   | > `text-align`, `font-size`,      |
|                                   | > `font-family`, `font-weight`,   |
|                                   | > `color`, `line-height`,         |
|                                   | > `border-style`, `border`,       |
|                                   | > `page-break-inside`,            |
|                                   | > `tablelayout`, `padding`,       |
|                                   | > `background-size`, `display`,   |
|                                   | > `padding-top`, `padding-right`, |
|                                   | > `padding-bottom`,               |
|                                   | > `padding-left`,                 |
|                                   | > `text-size-adjust`,             |
|                                   | > `break-inside`, `word-break`,   |
|                                   | > `width`, `height`,              |
|                                   | > `-ms-text-size-adjust`,         |
|                                   | > `-webkit-text-size-adjust`.     |
+-----------------------------------+-----------------------------------+
| Long text                         | - Long text is analyzed and       |
|                                   |   tokenized, and entries are      |
|                                   |   indexed as individual words,    |
|                                   |   enabling you to perform         |
|                                   |   advanced searches and use       |
|                                   |   wildcards.                      |
|                                   |                                   |
|                                   | - Long text fields can\'t be      |
|                                   |   sorted and used in graphical    |
|                                   |   dashboard widgets.              |
|                                   |                                   |
|                                   | - While editing a long text       |
|                                   |   field, pressing Enter will      |
|                                   |   create a new line (case is      |
|                                   |   insensitive).                   |
|                                   |                                   |
|                                   | Add a placeholder, if required.   |
+-----------------------------------+-----------------------------------+
| Markdown                          | Add markdown-formatted text as a  |
|                                   | template, which will be displayed |
|                                   | to users in the field after the   |
|                                   | indicator is created. Markdown    |
|                                   | lets you add basic formatting to  |
|                                   | text to provide a better end-user |
|                                   | experience.                       |
+-----------------------------------+-----------------------------------+
| Multi select/Array                | Select the following options:     |
|                                   |                                   |
|                                   | - Multi-select from a prefilled   |
|                                   |   (static) list                   |
|                                   |                                   |
|                                   | - An empty array field for the    |
|                                   |   user to add one or more values  |
|                                   |   as a comma-separated list       |
|                                   |                                   |
|                                   | Add a placeholder, if required.   |
+-----------------------------------+-----------------------------------+
| Number                            | Can contain any number. Default   |
|                                   | is 0.                             |
+-----------------------------------+-----------------------------------+
| Role                              | The role assigned to the          |
|                                   | indicator. Determines which users |
|                                   | (by role) can view the indicator. |
+-----------------------------------+-----------------------------------+
| Short text                        | - Short text is treated as a      |
|                                   |   single unit of text and is not  |
|                                   |   indexed by word. Advanced       |
|                                   |   search, including wildcards, is |
|                                   |   not supported.                  |
|                                   |                                   |
|                                   | - Short text fields are           |
|                                   |   case-sensitive by default, but  |
|                                   |   can be changed to               |
|                                   |   case-insensitive when creating  |
|                                   |   the field.                      |
|                                   |                                   |
|                                   | - While editing a short text      |
|                                   |   field, pressing Enter will save |
|                                   |   the change.                     |
|                                   |                                   |
|                                   | - Maximum length 60,000           |
|                                   |   characters                      |
|                                   |                                   |
|                                   | Recommended use is one-word       |
|                                   | entries, such as username and     |
|                                   | email address.                    |
|                                   |                                   |
|                                   | Select a placeholder, if          |
|                                   | required.                         |
+-----------------------------------+-----------------------------------+
| Single select                     | Select a value from a list of     |
|                                   | options. Add comma-separated      |
|                                   | values.                           |
+-----------------------------------+-----------------------------------+
| Tags                              | Accepts a single tag or a         |
|                                   | comma-separated list, not         |
|                                   | case-sensitive.                   |
|                                   |                                   |
|                                   | Add a placeholder, if required.   |
+-----------------------------------+-----------------------------------+
| URL                               | Add a URL when completing the     |
|                                   | field.                            |
+-----------------------------------+-----------------------------------+
| User                              | A user in Cortex XSIAM.           |
+-----------------------------------+-----------------------------------+

####### How to create a field

1.  Select Settings \> Configurations \> Object Setup \> Indicators \>
    Fields \> New Field.

2.  Select the relevant field type.

3.  Complete the following fields (if relevant):

  -----------------------------------------------------------------------
  Parameter                           Description
  ----------------------------------- -----------------------------------
  Mandatory                           If selected, this field is
                                      mandatory when used in a form.

  Field Name                          A meaningful display name for the
                                      field. After you type a name, you
                                      will see below the field that the
                                      **Machine name** is automatically
                                      populated. The field's machine name
                                      is applicable for searching and the
                                      CLI.

  Tooltip                             An optional tooltip for the field.
  -----------------------------------------------------------------------

4.  In the Basic Settings tab, define the values (according to the
    selected field type).

5.  In the **Attributes** tab define the following:

+-----------------------------------+--------------------------------------------------+
| Field                             | Description                                      |
+===================================+==================================================+
| Script to run when field value    | The script dynamically changes the field value   |
| changes                           | when script conditions are met. For a script to  |
|                                   | be available, it must have the                   |
|                                   | `field-change-triggered-indicator` tag when      |
|                                   | defining the script. For more information, see   |
|                                   | [Indicator field trigger                         |
|                                   | scripts](#UUID75d82af7c994375f36bf89d799171459). |
+-----------------------------------+--------------------------------------------------+
| Add to all indicator types        | This option is selected by default, which means  |
|                                   | this field is available to use in all indicator  |
|                                   | types.                                           |
|                                   |                                                  |
|                                   | Clear the checkbox to associate this field with  |
|                                   | a subset of indicator types.                     |
+-----------------------------------+--------------------------------------------------+

6.  Save the field.

7.  (Optional) In the indicator type, map custom indicator fields, so an
    indicator field is automatically updated, without the analyst having
    to manually change it.

####### Indicator field structure

Cortex XSIAM IOC fields are based on the STIX 2.1 specifications. These
fields provide a guideline for the fields we recommend you maintain
within an IOC. None of the fields are mandatory, except the value field.
Maintaining this field structure enables you to share and export IOCs to
additional threat intel based systems as well as to other cybersecurity
devices.

Like STIX, Cortex XSIAM indicators are divided into two categories, STIX
Domain Objects (SDOs) and STIX Cyber-observable Objects (SCOs). The
category determines which fields are presented in the layout of that
specific IOC. In Cortex XSIAM, all SCOs can be used in a relationship
with either SDOs or SCOs.

Each IOC table of fields is separated into three parts:

- System fields - Fields created and managed by Cortex XSIAM.

- Custom core fields - Custom fields shared by all IOCs of the same time
  (SDO or SCO). Fields may be empty.

- Custom unique fields - Fields unique to a specific type of IOC. If a
  user associates more fields with the IOC, the additional fields are
  also treated as unique.

######## STIX Cyber-observable Objects (SCO)

Account

Similar to STIX User Account Object, this indicator type represents a
user account in various platforms such as operating system, social media
accounts, and Active Directory. The value for the object is usually the
username for logging in.

  -----------------------------------------------------------------------
  System Fields                       Description
  ----------------------------------- -----------------------------------
  Value                               Defines the indicator on Cortex
                                      XSIAM. The value is the main key
                                      for the object in the system.

  Verdict                             Malicious, Suspicious, Benign, or
                                      Unknown.

  Expiration                          The expiration date of the object.

  Source Time Stamp                   When the object was created in the
                                      system.

  Modified                            When the object was last modified.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Core                Description
  ----------------------------------- -----------------------------------
  Blocked                             A Boolean switch to mark the object
                                      as blocked in the user environment.

  Community Notes                     Comments and free-form notes
                                      regarding the indicator.

  Description                         The description of the object.

  STIX ID                             The STIX ID for the object in the
                                      format of `account--<UUID>`.

  Tags                                Tags attached to the object.

  Traffic Light Protocol              Red, Amber, Green, or White.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Unique              Description
  ----------------------------------- -----------------------------------
  Account Type                        Specifies the type of the account,
                                      comes from `account-type-ov` by
                                      STIX.

  Creation Date                       The date the account was created
                                      (not the date the indicator was
                                      created).

  Display Name                        The display name of the account as
                                      it is shown in the UI.

  Groups                              The groups the account is a member
                                      of.

  User ID                             The account\'s unique ID according
                                      to the system it was taken from.
  -----------------------------------------------------------------------

Domain / DomainGlob

Network domain name, similar to the STIX Domain Name object. The value
is the domain address.

  -----------------------------------------------------------------------
  System Fields                       Description
  ----------------------------------- -----------------------------------
  Value                               Defines the indicator on Cortex
                                      XSIAM. The value is the main key
                                      for the object in the system.

  Verdict                             Malicious, Suspicious, Benign, or
                                      Unknown.

  Expiration                          The expiration date of the object.

  Source Time Stamp                   When the object was created in the
                                      system.

  Modified                            When the object was last modified.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Core                Description
  ----------------------------------- -----------------------------------
  Blocked                             A Boolean switch to mark the object
                                      as blocked in the user environment.

  Community Notes                     Comments and free form notes
                                      regarding the indicator.

  Description                         The description of the object.

  STIX ID                             The STIX ID for the object in the
                                      format of `domain--<UUID>`.

  Tags                                Tags attached to the object.

  Traffic Light Protocol              Red, Amber, Green, or White.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Unique              Description
  ----------------------------------- -----------------------------------
  Creation Date                       The date the domain was created.

  DNS Records                         All types of DNS records with a
                                      timestamp and their values (GRID).

  Expiration Date                     The domain expiration date.

  Certificates                        Any certificates issued for the
                                      domain.

  WHOIS Records                       Any records from WHOIS about the
                                      domain (GRID).
  -----------------------------------------------------------------------

Email

A single user email address.

  -----------------------------------------------------------------------
  System Fields                       Description
  ----------------------------------- -----------------------------------
  Value                               Defines the indicator on Cortex
                                      XSIAM. The value is the main key
                                      for the object in the system.

  Verdict                             Malicious, Suspicious, Benign, or
                                      Unknown.

  Expiration                          The expiration date of the object.

  Source Time Stamp                   When the object was created in the
                                      system.

  Modified                            When the object was last modified.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Core                Description
  ----------------------------------- -----------------------------------
  Blocked                             A Boolean switch to mark the object
                                      as blocked in the user environment.

  Community Notes                     Comments and free form notes
                                      regarding the indicator.

  Description                         The description of the object.

  STIX ID                             The STIX ID for the object in the
                                      format of `email--<UUID>`.

  Tags                                Tags attached to the object.

  Traffic Light Protocol              Red, Amber, Green, or White.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Unique
  -----------------------------------------------------------------------
  None

  -----------------------------------------------------------------------

File

Represents a single file. For backward compatibility, the indicator has
multiple fields for different types of hashes. New hashes, however,
should be stored under the **Hashes** grid field. The file value should
be its hash (either MD5, SHA-1, SHA-256, or SHA-512, in that order).

  -----------------------------------------------------------------------
  System Fields                       Description
  ----------------------------------- -----------------------------------
  Value                               Defines the indicator on Cortex
                                      XSIAM. The value is the main key
                                      for the object in the system.

  Verdict                             Malicious, Suspicious, Benign, or
                                      Unknown.

  Expiration                          The expiration date of the object.

  Source Time Stamp                   When the object was created in the
                                      system.

  Modified                            When the object was last modified.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Core                Description
  ----------------------------------- -----------------------------------
  Blocked                             A Boolean switch to mark the object
                                      as blocked in the user environment.

  Community Notes                     Comments and free form notes
                                      regarding the indicator.

  Description                         The description of the object.

  STIX ID                             The STIX ID for the object in the
                                      format of `file--<UUID>`.

  Tags                                Tags attached to the object.

  Traffic Light Protocol              Red, Amber, Green, or White.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Unique              Description
  ----------------------------------- -----------------------------------
  Creation Date                       The file creation date.

  File Extension                      The file extension.

  Associated File Names               Names the file is associated with.

  File Type                           The type of the file.

  Hashes                              Any hashes not specified in a
                                      separate field.

  imphash                             The imphash.

  MD5                                 The MD5 hash.

  Modified Date                       When the file was modified on the
                                      origin.

  Path                                The path to the file.

  Quarantined                         Was the file quarantined?

  SHA1                                The SHA1 hash.

  SHA256                              The SHA256 hash.

  SHA512                              The SHA512 hash.

  Size                                The file size.

  SSDeep                              The SSDeep hash.
  -----------------------------------------------------------------------

IPv4 / IPv6 / CIDR / IPv6CIDR

Represents an IP address and its subnet (CIDR). If no subnet is
provided, the address is treated as a single IP (same as a /32 subnet).

  -----------------------------------------------------------------------
  System Fields                       Description
  ----------------------------------- -----------------------------------
  Value                               Defines the indicator on Cortex
                                      XSIAM. The value is the main key
                                      for the object in the system.

  Verdict                             Malicious, Suspicious, Benign, or
                                      Unknown.

  Expiration                          The expiration date of the object.

  Source Time Stamp                   When the object was created in the
                                      system.

  Modified                            When the object was last modified.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Core                Description
  ----------------------------------- -----------------------------------
  Blocked                             A Boolean switch to mark the object
                                      as blocked in the user environment.

  Community Notes                     Comments and free form notes
                                      regarding the indicator.

  Description                         The description of the object.

  STIX ID                             The STIX ID for the object in the
                                      format of `type--<UUID>`.

  Tags                                Tags attached to the object.

  Traffic Light Protocol              Red, Amber, Green, or White.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Unique              Description
  ----------------------------------- -----------------------------------
  Geo Country                         The country where the object is
                                      located.

  Geo Location                        A set of geographic coordinates for
                                      the object.

  WHOIS records                       Any records from WHOIS about the
                                      domain (GRID).
  -----------------------------------------------------------------------

URL

Represents the properties of a uniform resource locator.

  -----------------------------------------------------------------------
  System Fields                       Description
  ----------------------------------- -----------------------------------
  Value                               Defines the indicator on Cortex
                                      XSIAM. The value is the main key
                                      for the object in the system.

  Verdict                             Malicious, Suspicious, Benign, or
                                      Unknown.

  Expiration                          The expiration date of the object.

  Source Time Stamp                   When the object was created in the
                                      system.

  Modified                            When the object was last modified.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Core                Description
  ----------------------------------- -----------------------------------
  Blocked                             A Boolean switch to mark the object
                                      as blocked in the user environment.

  Community Notes                     Comments and free form notes
                                      regarding the indicator.

  Description                         The description of the object.

  STIX ID                             The STIX ID for the object in the
                                      format of `url--<UUID>`.

  Tags                                Tags attached to the object.

  Traffic Light Protocol              Red, Amber, Green, or White.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Unique              Description
  ----------------------------------- -----------------------------------
  Certificates                        Any certificates issued for the
                                      domain.

  -----------------------------------------------------------------------

######## STIX Domain Objects (SDO)

Attack Pattern

Attack patterns are a type of TTP (Tactics, Techniques and Procedures)
that describe ways adversaries attempt to compromise targets. Attack
patterns help categorize attacks, generalize specific attacks to the
patterns that they follow, and provide detailed information about how
attacks are performed. An example of an attack pattern is spear
phishing, where an attacker sends a carefully crafted email message with
the intent of getting the target to click a link or open an attachment
that delivers malware. Attack patterns can also be more specific, such
as spear phishing by a particular threat actor (for example, an email
saying the target won a contest).

  -----------------------------------------------------------------------
  System Fields                       Description
  ----------------------------------- -----------------------------------
  Value                               Defines the indicator on Cortex
                                      XSIAM. The value is the main key
                                      for the object in the system.

  Verdict                             Malicious, Suspicious, Benign, or
                                      Unknown.

  Expiration                          The expiration date of the object.

  Source Time Stamp                   When the object was created in the
                                      system.

  Modified                            When the object was last modified.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Core                Description
  ----------------------------------- -----------------------------------
  Community Notes                     Comments and free form notes
                                      regarding the indicator.

  Description                         The description of the object.

  STIX ID                             The STIX ID for the object in the
                                      format of `attack-pattern--<UUID>`.

  Tags                                Tags attached to the object.

  Traffic Light Protocol              Red, Amber, Green, or White.
  -----------------------------------------------------------------------

  ----------------------------------------------------------------------------
  Custom Fields - Unique              Description
  ----------------------------------- ----------------------------------------
  Kill Chain Phases                   The list of kill chain phases this
                                      Attack Pattern is used for.

  External References                 List of external references consisting
                                      of a source and ID. For
                                      example, `{source: mitere, id: T1189}`
  ----------------------------------------------------------------------------

Campaign

A campaign is a grouping of adversarial behaviors that describes a set
of malicious activities or attacks (sometimes called waves) that occur
over a period of time against a specific set of targets. Campaigns
usually have well defined objectives and may be part of an intrusion
set.

Campaigns are often attributed to an intrusion set and threat actors.
The threat actors may reuse known infrastructure from the intrusion set
or may set up new infrastructure specifically for conducting that
campaign.

Campaigns can be characterized by their objectives and the issues they
cause, people or resources they target, and the resources (such as
infrastructure, intelligence, and malware, tools) they use.

For example, a campaign can describe a crime syndicate\'s attack using a
specific variant of malware and new C2 servers against the executives of
ACME Bank during the summer of 2020 to gain secret information about an
upcoming merger with another bank.

  -----------------------------------------------------------------------
  System Fields                       Description
  ----------------------------------- -----------------------------------
  Value                               Defines the indicator on Cortex
                                      XSIAM. The value is the main key
                                      for the object in the system.

  Verdict                             Malicious, Suspicious, Benign, or
                                      Unknown.

  Expiration                          The expiration date of the object.

  Source Time Stamp                   When the object was created in the
                                      system.

  Modified                            When the object was last modified.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Core                Description
  ----------------------------------- -----------------------------------
  Community Notes                     Comments and free form notes
                                      regarding the indicator.

  Description                         The description of the object.

  STIX ID                             The STIX ID for the object in the
                                      format of `campaign--<UUID>`.

  Tags                                Tags attached to the object.

  Traffic Light Protocol              Red, Amber, Green, or White.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Unique              Description
  ----------------------------------- -----------------------------------
  Aliases                             Alternative names used to identify
                                      this campaign.

  Objective                           The campaign's primary goal,
                                      objective, desired outcome, or
                                      intended effect.
  -----------------------------------------------------------------------

Course of action

A course of action is an action taken either to prevent an attack or to
respond to an attack that is in progress. It may describe technical,
automatable responses (applying patches, reconfiguring firewalls), but
can also describe higher level actions such as employee training or
policy changes. For example, a course of action to mitigate a
vulnerability could describe applying the patch that fixes it.

  -----------------------------------------------------------------------
  System Fields                       Description
  ----------------------------------- -----------------------------------
  Value                               Defines the indicator on Cortex
                                      XSIAM. The value is the main key
                                      for the object in the system.

  Verdict                             Malicious, Suspicious, Benign, or
                                      Unknown.

  Expiration                          The expiration date of the object.

  Source Time Stamp                   When the object was created in the
                                      system.

  Modified                            When the object was last modified.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Core                Description
  ----------------------------------- -----------------------------------
  Community Notes                     Comments and free form notes
                                      regarding the indicator.

  Description                         The description of the object.

  STIX ID                             The STIX ID for the object in the
                                      format of
                                      `course-of-action--<UUID>`.

  Tags                                Tags attached to the object.

  Traffic Light Protocol              Red, Amber, Green, or White.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Unique              Description
  ----------------------------------- -----------------------------------
  Action                              Reserved to capture
                                      structured/automated courses of
                                      action.

  -----------------------------------------------------------------------

CVE

To preserve backward compatibility, our vulnerability indicator is
referred to as CVE, but it is equivalent to the Vulnerability object
defined by STIX. Unlike STIX, in TIM the object is identified by its CVE
number. A vulnerability is a weakness or defect in the requirements,
designs, or implementations of the computational logic (code) found in
software and some hardware components (firmware) that can be directly
exploited to negatively impact the confidentiality, integrity, or
availability of that system.

  -----------------------------------------------------------------------
  System Fields                       Description
  ----------------------------------- -----------------------------------
  Value                               Defines the indicator on Cortex
                                      XSIAM. The value is the main key
                                      for the object in the system.

  Verdict                             Malicious, Suspicious, Benign, or
                                      Unknown.

  Expiration                          The expiration date of the object.

  Source Time Stamp                   When the object was created in the
                                      system.

  Modified                            When the object was last modified.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Core                Description
  ----------------------------------- -----------------------------------
  Community Notes                     Comments and free form notes
                                      regarding the indicator.

  Description                         The description of the object.

  STIX ID                             The STIX ID for the object in the
                                      format of `vulnerability--<UUID>`.

  Tags                                Tags attached to the object.

  Traffic Light Protocol              Red, Amber, Green, or White.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Unique              Description
  ----------------------------------- -----------------------------------
  CVSS Version                        The version of the CVSS scoring
                                      system.

  CVSS Score                          The score given to the CVE.

  CVSS Vector                         The full CVSS vector.

  CVSS Table                          All CVSS data by Metric - Value
                                      pairs.
  -----------------------------------------------------------------------

Infrastructure

The Infrastructure SDO represents a type of TTP and describes any
systems, software services and any associated physical or virtual
resources that support some purpose (for example, C2 servers used as
part of an attack, a device or server that is part of a defense, and
database servers targeted by an attack). While elements of an attack can
be represented by other SDOs or SCOs, the Infrastructure SDO represents
a named group of related data that constitutes the infrastructure.

  -----------------------------------------------------------------------
  System Fields                       Description
  ----------------------------------- -----------------------------------
  Value                               Defines the indicator on Cortex
                                      XSIAM. The value is the main key
                                      for the object in the system.

  Verdict                             Malicious, Suspicious, Benign, or
                                      Unknown.

  Expiration                          The expiration date of the object.

  Source Time Stamp                   When the object was created in the
                                      system.

  Modified                            When the object was last modified.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Core                Description
  ----------------------------------- -----------------------------------
  Community Notes                     Comments and free form notes
                                      regarding the indicator.

  Description                         The description of the object.

  STIX ID                             The STIX ID for the object in the
                                      format of `infrastructure--<UUID>`.

  Tags                                Tags attached to the object.

  Traffic Light Protocol              Red, Amber, Green, or White.
  -----------------------------------------------------------------------

  ------------------------------------------------------------------------
  Custom Fields - Unique              Description
  ----------------------------------- ------------------------------------
  Aliases                             Alternative names used to identify
                                      this infrastructure.

  Infrastructure types                The type of infrastructure being
                                      described. Values should come from
                                      STIX `infrastructure-type-ov` open
                                      vocabulary.
  ------------------------------------------------------------------------

Intrusion set

An intrusion set is a grouped set of adversarial behaviors and resources
with common properties that is believed to be orchestrated by a single
organization. An intrusion set may capture multiple campaigns or other
activities that are all tied together by shared attributes indicating a
commonly known or unknown threat actor. New activity can be attributed
to an intrusion set even if the threat actors behind the attack are not
known. Threat actors can move from supporting one intrusion set to
supporting another, or they may support multiple intrusion sets.

Whereas a campaign is a set of attacks over a period of time against a
specific set of targets to achieve an objective, an intrusion set is the
entire attack package and may be used over a very long period of time in
multiple campaigns to achieve potentially multiple purposes.

  -----------------------------------------------------------------------
  System Fields                       Description
  ----------------------------------- -----------------------------------
  Value                               Defines the indicator on Cortex
                                      XSIAM. The value is the main key
                                      for the object in the system.

  Verdict                             Malicious, Suspicious, Benign, or
                                      Unknown.

  Expiration                          The expiration date of the object.

  Source Time Stamp                   When the object was created in the
                                      system.

  Modified                            When the object was last modified.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Core                Description
  ----------------------------------- -----------------------------------
  Community Notes                     Comments and free form notes
                                      regarding the indicator.

  Description                         The description of the object.

  STIX ID                             The STIX ID for the object in the
                                      format of `intrusion-set--<UUID>`.

  Tags                                Tags attached to the object.

  Traffic Light Protocol              Red, Amber, Green, or White.
  -----------------------------------------------------------------------

  --------------------------------------------------------------------------
  Custom Fields - Unique              Description
  ----------------------------------- --------------------------------------
  Aliases                             Alternative names used to identify
                                      this intrusion set.

  Goals                               The high-level goals of this intrusion
                                      set, what it is trying to do.

  Primary Motivation                  The primary reason, motivation, or
                                      purpose behind this intrusion set.
                                      Values should come from
                                      STIX `attack-motivation-ov` open
                                      vocabulary.

  Secondary Motivation                The secondary reason, motivation, or
                                      purpose behind this intrusion set.
                                      Values should come from
                                      STIX `attack-motivation-ov` open
                                      vocabulary.

  Resource level                      Specifies the organizational level at
                                      which this intrusion set typically
                                      works. Values should come from
                                      STIX `attack-resource-level-ov` open
                                      vocabulary.
  --------------------------------------------------------------------------

Malware

Malware is a type of TTP that represents malicious code. It generally
refers to a program that is inserted into a system, usually covertly.
The intent is to compromise the confidentiality, integrity, or
availability of the victim\'s data, applications, or operating system
(OS) or otherwise annoy or disrupt the victim.

  -----------------------------------------------------------------------
  System Fields                       Description
  ----------------------------------- -----------------------------------
  Value                               Defines the indicator on Cortex
                                      XSIAM. The value is the main key
                                      for the object in the system.

  Verdict                             Malicious, Suspicious, Benign, or
                                      Unknown.

  Expiration                          The expiration date of the object.

  Source Time Stamp                   When the object was created in the
                                      system.

  Modified                            When the object was last modified.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Core                Description
  ----------------------------------- -----------------------------------
  Community Notes                     Comments and free form notes
                                      regarding the indicator.

  Description                         The description of the object.

  STIX ID                             The STIX ID for the object in the
                                      format of `malware--<UUID>`.

  Tags                                Tags attached to the object.

  Traffic Light Protocol              Red, Amber, Green, or White.
  -----------------------------------------------------------------------

  ---------------------------------------------------------------------------------------
  Custom Fields - Unique              Description
  ----------------------------------- ---------------------------------------------------
  Aliases                             A list of other names the malware is known as.

  Architecture                        The processor architectures (for exmple, x86, ARM)
                                      that the malware instance or family is executable
                                      on. The values should come from the
                                      STIX `processor-architecture-ov open vocabulary`.

  Capabilities                        Any of the capabilities identified for the malware
                                      instance or family. The values should come from
                                      STIX `malware-capabilities-ov` open vocabulary.

  Implementation Languages            The programming language(s) used to implement the
                                      malware instance or family. The values should come
                                      from the STIX `implementation-language-ov` open
                                      vocabulary.

  Is Malware Family                   Whether the object represents a malware family (if
                                      true) or a malware instance (if false).

  Malware Types                       Which type of malware. Values should come from
                                      STIX `malware-type-ov` open vocabulary.

  Operating System Refs               Identifier of a software object.
  ---------------------------------------------------------------------------------------

Report

Reports are collections of threat intelligence focused on one or more
topics, such as a description of a threat actor, malware, or attack
technique, including context and related details. They are used to group
related threat intelligence together so that it can be published as a
comprehensive cyber threat story.

  -----------------------------------------------------------------------
  System Fields                       Description
  ----------------------------------- -----------------------------------
  Value                               Defines the indicator on Cortex
                                      XSIAM. The value is the main key
                                      for the object in the system.

  Verdict                             Malicious, Suspicious, Benign, or
                                      Unknown.

  Expiration                          The expiration date of the object.

  Source Time Stamp                   When the object was created in the
                                      system.

  Modified                            When the object was last modified.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Core                Description
  ----------------------------------- -----------------------------------
  Community Notes                     Comments and free form notes
                                      regarding the indicator.

  Description                         The description of the object.

  STIX ID                             The STIX ID for the object in the
                                      format of `report--<UUID>`.

  Tags                                Tags attached to the object.

  Traffic Light Protocol              Red, Amber, Green, or White.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Unique              Description
  ----------------------------------- -----------------------------------
  Publications                        Links to publications of the
                                      report.

  -----------------------------------------------------------------------

Threat actor

Threat actors are individuals, groups, or organizations believed to be
operating with malicious intent. A threat actor is not an intrusion set
but may support or be affiliated with various intrusion sets, groups, or
organizations over time.

  -----------------------------------------------------------------------
  System Fields                       Description
  ----------------------------------- -----------------------------------
  Value                               Defines the indicator on Cortex
                                      XSIAM. The value is the main key
                                      for the object in the system.

  Verdict                             Malicious, Suspicious, Benign, or
                                      Unknown.

  Expiration                          The expiration date of the object.

  Source Time Stamp                   When the object was created in the
                                      system.

  Modified                            When the object was last modified.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Core                Description
  ----------------------------------- -----------------------------------
  Community Notes                     Comments and free form notes
                                      regarding the indicator.

  Description                         The description of the object.

  STIX ID                             The STIX ID for the object in the
                                      format of `threat-actor--<UUID>`.

  Tags                                Tags attached to the object.

  Traffic Light Protocol              Red, Amber, Green, or White.
  -----------------------------------------------------------------------

  --------------------------------------------------------------------------------
  Custom Fields - Unique              Description
  ----------------------------------- --------------------------------------------
  Alias                               A list of other names the threat actor is
                                      known as.

  Geo country                         The country the threat actor is associated
                                      with.

  Goals                               The high-level goals of this threat actor,
                                      what it is trying to do.

  Resource Level                      The organizational level at which this
                                      threat actor typically works. Values for
                                      this property should come from
                                      STIX `attack-resource-level-ov` open
                                      vocabulary.

  Primary Motivation                  The primary reason, motivation, or purpose
                                      behind this threat actor. Values for this
                                      property should come from
                                      STIX `attack-motivation-ov` open vocabulary.

  Secondary Motivation                The secondary reasons, motivations, or
                                      purposes behind this threat actor. Values
                                      for this property should come from
                                      STIX `attack-motivation-ov` open vocabulary.

  Sophistication                      The skill, specific knowledge, special
                                      training, or expertise a threat actor must
                                      have to perform the attack. Values for this
                                      property should come from
                                      STIX `threat-actor-sophistication-ov` open
                                      vocabulary.

  Threat actor type                   The type(s) of this threat actor. Values
                                      should come from
                                      STIX `threat-actor-type-ov` open vocabulary.
  --------------------------------------------------------------------------------

Tool

Tools are legitimate software used by threat actors to perform attacks.
Knowing how and when threat actors use such tools can help understand
how campaigns are executed. Unlike malware, these tools or software
packages are often found on a system and have legitimate purposes for
power users, system administrators, network administrators, or even
regular users. Remote access tools such as RDP and network scanning
tools such as Nmap are examples of tools that may be used by a threat
actor during an attack.

  -----------------------------------------------------------------------
  System Fields                       Description
  ----------------------------------- -----------------------------------
  Value                               Defines the indicator on Cortex
                                      XSIAM. The value is the main key
                                      for the object in the system.

  Verdict                             Malicious, Suspicious, Benign, or
                                      Unknown.

  Expiration                          The expiration date of the object.

  Source Time Stamp                   When the object was created in the
                                      system.

  Modified                            When the object was last modified.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Core                Description
  ----------------------------------- -----------------------------------
  Community Notes                     Comments and free form notes
                                      regarding the indicator.

  Description                         The description of the object.

  STIX ID                             The STIX ID for the object in the
                                      format of `tool--<UUID>`.

  Tags                                Tags attached to the object.

  Traffic Light Protocol              Red, Amber, Green, or White.
  -----------------------------------------------------------------------

  -----------------------------------------------------------------------
  Custom Fields - Unique              Description
  ----------------------------------- -----------------------------------
  Alias                               Alternative names used to identify
                                      this tool.

  Tool Types                          The kind(s) of tool(s) being
                                      described. Values for this property
                                      should come from
                                      STIX `tool-type-ov` open
                                      vocabulary.

  Tool Version                        The version identifier associated
                                      with the tool.

  Kill Chain Phases                   The list of kill chain phases this
                                      attack pattern is used for.
  -----------------------------------------------------------------------

####### Indicator field trigger scripts

Indicator field trigger scripts are automated responses that are
triggered by a change in an indicator field value. In the script, you
define the change in the indicator field value to check for and the
actions to take when the change occurs. For example, you can:

- Create a script that runs when the **Verdict** field of an indicator
  changes. For example, the script will fetch all issues related to the
  indicator and take any action that is configured, such as reopening or
  changing severity.

- Create a script that runs when the **Expiration Status** field
  changes. For example, you can define a script that will immediately
  update the relevant allow/block list and not wait for the next
  iteration, as seen in the following sample script:

<!-- -->

- indicators = demisto.args().get('indicators')
      new_value = demisto.args().get('new')

      indicator_values = []
      for indicator in indicators:
          current_value = indicator.get('value')
          indicator_values.append(current_value)

      if new_value == "Expired":
          # update allow/block list regarding expired indicators
      else:
          # update allow/block list regarding active indicators

######## Indicator field trigger script arguments

Scripts can be created in Python, PowerShell, or JavaScript on
the Scripts page. To use a field trigger script, you need to add
the **field-change-triggered-indicator** tag when creating the script.
You can then add the script in the Attributes tab when you edit
or create a custom indicator field. If you did not add the tag when
creating the script, the script will not be available for use.

Indicator field trigger scripts have the following triggered field
information available as arguments (args):

  -----------------------------------------------------------------------
  Argument                            Description
  ----------------------------------- -----------------------------------
  `associatedToAll`                   Whether the field is associated
                                      with all or some indicators. Value:
                                      `true` or `false`.

  `associatedTypes`                   An array of the indicator types the
                                      field is associated with.

  `cliName`                           The name of the field when called
                                      from the CLI.

  `description`                       The description of the field.

  `indicators`                        A list of indicators that have the
                                      current change.

  `isReadOnly`                        Specifies whether the field is
                                      non-editable. Value: `true` or
                                      `false`.

  `name`                              The name of the field.

  `new`                               The new value of the field.

  `old`                               The old value of the field.

  `ownerOnly`                         Specifies that only the creator of
                                      the field can edit. Value: `true`
                                      or `false`.

  `placeholder`                       The placeholder text.

  `required`                          Specifies whether this is a
                                      mandatory field. Value: `true` or
                                      `false`.

  `selectValues`                      If this is a multi-select type
                                      field, these are the values the
                                      field can take.

  `system`                            Whether it is a Cortex XSIAM
                                      defined field.

  `type`                              The field type.

  `user`                              The username of the user who
                                      triggered the script.
  -----------------------------------------------------------------------

######## Indicator field trigger script best practices

- Indicator field trigger scripts can be configured on the **Verdict**,
  **Related Incidents**, **Expiration Status**, and **Indicator Type**
  fields, as well as any custom indicator fields.

- Indicator field trigger scripts work in all TIM (Threat Intelligence
  Management) scenarios and workflows, except for feed ingestion.

- Fields that can hold a list (related incidents, multi-select/tag/role
  type custom fields) will provide an array of the delta. For example,
  if a multi-select field value has changed from \[\"a\"\] to \[\"a\",
  \"b\"\], the new argument of the script will get a value of \[\"b\"\].

- Indicator field trigger scripts run as a batch. This means that if
  multiple indicators are changed in the same way and are set to trigger
  the same action, it will happen in one batch.

<!-- -->

- For example, in the following scenario for a configured indicator
  field trigger script named `myTriggerScript` on the **Verdict**
  indicator field:

  - The Threat Intel Library has two existing Malicious indicators:
    1.1.1.1 and 2.2.2.2.

  - The user runs the following command
    `!setIndicators indicatorsValues="1.1.1.1,2.2.2.2" verdict=Benign`.

  - The `myTriggerScript` script will run just once, with the following
    parameters:

    - new - \"Benign\"

    - old - \"Malicious\"

    - indicators - \"\[{\<indicator_1.1.1.1\>},{\<indicator_2.2.2.2}\]\"

<!-- -->

- When writing indicator field trigger scripts, avoid scenarios that
  call the scripts endlessly (for example, a change in field A triggers
  script X, which changes field B\'s value, which in turn calls script
  Y, which changes field A\'s value).

######## Add an indicator field trigger script to an indicator field

After creating an indicator field trigger script in the **Scripts** page
in Python, PowerShell, or JavaScript, you can then associate it with an
indicator field.

1.  Go to Settings \> Configurations \> Object Setup \> Indicators \>
    Fields.

2.  Select the indicator field and click **Edit**.

3.  In the **Attributes** tab, under
    **Script to run when field value changes**, select the desired
    indicator field trigger script.

- > **Note**

  > Indicator field trigger scripts must have the
  > `field-change-triggered-indicator` tag to appear in the list.

##### Indicator classification and mapping

The following table shows methods by which indicators are detected and
ingested in Cortex XSIAM and how they are classified and mapped.

+-----------------------+-----------------------+---------------------------------------------------------------+
| Method                | Description           | Classification and Mapping                                    |
+=======================+=======================+===============================================================+
| Integration           | Feed integrations:    | Indicator classification and mapping is done in the           |
|                       | Fetch indicators from | integration code by duplicating the integration and not in    |
|                       | a feed, for example,  | the Indicators \> Classification & Mapping tab. For more      |
|                       | TAXII, Office 365,    | information, see [Feed                                        |
|                       | and Unit 42 ATOMS     | Integrations](https://xsoar.pan.dev/docs/integrations/feeds). |
|                       | Feed.                 |                                                               |
|                       |                       | Some integrations come with a classifier and mapper, which    |
|                       |                       | you can customize.                                            |
+-----------------------+-----------------------+---------------------------------------------------------------+
| Indicator extraction  | If you have enabled   | Only the value of an indicator is extracted, so no            |
|                       | system-wide indicator | classification or mapping is needed.                          |
|                       | extraction,           |                                                               |
|                       | indicators are        | For more information, see [Indicator                          |
|                       | extracted from all    | extraction](#UUID5428bf3967d9a59a695b824dd270a6ac).           |
|                       | issues in Cortex      |                                                               |
|                       | XSIAM.                |                                                               |
+-----------------------+-----------------------+---------------------------------------------------------------+
| Manual                | - Command line        | Data is inserted manually via the UI so no classification or  |
|                       |                       | mapping is needed.                                            |
|                       | - Mark: The user      |                                                               |
|                       |   marks a piece of    | If importing an STIX file, mapping is done via the STIX       |
|                       |   data as an          | parser code.                                                  |
|                       |   indicator.          |                                                               |
|                       |                       |                                                               |
|                       | - STIX file: Manually |                                                               |
|                       |   upload a STIX file  |                                                               |
|                       |   on the Threat Intel |                                                               |
|                       |   (Indicators) page.  |                                                               |
+-----------------------+-----------------------+---------------------------------------------------------------+

###### Classify and map an indicator type for an integration

The indicator classification and mapping feature enables you to take the
data that Cortex XSIAM ingests from integrations, and classify and map
the data to indicator types and indicator fields. By classifying the
data as different indicator types, you can process them with different
playbooks suited to their respective requirements.

> **Note**
>
> When creating a new indicator type, you classify and map the indicator
> fields in the indicator type settings. For more details, see [Map
> custom indicator fields](#UUIDc62ed734e8ddd01c8a8f91546a16d09a).

Classification determines the type of indicator that is created for data
ingested from a specific integration. You create a classifier and define
that classifier in an integration.

You can map the fields from your third-party integration to the fields
in your indicator layouts as follows:

- Map your fields to indicator types irrespective of the integration or
  classifier. This means that you can create a mapping before defining
  an instance and ingesting indicators. By doing so, when you do define
  an instance and apply a mapper, the data that comes in is already
  mapped.

- Create default mapping for all of the fields that are common to all
  indicator types. You can still overwrite the contents of a field in
  the specific indicator type.

###### Classify an indicator type

When an integration fetches indicators, it populates the raw JSON object
for the indicator. The raw JSON object contains all of the attributes
(fields) for an indicator. For example, source, when the event was
created, the priority that was designated by the integration, and more.
When classifying ingested indicator data, you want to select an
attribute (field) that can determine the indicator type.

Use this procedure to create a classifier or duplicate an existing
classifier for ingested indicator data.

1.  Select Settings \> Configurations \> Object Setup \> Indicators \>
    Classification & Mapping.

2.  Do one of the following:

    a.  To create a new classifier, select + New \> Indicator
        Classifier.

    b.  To edit an existing classifier, select it and click **Edit**.

    - If the classifier is installed from a content pack, you need to
      duplicate and then edit.

3.  Under **Get data**, select from where you want to import the
    indicator data. You will classify the indicator type based on this
    information.

- > **Note**

  > You can optionally skip importing data. Click the pencil on the
  > right of each indicator type on the right pane to enter the value
  > manually.

  - **Pull from instance:** Select an existing integration instance to
    import indicator data from.

  - **Upload JSON:** Upload a formatted JSON file that includes the
    fields you want to classify by.

4.  Under **Fetched data**, select from the attributes (fields) in the
    imported indicator object a field that will serve as the classifier
    (key) to route to a specific indicator type.

- Cortex XSIAM searches through the imported indicator objects for the
  values for the field you select.

5.  Drag the found values from the **Unmapped Values** column to the
    relevant indicator type on the right pane.

6.  **Save** the classifier.

7.  Apply the indicator classifier to the relevant feed integration.

    a.  Go to Settings \> Configurations \> Data Collection \>
        Automation & Feed Integrations.

    b.  Select an existing integration instance you want to apply the
        indicator classifier to or create a new integration instance.

    c.  In the integration instance settings under **Classifier**,
        select the classifier you created and click **Save**.

###### Map indicator fields

Mappers enable you to map the information from ingested indicator data
to the indicator fields that you have in your system.

Mapping data takes place in two stages:

1.  Map all of the fields that are common to all indicators in the
    default mapping.

2.  Map the additional fields that are specific for each indicator type,
    or overwrite the mapping that you used in the default mapping.

> **Note**
>
> In the **Classification & Mapping** page, the mapping does not
> indicate for which indicator types they are configured. When creating
> a mapper, it is best practice to add to the mapper name and the
> indicator type the mapper is for. For example, Mail Listener -
> Phishing.
>
> When mapping a list, we recommend you map to a multi-select field.
> Short text fields do not support lists. If you need to map a list to a
> short text field, add a transformer in the relevant playbook task to
> split the data back into a list.

Use this procedure to create a mapper or duplicate an existing mapper to
map all of the ingested indicator fields to an indicator layout.

1.  Select Settings \> Configurations \> Indicators \> Classification &
    Mapping.

2.  Do one of the following:

    a.  To create a new mapper, select + New \> Indicator Mapper
        (incoming).

    b.  To edit an existing mapper, select it and click **Edit**.

    - If the mapper is installed from a content pack, you need to
      duplicate and then edit.

3.  Under **Get data**, select from where you want to import the
    indicator data. You will map the indicator data based on this
    information.

    - **Pull from instance:** Select an existing integration instance to
      import indicator data from.

    - **Upload JSON:** Upload a formatted JSON file that includes the
      fields you want to map.

4.  Under **Indicator Type**, start by mapping out the
    **Common Mapping**. This mapping includes the fields that are common
    to all of the indicator types and saves you time having to define
    these fields individually in each indicator type.

5.  Click the attribute (field) to which you want to map. You can
    further manipulate the field using filters and transformers.

6.  Repeat this process for the other indicator types for which this
    mapping is relevant.

7.  **Save** the mapper.

8.  Apply the indicator mapper to the relevant feed integration.

    a.  Go to Settings \> Configurations \> Data Collection \>
        Automation & Feed Integrations.

    b.  Select an existing integration instance you want to apply the
        classifier to or create a new integration instance.

    c.  In the integration instance settings under **Mapper**, select
        the mapper you created and click **Save**.

##### Indicator extraction

Indicator extraction identifies indicators from different text sources
in the system (such as War Room entries and email content), extracts
them (usually based on regex), and creates indicators in Cortex XSIAM .
After extraction, the indicator can be enriched.

Indicator enrichment takes the extracted indicator and provides detailed
information about the indicator, based on enrichment feeds such as
VirusTotal and IPinfo.

> **Note**
>
> By default, system-wide automatic indicator extraction and enrichment
> is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex
> XSIAM 3.x, system-wide automatic indicator extraction and enrichment
> is enabled.
>
> If you have a Threat Intel Management (TIM) Add-on, you can enable or
> disable automatic indicator extraction system-wide. Go to Settings \>
> Configuration \> General \> Server Settings. In the **Indicators**
> section, enable
> **Enable automatic indicator extraction and enrichment from issues**.

To extract indicators from incoming feeds without enrichment or to
prevent enrichment for existing indicators, see [Exclude indicators from
enrichment](#UUID86ed9c54c28ff3edd9e691c4a102dd87).

In Cortex XSIAM, the indicator extraction feature extracts indicators
from War Room entries and enriches them using commands and scripts
defined for the indicator type.

You can extract indicators in the following scenarios:

- When fetching issues

- In a playbook task

- Using the command line

> **Note**
>
> Reputation commands, such as `!ip` and `!domain`, can only be used
> after you configure and enable a reputation integration instance, such
> as VirusTotal and Whois.

###### Indicator extraction modes

You set the indicator extraction mode:

- In a [playbook task](#UUIDafa33eb345c4c566f9517696f6d859e4).

- Running a [command](#UUID210ec33151f8b4e535fa4f3c2b1fcf30) during an
  investigation.

Indicator extraction supports the following modes:

- **None**: Indicators are not extracted automatically. Use this option
  when you do not want to further evaluate the indicators.

- **Inline**: Indicators are extracted within the context that indicator
  extraction runs (synchronously). The findings are added to the context
  data. For example, if indicator extraction mode for a task in a
  playbook is inline, the extraction and enrichment must complete before
  the next task begins. This option provides the most robust information
  available per indicator.

  - > **Note**

  <!-- -->

  - > The inline configuration may delay playbook execution.

    > **Note**

    > While indicator creation is asynchronous, indicator extraction and
    > enrichment are run synchronously. Data is placed into the issue
    > context and is available via the context for subsequent tasks.

    > All indicators are automatically extracted and enriched before a
    > playbook is run. For an on-field change, extraction occurs before
    > the next playbook tasks run.

- **Out of band**: Indicators are extracted in parallel (asynchronously)
  to other actions. The extracted data will be available within the
  issue, however, it is not available for immediate use in task inputs
  or outputs since the information is not available in real-time.

<!-- -->

- > **Note**

  > When using out of band, the extracted indicators do not appear in
  > the context. If you want the extracted indicators to appear select
  > inline.

<!-- -->

- If system-wide indicator extraction and enrichment is enabled,
  indicators are extracted according to the following system defaults:

  - Issue creation - inline

  - Tasks - none, can be overridden on a per task basis

  - CLI - out of band, but can be overridden on a per-command basis

###### Troubleshoot indicator extraction

If indicators are not extracted, check whether the indicator mode is set
to none, and verify the indicator is not in the Exclusion List, as is or
as part of a regular expression (regex).

###### Set the indicator extraction mode for a playbook task

By default, system-wide indicator extraction is disabled. You can set
the indicator extraction mode for specific playbook tasks.

1.  Select the playbook where you want to add indicator extraction to a
    task, and click **Edit**.

2.  In the playbook, click a task to open the **Edit Task** window.

3.  Click the **Advanced** tab.

4.  In the indicator extraction drop-down menu, select the mode you want
    to use.

5.  Click **OK**.

###### Disable indicator extraction for scripts or integrations

By default, system-wide indicator extraction and enrichment is disabled.

If you have enabled system-wide indicator extraction and enrichment, the
procedure below enables you to disable indicator extraction for a
specific script or integration.

- To disable indicator extraction for a script, add the
  `IgnoreAutoExtract` entry with the value of `true`, when returning an
  entry.

<!-- -->

- For example:

      entry = {
          'Type': entryTypes['note'],
          'Contents': {
          'Echo' : demisto.args()['echo']
              },
          'ContentsFormat': formats['json'],
          'ReadableContentsFormat': formats['markdown'],
          'HumanReadable': hr,
          'IgnoreAutoExtract' : True
         }

<!-- -->

- To disable indicator extraction for an integration, add the
  `'IgnoreAutoExtract'` entry with the value of `true`, when returning
  an entry.

<!-- -->

- For example in the ServiceNow integration:

      entry = {
              'Type': entryTypes['note'],
              'Contents': result,
              'ContentsFormat': formats['json'],
              'ReadableContentsFormat': formats['markdown'],
              'HumanReadable': tableToMarkdown('ServiceNow ticket', hr, headers=headers, removeNull=True),
              'EntryContext': {
                  'Ticket(val.ID===obj.ID)': context,
                  'ServiceNow.Ticket(val.ID===obj.ID)': context
              },
              'IgnoreAutoExtract': True
          }
          entries.append(entry)
          return entries

For more information about command results in Python, see [Python code
conventions for
CommandResults](https://xsoar.pan.dev/docs/integrations/code-conventions#commandresults).

##### Configure indicator expiration

Indicators can have the Expiration Status field set to **Active** or
**Expired**, which is determined by the **Expiration** field. When
indicators expire, they still exist in Cortex XSIAM, meaning they are
still displayed, and you can still search for them. A job that runs
daily checks for newly expired indicators and updates
the **Expiration Status** field.

When indicators expire, the expiration status and expiration fields are
updated. You can use it to take actions based on indicator expiration.
For more information, see [Indicator field trigger
scripts](#UUID75d82af7c994375f36bf89d799171459).

You can set the default expiration method for indicators either to never
expire or to expire after a specific period. The default expiration
method is set by the indicator type. For more information, see
[Indicator type profile](#UUIDadaa1c76c55c0be097e03f2126acf604).

The following table shows the hierarchy by which indicators are expired.

+-----------------------------------+---------------------------------------------------------------------------------------------+
| Method                            | Description                                                                                 |
+===================================+=============================================================================================+
| Manual                            | Manually expire the indicator either in the indicator layout or CLI. This method overrides  |
|                                   | all other methods.                                                                          |
|                                   |                                                                                             |
|                                   | > **Note**                                                                                  |
|                                   | >                                                                                           |
|                                   | > You need to run CLI commands in the Case or Issue War Room.                               |
|                                   |                                                                                             |
|                                   | Use the `expireIndicators` command to change the expiration status to **Expired** for one   |
|                                   | or more indicators. This command accepts a comma-separated list of indicator values and     |
|                                   | supports multiple indicator types. For example, you can set the expiration status for an IP |
|                                   | address, domain, and file                                                                   |
|                                   | hash:`!expireIndicators value=1.1.1.1,safeurl.com,45356A9DB614ED7161A3B9192E2F318D0AB5AD10` |
|                                   |                                                                                             |
|                                   | Use the `!setIndicators` command to reset the indicators\' expiration value. The            |
|                                   | parameter\'s value can either be `never` or a time in ISO 8601 format. For example,         |
|                                   | `2006-01-02T15:04:05Z` (for UTC time) or `2006-01-02T15:04:05Z07:00` (UTC +7 hours).        |
|                                   |                                                                                             |
|                                   | **Examples:**                                                                               |
|                                   |                                                                                             |
|                                   | - `!setIndicators indicatorsValues=watson.com expiration=Never`                             |
|                                   |                                                                                             |
|                                   | - `!setIndicators indicatorsValues=watson.com expiration=2006-01-02T15:04:05Z`              |
|                                   |                                                                                             |
|                                   | You can also use these commands in a script, but the user can override this if running a    |
|                                   | command in the CLI or the indicator layout.                                                 |
+-----------------------------------+---------------------------------------------------------------------------------------------+
| Feed integration                  | Some integrations support setting the expiration method on an integration instance level,   |
|                                   | which overrides the method defined for the indicator type.                                  |
|                                   |                                                                                             |
|                                   | > **Note**                                                                                  |
|                                   | >                                                                                           |
|                                   | > If a feed\'s expiration method is set to **When removed from the feed**, indicators that  |
|                                   | > are removed from the feed immediately expire. Note that if the feed is disabled, its      |
|                                   | > expiration method reverts to that of the indicator type (time-based).                     |
|                                   | >                                                                                           |
|                                   | > Time-based expiration is set according to feed reliability. If the same indicator appears |
|                                   | > on multiple feeds, the feed with the highest reliability determines the indicator\'s      |
|                                   | > expiration time. If multiple feeds have the same reliability, the last feed to add or     |
|                                   | > modify the indicator determines its expiration time.                                      |
|                                   | >                                                                                           |
|                                   | > Example:                                                                                  |
|                                   |                                                                                             |
|                                   | - > An indicator was initially fetched by Feed A, then by Feed B.                           |
|                                   |                                                                                             |
|                                   | - > Both feeds have the same reliability.                                                   |
|                                   |                                                                                             |
|                                   | - > Feed B\'s indicators are set to expire **When removed from the feed**.                  |
|                                   |                                                                                             |
|                                   | - > Feed B is now disabled.                                                                 |
|                                   |                                                                                             |
|                                   | > After Feed B is disabled, the indicator\'s expiration method reverts to that of the       |
|                                   | > indicator type (for example, expire after 7 days). However, if Feed A then modifies the   |
|                                   | > indicator (or removes and re-adds it), the expiration method changes back to Feed A\'s    |
|                                   | > settings.                                                                                 |
+-----------------------------------+---------------------------------------------------------------------------------------------+
| Indicator type                    | The expiration method (interval or never) is defined according to indicator type, which     |
|                                   | applies to all indicators of this type. This is the default expiration method for an        |
|                                   | indicator.                                                                                  |
+-----------------------------------+---------------------------------------------------------------------------------------------+

##### Configure Threat Intelligence feed integrations

You can download and install content packs, including threat
intelligence integrations such as:

- MITRE ATT&CK

- Unit 42 ATOMs

- Unit 42 Intel Objects Feed

- AlienVault

- AWS

**How to configure threat intelligence feed integrations**

1.  Go to Marketplace and install the relevant threat intelligence
    content pack.

2.  Configure the threat intelligence integration by going to Settings
    \> Configurations \> Integrations \> Threat Intelligence, search for
    your integration, and click **Add Instance**.

- The following table is a non-exhaustive list of the most common feed
  integration parameters. Each feed integration may have parameters
  unique to that integration. Read the documentation for specific feed
  integrations for more details.

+-----------------------------------+--------------------------------------------------+
| Parameter                         | Description                                      |
+===================================+==================================================+
| Fetches indicators                | Select this option for the integration instance  |
|                                   | to fetch indicators.                             |
|                                   |                                                  |
|                                   | Some integrations can fetch indicators or        |
|                                   | issues. Select the relevant option for what you  |
|                                   | need to fetch in the instance.                   |
+-----------------------------------+--------------------------------------------------+
| URL                               | The URL of the feed.                             |
+-----------------------------------+--------------------------------------------------+
| Feed Fetch Interval               | When the integration instance should fetch       |
|                                   | indicators from the feed.                        |
+-----------------------------------+--------------------------------------------------+
| Indicator verdict                 | The indicator verdict that will apply to all     |
|                                   | indicators fetched from this integration         |
|                                   | instance. See [Indicator                         |
|                                   | verdict](#UUIDe81d97c2bf36b36f5f32aa99cbf6bfc5). |
+-----------------------------------+--------------------------------------------------+
| Source reliability                | The reliability of the source that provides the  |
|                                   | threat intelligence data.                        |
+-----------------------------------+--------------------------------------------------+
| Indicator Expiration Method       | The method by which to expire indicators from    |
|                                   | this integration instance. The default           |
|                                   | expiration method is the interval configured for |
|                                   | the indicator type to which this indicator       |
|                                   | belongs.                                         |
|                                   |                                                  |
|                                   | - Indicator Type: The expiration method defined  |
|                                   |   for the indicator type to which this indicator |
|                                   |   belongs (interval or never).                   |
|                                   |                                                  |
|                                   | - Time Interval: Expires indicators from this    |
|                                   |   instance after the specified time interval, in |
|                                   |   days or hours.                                 |
|                                   |                                                  |
|                                   | - Never Expire: Indicators from this instance    |
|                                   |   never expire.                                  |
|                                   |                                                  |
|                                   | - When removed from the feed: When the           |
|                                   |   indicators are removed from the feed they are  |
|                                   |   expired in the system.                         |
|                                   |                                                  |
|                                   | <!-- -->                                         |
|                                   |                                                  |
|                                   | - > **Note**                                     |
|                                   |                                                  |
|                                   |   > Some feeds only provide information about    |
|                                   |   > new indicators and do not specify when       |
|                                   |   > indicators are removed. Indicators from      |
|                                   |   > these feeds cannot be automatically expired  |
|                                   |   > on removal.                                  |
|                                   |                                                  |
|                                   |   > If a feed\'s expiration method is set to     |
|                                   |   > **When removed from the feed**, indicators   |
|                                   |   > that are removed from the feed immediately   |
|                                   |   > expire. Note that if the feed is disabled,   |
|                                   |   > its expiration method reverts to that of the |
|                                   |   > indicator type (time-based).                 |
|                                   |                                                  |
|                                   |   > Time-based expiration is set according to    |
|                                   |   > feed reliability. If the same indicator      |
|                                   |   > appears on multiple feeds, the feed with the |
|                                   |   > highest reliability determines the           |
|                                   |   > indicator\'s expiration time. If multiple    |
|                                   |   > feeds have the same reliability, the last    |
|                                   |   > feed to add or modify the indicator          |
|                                   |   > determines its expiration time.              |
|                                   |                                                  |
|                                   |   > Example:                                     |
|                                   |                                                  |
|                                   |   - > An indicator was initially fetched by Feed |
|                                   |     > A, then by Feed B.                         |
|                                   |                                                  |
|                                   |   - > Both feeds have the same reliability.      |
|                                   |                                                  |
|                                   |   - > Feed B\'s indicators are set to expire     |
|                                   |     > **When removed from the feed**.            |
|                                   |                                                  |
|                                   |   - > Feed B is now disabled.                    |
|                                   |                                                  |
|                                   |   > After Feed B is disabled, the indicator\'s   |
|                                   |   > expiration method reverts to that of the     |
|                                   |   > indicator type (for example, expire after 7  |
|                                   |   > days). However, if Feed A then modifies the  |
|                                   |   > indicator (or removes and re-adds it), the   |
|                                   |   > expiration method changes back to Feed A\'s  |
|                                   |   > settings.                                    |
+-----------------------------------+--------------------------------------------------+
| Bypass exclusion list             | When selected, the exclusion list is ignored for |
|                                   | indicators from this feed. This means that if an |
|                                   | indicator from this feed is on the exclusion     |
|                                   | list, the indicator might still be added to the  |
|                                   | system.                                          |
+-----------------------------------+--------------------------------------------------+
| Trust any certificate (not        | When selected, certificates are not checked.     |
| secure)                           |                                                  |
+-----------------------------------+--------------------------------------------------+
| Use system proxy settings         | Runs the integration instance using the proxy    |
|                                   | server (HTTP or HTTPS) when an engine is         |
|                                   | selected.                                        |
+-----------------------------------+--------------------------------------------------+
| Do not use in CLI by default      | Excludes this integration instance when running  |
|                                   | a generic command that uses all available        |
|                                   | integrations.                                    |
+-----------------------------------+--------------------------------------------------+

##### Exclude indicators from enrichment

You can disable enrichment for individual indicators or disable
enrichment for all indicators fetched by any of the following feeds:

- Azure Feed

- Office 365 Feed

- Cisco WebEx Feed

- Cloudflare Feed

- Fastly Feed

- AWS Feed

- Zoom Feed

- Public DNS Feed

- Google IP Ranges Feed

If you disable enrichment for an incoming feed, the indicators are
extracted and saved but not enriched by Cortex XSIAM, enabling you to
conserve system resources when dealing with known indicators.

When an indicator has enrichment excluded, the **Enrich Indicator**
button is disabled. If you try to enrich an indicator that is enrichment
excluded, an error will occur.

Indicators of the following indicator types can have enrichment
excluded:

- IP

- Domain

- Email

- URL

- File

**Exclude enrichment for a feed integration**

To exclude enrichment for indicators fetched from a feed integration,
when configuring an instance of the feed integration, select the
**Enrichment Excluded** checkbox.

**Exclude enrichment for individual indicators**

When creating or editing an indicator of one of the following types: IP,
Domain, Email, URL, or File, you have the option to set
**Enrichment Excluded** to **Yes** or **No**. The default is **No**.

**View list of enrichment excluded indicators**

To view the enrichment excluded indicators in the **Indicators** table,
add the **Enrichment Excluded** column to the table.

##### Generate issues from indicators using indicator rules for prevention and detection

Indicator rules allow you to utilize indicators in the system for
detection and prevention. These rules allow you to select indicators or
indicator traits to be detected by the tenant and prevented by the
endpoint. Indicator rules marked for detection and prevention generate
issues that you can then track and investigate.

> **Note**
>
> Indicators should be present in the Threat Intelligence database
> (Threat Management \> Threat Intelligence \> Indicators) before
> creating detection and prevention rules.

Indicator rules can be used for the following:

- Real-time prevention on the agent

<!-- -->

- Create an indicator rule for a Restrictions profile on the Agent using
  filters applied on file (SHA256 and MD5) indicators. A
  Restrictions profile limits the locations from which executables can
  run on an endpoint. When the Cortex XDR agent detects behavior that
  matches a rule defined in your profile, the Cortex XDR agent applies
  the security profile that is attached to the rule for further
  inspection. An issue is then generated in Cortex XSIAM (source is XDR
  Agent). For more information about the Restrictions profile, see [Set
  up restrictions prevention
  profiles](#UUID782ed1ba266abada97ca57d2dbd475e3).

<!-- -->

- Cortex XSIAM tenant (server-side) detection

<!-- -->

- Create rules based on filters that are applied to a file (SHA256, MD5)
  an IP address, and a domain. If an indicator rule applies, an issue is
  generated in Cortex XSIAM (source is Threat Intelligence).

  > **Note**

  > Although you can create IOC rules for detection, indicator rules are
  > designed to leverage threat intelligence indicators like MD5 and
  > SHA256 hashes that are present in your TIM library. These rules
  > directly integrate with and rely on the indicators ingested and
  > managed by TIM. Indicators must be in the TIM database before
  > creating these rules.

  > For more information about IOC rules, see [What\'s an
  > IOC?](#UUIDd9474b6a71b95bd42d2176cc417c4a0e)

###### Create a Prevention Rule

Prevention Rules are created based on the file (SHA256 and MD5)
indicator type.

1.  Create a Restrictions Profile.

    1.  Select Inventory \> Endpoints \> Policy Management \> Prevention
        \> Profiles \> Add Profile \> Create New.

    2.  Select one of the following Platforms.

        - Windows

        - MacOS

        - Linx

    3.  Select **Restrictions**.

    4.  From the **Custom Indicator Prevention Rules** section, in the
        **Action Mode** field, select **Enabled**.

    - You will see that there are no custom prevention rules defined.
      After you create an indicator rule, you will need to edit this
      profile and select the indicator rule.

    5.  Add the parameters as required. For more information, see [Set
        up restrictions prevention
        profiles](#UUID782ed1ba266abada97ca57d2dbd475e3).

    6.  Create the Profile.

2.  Create the Indicator Rule.

    1.  Select Threat Management \> Detection Rules \> Indicator Rules
        \> Add Rule \> Prevention Rule.

    2.  From the **Create New Prevention Rule** wizard, in the
        **General** section, add the following parameters:

+-----------------------------------+---------------------------------------+
| Parameter                         | Description                           |
+===================================+=======================================+
| Rule Name                         | Add a meaningful name.                |
+-----------------------------------+---------------------------------------+
| Select Profiles for Prevention    | Select the Retentions profile you     |
| (To block files)                  | created in step 1.                    |
|                                   |                                       |
|                                   | For the profile to appear, when       |
|                                   | defining the Retentions profile, the  |
|                                   | **Custom Indicator Prevention Rules** |
|                                   | section must be set to **Enabled**.   |
+-----------------------------------+---------------------------------------+
| Severity                          | Defines the severity of the issue.    |
+-----------------------------------+---------------------------------------+
| Description                       | Add a meaningful description.         |
+-----------------------------------+---------------------------------------+

3.  Click Next.

4.  In the Target section, use the filters and/or select the file
    indicators to which to apply the rule.

- > **Note**

  > You can\'t change the **Preventable = True**, **Status = Active**
  > and **Type = File** filters, which comply with the requirements of
  > the supported indicator type for Prevention on the Agent.

  ---------------------------------------------------------------------------------------
  Filter                              Description
  ----------------------------------- ---------------------------------------------------
  Value                               The hash value of the field (SHA256 or MD5).

  Verdict                             The reputation of the
                                      indicator: Malicious, Suspicious, Benign, Unknown

  Has Related Issues                  Whether the indicator has related issues.

  Campaign                            Whether the indicator is part of an existing
                                      campaign.

  Mitre ID                            Mitre ID associated with the related issues.

  Mitre Tactic                        Mitra Tactic associated with the related issues.

  Tags                                The tags applied to indicators.

  Confidence                          The level of confidence.

  Aggregated Reliability              The reliability score such as A - Completely
                                      reliable.

  Feed                                The source (script, manual, etc.) that last set the
                                      indicator\'s expiration status.
  ---------------------------------------------------------------------------------------

5.  Click Next and then save the rule.

<!-- -->

3.  Add the indicator rule to the Restrictions Profile.

    1.  Go to Inventory \> Endpoints \> Policy Management \> Prevention
        \> Profiles.

    2.  Edit the Restrictions Profile you created in step 1.

    3.  In the **Custom Indicator Prevention Rules** tab, select the
        indicator rule you created in step 2.

    4.  Save the Profile.

Create a prevention rule blocking indicators from a feed

In this example, create an Indicator Prevention rule, which blocks file
indicators using the Unit 42 Intel Feed and then generates an issue.

Before you begin create a Restrictions Profile called `JC-Win-R-O1`,
with the **Custom Indicator Prevention Rules **section set to
**Enabled**.

1.  Create a Prevention Indicator Rule and in the **General** section,
    add the following parameters.

  -----------------------------------------------------------------------
  Field                               Value
  ----------------------------------- -----------------------------------
  Rule Name                           JC-IR-Prevent-02

  Select Profiles For Prevention (To  JC-WIN-R-01
  Block Their Files)                  

  Severity                            Medium

  Description                         To raise prevention on IOCs from
                                      Unit 42 Intel Feed
  -----------------------------------------------------------------------

2.  In the **Target** Section, select the `Feed=Unit 42 Intel` filter.

- ![](media/rId3160.png){width="5.833333333333333in"
  height="1.3635411198600176in"}

3.  In the Restrictions Profile, add the indicator rule.

When a File indicator from Unilt 42 Intel is found, the XDR Agent blocks
the indicator.

![](media/rId3163.png){width="5.833333333333333in"
height="4.433626421697288in"}

An issue is generated in Cortex XSIAM. The Issue Source
is** XDR Agent**, severity is **medium** and the Action is
**Prevented (Blocked)**.

![](media/rId3166.png){width="5.833333333333333in" height="0.30625in"}

> **Note**
>
> The Indicator Rule shows the number of issues generated by the rule,
> You can view the issues that were generated using the Indicator rule,
> by right-clicking the rule and select **View related issues**.

###### Create a Detection rule

After you create a detection rule, Cortex XSIAM searches indicators in
your tenant and raises an issue if a match is detected. Detection rules
apply for File, Domain, and IP Address indicator types.

1.  Select Threat Management \> Detection Rules \> Indicator Rules \>
    Add Rule \> Detection Rule.

2.  From the **Create New Detection Rule** wizard, in the **General**
    section, add the following parameters:

  -----------------------------------------------------------------------
  Parameter                           Description
  ----------------------------------- -----------------------------------
  Rule Name                           Add a meaningful name.

  Severity                            Defines the severity of the issue.

  Description                         Add a meaningful description.
  -----------------------------------------------------------------------

3.  Click Next.

4.  In the Target section, use the filters and/or select the file
    indicators to which to apply the rule.

- > **Note**

  > You can\'t change the **Detectable = True** and **Status = Active**
  > filters, which comply with the requirements of the supported
  > indicator type for detection.

  ---------------------------------------------------------------------------------------
  Filter                              Description
  ----------------------------------- ---------------------------------------------------
  Value                               The hash value of the field (SHA256 or MD5), IP
                                      address, or domain.

  Verdict                             The reputation of the
                                      indicator: Malicious, Suspicious, Benign, Unknown

  Has Related Issues                  Whether the indicator has related issues.

  Campaign                            Whether the indicator is part of an existing
                                      campaign.

  Mitre ID                            Mitre ID associated with the related issues.

  Mitre Tactic                        Mitra Tactic associated with the related issues.

  Tags                                The tags applied to indicators.

  Confidence                          The level of confidence.

  Aggregated Reliability              The reliability score such as A - Completely
                                      reliable.

  Feed                                The source (script, manual, etc.) that last set the
                                      indicator\'s expiration status.

  Type                                The indicator type (Domain, File, IP)
  ---------------------------------------------------------------------------------------

5.  Click Next and then save the rule.

6.  If the indicator rule has generated issues, right-click the rule and
    select **View related issues**.

Create a detection rule from feeds

In this example, create a detection rule from many feeds, such as Unit
42 Intel, AzureRiskyUsers, and Mail-Sender that returns a malicious
verdict.

1.  In the **General** section, add the following parameters.

  -----------------------------------------------------------------------
  Field                               Value
  ----------------------------------- -----------------------------------
  Rule Name                           JC-IR-Prevent-01

  Severity                            Medium

  Description                         To raise detection on all
                                      indicators uploaded from feeds with
                                      a malicious verdict.
  -----------------------------------------------------------------------

2.  In the **Target** Section, select **Feed** (**Select All**) and
    **Verdict = Malicious**.

- ![](media/rId3171.png){width="5.833333333333333in"
  height="2.005207786526684in"}

When a malicious verdict is found from the feed, an issue is generated.
The Issue Source is **Threat Intelligence**, severity is **medium** and
the Action is **Detected**.

![](media/rId3174.png){width="5.833333333333333in"
height="0.7364577865266841in"}

> **Note**
>
> The Issue source is Threat Intelligence.

###### Manage Indicator Rules

The **Indicator Rules** page displays the following fields for each
rule:

  -----------------------------------------------------------------------
  Field                               Description
  ----------------------------------- -----------------------------------
  **Rule ID**                         Unique identifier for the rule.

  **Creation Date**                   Timestamp of when the rule was
                                      created.

  **Modification Date**               Timestamp when the rule was edited.

  **Name**                            Name of the rule.

  **Type**                            Whether the rule is a
                                      **Prevention** or **Detection**
                                      type rule.

  **Target**                          Hash, IP address, File, or domain
                                      value associated with the rule.

  **Severity**                        Level of severity associated with
                                      the rule.

  **# of issues**                     Number of issues generated by the
                                      rule.

  **Created by**                      The email address of the user who
                                      created the rule.

  **Description**                     An optional description associated
                                      with the rule.

  **Status**                          Whether the rule is **Enabled** or
                                      **Disabled**.

  **Used in profiles**                Cortex XDR agent Restriction
                                      Profile associated with the rule.
  -----------------------------------------------------------------------

> **Note**
>
> If an indicator matches multiple indicator rules, the highest severity
> rule is used. If all have the same severity, the rules are used by the
> first created.

In the **Indicator Rules** table, right-click a rule to perform actions,
including the following:

  -----------------------------------------------------------------------
  Action                              Description
  ----------------------------------- -----------------------------------
  **View related issues**             View issues generated by the rule.

  **Disable/Enable**                  Depending on the current status,
                                      **Disable** or **Enable** the rule.

  **Edit Rule**                       Modify the rule.

  **Save as new**                     Create a new rule using the current
                                      rule configurations.

  **Delete**                          Delete the rule.
  -----------------------------------------------------------------------

##### Export indicators

In the Indicators table, you can export indicators in a CSV or STIX
file. You can also export indicators using an integration or a playbook.

###### Export indicators using the Generic Export Indicators Integration

You can export indicators in a hosted text file (External Dynamic list)
from Cortex XSIAM or an engine using the Generic Export Indicators
Service integration. Exported indicators can be used for example in
firewall block lists, allow lists, and monitoring and analysis in
Splunk. See [Generic Export Indicators
Service](https://xsoar.pan.dev/docs/reference/integrations/edl).

The Generic Export Indicators Service integration can be configured to
export specific fields in different output formats. Multiple instances
of the integration can be configured for different indicator queries,
and the output can be customized to work with a variety of third-party
services.

You can set up the Generic Export Indicators Service integration by
setting up a long-running integration. See [Forward Requests to
Long-Running Integrations](#UUID13e658997aaf3b02af24cb31b0f22418).

If you configure the Generic Export Indicator to run on-demand, use the
`!export-indicators-list-update` command for the first time to
initialize the export process.

###### Export indicators using playbooks

Cortex XSIAM provides out-of-the-box playbooks for TIM, including
playbooks that enable you to export indicators. All TIM-related
playbooks have the \'TIM\' prefix. Some are generic and some are
dedicated to a specific vendor, like QRadar (for example, [TIM - QRadar
Add Domain
Indicators](https://xsoar.pan.dev/docs/reference/playbooks/tim---q-radar-add-domain-indicators))
and ArcSight (for example, [TIM- Arcsight Add IP
Indicators](https://xsoar.pan.dev/docs/reference/playbooks/tim---arc-sight-add-ip-indicators)).

If you define a playbook task input that pulls from indicators, the
entire playbook runs in Quiet Mode. This means the task or playbook
information is not written to the War Room, and inputs and outputs are
not displayed in the playbook. However, errors and warnings are still
written to the War Room.

> **Caution**
>
> You should not run a query on a field that you might change in the
> playbook flow. For example, you shouldn't have a playbook with query
> `Verdict:Malicious` and then change the indicator verdict as a part of
> the playbook.

#### Indicator management

Indicators are artifacts associated with security issues and are an
essential part of the case management and remediation process. They help
correlate issues, create hunting operations, and enable you to easily
analyze cases and reduce Mean Time to Response (MTTR).

Cortex XSIAM threat intelligence includes access to the Unit 42 Intel
service, enabling you to identify threats in your network and discover
and contextualize trends. Unit 42 Intel provides data from WildFire
(Palo Alto Networks' cloud-based malware sandbox), the PAN-DB URL
Filtering database, Palo Alto Networks' Unit 42 threat intelligence
team, and third-party feeds (including both closed and open-source
intelligence). Unit 42 Intel data is continually updated to include the
most recent threat samples analyzed by Palo Alto Networks, enabling you
to keep up with threat trends and take a proactive approach to securing
your network.

Under the **Threat Management** side menu, **Threat Intelligence**
contains the following sub menu items:

- Indicators

- Sample Analysis

- Sessions and Submissions

##### Indicators

Displays a list of indicators added to Cortex XSIAM, where you can
perform several indicator actions, including Unit 42 data. For
understanding search queries, see [Query indicators with Unit 42 Intel
data](#UUID7708e4d66afee691dda2d15ceba75fab).

You can perform the following actions on the **XSIAM Indicators** page.

+-----------------------------------+-----------------------------------+
| Action                            | Description                       |
+===================================+===================================+
| Investigate an indicator          | Click on an indicator to view and |
|                                   | take action on the indicator.     |
+-----------------------------------+-----------------------------------+
| Create an indicator               | Indicators are added to the       |
|                                   | indicators table from feed        |
|                                   | integrations, adding Unit 42      |
|                                   | data, or you can manually create  |
|                                   | a new indicator in the system.    |
|                                   |                                   |
|                                   | When creating an indicator, in    |
|                                   | the **Verdict** field, you can    |
|                                   | either select a Verdict or leave  |
|                                   | it blank to calculate it later by |
|                                   | clicking **Save & Enrich**, which |
|                                   | updates the indicator from        |
|                                   | enrichment sources. After you     |
|                                   | select an indicator type, you can |
|                                   | add any custom field data.        |
+-----------------------------------+-----------------------------------+
| Edit                              | Edit a single indicator or select |
|                                   | multiple indicators to perform a  |
|                                   | bulk edit.                        |
+-----------------------------------+-----------------------------------+
| Delete and Exclude                | Delete and exclude one or more    |
|                                   | indicators from all indicator     |
|                                   | types or a subset of indicator    |
|                                   | types.                            |
|                                   |                                   |
|                                   | If you select the                 |
|                                   | **Do not add to exclusion list**  |
|                                   | checkbox, the selected indicators |
|                                   | are only deleted.                 |
+-----------------------------------+-----------------------------------+
| Export CSV                        | Export the selected indicators to |
|                                   | a CSV file.                       |
+-----------------------------------+-----------------------------------+
| Export STIX                       | Export the selected indicators to |
|                                   | a STIX file.                      |
+-----------------------------------+-----------------------------------+
| Upload a STIX file                | To upload a STIX file, click the  |
|                                   | upload button (top right of the   |
|                                   | page) and add the indicators from |
|                                   | the file to the system.           |
+-----------------------------------+-----------------------------------+

##### Sample analysis

Unit 42 Intel also provides sample analysis for files that help you
conduct in-depth investigations, find links between attacks, and analyze
threat patterns. If the file indicator is in the Unit 42 Intel service,
you have access to a full report on activities, properties, and
behaviors associated with the file. In addition, you can see how many
other malicious, suspicious, or unknown file samples included the same
activities, properties, and behaviors, and also build queries to find
related samples. For more information, see [Investigate files using
sample analysis](#UUID9200dc910273dbed82e60f747aad2c4c).

##### Sessions and Submissions

Unit 42 Intel provides in-depth information on device communication.

Cortex XSIAM users can use their Sessions and submissions data for
investigation and analysis. You can see which XDR agent reported the
file and which computers are affected.

For example, if you have a file indicator that has been determined as
malicious, in the **Sessions & Submissions** tab, you can see where this
file came from and where it is in your network by viewing the firewall
sessions this file passed through. You can see which XDR agents in your
system reported the file, which tells you which machines might be
infected. You can block the external IP address with your firewall, and,
if needed, isolate the affected machines to contain the attack. If the
source is internal, you can investigate that endpoint.

##### Indicator Rules

The **Indicator Rules** page is located under the Threat Management \>
Detection Rules menu and displays the following fields for each rule.
For more information, see [Generate issues from indicators using
indicator rules for prevention and
detection](#UUID24f89287b06a73f19a2775e2739df832).

  -----------------------------------------------------------------------
  Field                               Description
  ----------------------------------- -----------------------------------
  **Rule ID**                         Unique identifier for the rule.

  **Creation Date**                   Timestamp of when the rule was
                                      created.

  **Modification Date**               Timestamp when the rule was edited.

  **Name**                            Name of the rule.

  **Type**                            Whether the rule is a
                                      **Prevention** or **Detection**
                                      type rule.

  **Target**                          Hash, IP address, File, or domain
                                      value associated with the rule.

  **Severity**                        Level of severity associated with
                                      the rule.

  **# of issues**                     Number of issues generated by the
                                      rule.

  **Created by**                      The email address of the user who
                                      created the rule.

  **Description**                     An optional description associated
                                      with the rule.

  **Status**                          Whether the rule is **Enabled** or
                                      **Disabled**.

  **Used in profiles**                Cortex XDR agent Restriction
                                      Profile associated with the rule.
  -----------------------------------------------------------------------

> **Note**
>
> If an indicator matches multiple indicator rules, the highest severity
> rule is used. If all have the same severity, the rules are used by the
> first created.

In the **Indicator Rules** table, right-click a rule to perform actions,
including the following:

  -----------------------------------------------------------------------
  Action                              Description
  ----------------------------------- -----------------------------------
  **View related issues**             View issues generated by the rule.

  **Disable/Enable**                  Depending on the current status,
                                      **Disable** or **Enable** the rule.

  **Edit Rule**                       Modify the rule.

  **Save as new**                     Create a new rule using the current
                                      rule configurations.

  **Delete**                          Delete the rule.
  -----------------------------------------------------------------------

#### Query indicators with Unit 42 Intel data

You can access threat intel data through the following methods:

- On the **XSIAM Indicators** page, select an indicator to start
  investigating. If the indicator also exists in Unit 42 Intel, the
  **Unit 42 Intel** tab is available.

- When investigating an issue, select an extracted indicator. The
  **Quick View** shows basic information about the indicator in Cortex
  XSIAM and Unit 42 (if available). **Full view** shows the full Cortex
  XSIAM indicator summary.

- On the **XSIAM Indicators** page, query an indicator, which may or may
  not be in the Cortex XSIAM intel library.

<!-- -->

- Unit 42 Intel data is cloud-based and remotely maintained so that you
  can view data from Unit 42 Intel and add only the information you need
  to your Cortex XSIAM threat intel library. When you search for an IP
  address, domain, URL, or file, you can view the indicator in Cortex
  XSIAM and the additional information provided by Unit 42 Intel. When
  an indicator does not yet exist in Cortex XSIAM, but does exist in
  Unit 42 Intel, you can add the indicator to the Cortex XSIAM threat
  intel library. You can add the indicator and enrich it with your
  existing integrations, or add the indicator without enrichment. When
  the indicator already exists in Cortex XSIAM, but additional
  information is available from Unit 42 Intel, you can update your
  indicator with the most recent data from Unit 42 Intel.

  The Threat Intel library is a centralized space for all indicators,
  whether they are found in an issue, brought in as a feed, or added
  manually. You can view in-depth information on collected indicators
  and filter the library based on common attributes.

  > **Note**

  > You can search or look up indicators. A search, which can include
  > wildcards and complex queries, can return multiple results. Searches
  > are only performed in Cortex XSIAM. Lookups are exact values, are
  > performed in both Cortex XSIAM and Unit 42 Intel data, and can only
  > return one result.

##### Indicator query considerations

When querying directly on the **XSIAM Indicators** page, the following
considerations apply:

- Querying an IP address, domain, URL, or SHA256 file hash, without a
  wildcard or complex search (Boolean search, `type:file`, etc.),
  queries both the Cortex XSIAM threat intel library and Unit 42 Intel,
  with no date range limit.

- If you enter an indicator type that is not an IP address, domain, URL,
  or SHA256 file hash, or you enter a wildcard or complex option
  (Boolean search, type:file, etc.), no lookup is performed in Unit 42.
  In Cortex XSIAM, a search is performed. By default, the search is for
  the last 7 days, but you can adjust the date range.

- Wildcard searches can only be performed in the local Cortex XSIAM
  threat intel library, and not in Unit 42 Intel data. Example:
  \*xample.com

- Complex searches are only conducted in the local Cortex XSIAM threat
  intel library, and not in Unit 42 Intel data. Example: `type:URL` and
  `verdict:Malicious`.

- For files, only the SHA256 hash returns Unit 42 Intel data.

- For a query to include Unit 42 Intel results, it must be a lookup for
  an exact match.

You can search for indicators using any of the available search fields.
This is a partial list of the available search fields.

+-----------------------------------+-----------------------------------+
| Field                             | Description                       |
+===================================+===================================+
| `type`                            | The type of the indicator, such   |
|                                   | as File or Email.                 |
+-----------------------------------+-----------------------------------+
| `verdict`                         | The reputation of the indicator:  |
|                                   |                                   |
|                                   | - Malicious                       |
|                                   |                                   |
|                                   | - Suspicious                      |
|                                   |                                   |
|                                   | - Benign                          |
|                                   |                                   |
|                                   | - Unknown                         |
+-----------------------------------+-----------------------------------+
| `aggregatedReliability`           | Searches for indicators based on  |
|                                   | a reliability score such as       |
|                                   | `A - Completely reliable`.        |
+-----------------------------------+-----------------------------------+
| `sourceBrands`                    | Indicator feed or enrichment      |
|                                   | integrations.                     |
+-----------------------------------+-----------------------------------+
| `sourceInstances`                 | A specific instance of an         |
|                                   | indicator feed or enrichment      |
|                                   | integration.                      |
+-----------------------------------+-----------------------------------+
| `expirationSource`                | The source (such as script or     |
|                                   | manual.) that last sets the       |
|                                   | indicator\'s expiration status.   |
+-----------------------------------+-----------------------------------+
| `tags`                            | Tags applied to indicators.       |
+-----------------------------------+-----------------------------------+
| `comments`                        | Search for keywords within        |
|                                   | indicators' comments.             |
+-----------------------------------+-----------------------------------+

You can use a wildcard query, which finds indicators containing terms
that match the specified wildcard. For example, the `*` pattern matches
any sequence of 0 or more characters, and `?` matches any single
character. For a regex query, use the following value:

`"/.*\\?.*/"`

##### Indicator queries and Unit 42

Unit 42 Intel data is not automatically added to the Cortex XSIAM Threat
Intel library. When you query for an indicator on
the **XSIAM Indicators** page, in some cases the indicator is not in the
Threat Intel library, but exists in Unit 42 Intel. In other cases, the
indicator may already be in the Cortex XSIAM Threat Intel library, but
more in-depth information is available from Unit 42 Intel.

When a query is performed in both Cortex XSIAM and Unit 42 Intel, there
are four possible results:

The indicator exists in Cortex XSIAM but does not exist in Unit 42 Intel

The Cortex XSIAM search result is displayed in a table. Click on the
value to reach the **Summary** tab. The **Summary** tab presents
information about the indicator stored in Cortex XSIAM. The
**Unit 42 Intel** tab is disabled.

The indicator exists in Unit 42 Intel, but does not exist in the Cortex
XSIAM threat intel library

To view the Unit 42 Intel data for this indicator, click on the
indicator search term in blue.

![](media/rId3195.png){width="5.833333333333333in"
height="1.2681157042869642in"}

From the **Unit 42 Intel** tab, you have the option to add the indicator
to Cortex XSIAM or to add and enrich the indicator to Cortex XSIAM.

- **Add to XSIAM**

<!-- -->

- The indicator is added to Cortex XSIAM. If the indicator is related to
  one or more Unit 42 threat intel objects already in Cortex
  XSIAM (ingested through the Unit 42 Feed integration), relationships
  are created in the database between the Unit 42 threat intel objects
  and the file indicator. No third-party enrichments are run on the
  indicator. We recommend using this option if, for security reasons,
  you do not want to expose the indicator to any third-party services.

<!-- -->

- **Add to XSIAM & Enrich**

<!-- -->

- The indicator is added to Cortex XSIAM. If the indicator is related to
  one or more Unit 42 threat intel objects already in Cortex
  XSIAM (ingested through the Unit 42 Feed integration), relationships
  are created in the database between the Unit 42 threat intel objects
  and the file indicator. Your configured third-party enrichments are
  run on the indicator.

When you add indicators to the Cortex XSIAM threat intel library from
Unit 42 Intel, the indicators are available for use in scripts and
playbooks.

The indicator exists in Cortex XSIAM and in Unit 42 Intel

The Cortex XSIAM result is displayed in a table. Click on the value to
reach the Summary tab. The Summary tab presents information about the
indicator stored in Cortex XSIAM. Click on the Unit 42 Intel tab to view
Unit 42 data. From the Unit 42 Intel tab, you have the option to do the
following:

- **Update**

<!-- -->

- Updated Unit 42 Intel for the indicator is added to Cortex XSIAM. If
  the indicator is related to one or more Unit 42 threat intel objects
  already in Cortex XSIAM (brought in through the Unit 42 Feed
  integration), relationships are created in the database between the
  Unit 42 threat intel objects and the file indicator. No third-party
  enrichments are run on the indicator. We recommend using this option
  if, for security reasons, you do not want to expose the indicator to
  any third-party services.

<!-- -->

- **Update & Enrich**

<!-- -->

- Updated Unit 42 Intel for the indicator is added to Cortex XSIAM. If
  the indicator is related to one or more Unit 42 threat intel objects
  already in Cortex XSIAM (brought in through the Unit 42 Feed
  integration), relationships are created in the database between the
  Unit 42 threat intel objects and the file indicator. Your configured
  third-party enrichments are run on the indicator.

The indicator does not exist in Cortex XSIAM or in Unit 42 Intel

If the query was for an indicator type that is not an IP address,
domain, URL, or SHA256 file hash OR if the query included a wildcard or
a complex search, the search was performed on Cortex XSIAM data from the
last 7 days. You can extend the date range to see if the indicator is in
Cortex XSIAM but is older than 7 days.

![](media/rId3200.png){width="5.833333333333333in"
height="1.4518897637795276in"}

#### Indicator investigation

Cortex XSIAM enables you to centralize and manage every aspect of your
TIM investigation. Create, extract, and enrich indicators using Unit 42
Intel data and explore their relationships to gain deeper insights.

After you start ingesting indicators into Cortex XSIAM, you can start
your investigation, including creating indicators, adding indicators to
an issue, extracting indicators, exporting indicators, etc.

Cortex XSIAM Threat Intel includes access to the Unit 42 Intel service,
enabling you to identify threats in your network and discover and
contextualize trends. Unit 42 Intel provides data from WildFire (Palo
Alto Networks' cloud-based malware sandbox), the PAN-DB URL Filtering
database, Palo Alto Networks' Unit 42 threat intelligence team, and
third-party feeds (including both closed and open-source intelligence).
Unit 42 Intel data is continually updated to include the most recent
threat samples analyzed by Palo Alto Networks, enabling you to keep up
with threat trends and take a proactive approach to securing your
network.

When investigating an indicator, you can see the following tabs:

- **Summary**

<!-- -->

- View verdict, enrich, expire, delete and exclude the indicator, add
  relationships, view related issues, and add comments. Add or remove
  tags, which can help classify known threats. For example, you may want
  to group specific malware indicators that are part of ransomware, such
  as trojan or loader. Unit 42 Intel data also publishes tags to assist
  your classification.

<!-- -->

- **Additional Details**

<!-- -->

- Add or view any community notes for sharing and any custom details.

<!-- -->

- **Unit 42 Intel**

<!-- -->

- If the indicator is available in Unit 42, you can view related Unit 42
  Intel data.

  If the indicator has been found in the Unit 42 database you can view
  the following information (and download the Wildfire report (if
  available), according to indicator type:

  Available data according to indicator type

+-----------------------------------+-----------------------------------+
| Indicator Type                    | Layout Sections                   |
+===================================+===================================+
| IP address                        | - Verdict                         |
|                                   |                                   |
|                                   | - Source                          |
|                                   |                                   |
|                                   | - Relationships                   |
|                                   |                                   |
|                                   | - PAN-DB Categorization           |
|                                   |                                   |
|                                   | - Passive DNS                     |
+-----------------------------------+-----------------------------------+
| URL                               | - Verdict                         |
|                                   |                                   |
|                                   | - Source                          |
|                                   |                                   |
|                                   | - Relationships                   |
|                                   |                                   |
|                                   | - PAN-DB Categorization           |
|                                   |                                   |
|                                   | - WHOIS                           |
+-----------------------------------+-----------------------------------+
| Domain                            | - Verdict                         |
|                                   |                                   |
|                                   | - Source                          |
|                                   |                                   |
|                                   | - Relationships                   |
|                                   |                                   |
|                                   | - PAN-DB Categorization           |
|                                   |                                   |
|                                   | - Passive DNS                     |
|                                   |                                   |
|                                   | - WHOIS                           |
+-----------------------------------+-----------------------------------+
| File                              | - Verdict                         |
|                                   |                                   |
|                                   | - Source                          |
|                                   |                                   |
|                                   | - Relationships                   |
|                                   |                                   |
|                                   | - Summary                         |
|                                   |                                   |
|                                   | - WildFire Analysis               |
|                                   |                                   |
|                                   | - Related Sessions & Submissions  |
+-----------------------------------+-----------------------------------+

When investigating an indicator, you can perform actions on the
indicator, such as:

  --------------------------------------------------------------------------------------------
  Action                              Description
  ----------------------------------- --------------------------------------------------------
  Enrich an indicator                 You can view detailed information about the indicator
                                      (WHOIS information for example), using third-party
                                      integrations such as VirusTotal and IPinfo. For more
                                      information, see [Extract and enrich an
                                      indicator](#UUID2d878fe6eedc065f07c1b8c788966634).

  Expire an indicator                 You may want to expire an indicator to filter out less
                                      relevant issues, allowing analysts to focus on active
                                      threats. For more information, see [Expire an
                                      indicator](#UUID3bf0635d1373bfd6596ce9a8f5b3c956).

  Manage indicator relationships      Threat Intel Management in Cortex XSIAM includes a feed
                                      that brings in a collection of threat intel objects as
                                      indicators. These indicators are stored in the Cortex
                                      XSIAM threat intel library and include Malware, Attack
                                      Patterns, Campaigns, and Threat Actors. When you add or
                                      update an indicator from Unit 42 Intel,
                                      a relationship is formed in the database between the
                                      relevant threat intel object and the new, or updated,
                                      indicator. For more information, see [Manage indicator
                                      relationships](#UUID2e21f1264b84b77ffb973515238aa315).

  Delete and exclude indicators       Indicators added to an exclusion list are disregarded by
                                      the system and are not created or involved in automated
                                      flows. For more information, see [Delete and exclude
                                      indicators](#UUID4144b24a6a01c03aaeb76110cb2faeec).
  --------------------------------------------------------------------------------------------

##### Indicator verdict

An indicator's verdict is assigned according to the verdict returned by
the source with the highest reliability, where reliability is scaled
based on the [Admiralty Source and Information Reliability
Matrix](https://www.researchgate.net/figure/The-Admiralty-Code-for-Confidence_fig3_351655780).
In cases where multiple sources with the same reliability score return a
different verdict for the indicator, the worst verdict is taken.
Indicators are assigned the following verdicts:

- 0: Unknown

- 1: Benign

- 2: Suspicious

- 3: Malicious

In the UI, you can manually set the verdict when creating or editing an
indicator. If you manually changed the indicator's verdict in the UI and
want to recalculate it according to enrichment integrations, set the
verdict to `Unknown` and then enrich the indicator. If you run indicator
enrichment without setting the verdict to `Unknown`, the indicator is
enriched but the manually set verdict is not changed.

You can also manually set the verdict by running
`!setIndicator` or `!setIndicators` in the CLI (for example in the
Playground), but if you set the verdict to `Unknown` the system will not
overwrite it.

**Source reliability**

The reliability of an intelligence data source influences the verdict of
an indicator and the values for indicator fields when merging
indicators. Indicator fields are merged according to the source
reliability hierarchy, which means that when there are two different
values for a single indicator field, the field will be populated with
the value provided by the source with the highest reliability score.

In rare cases, two sources with the same reliability score might return
different values for the same indicator field. In these cases, the field
is populated with the most recently provided source, unless the field is
verdict. If two sources have the same reliability score and return
different values for the verdict field, the worse verdict is used.

For the field types Tags and Multi-select, all values are appended, and
nothing is overridden.

+-----------------------+-----------------------+------------------------------------------------------+
| Source                | Reliability Score     | Notes                                                |
+=======================+=======================+======================================================+
| Manual                | A+++                  | A user manually updates the verdict of an indicator. |
+-----------------------+-----------------------+------------------------------------------------------+
| Reputation script     | A++                   | A script with the **reputation** tag calculates the  |
|                       |                       | verdict of an indicator. For example, the            |
|                       |                       | *DataDomainReputation* script evaluates the verdict  |
|                       |                       | of a URL or domain.                                  |
+-----------------------+-----------------------+------------------------------------------------------+
| Third-party           | A+                    | An integration or service that evaluates the verdict |
| enrichment            |                       | of an indicator. For example, the *urlscan.io*       |
|                       |                       | integration evaluates the verdict of a URL.          |
+-----------------------+-----------------------+------------------------------------------------------+
| Feed                  | A: Completely         | The feed reliability is applied at the integration   |
|                       | reliable              | instance level.                                      |
|                       |                       |                                                      |
|                       |                       | For information on how to configure, see [Configure  |
|                       |                       | Threat Intelligence feed                             |
|                       |                       | integrations](#UUID7531f220b2bd6784c9161c82fa44a259) |
+-----------------------+-----------------------+------------------------------------------------------+
| B: Usually reliable   |                       |                                                      |
+-----------------------+-----------------------+------------------------------------------------------+
| C: Fairly reliable    |                       |                                                      |
+-----------------------+-----------------------+------------------------------------------------------+
| D: Not usually        |                       |                                                      |
| reliable              |                       |                                                      |
+-----------------------+-----------------------+------------------------------------------------------+
| E: Unreliable         |                       |                                                      |
+-----------------------+-----------------------+------------------------------------------------------+
| F: Reliability cannot |                       |                                                      |
| be judged             |                       |                                                      |
+-----------------------+-----------------------+------------------------------------------------------+

**Different verdicts from integrations**

In this example, two third-party integrations, VirusTotal and
AlienVault, return a different verdict for the same indicator. The
indicator's verdict will be Malicious because VirusTotal's reliability
score is higher than AlienVault.

  -----------------------------------------------------------------------
  Integration       Reliability       Verdict           Final Verdict
  ----------------- ----------------- ----------------- -----------------
  VirusTotal        C - Fairly        Malicious         Malicious
                    reliable                            

  AlienVault        D- Not usually    Benign            
                    reliable                            
  -----------------------------------------------------------------------

In this example, two sources with the same verdict score return a
different verdict for the same indicator. The indicator's verdict will
be Malicious because when two sources have the same reliability, the
worse verdict applies.

  -----------------------------------------------------------------------
  Integration       Reliability       Verdict           Final Verdict
  ----------------- ----------------- ----------------- -----------------
  TAXII Feed        B - Usually       Malicious         Malicious
                    reliable                            

  CSV Feed          B - Usually       Benign            
                    reliable                            
  -----------------------------------------------------------------------

##### Extract and enrich an indicator

Indicator extraction identifies indicators from different text sources
in the system (such as War Room entries), extracts them, and creates
indicators in Cortex XSIAM. After extraction, the indicators are
enriched.

> **Note**
>
> By default, system-wide automatic indicator extraction and enrichment
> is disabled. However, if you migrated from Cortex XSIAM 2.x to Cortex
> XSIAM 3.x, system-wide automatic indicator extraction and enrichment
> is enabled.
>
> If you have a Threat Intel Management (TIM) Add-on, you can enable or
> disable automatic indicator extraction system-wide. Go to Settings \>
> Configuration \> General \> Server Settings. In the **Indicators**
> section, enable
> **Enable automatic indicator extraction and enrichment from issues**.

Indicator enrichment takes the extracted indicator and provides detailed
information about the indicator (WHOIS information for example), using
third-party integrations such as VirusTotal and IPinfo.

If you want to extract an indicator manually, you can do the following:

- Run indicator extraction in the CLI by running one of the following
  commands:

+-----------------------------------+-----------------------------------------------------------------------------------+
| Command                           | Description                                                                       |
+===================================+===================================================================================+
| extractIndicators                 | If you want to extract indicators from non-War-Room-entry sources (such as        |
|                                   | extracting from files), use the `!extractIndicators` command from the CLI. Use    |
|                                   | the command to do the following:                                                  |
|                                   |                                                                                   |
|                                   | - Validate regex: Test a specific string to see if the relevant indicators are    |
|                                   |   extracted correctly, such as a URL.                                             |
|                                   |                                                                                   |
|                                   | - In a playbook or script. The command extracts indicators in a playbook or a     |
|                                   |   script (non War Room source), and also creates and enriches them.               |
|                                   |                                                                                   |
|                                   | You can extract the following:                                                    |
|                                   |                                                                                   |
|                                   | - A specified entry (an entry ID)                                                 |
|                                   |                                                                                   |
|                                   | - Investigation (Investigation ID)                                                |
|                                   |                                                                                   |
|                                   | - Text                                                                            |
|                                   |                                                                                   |
|                                   | - File path                                                                       |
|                                   |                                                                                   |
|                                   | For example,                                                                      |
|                                   | type `!extractIndicators text="some text 1.1.1.1 something" auto-extract=inline`. |
|                                   | The entry text contains the text of the indicators, which is extracted and        |
|                                   | enriched.                                                                         |
|                                   |                                                                                   |
|                                   | You can also extract indicators by adding the auto-extract parameter with the     |
|                                   | script and the mode for which you are setting it up. For                          |
|                                   | example:`!ReadFile entryId=826@101 auto-extract=inline`.                          |
|                                   |                                                                                   |
|                                   | Usually, when using the CLI, you want to disable indicator extraction. For        |
|                                   | example, if you return internal/private data to the War Room, and you do not want |
|                                   | it to be extracted and enriched in third-party services,                          |
|                                   | add `auto-extract=none` to your CLI command.                                      |
+-----------------------------------+-----------------------------------------------------------------------------------+
| enrichIndicators                  | The `enrichIndicators` command is usually used when you want to batch enrich      |
|                                   | indicators. This command works on existing indicators only (it does not create    |
|                                   | them on its own). When running the command, the relevant enrichment command is    |
|                                   | triggered (such as `!ip`), which is based on the indicator type that is found.    |
|                                   | The data is saved to context and the indicator.                                   |
|                                   |                                                                                   |
|                                   | > **Note**                                                                        |
|                                   | >                                                                                 |
|                                   | > Triggering enrichment on a substantial number of indicators can take time       |
|                                   | > (because it\'s activating all enrichment integrations per indicator) and can    |
|                                   | > result in performance degradation.                                              |
+-----------------------------------+-----------------------------------------------------------------------------------+
| Reputation commands               | Reputation commands such as !ip, can be run for new indicators and indicators     |
|                                   | already in the system. If extraction is on, the data is saved both to the         |
|                                   | indicator and the issue\'s context. If not, then the data is saved only to the    |
|                                   | context because the mapping flow is always triggered in enrichment commands. The  |
|                                   | default configuration is set to none in playbook tasks for extraction.            |
|                                   |                                                                                   |
|                                   | > **Note**                                                                        |
|                                   | >                                                                                 |
|                                   | > Reputation commands, such as `!ip, !domain` can only be used when you configure |
|                                   | > and enable a reputation integration instance, such as VirusTotal and WHOIS.     |
+-----------------------------------+-----------------------------------------------------------------------------------+

- Use the **Enrich indicator** button in the indicator layout. This is
  the same effect as running a reputation command.

- Run indicator enrichment in the **Quick View** window

<!-- -->

- If there is an enhancement script attached to the indicator type, in
  the indicator **Quick View** window, you can run a script to enrich an
  indicator. For example, the Domain indicator type uses
  the `DomainReputation` enhancement script. In an issue that contains a
  domain indicator type, click **Quick View**. In the Indicators tab,
  click Domain \> Actions \> DomainReputation.

  You can also run the enhancement script in the CLI.

##### Expire an indicator

Indicators can have the Expiration Status field set to **Active** or
**Expired**. When indicators expire, they still exist in Cortex XSIAM,
meaning they are still displayed and you can still search for them. You
may want to expire an indicator to filter out less relevant
issues, allowing analysts to focus on active threats. Expiring IoCs that
are no longer relevant helps ensure that security systems remain focused
on current threats.

You can set up expiration in the indicator type, integration feed, or in
a script. For more information, see [Configure indicator
expiration](#UUID6626ec9c2e6a5d97f43baad13728a39e). When you manually
expire an indicator, this overrides indicator extraction rules set in
scripts, indicator types, and feeds.

You can expire indicators using the following methods:

- In the indicator layout by clicking **Expire indicator**.

- Use the `expireIndicators` command to change the expiration status to
  **Expired** for one or more indicators. This command accepts a
  comma-separated list of indicator values and supports multiple
  indicator types. For example, you can set the expiration status for an
  IP address, domain, and file hash:
  `!expireIndicators value=1.1.1.1,safeurl.com,45356A9DB614ED7161A3B9192E2F318D0AB5AD10`.

- Use the `!setIndicator` or for multiple indicators use the
  `!setIndicators` command to reset the indicators\' expiration value.
  The value can also be set to `Never`, so that the indicators never
  expire. For example,
  `!setIndicators indicatorsValues=watson.com expiration=Never`.

> **Note**
>
> You need to run these commands in the Case or Issue War Room.

##### Manage indicator relationships

Indicator relationships are connections between different indicators.
These relationships can be IP addresses related to one another, domains
impersonating legitimate domains, etc. These relationships enable you to
enhance investigations with information about indicators and how they
might be connected to other issues or indicators. For example, if you
have a phishing issue with several indicators, one of those indicators
might lead to another indicator, which is a malicious threat actor. Once
you know the threat actor, you can investigate to see the issues it was
involved in, its known TTPs (tactics, techniques, and procedures), and
other indicators that might be related to the threat actor. The initial
issue which started as a phishing investigation immediately becomes a
true positive and relates to a specific malicious entity.

Relationships are created from threat intel feeds and enrichment
integrations that support the automatic creation of relationships, such
as **AlienVault OTX v2** and **URLhaus**, by selecting
**Create relationships** in the integration settings. Based on the
information that exists in the integrations, the relationships are
formed.

You can view indicator relationships by clicking on the indicator from
an issue, and then from the **Quick View** window click the
**Relationships** tab.

###### Create indicator relationships

You can also manually create and modify relationships, which is useful
when a specific threat report comes out. For example, Unit 42's
SolarStorm report contains indicators and relationships that might not
exist in your system, or you might not be aware of their connection.

If a relationship is no longer relevant, you can revoke it. This might
be relevant, for example, if a known malicious domain is no longer
associated with a specific IP address.

When you create a relationship, you can set the relationship type such
as whether the indicator is related, attached, applied, etc. For
example, a file is `attached-to` an email. The email `communicated-with`
the file.

You can create relationships by adding them in a playbook, in the CLI
using the `CreateIndicatorRelationship` command, or when investigating
an indicator in the Threat Intel tab.

**How to add an indicator relationship from an Indicator**

1.  Open an indicator and in the **RELATIONSHIPS** section add a
    relationship.

2.  In the **New Relationships** window, in Step 1, add a query by which
    to search for the relevant indicators.

- You can optionally limit the time range for the search.

3.  Select the indicators you want to create a relationship to.

4.  In Step 2 set the relationship type.

- By default, the relationship is  **related-to**. For example, IP
  address x.x.x.x is `related-to` IP address y.y.y.y.

5.  Save the relationship.

> **Note**
>
> You can also add an indicator relationship from the Quick View when
> selecting an indicator from an issue.

###### Investigate an indicator using indicator relationships

In this example, you can see how to use the relationships feature to
further your investigation.

1.  When opening an issue, the severity is low, but the issue contains
    the following indicators:

    - File

    - IP

2.  When you click the file hash indicator, neither the **Info** nor
    **Relationships** tabs have any additional details. This seems to
    indicate that the file is harmless.

- ![](media/rId3212.png){width="3.3229166666666665in"
  height="1.6145833333333333in"}

3.  Click on the IP address indicator.

- Under the **Info** tab, you can see that the indicator was ingested
  from a threat intel feed. This already bears further investigation.

  ![](media/rId3215.png){width="3.28125in" height="1.90625in"}

4.  Go to the **Relationships** tab.

- You can see that this indicator is related to a campaign.

  ![](media/rId3218.png){width="3.3333333333333335in"
  height="2.0520833333333335in"}

  What started as a low severity issue, has become a lot more
  threatening.

##### Delete and exclude indicators

Indicators added to an exclusion list are disregarded by the system and
are not created or involved in automated flows such as indicator
extraction. You can still manually enrich IP addresses and URLs that are
on the exclusion list, but the results are not posted to the War Room.

Add indicators to the exclusion list either in the **Indicators** table
or in the **Exclusion List** page.

**Delete and exclude indicators in the Indicators table**

Select one or more indicators from the **Indicators** table and click
the **Delete and Exclude** button. The indicators are deleted from the
**Indicators** table and added to the exclusion list. You can associate
these indicators with one or more indicator types.

If you delete the indicator it is removed from Cortex XSIAM. This option
should be used mainly for correcting errors in ingestion, and not as
part of your regular workflow.

**Add indicators in the Exclusion List page**

From the **Exclusion List** page, you can view the list of excluded
indicators, add an indicator to the exclusion list, or define indicator
values to be excluded using a regular expression (regex) or CIDR.

1.  Select Settings \> Configurations \> Object Setup \> Indicators \>
    Exclusion List \> New excluded indicator.

2.  Add the indicator value. For example, example.com (for a domain).

- > **Caution**

  > Ensure you are using the correct syntax when defining the values for
  > your exclusion lists.

3.  Select whether to use Regex.

- A regular expression enables you to identify a sequence of characters
  in an unknown string. The following example would identify
  www.demisto.com: `[A-Za-z0-9!@#$%\.&]*demisto[A-Za-z0-9!@#$%\.&]*`.

  Classless inter-domain routing (CIDR) enables you to define a range of
  IP addresses. For example, the IPv4 block 192.168.100.0/22 represents
  the 1024 IPv4 addresses from 192.168.100.0 to 192.168.103.255.

4.  Add a reason as to why you are excluding the indicator.

5.  Add the indicator types that apply.

6.  Save the excluded indicator.

###### Exclusion list examples

+-----------------------+--------------------------------+---------------------------------------------------------+
| Exclusion             | Description                    | Settings                                                |
+=======================+================================+=========================================================+
| Domain, URLs, and     | Excludes a specific domain,    | Define two entries to cover all URLs and subdomains     |
| subdomains            | and all subdomains and URLs    | associated with a specific domain.                      |
|                       | associated with the domain.    |                                                         |
|                       |                                | Entry one:                                              |
|                       |                                |                                                         |
|                       |                                | - Value: Subdomains and URLs. Example: `\.example\.com` |
|                       |                                |                                                         |
|                       |                                | - Select **Use Regex**.                                 |
|                       |                                |                                                         |
|                       |                                | - Do not select any indicator types.                    |
|                       |                                |                                                         |
|                       |                                | Entry two:                                              |
|                       |                                |                                                         |
|                       |                                | - Value: The specific domain. Example: `example.com`    |
|                       |                                |                                                         |
|                       |                                | - **Do NOT** select **Use Regex**.                      |
|                       |                                |                                                         |
|                       |                                | - Do not select any indicator types.                    |
+-----------------------+--------------------------------+---------------------------------------------------------+
| Subdomain (and URLs)  | Excludes any subdomains and    | - Value: Subdomains and URLs. Example: `\.example\.com` |
| specifically          | URLs of a domain, but the      |                                                         |
|                       | domain is still extracted.     | - Select **Use Regex**.                                 |
|                       |                                |                                                         |
|                       |                                | - Do not select any indicator types.                    |
+-----------------------+--------------------------------+---------------------------------------------------------+
| Specific domain only  | Excludes a specific domain.    | - Value: The specific domain. Example: `example.com`    |
|                       | Subdomains and URLs are still  |                                                         |
|                       | extracted.                     | - **Do NOT** select **Use Regex**.                      |
|                       |                                |                                                         |
|                       |                                | - Select indicator type: **Domain**.                    |
+-----------------------+--------------------------------+---------------------------------------------------------+
| URL with wildcards    | Excludes any indicators of     | - Value: The URL with wildcard added at the end.        |
|                       | type URL matching the regex.   |   Example: `http://examplesub.example.com`              |
|                       | Indicators example.com and     |                                                         |
|                       | examplesub.example.com of type | - Select **Use Regex**.                                 |
|                       | Domain would still be          |                                                         |
|                       | extracted. Start the regex     | - Select indicator type: **URL**.                       |
|                       | with `https?://` to exclude    |                                                         |
|                       | both HTTP and HTTPS URLs.      |                                                         |
+-----------------------+--------------------------------+---------------------------------------------------------+
| Specific URL          | Excludes a specific URL, but   | - Value: The specific URL. Example:                     |
|                       | the domain and subdomains are  |   `http://examplesub.example.com/myexample`             |
|                       | still extracted.               |                                                         |
|                       |                                | - **Do NOT** select **Use Regex**.                      |
|                       |                                |                                                         |
|                       |                                | - Select indicator type: **URL**.                       |
+-----------------------+--------------------------------+---------------------------------------------------------+
| URLs, domain, and     | Excludes domain example.com,   | - Value: Domain, subdomains and URLs, case insensitive  |
| subdomains,           | its subdomains, and its URLs.  |   and anchored to the start of the indicator. Example:  |
| case-insensitive,     | Case-insensitive. Anchors      |   `(?i)^(https?://)?(([a-zA-Z0-9\-]+\.)+)?example\.com` |
| anchored to start     | regex match to the start of    |                                                         |
|                       | the indicator value, so        | - Select **Use Regex**.                                 |
|                       | indicators that contain but do |                                                         |
|                       | not start with a match (e.g.,  | - Select indicator types: **URL**, **Domain**.          |
|                       | example.net?param=example.com) |                                                         |
|                       | are not excluded.              |                                                         |
+-----------------------+--------------------------------+---------------------------------------------------------+
| All URLs              | Excludes all URLs for a        | - Value: URLs with or without a path. Example:          |
|                       | specific domain that have a    |   `example\.com/`                                       |
|                       | path (even an empty path), but |                                                         |
|                       | the domain and subdomains are  | - Select **Use Regex**.                                 |
|                       | still extracted.               |                                                         |
|                       |                                | - Do not select any indicator types.                    |
+-----------------------+--------------------------------+---------------------------------------------------------+

##### Investigate files using sample analysis

Unit 42 Intel\'s Sample Analysis tools enable you to conduct in-depth
investigations and analyses of file samples. If the file indicator is
found in the Unit 42 Intel service, you have access to a full report on
activities, properties, and behaviors associated with the file. File
samples are run and analyzed using Palo Alto Networks' WildFire
cloud-based threat analysis service, so you can view dynamic analysis of
observed behavior, static analysis of the file contents, and related
sessions and submissions. For example, when investigating a malicious
file found in your network, you want to understand what the file did
locally and in the network.

You can search for file samples, either on the **XSIAM Indicators** page
or the **Sample Analysis** page. If using the **Sample Analysis** page,
you can search for the following samples:

- **Public Samples**

<!-- -->

- Searches for samples that have been submitted by firewalls or sample
  sources other than those associated with your CSP account.

<!-- -->

- **My Samples**

<!-- -->

- The **My Samples** option takes data submitted from WildFire through
  the Cortex XDR Agent, the Palo Alto Networks Firewall, Prisma SaaS,
  and Prisma Access. It takes data from devices in the same CSP account
  where your tenant is registered.

  > **Note**

  > WildFire provides verdicts and analysis reports without requiring a
  > license key. To send files to WildFire for analysis, see [Set up
  > Malware Prevention
  > Profiles](/document/preview/953906#UUID-96637ab0-4b96-ac8c-66cc-61dc18f3aa5e).

<!-- -->

- **All Samples**

<!-- -->

- Searches for both public and your samples.

> **Note**
>
> When searching on the **Sample Analysis** page for relationships
> `-relationships""`, some results may appear without their specific
> relationships listed, due to internal relationship permissions.

In the **Sample Analysis** tab, you can search for samples based on the
sample hash and it compares all historical and new samples to the search
conditions and filters the search results accordingly.

###### Investigate a file sample

On the **Sample Analysis** page, locate a file you want to investigate
and click the SHA256 section to start the investigation.

In the **Unit 42 Intel** tab, you can see the following sections:

+-----------------------------------+------------------------------------------------------------------------------+
| Section                           | Description                                                                  |
+===================================+==============================================================================+
| General Section                   | In the top half of the page, you can see the Verdict, a summary of the file, |
|                                   | when it was first and last seen by Wildfire, and any relationships.          |
|                                   |                                                                              |
|                                   | You can download a WildFire report in PDF format, which includes information |
|                                   | such as File Information, Static Analysis, and Dynamic Analysis.             |
+-----------------------------------+------------------------------------------------------------------------------+
| WildFire Dynamic Analysis -       | A high-level overview of the behavior observed when the file was run in the  |
| Observed Behavior                 | WildFire sandbox. Examples might include potentially malicious behaviors     |
|                                   | such as connecting to a potentially vulnerable port or creating an           |
|                                   | executable file in the Windows folder, as well as behaviors frequently       |
|                                   | performed by legitimate software, such as scheduling a task in Windows Task  |
|                                   | Scheduler.                                                                   |
+-----------------------------------+------------------------------------------------------------------------------+
| WildFire Dynamic Analysis -       | Dynamic analysis provides a granular view of file activity, process          |
| Sections                          | activity, registry activity, connection activity, etc. Files run in a        |
|                                   | custom-built, evasion-resistant virtual environment in which previously      |
|                                   | unknown submissions are detonated to determine real-world effects and        |
|                                   | behavior. Behavior can be observed in one or more operating system           |
|                                   | environments. It is broken down into the machines it was simulated and the   |
|                                   | activity itself. For example, Process Activity lists files that started a    |
|                                   | parent process, the process name, the action the process performed, and      |
|                                   | whether they are malicious, suspicious, etc. It shows not only the observed  |
|                                   | behavior of the file sample, but also how many times the behavior was        |
|                                   | observed in other Unit 42 samples (malicious samples, suspicious samples,    |
|                                   | and unknown samples).                                                        |
|                                   |                                                                              |
|                                   | In the following example, you can see that the parent process `sample.exe`   |
|                                   | wrote to file                                                                |
|                                   | `kernel32=E02A3B57EA8B393408FF782866A1D342DD8C6B5F5925BA527981DBB21B6A4080`. |
|                                   | The same behavior occurred in 3.57m samples that had a verdict of malicious. |
|                                   |                                                                              |
|                                   | ![](media/rId3225.png){width="5.833333333333333in"                           |
|                                   | height="0.9843744531933508in"}                                               |
+-----------------------------------+------------------------------------------------------------------------------+
| WildFire Static Analysis          | The WildFire Static analysis detects known threats by analyzing the          |
|                                   | characteristics of a sample before execution in the WildFire sandbox. Static |
|                                   | analysis can provide instant identification of malware variants and includes |
|                                   | dynamic unpacking to analyze threats attempting to evade detection using     |
|                                   | packer tools. You can analyze files such as Portable Executable (PE) files   |
|                                   | and any suspicious files.                                                    |
+-----------------------------------+------------------------------------------------------------------------------+
| Related Sessions & Submissions    | Shows any related sessions and submissions where the file was seen in your   |
|                                   | Cortex XDR Agent or Firewall.                                                |
+-----------------------------------+------------------------------------------------------------------------------+

You have the option to add the file sample (without enriching) to Cortex
XSIAM or to add and enrich the indicator to Cortex XSIAM.

- **Add to XSIAM**

<!-- -->

- The indicator is added to Cortex XSIAM. If the indicator is related to
  one or more Unit 42 threat intel objects already in Cortex
  XSIAM (ingested through the Unit 42 Feed integration), relationships
  are created in the database between the Unit 42 threat intel objects
  and the file indicator. No third-party enrichments are run on the
  indicator. We recommend using this option if, for security reasons,
  you do not want to expose the indicator to any third-party services.

<!-- -->

- **Add to XSIAM & Enrich**

<!-- -->

- The indicator is added to Cortex XSIAM. If the indicator is related to
  one or more Unit 42 threat intel objects already in Cortex
  XSIAM (ingested through the Unit 42 Feed integration), relationships
  are created in the database between the Unit 42 threat intel objects
  and the file indicator. Your configured third-party enrichments are
  run on the indicator.

When you add indicators to the Cortex XSIAM threat intel library from
Unit 42 Intel, the indicators are available for use in scripts and
playbooks.

###### Sample Analysis Advanced Search

You can use Unit 42 Intel data to build complex searches for file
samples with similar characteristics. In some sections, you can search
for specific characteristics. For example, in the
**WILDFIRE DYNAMIC ANALYSIS - OBSERVED BEHAVIOR**, section you can add
**Behavior** to a search. In the
**WILDFIRE DYNAMIC ANALYSIS - SECTIONS**, you can add
**PARENT PROCESS**, **ACTION**, or **PARAMETERS** or all characteristics
of the file activity to a search.

To investigate further you can build a new search that contains this
specific behavior and view the relevant samples. When selecting the
relevant column, you can do the following:

- **Add to Sample Analysis Search**

<!-- -->

- Adds selected information from a column to a Sample Analysis search
  (in the **WILDFIRE DYNAMIC ANALYSIS - SECTIONS**, you can add a whole
  row to the search).

<!-- -->

- **Create New Sample Analysis Search**

<!-- -->

- Clears any search characteristics you have already added and starts a
  new Sample Analysis search with the selected characteristics.

After selecting the relevant option, a message appears. You can do the
following:

- Run the query now, by clicking the link.

<!-- -->

- You pivot to the **Sample Analysis** page where you can edit or run
  your search for samples that exhibited the same behavior.

<!-- -->

- If you want to add additional items to the search, ignore the message.

<!-- -->

- To run the search, go to the **Sample Analysis** page.

You can save the search query for future use.

In the following example, you have an issue with an extracted file
indicator. The **Unit 42 Intel** tab shows the file's behavior. You
scroll through the sample\'s behavior and see a suspicious behavior:
`Powershell.exe` written to a file in the Administrator\'s User folder,
named `443.exe`. You want to find other samples with the same behavior
and determine if they are related to a known adversary or malware, so
you add that specific behavior to your search.

##### Use sessions and submissions in your investigation

The **Sessions & Submissions** page enables you to use your firewall
sessions and submissions data for investigation and analysis.

**Sessions** refer to firewall sessions that show connections from one
endpoint to another. A firewall can forward information about network
sessions for an investigation. Cortex XSIAM TIM uses session information
to learn more about the context of the suspicious network event,
indicators of compromise related to the malware, affected hosts and
clients, and applications used to deliver the malware.

**Submissions** refer to sample logs reported to Wildfire from the
Cortex XDR Agent and other Palo Alto Networks products. While Sessions
data shows connections from one endpoint to another, submissions data
shows if a file was found on a specific endpoint.

Firewall data can be submitted from WildFire through the Cortex XDR
Agent, the Palo Alto Networks Firewall, Prisma SaaS, and Prisma Access.

You can take steps to block external IP addresses that are the sources
of malicious files and threat campaigns. You can find compromised
machines within your network, isolate them as needed, and take
remediation steps. For example, search for a file hash in
**Sessions & Submissions**. If the file appeared in one or more sessions
or submissions, you can see when and where that occurred. A firewall
session data enables you to view the source IP and the destination IP
for each session that includes the file.

You can see which XDR agent reported the file and which computers are
affected.

> **Note**
>
> When searching on the **Sessions & Submissions** page for
> relationships `-relationships""`, some results may appear without
> their specific relationships listed, due to internal relationship
> permissions.

**Investigate Sessions and Submissions**

From **Sessions & Submissions** in the **ID** column click an ID to
start an investigation.

In the **Session Summary** tab you can see the following information:

+-----------------------------------+--------------------------------------------------------------+
| Section                           | Description                                                  |
+===================================+==============================================================+
| Basic Information                 | Includes general information such as the session Timestamp,  |
|                                   | destination IP, and source country.                          |
+-----------------------------------+--------------------------------------------------------------+
| Sample Information                | Includes file information, such as the file name, SHA, File  |
|                                   | URL, and Status. The Status for blocked samples              |
|                                   | is **Blocked**, while the status for allowed samples is      |
|                                   | blank.                                                       |
|                                   |                                                              |
|                                   | > **Note**                                                   |
|                                   | >                                                            |
|                                   | > The Application is matched to the type of application      |
|                                   | > traffic detected in a session. For example, a search for   |
|                                   | > the Application web-browsing returns sessions during which |
|                                   | > web browsing over HTTP occurred. See                       |
|                                   | > [Applipedia](https://applipedia.paloaltonetworks.com/) for |
|                                   | > an updated list of applications that Palo Alto Networks    |
|                                   | > identifies.                                                |
+-----------------------------------+--------------------------------------------------------------+
| Metadata                          | Includes metadata, such as the source, region, and Device    |
|                                   | Hostname.                                                    |
+-----------------------------------+--------------------------------------------------------------+
| Related Sessions and Submissions  | Lists any related sessions and submissions for further       |
|                                   | investigation                                                |
+-----------------------------------+--------------------------------------------------------------+

###### Sessions & Submissions advanced search

You can use Unit 42 Intel data to build complex searches for sessions
and submissions with similar characteristics. From within the
**Session Summary** tab, any of the items listed in the
**Basic Information**, **Sample Information**, or **Metadata** sections
can be used to create a new search for similar sessions and submissions.
For example, you can create a new search that includes a specific
destination IP and a specific file name that you found together in a
session.

To build a new search, hover your cursor over the end of the desired
row. You can submit the following search:

![](media/rId3232.png){width="5.833333333333333in"
height="1.5186778215223098in"}

- **Add to Sessions & Submissions Search**

<!-- -->

- Adds selected information to a **Sessions & Submissions** search.

<!-- -->

- **Create New Sessions & Submissions Search**

<!-- -->

- Clears any search characteristics you have already added and starts a
  new **Sessions & Submissions** search.

After selecting the relevant option, a message appears. You can do the
following:

- Run the query now, by clicking the link.

<!-- -->

- You pivot to the **Sessions & Submissions** page where you can edit or
  run your search for sessions and submissions that exhibited the same
  behavior.

<!-- -->

- If you want to add additional items to the search, ignore the message.

<!-- -->

- To run the search without clicking on the popup link, go to the
  **Sessions & Submissions** page.

