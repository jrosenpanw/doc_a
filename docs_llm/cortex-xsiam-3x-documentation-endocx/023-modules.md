## Modules

### Discovery Engine

The Discovery Engine is a key part of Cortex XSIAM\'s security posture
management. It scans your cloud accounts to discover all assets and add
them to the unified asset inventory.

#### What is the Discovery Engine?

> **Note**
>
> Requires the Cortex Cloud Posture Management add-on or the Cortex
> Cloud Runtime Security add-on.

The Discovery Engine is an essential component of Cortex XSIAM\'s
security posture management. The Discovery Engine scans your onboarded
cloud accounts and discovers your assets, services and resources. The
discovered assets are added to the Unified Asset Inventory. Once these
assets are identified, they can be scanned for misconfigurations and
vulnerabilities, ensuring the security of your cloud environments. The
cloud service provider (CSP) permissions that are required for the
Discovery Engine are available
[here](#UUID18e6f3f1a1c6b0c2ea3b86c571cdf3cd).

The Discovery Engine performs three main functionalities:

- **Full discovery scans:** The Discovery Engine calls all of the APIs
  in the discovery catalog (depending on the scope defined in the
  onboarding wizard) to scan every visible asset, service, and resource
  in the onboarded CSP. This full scan is performed every 12 hours.

- **Event Assisted Ingestion (EAI):** Using the collection of audit logs
  (whether enabled as part of the onboarding process or collected
  separately using a data collector), Cortex XSIAM analyzes the audit
  logs and identifies specific events or changes to certain asset types.
  If a change is identified, it triggers the Discovery Engine to scan
  that specific resource. This enables near-real-time discovery for
  specific assets, including VMs and data assets across AWS and GCP.

- **On-demand scans:** You can initiate a discovery scan for a specific
  CSP account or cloud instance using the **Discover Now** option. This
  option is available by right-clicking the account and selecting
  **Discover Now** . For a cloud instance, click the **More options**
  icon and select **Discovery Now**. Note that you can initiate an
  on-demand scan as long as there is no scan currently in progress. If a
  scan is already in progress, wait until it completes before initiating
  a new scan. A discovery scan can vary in duration based on the number
  of resources being scanned.

##### How does the Discovery Engine work?

The Discovery Engine is an API collection engine that gathers
information about your cloud environment. The engine executes resource
ingestion templates (RIT) that define which CSP APIs and actions to call
in order to collect, stitch, and normalize data. This process ensures
the information is consistent. Once normalized, relevant assets are
added or updated in the unified asset inventory. The specific APIs it
calls are detailed in the [discovery
catalog](https://docs-cortex.paloaltonetworks.com/r/Cortex-Cloud-Discovery-Catalog/Cortex-Cloud-discovery-catalog)
, organized according to RITs. The processed data collected by the RITs
is used to maintain an up-to-date inventory of all your cloud assets in
the unified asset inventory.

##### Technical details

- **API limits:** The Discovery Engine has no limit to the number of CSP
  APIs it calls; the goal is to provide a current and comprehensive view
  of your entire cloud environment. The number of API calls made by the
  Discovery Engine depends on the number of resources in your cloud
  environment, the frequency of changes to EAI-supported assets, and how
  often you run on-demand scans.

- **Retry mechanism:** The Discovery Engine implements an exponential
  backoff mechanism with up to three retries with a maximum of 1.5
  minutes for retry attempts.

- **Infrastructure:** The Discovery Engine always performs its
  functionality from the Cortex XSIAM tenant, regardless of whether you
  selected Cloud Scan or Scan with Outpost in the onboarding wizard.

##### Discovery catalog

The [discovery
catalog](https://docs-cortex.paloaltonetworks.com/r/Cortex-Cloud-Discovery-Catalog/Cortex-Cloud-discovery-catalog)
lists all of the resource ingestion templates (RIT). Each RIT has the
following details:

- **RIT NAME:** The name of the template

- **PROVIDER:** The cloud service provider associated with this RIT

- **SERVICE:** The specific API service invoked by the Discovery Engine
  as part of this RIT

- **ACTION:** The action performed by the API service

- **SCOPE:** Whether the action is performed on a regional scope or a
  global scope

- **ASSET TYPE:** The asset type created from resources identified by
  this RIT. If there is no asset type listed, this RIT does not create
  an asset. It is an intermediary RIT used to support execution of other
  RITs.

### Cortex Cloud AI Security

Cortex Cloud AI Security provides a comprehensive overview of the AI
assets within an organization. It is designed to ensure AI security by
offering tools to review and prioritize AI risks effectively.

#### What is Cortex Cloud AI Security?

Cortex Cloud AI Security provides:

- **Comprehensive Visibility:** Obtains a full picture of AI components,
  including models, agents, data flows, and infrastructure across all
  cloud environments. This broad visibility ensures that every AI asset
  is accounted for and continuously monitored, reducing blind spots in
  the AI ecosystem.

- **Full supply chain protection:** Maps the dependencies between data,
  models, and cloud resources to remediate risks such as poisoned
  datasets or unsanctioned models. Maintains the integrity of your AI
  bill of materials (AI-BOM).

- **Detailed asset inventory:** Access an in-depth inventory of all AI
  assets, enriched with contextual details. This deep insight into each
  asset's specifics and functionalities facilitates a better
  understanding and more effective management of these resources.

- **Advanced risk assessment:** Proactively identifies and issues alerts
  on misconfigurations and security flaws in AI assets. Cortex Cloud AI
  Security employs sophisticated detection mechanisms to tackle risks
  associated specifically with AI, managing permissions, and ensures
  robust security practices are upheld throughout the AI supply chain.

- **Dynamic risk prioritization:** Utilizes insights into data
  sensitivity and the broader security context to effectively understand
  and prioritize risks. This strategic approach enables organizations to
  target and mitigate the most critical threats swiftly, thereby
  enhancing the overall security landscape.

- **Governance and control:** Implements comprehensive guardrails and
  controls for AI models both during development and in production.
  Ensures that AI assets operate within defined security parameters,
  reducing the likelihood of security breaches and data leaks.

- **Compliance assurance:** Regularly tests AI systems against emerging
  AI regulations and industry standards, such as the OWASP
  *Top 10 for Large Language Models (LLMs)*. Gets clear guidelines on
  corrective actions needed to achieve full compliance and ensures that
  AI assets align with both current and future regulations.

These benefits ensure that using Cortex Cloud AI Security can maintain a
robust security posture across your AI environment, proactively manage
risks, and align with compliance and internal security policies.

**Cortex Cloud AI Security overview dashboard**

The Cortex Cloud AI Security overview dashboard serves as the central
hub for information on the AI ecosystem within the organization. It
provides a comprehensive overview of AI security posture and is designed
to help users quickly access relevant information. The layout and
organization of the dashboard are tailored to guide you in understanding
the AI environment and determining the next steps to take for effective
AI governance.

The following image shows the Cortex Cloud AI Security dashboard:

![](media/rId3307.png){width="5.833333333333333in"
height="3.6020833333333333in"}

**AI assets inventory**

You can view all AI assets in your environment, regardless of deployment
mode or cloud provider. Connected assets are discovered, contextualized,
and presented with detailed information. You can dive deeper into the
asset context as required.

Cortex Cloud AI Security provides visibility into how sensitive data is
being utilized and potentially impacted by AI systems. By identifying
the AI assets that interact with sensitive data, the platform helps
ensure that appropriate protection protocols are applied where most
needed, thereby enhancing overall data security and reducing the risk of
data breaches and leakage.

**AI security issues**

Cortex Cloud AI Security provides risk assessment for the supported AI
assets, with risk rules created by the research team. These risk rules
are designed to detect misconfigurations and security flaws in AI assets
and send alerts about them. In addition to the provided default risk
rules, Cortex Cloud AI Security also supports custom risk rule creation,
so you can codify and integrate internal policies into the Cortex Cloud
AI Security risk engine, streamlining your remediation efforts.

When insecure models and deployments are used, several types of attacks
can occur, such as the following:

- **Data Poisoning Attacks:** In \"Training Data Poisoning\", malicious
  actors manipulate the training data to introduce biases or
  vulnerabilities into the model, causing it to make incorrect or
  harmful predictions.

- **Model Inversion Attacks:** Attackers can infer sensitive information
  about the training data by querying the model, potentially leading to
  data breaches and loss of intellectual property.

- **Adversarial Attacks:** Crafted inputs can deceive the model into
  making incorrect predictions, which is particularly dangerous in
  critical applications like autonomous driving or medical diagnosis.

- **Evasion Attacks:** Evasion attacks are a prevalent threat to machine
  learning models during inference. This type of attack involves
  crafting inputs that appear normal to humans but are misclassified by
  machine learning systems. For instance, an adversary might alter a few
  pixels in an image prior to submission, causing an image recognition
  system to misidentify it.

- **Model Extraction Attacks:** Attackers can approximate a model\'s
  functionality by repeatedly prompting it, effectively stealing the
  intellectual property and potentially using it for malicious purposes.

- **Data Leakage:** If a model unintentionally reveals sensitive
  information it was trained on or data that is used in inference, it
  can lead to breaches of confidential or personal data.

- **Model Manipulation:** Unauthorized access to the model can allow
  attackers to alter its parameters or behavior, leading to compromised
  functionality and trustworthiness.

- **Inference Attacks:** Attackers exploit the model to deduce whether
  specific data was part of the training set, potentially exposing
  sensitive information.

These types of attacks highlight the importance of implementing robust
security measures, as outlined by the OWASP (Open Web Application
Security Project) *Top 10 Risk & Mitigations for LLMs and Gen AI Apps*.

#### Supported services in Cortex Cloud AI Security

The following lists the various services that are compatible with Cortex
Cloud AI Security, detailing the specific platforms and services where
Cortex Cloud AI Security can be effectively used to ensure security and
compliance:

- **AWS:** Amazon Bedrock, Amazon SageMaker

- **Azure:** Azure OpenAI

- **GCP:** Vertex AI

- Self-managed AI models

#### Cortex Cloud AI Security concepts

##### Introduction to AI applications

The AI application ecosystem comprises several critical components that
work together to enable the functionality of AI-driven applications. The
following explains the main concepts and shows some examples.

###### Model

The model is the core component of the AI ecosystem. It is the trained
machine learning model that takes input data, processes it, and produces
output. In the context of large language models (LLMs), this involves
understanding and generating human-like text based on the given input.

OpenAI GPT-4 model, which can generate coherent and contextually
relevant text, answer questions, and perform various other natural
language processing tasks.

###### Model endpoint

The model endpoint is the interface through which applications interact
with the AI model. It acts as an access point for sending inputs to the
model and receiving outputs. The endpoint is responsible for managing
requests, routing them to the appropriate model instance, and returning
the results to the application.

A Microsoft Azure OpenAII deployment using OpenAI GPT-4 , which you can
use to integrate natural language processing capabilities into your
applications by sending text prompts and receiving generated text in
response.

Amazon Web Services (AWS) EC2 instances with GPU acceleration running
Llama2 by Meta, which supports an application that communicates with the
EC2 instance.

###### Plugin

A plugin is an auxiliary but highly capable model or tool that acts as a
helper to the primary AI model. Plugins extend the functionality of the
main model by providing specialized capabilities, such as accessing
inference datasets, performing specific computations, or interfacing
with other services. This approach, known as retrieval-augmented
generation (RAG), enhances the primary model\'s ability to generate more
accurate and contextually relevant outputs. For more information, see
[Inference datasets](#Xd88be46d75bc09dad9db069d90f322e23511af2) and
[Retrieval-Augmented
Generation](#Xf2afffa2bb7cfd4275fed55de01fdcb5bedd445).

A weather plugin integrated with an AI chatbot that allows the chatbot
to fetch and provide real-time weather updates based on user queries.
Another example is a language translation plugin that helps the main
model translate text between different languages.

###### Training datasets

Training is a fundamental stage in the AI development process where the
model learns to perform its tasks by processing large amounts of data.
During this phase, the model is exposed to various examples and adjusts
its internal parameters to minimize errors in predictions or
classifications. The dataset is the integral part of the process, with
the insights learned by the model influenced by the training data.

Training a model like GPT-4 involves using vast text corpora from
various sources to help the model understand language patterns, context,
and nuances, enabling it to generate coherent and contextually relevant
text.

###### Inference datasets

Inference datasets are specialized collections of data used during the
inference phase of AI models, which is the stage where the model makes
predictions or generates outputs based on new input data. Unlike
training datasets, which are used to teach the model how to understand
and process information, inference datasets help improve the model\'s
performance by providing realistic, real-world data inputs for better
contextual answering.

When building a chatbot for customers to learn more about their spending
habits, financial institutions use customer transactions as inference
data to provide contextually accurate answers.

###### Fine-tuning

Fine-tuning in machine learning refers to the process of adapting a
pre-trained model to perform specific tasks or cater to particular use
cases. This technique has become essential in deep learning, especially
for training foundation models used in generative AI. Fine-tuning
leverages data (similarly to training) in order to adjust the responses
of the model to certain inputs, making it more suitable for the intended
business case.

###### Retrieval-Augmented Generation

Retrieval-Augmented Generation (RAG) enhances large language model (LLM)
responses by incorporating information from knowledge bases and other
sources. This allows the model to reference up-to-date inference data
before generating a response, improving contextual accuracy. This
approach is cost-effective and ensures the output remains relevant,
accurate, and useful across different contexts.

###### Example scenario: AI-powered customer support chatbot

To illustrate how these components work together, consider an AI-powered
customer support chatbot:

![](media/rId3325.png){width="5.833333333333333in"
height="2.902083333333333in"}

- **Model endpoint:** The chatbot application interacts with the GPT-4
  model through the Azure OpenAI Deployment, which serves as the model
  endpoint. This endpoint handles user queries, processes them, and
  directs them to the GPT-4 model to generate responses.

- **Model:** The GPT-4 model receives the user\'s query, processes it,
  and generates a relevant and contextually appropriate response based
  on the information and nuances provided in the query.

- **Plugin:** The chatbot integrates a customer database plugin that
  allows it to fetch user-specific inference data, such as order status
  or account details, to provide more personalized and accurate support.
  The customer database used by the plugin is the Inference Dataset.

- **Training dataset:** The chatbot undergoes fine-tuning using a
  dataset of previous customer interactions and support tickets, making
  it adept at handling common inquiries and issues in the specific
  industry.

- **Application:** The customer support platform integrates the chatbot
  with a user-friendly interface.

#### Cortex Cloud AI Security use cases

##### Understand your AI ecosystem

Understanding your AI ecosystem is crucial for identifying potential
vulnerabilities and ensuring the robustness of your AI operations. A
comprehensive view of your AI landscape helps in pinpointing where
sensitive data is processed and stored, as well as how data flows
between systems.

To understand your AI ecosystem, use the **AI Security Dashboard**,
which provides visibility into all the AI components. You can also see
how your AI assets relate to any other asset in the environment using
the **Graph Search**. The complete list of your AI assets can be found
under **AI Inventory**, where you can investigate each individual asset.

##### Investigate an AI asset

To understand a specific component of your AI ecosystem and identify any
findings or security issues related to it, use its asset card and links
to findings, issues, and cases created for the asset. When you select an
asset, you can review all the tabs on its asset card. These tabs on the
asset cards provide information about the following: overview, access,
data, vulnerabilities, applications, and AI ecosystems.

##### Detect AI security issues

Detecting the AI security issues early is pivotal to safeguarding
AI-powered applications and the sensitive data they handle. AI systems,
due to their complexity, can often be opaque, making it difficult to
identify vulnerabilities using traditional methods. To detect security
issues in your AI ecosystem, use the **AI Security Issues** page.

##### Secure the data for AI

Securing the data utilized by AI systems is critical. Cortex Cloud AI
Security helps you identify the data that is impacted by your AI
ecosystem, whether it\'s training data, data used for RAG (Retrieval
Augmented Generation) or any other related data such as prompt logs. It
also classifies this data, using Cortex Cloud Data Security. Data
classification across your AI ecosystem allows you to identify  models
that are trained on sensitive data and to prioritize all identified
risks and issues based on their data impact. For example, missing
guardrails on a sensitive model should be treated differently due to its
context.

##### Discover self-managed AI models

Cortex Cloud AI Security helps organizations discover self-managed AI
models.

Self-managed AI models refer to AI models that are deployed and operated
on self-managed cloud infrastructure, rather than through cloud
providers\' managed services. These models are often sourced from public
repositories like Hugging Face, and can lead to the proliferation of
shadow AI.

The growing use of AI in business workflows makes it increasingly
important to manage and secure all AI models, whether deployed through
managed services or self-managed infrastructures. Self-managed AI
models, in particular, introduce unique risks, such as security
vulnerabilities and compliance gaps. Tracking and securing these models
is essential to reducing risks and ensuring that AI applications remain
safe, secure, and compliant.

##### Comply with AI regulations

Cortex Cloud AI Security ensures compliance with emerging AI mandates
and industry standards, which is crucial because new frameworks require
unique measures to govern AI-specific vulnerabilities. For example, data
poisoning is a major risk for AI applications but traditional compliance
programs are not designed to handle it; however, new frameworks for AI
governance include relevant measures, such as the documentation of data
sources used to train AI models.  In addition, AI-powered applications
also add complexity for existing regulations like GDPR, due to their
data processing and interconnected systems.

Cortex Cloud AI Security allows for continuous monitoring and
visualization of compliance with leading AI standards, such as the OWASP
Top Ten for LLM.

Complying with current industry standards can help shorten the time
needed to meet future binding regulations. Cortex Cloud AI Security
helps you enforce policies, maintain audit trails, and achieve
compliance, providing visibility into compliance violations and helping
manage your AI Inventory, which is essential for controlling model
sprawl and shadow AI.

#### How to perform advanced AI Security investigations using XQL

##### Overview

Cortex Cloud AI Security centralizes information about your AI ecosystem
into a list of datasets, providing the foundation for comprehensive
security investigations. Using Cortex Query Language (XQL) , security
practitioners can create custom queries to extract valuable insights
from these data sources within their appliance. For more information,
see [Get started with XQL](#UUIDd08e1a9c8397fe101964781e65ee8407).

You can use the following AI-related datasets:

  -------------------------------------------------------------------------------------
  Dataset                             Description
  ----------------------------------- -------------------------------------------------
  asset_inventory                     Provides a normalized, structured inventory of
                                      all digital assets across your AI environment,
                                      including detailed metadata for each asset, such
                                      as type, cloud provider, region, and security
                                      configurations. The dataset also maps
                                      relationships between assets, enabling the
                                      identification of complex AI and cloud
                                      dependencies for a comprehensive AI security
                                      posture.

  classification_mgmt_data_profile    Provides administrative insights into the data
                                      classification policies and profiles configured
                                      within the Cortex Cloud Data Classification
                                      service.This dataset is primarily used for
                                      monitoring and managing the data classification
                                      rules in the Cortex Cloud environment.

  findings                            Contains the findings that are associated with
                                      the assets that are found in your environments.
                                      For more information, see [Findings and
                                      events](#UUIDbf161f3cb4dca8f66e01758cc950c3ea).

  issues                              Consolidates all AI security vulnerabilities,
                                      misconfigurations, and threats detected by Cortex
                                      Cloud AI Security. Each entry includes detailed
                                      context, such as the affected asset ID, a risk
                                      score, a description of the issue, and suggested
                                      remediation steps. This dataset provides a
                                      unified, actionable view of all security risks
                                      for your organization.
  -------------------------------------------------------------------------------------

##### Investigate Cortex Cloud AI Security

To run queries on your Cortex Cloud AI Security datasets:

1.  In Cortex XSIAM, in the navigation pane on the left, click
    **Investigation & Response**, then under **Search**, click
    **Query Builder**.

2.  Click **XQL**.

3.  You can start typing your query in the box at the top of the screen,
    or search for existing queries on the **Query Library** tab.

4.  Click **Run**. The results of the query appear on the
    **Query Results** tab.

> **Note**
>
> For more information, see
> [/document/preview/1282353#UUID-6b616ab5-87bc-e353-5aa5-51e6d5370560](/document/preview/1282353#UUID-6b616ab5-87bc-e353-5aa5-51e6d5370560).

##### Examples

Here are some examples of AI-related queries you can run in Cortex XSIAM
to investigate your AI Security posture:

1\. AI assets that were first discovered in the last 7 days

    dataset = asset_inventory
    | filter xdm.asset.type.class = "AI"
    | alter found = xdm.asset.first_observed
    | filter timestamp_diff(found, current_time(), "DAY") >= 7
    | fields
        xdm.asset.name as Asset_Name,
        xdm.asset.type.category as Asset_Type,
        xdm.asset.first_observed as First_Observed,
        xdm.asset.provider as Cloud,
        xdm.asset.cloud.region as Region

2\. Sensitive AI assets, such as datasets containing sensitive data,
models trained on sensitive data, or model endpoints using sensitive
inference data

    dataset = asset_inventory
    | filter xdm.asset.type.class = "AI"
    | join (
        dataset = findings
        | filter xdm.finding.type_id = 110000001
    ) as sensitive_AI sensitive_ai.xdm.finding.asset_id = xdm.asset.id
    | fields
        xdm.asset.name as Asset_Name,
        xdm.asset.type.category as Asset_Type,
        xdm.asset.provider as Cloud,
        xdm.finding.normalized_fields as Sensitive_Data

3\. Fine-tuned AI models

    dataset = asset_inventory
    | filter xdm.asset.type.category = "Model" and xdm.ai.model.kind = "FINE_TUNED"
    | fields
        xdm.asset.name as Asset_Name,
        xdm.asset.type.category as Asset_Type,
        xdm.asset.provider as Cloud,
        xdm.ai.model.kind as model_kind

4\. Public AI deployments that are accessible from the public internet

    dataset = findings
    | filter xdm.finding.type_id = 110000004
    | join (dataset = asset_inventory | filter xdm.asset.type.category = "Model Endpoint") as public_endpoints public_endpoints.xdm.asset.id = xdm.finding.asset_id
    | fields xdm.asset.name as Asset_Name, xdm.asset.type.category as Asset_Type, xdm.asset.provider as Cloud

5\. AI datasets containing sensitive PII data

    dataset = asset_inventory
    | filter xdm.asset.type.class = "AI" and xdm.asset.type.category = "Dataset"
    | join(
        dataset = findings
        | filter xdm.finding.type_id = 110000001
        | filter xdm.finding.is_active = TRUE
        | alter data_profile = json_extract_scalar_array(xdm.finding.normalized_fields, "$['xdm.data.data_profile']")
        | arrayexpand data_profile
    ) as sensitive_AI sensitive_ai.xdm.finding.asset_id = xdm.asset.id
    | join(
        dataset = classification_mgmt_data_profile
        | filter name = "PII" and enabled = True
    ) as data_profile_def data_profile_def.id = to_integer(data_profile)
    | fields name as data_type, xdm.asset.name as dataset_name, xdm.asset.strong_id as dataset_full_path, xdm.asset.provider as dataset_provider, xdm.asset.realm as dataset_realm, xdm.asset.type.name as dataset_type, xdm.finding.description as description

6\. AI datasets containing sensitive PCI data

    dataset = asset_inventory
    | filter xdm.asset.type.class = "AI" and xdm.asset.type.category = "Dataset"
    | join(
        dataset = findings
        | filter xdm.finding.type_id = 110000001
        | filter xdm.finding.is_active = TRUE
        | alter data_profile = json_extract_scalar_array(xdm.finding.normalized_fields, "$['xdm.data.data_profile']")
        | arrayexpand data_profile
    ) as sensitive_AI sensitive_ai.xdm.finding.asset_id = xdm.asset.id
    | join(
        dataset = classification_mgmt_data_profile
        | filter name = "PCI" and enabled = True
    ) as data_profile_def data_profile_def.id = to_integer(data_profile)
    | fields name as data_type, xdm.asset.name as dataset_name, xdm.asset.strong_id as dataset_full_path, xdm.asset.provider as dataset_provider, xdm.asset.realm as dataset_realm, xdm.asset.type.name as dataset_type, xdm.finding.description as description

7\. AI assets with more than one issue

    dataset = asset_inventory
    | filter xdm.asset.type.class = "AI" and xdm.asset.type.category in ("Dataset", "Model", "Model Endpoint")
    | join (
        dataset = issues_with_sbac
        | fields xdm.issue.id as issue_id, xdm.issue.domain, xdm.issue.status.progress as progress, xdm.issue.is_excluded as is_excluded
        | filter xdm.issue.domain = "POSTURE" and is_excluded != true and progress != "RESOLVED"
        | join type = inner (
            dataset = issue_to_asset
            | fields xdm.asset.id as ita_assetid, xdm.issue.id
        ) as its its.xdm.issue.id = issue_id
        | fields issue_id, ita_assetid
        | comp count(issue_id) as issues_count by ita_assetid
    ) as iss iss.ita_assetid = xdm.asset.id

8\. VMs deploying self-managed AI models

    dataset = asset_inventory
    | filter xdm.asset.type.class = "AI" and xdm.asset.type.category in ("Model") and xdm.asset.type.id = "SELF_MANAGED_MODEL"
    | alter relation = json_extract_array(xdm.asset.normalized_fields, "$['xdm.asset.relations']")
    | arrayexpand relation
    | alter relation_type = json_extract_scalar(relation, "$['xdm.asset.relation.type']")
    | filter relation_type in("DEPLOYED_ON")
    | alter relation_asset_id_to_find = json_extract_scalar(relation, "$['xdm.asset.relation.asset_id']")
    | dedup relation_asset_id_to_find
    | join(
        dataset = asset_inventory
    ) as vm_asset vm_asset.xdm.asset.id = relation_asset_id_to_find
    | fields xdm.asset.name as compute_instance_name, xdm.asset.realm as compute_instance_realm, xdm.asset.provider as compute_instance_provider, xdm.asset.type.name as compute_instance_type

9\. Disks storing self-managed AI models

    dataset = asset_inventory
    | filter xdm.asset.type.class = "AI" and xdm.asset.type.category in ("Model") and xdm.asset.type.id = "SELF_MANAGED_MODEL"
    | alter relation = json_extract_array(xdm.asset.normalized_fields, "$['xdm.asset.relations']")
    | arrayexpand relation
    | alter relation_type = json_extract_scalar(relation, "$['xdm.asset.relation.type']")
    | filter relation_type in("STORED_IN")
    | alter relation_asset_id_to_find = json_extract_scalar(relation, "$['xdm.asset.relation.asset_id']")
    | dedup relation_asset_id_to_find
    | join(
        dataset = asset_inventory
    ) as vm_asset vm_asset.xdm.asset.id = relation_asset_id_to_find
    | fields xdm.asset.name as disk_name, xdm.asset.realm as disk_realm, xdm.asset.provider as disk_provider, xdm.asset.type.name as disk_type, xdm.asset.strong_id as disk_id

10\. Active AI models with the number of days since last used

    dataset = asset_inventory
    | filter xdm.asset.type.class = "AI"
    | filter xdm.asset.type.category in ("Model")
    | join (
        dataset = findings
        | filter xdm.finding.type_id = 110000007 and xdm.finding.is_active = TRUE
        | alter days_since_invoked = json_extract_scalar(xdm.finding.extended_fields, "$['days_since_invoked']")
    ) as model_activity model_activity.xdm.finding.asset_id = xdm.asset.id
    | fields xdm.asset.name as Asset_Name, xdm.asset.type.category as Asset_Type, xdm.asset.first_observed as First_Observed, xdm.asset.provider as Cloud, xdm.asset.cloud.region as Region, days_since_invoked

### Cortex Cloud Application Security

The Application Security module provides comprehensive security for your
applications throughout their entire lifecycle. It offers unified
visibility and control over your application\'s security from
development through to deployment.

#### Application Security use cases

- **Application Security Posture Management** (ASPM): Provides a
  consolidated view of application risks and vulnerabilities across your
  environment, enabling you to understand and manage your overall
  security posture. For more information refer to
  [#UUIDbbb14716d43fe12e5c9ee68cdb25e551](#UUIDbbb14716d43fe12e5c9ee68cdb25e551)

- **CI/CD Security**: Focuses on securing your continuous integration
  and continuous delivery pipelines, ensuring the integrity and security
  of your automated build and deployment processes. For more information
  refer to
  [#UUIDb0cfc5a40701b41517c43871acb1f4b5](#UUIDb0cfc5a40701b41517c43871acb1f4b5)

- **Code Security**: Identifies and helps mitigate security issues
  directly within your source code, including vulnerabilities in
  Infrastructure-as-Code (IaC) and open-source components, from the
  earliest stages of development. For more information refer to
  [#UUIDb0cfc5a40701b41517c43871acb1f4b5](#UUIDb0cfc5a40701b41517c43871acb1f4b5)

#### Application Security Posture Management (ASPM)

ASPM is a comprehensive and integrated approach designed to centralize
and automate the continuous monitoring, evaluation, and enhancement of
an organization\'s application security throughout its entire software
lifecycle - from initial code development through deployment and ongoing
operations in cloud or on-premises environments.

ASPM functions as a unified governance layer. It aggregates, correlates,
and assesses security signals and findings from various application
security testing tools (such as SAST, DAST, and SCA) and other critical
data sources, providing a holistic, real-time, and actionable view of an
application\'s overall security landscape. This unified approach
directly addresses challenges like fragmented visibility, siloed
security teams, inefficient resource allocation, and delayed
remediation.

ASPM secures your applications by treating each as a dynamic, logical
entity, encompassing its complex array of components. This includes
custom code, open-source libraries, APIs, microservices, Infrastructure
as Code (IaC) configurations, runtime environments (like containers),
and data flows. By identifying and prioritizing these applications as
single entities, ASPM enables focused monitoring and safeguarding of
high-priority assets across the entire Software Development Lifecycle
(SDLC), including VCS repositories, CI/CD pipelines, and container
registries. This ensures you can effectively identify, prioritize, and
remediate critical issues that could impact key business systems,
thereby continuously reducing the risk of vulnerabilities and breaches.

##### ASPM use cases

The primary use cases for the Cortex XSIAM ASPM platform include:

- **Comprehensive visibility**: Gain a holistic, unified view of your
  application security posture across all stages of the software
  development lifecycle (SDLC), enabling you to identify and address
  vulnerabilities and misconfigurations

  - **Applications**: insights into the SDLC of your critical business
    applications

  - **Code to cloud**: Visualize and understand the relationship between
    your source code and deployed cloud resources, enabling you to
    identify and prioritize risks associated with your deployments

  - **CI/CD systems**: Monitor and analyze the security configurations
    and activities within your CI/CD pipelines to identify and mitigate
    risks introduced during the build and deployment processes

  - **Third party ingestion**: Integrate security findings from
    third-party scanners and security tools to gain a centralized view
    of your security posture and correlate findings across your
    development lifecycle

- **Contextual risk prioritization and proactive detection**: Prioritize
  remediation efforts based on a data-driven risk assessment that
  combines code-level vulnerabilities, runtime behaviors, and
  infrastructure configurations. Proactively detect critical issues such
  as exposed application secrets, IaC misconfigurations, SCA CVE
  vulnerabilities, package operational risks, and license miscompliance,
  all within the context of your application\'s architecture and
  potential impact on business operations. This allows you to focus on
  the most impactful threats and address them before they are exploited,
  ensuring a robust security posture

- **Effective prevention**: Enforce security policies and prevent
  security risks from impacting your applications

- **Actionable remediation**: Improve your security posture with
  actionable remediation guidance for identified security risks. The
  platform offers automated remediation for IaC misconfigurations and
  CVE vulnerabilities, in addition to clear steps for manual fixes for
  all categories of detected risks

##### ASPM key features

The Cortex XSIAM ASPM solution provides the following key features to
help you gain comprehensive control over your application security
posture:

- **Command Center**: A central dashboard providing a real-time overview
  of your organization\'s Application Security program, including
  security coverage, issue distribution (total, prevented, prioritized),
  and identification of riskiest applications

- **Coverage**: Provides detailed visibility into the security
  monitoring status of Application Security assets (such as VCS
  repositories and CI/CD pipelines) by security scanners, highlighting
  coverage percentages, gaps, and scanner success/failure rates

- **Backlog Management**: Enables categorization of issues and findings
  as **New** or **Backlog** (technical debt), allowing for
  differentiated management, filtering, and policy enforcement to
  prioritize new vulnerabilities

- **Application Builder**: Facilitates the definition and management of
  applications, automatically discovering and associating all relevant
  assets across the SDLC (from code to cloud) to provide a centralized
  and holistic view of application risk

- **Application side card**: Offers a unified, high-level summary of
  risks across the full application lifecycle, aggregating insights from
  multiple security domains, displaying key risk metrics, and showing
  application topology

- **Code-to-Cloud context**: Provides end-to-end visibility by mapping
  code-level issues (such as IaC misconfigurations and CVEs) to deployed
  assets and runtime issues, enabling full lifecycle insight from
  development through CI/CD to production

- **Generic 3rd party SARIF Collector**: Automates the ingestion of
  findings from diverse third-party scanners directly into the platform
  via SARIF file uploads, providing unique API access, real-time
  ingestion status, and detailed execution logs to streamline security
  workflows

##### ASPM user roles and permissions

The **AppSec Admin** role is the dedicated user role for ASPM, granting
full permissions for all application security-related activities. They
can create and modify detection rules within the Code/Build domain,
track progress, and adjust enforcements as needed. Additionally, they
can triage and investigate findings, issues, and cases spanning from
code to cloud. The role also includes complete visibility into all cloud
assets.

Permissions assigned to the **AppSec Admin** role cannot be modified.
However, you can save this role as a new custom role which can then be
edited to meet specific organizational needs, offering a balance between
standardized roles and customizable access control.

You can view **AppSec Admin** permissions in the tenant by navigating to
Settings \> Configurations \> Roles \> AppSec Admin.

##### ASPM Command Center

The ASPM Command Center acts as a central hub for managing your
application security posture across the entire Software Development
Lifecycle (SDLC), from code to cloud. It offers a high-level, real-time
view of your organization, providing critical insights into:

- **Overall security trends**: Track how your application security
  posture is evolving over time

- **Policy compliance**: Monitor adherence to your security policies
  throughout the SDLC

- **Coverage**: Gain visibility into scanned and unscanned assets,
  helping you identify and address security gaps

- **Critical risks**: Quickly identify and understand your most
  significant security threats

From this single, centralized location, you can track progress,
prioritize actions, and dive deeper into specific areas such as
vulnerabilities, security coverage and issue prioritization. This allows
you to understand whether overall risk is being reduced, where critical
security gaps exist, and how secure development practices are being
enabled. This allows you to focus on the most critical threats and
suggest effective mitigations. Ultimately, the Command Center helps you
focus on the most critical threats and suggest effective mitigations by
visualizing the data flow of issues from various sources, through
blocking and prioritization, leading to their aggregation into
actionable cases.

###### Use cases

- **Data source and issue overview**: View all your connected data
  sources including version control systems (VCS), data ingested from
  3rd-party sources, CI/CD pipelines, and registries, along with the
  issues generated by Cortex XSIAM from findings detected within these
  data sources

- **Coverage**: Assess your total security coverage of scanned assets,
  including coverage per data source, providing immediate insight into
  the completeness of your security monitoring efforts and highlighting
  areas where coverage needs to be improved

- **Deduplication and prioritization**: Analyze security issues by
  determining which were blocked by guardrails and which were
  deduplicated and aggregated for further action. This streamlines the
  volume of issues, ensuring your focus remains on the most impactful
  threats by presenting a refined set of prioritized issues

- **Riskiest applications**: Identify your applications most at risk.
  This view presents a list of critical applications and the overall
  count of high and critical cases across all applications, enabling
  rapid prioritization of top security concerns

###### ASPM Command Center workflow

The **ASPM Command Center** is designed to provide a comprehensive,
interactive, and actionable overview of your application security
posture. It streamlines the complex journey of security findings from
their origin, through prioritization and aggregation, to resolution,
empowering you to maintain a strong application security posture.

The ASPM Command Center is an interactive graph that visually represents
your application security workflow, moving from general data sources to
a prioritization funnel, to specific, actionable cases. This
visualization helps you quickly understand your security posture.

####### Data sources and coverage

The first section of the graph focuses on your data sources, including
both onboarded and third-party sources, categorized into
**CI/CD Pipelines ** and **VCS & 3rd Party** data sources. In this
section interactive elements provide more detailed information:

- **Data source overview**: Hovering over a data source provides a quick
  overview of its coverage

- **Total coverage insights**: The More Coverage Details tab opens a
  dedicated **Total Coverage** page within the **ASPM Command Center**.
  This page displays the overall amount and percentage of each data
  source type out of your total, along with a granular breakdown of
  scanner coverage (SAST, SCA, Secrets, IAC), showing the same detailed
  metrics

- **Increase coverage**: The Click to Increase Coverage link directs you
  to the **AppSec Coverage** page, which enables you to enhance your
  security coverage

- **Issue count**: Each data source also displays the number of issues
  detected

####### Prioritization and aggregation funnel

Clicking on the prioritization and aggregation part of the graph
provides a dedicated view within the ASPM Command Center, displaying the
security funnel. This page includes:

- **Issues**: The initial volume of security issues

<!-- -->

- > **Note**

  > Breakdown by type: Issues are further broken down by type (such as
  > IAC or Secrets).

<!-- -->

- **Open After Guardrails**: The amount of issues that persist after
  being filtered by your security guardrails, including those blocked in
  PRs

- **Prioritized**: Issues refined by parameters such as context, impact,
  probability, and issues not found in deployed applications

- **Cases** generated: At the end of this funnel, the number of cases
  generated post-prioritization and aggregation are displayed, with a
  breakdown prioritized by application, type, and severity

####### Case management

In the ASPM Command Center **Overview** page, the final section of the
graph summarizes your cases: It displays the total count of open and
closed cases. Open cases are further broken down by critical and high
severity, alongside a summary of closed cases.

####### Key performance indicators (KPIs)

The ASPM Command Center also features Key Performance Indicator (KPI)
widgets for a high-level overview:

- **Total Coverage** widget: Shows the percentage and absolute number of
  total assets scanned. Clicking this widget redirects you to the
  **AppSec Coverage** page

- **Riskiest Applications** widget: Presents a list of your most
  vulnerable applications, detailing the number of cases and their
  criticality. Selecting an app from this list opens the application
  case side panel directly within the ASPM Command Center, without the
  need to leave the command center and navigate to the dedicated
  **Cases** page

For tailored analysis, the ASPM Command Center Overview page includes
severity filters, allowing you to refine the displayed data based on the
criticality of issues.

##### Coverage

In Application Security Posture Management (ASPM), **Coverage** provides
a comprehensive overview of your security posture across the SDLC (code,
build, deploy). It offers visibility into scanned and unscanned assets,
active scanners, and implemented guardrails, enabling you to identify
and address security gaps for continuous protection.

This visibility includes:

###### Use cases

- **Data source coverage**: Identify onboarded and partially onboarded
  version control systems (VCS) and third-party integrations, ensuring
  all relevant data is available for analysis

- **Scanner coverage**: Determine which Static Application Security
  Testing (SAST) (sourced solely from third-party ingestion), Software
  Composition Analysis (SCA), Secrets, Infrastructure as Code (IaC),
  CI/CD misconfiguration and security posture management (SPM), and
  malware (image scans) are actively scanning your codebase and build

- **Guardrail coverage**: Understand which security policies and
  guardrails are applied at each stage, and assess their effectiveness

- **Stage-specific maturity**: Evaluate the coverage and maturity of
  your security posture at each stage of the SDLC, enabling targeted
  improvements

- **Application-specific coverage**: Gain a granular view of your
  application\'s security coverage, including data sources, scanners,
  and policies applied at each stage

- **Global and application scores**: Understand the global and
  application-specific security coverage scores, reflecting the overall
  maturity of your security posture

###### Coverage in the user interface

To access **Coverage**, navigate to Modules, \> Application Security \>
AppSec Coverage.

This interface offers a comprehensive overview of your application
security coverage, presenting key metrics and visualizations related to
application data sources, scanners, and guardrails. Interactive widgets
provide a summary of your coverage. When you apply a filter through a
widget, all data displayed on the dashboard, including the asset
inventory, will dynamically reflect the selected filter criteria. The
asset inventory provides detailed information about application assets
in your SDLC for in-depth analysis of your security posture. You can
also see all issues for specific assets by selecting them in the
inventory table.

####### Application-specific coverage

You can focus on the security posture of your critical business
applications, allowing you to prioritize remediation efforts for your
most important assets. To view application-specific data, select Add
Filters \> Applications \> enter the unique application name as provided
when creating it.

####### Coverage by data source

This widget provides metrics based on the coverage of the data source
such as version control systems (GitHub and so on), CI tools (Jenkins
and so on), Repositories (JFrog) and third party data sources (such as
Veracode). In addition, insights are provided, such as the amount of
assets added recently or whether a data source is not connected.

####### Coverage by status

This widget provides coverage metrics based on the percentage of scanned
repositories out of the total amount of repositories. Values: scanned,
partially scanned, unscanned.

####### Coverage by scanner type

This widget provides metrics based on the coverage of the scan types,
including code scanners (vulnerabilities, code weaknesses, secrets, IaC
misconfigurations) and images (malware).

####### Asset coverage inventory table

The asset coverage inventory table displays a list of assets. Table
properties include:

  -----------------------------------------------------------------------
  Property                            Description
  ----------------------------------- -----------------------------------
  Asset Type                          The type of asset scanned, such as
                                      repositories or container image
                                      repositories

  Name                                The name of the scanned asset

  Applications                        The type of applications associated
                                      with the asset

  Scanners Data                       Informations about the scanners
                                      that were applied to the asset.
                                      Upon hovering on the scanner,
                                      additional data the type of scanner
                                      and its status; enabled or disabled

  Last scan status                    The status of the last scan:
                                      Completed, not scanned yet, in
                                      progress and error
  -----------------------------------------------------------------------

##### Backlog baseline

In managing application security, it\'s crucial to distinguish between
backlog issues and new issues. Backlog issues represent the security
technical debt- vulnerabilities that existed in a code repository or
branch before a security scanner\'s initial run, or were uncovered by
new scanner capabilities or rules. This collection defines a historical
**backlog point** for a codebase. New issues are fresh vulnerabilities
introduced into the codebase, typically through recent changes such as
pull requests. This classification allows you to implement tailored
security policies and prioritize remediation efforts more effectively.

###### Backlog use cases

- **Gain granular visibility into security technical debt**:
  **AppSec Admins** need a clear, detailed picture of their security
  technical debt. This means being able to see the number of issues
  classified as **backlog** and **new** per repository and branch within
  an Application Security dashboard. This granular view allows managers
  to understand the full scope of their technical debt and identify
  areas where new vulnerabilities are still being introduced (bleeding)

- **Monitor and optimize security program performance**: To effectively
  manage security initiatives, **AppSec Admins** require a way to track
  the trend of **backlog** and **new** issues over time, both in total
  and broken down by each scanner (IaC, Secret, Vulnerability, SAST).
  Displaying this trend data in a dashboard widget helps you understand
  the pace of issue resolution across teams and pinpoint areas that may
  require escalation or additional resources

- **Streamline prioritization and remediation by scanner**: Application
  Security practitioners, development managers, and business owners need
  to efficiently prioritize and act on security findings. This is
  achieved by seeing, for each scanner, which issues are classified as
  **backlog** and **new**. This scanner-specific view allows for
  targeted remediation efforts, ensuring teams can focus on the most
  relevant and impactful issues based on their origin and status. This
  also includes the ability to integrate scanner-specific issue counts
  into broader dashboards like **DevChamp** and **DevSecOps** for
  cross-functional awareness

- **Implement differentiated security policies**: To ensure the system
  accurately reflects an organization\'s specific context, it must allow
  for customizable issue classification. This includes defining a
  historical cutoff date for when issues in existing repositories are
  considered **backlog** and **new**, and setting parameters such as
  treating new vulnerabilities discovered on existing Software Bill of
  Materials (SBOMs) as **new** issues. This flexibility ensures the
  backlog/new distinction is meaningful and actionable for all
  stakeholders.

###### Issue/Finding classification by scanner

This table details how security issues and findings are classified as
either **Backlog** or **New** based on their originating scanner and
specific detection scenarios

+-----------------+-------------------+-----------------+---------------------------------------------------+
| Scanner         | Backlog           | New Issue       | Comment                                           |
+=================+===================+=================+===================================================+
| IaC             | The first time an | Issues added    | If a new AppSec rule runs against the code        |
|                 | IaC detection     | through pull    | repository, the detected issue is considered a    |
|                 | rule ran against  | requests that   | **Backlog** issue                                 |
|                 | the code          | are created by  |                                                   |
|                 | repository        | a detection     |                                                   |
|                 |                   | rule which      |                                                   |
|                 |                   | previously ran  |                                                   |
|                 |                   | against this    |                                                   |
|                 |                   | repository      |                                                   |
+-----------------+-------------------+-----------------+---------------------------------------------------+
| Secrets         | The first time a  | A secret that   | If a new signature is added/changed in the secret |
|                 | secret was        | was added in a  | signature engine (by the vendor or by the user),  |
|                 | detected on the   | pull request    | its first run will be considered a **Backlog**    |
|                 | code repository   |                 | issue                                             |
|                 | with a specific   |                 |                                                   |
|                 | signature         |                 |                                                   |
|                 | (out-of-the-box   |                 |                                                   |
|                 | or                |                 |                                                   |
|                 | customer-created) |                 |                                                   |
+-----------------+-------------------+-----------------+---------------------------------------------------+
| SCA             | The first time    | A vulnerability | - If there is a new vulnerability on an existing  |
| Vulnerabilities | the SCA scanner   | found in a pull |   package version, it is considered a **Backlog** |
|                 | created an SBOM   | request on a    |   issue                                           |
|                 | of the code       | new or updated  |                                                   |
|                 | repository and    | package         | - If you set the global parameter                 |
|                 | identified        |                 |   **issues on existing SBOM are considered new**, |
|                 | vulnerabilities   |                 |   it will be considered a new issue               |
+-----------------+-------------------+-----------------+---------------------------------------------------+
| SAST            | The first time    | A SAST finding  | This classification also applies if you import a  |
|                 | the SAST scanner  | that was found  | SARIF file for a repository.                      |
|                 | sends results on  | on a pull       |                                                   |
|                 | this code         | request         | > **Note**                                        |
|                 | repository and    |                 |                                                   |
|                 | file              |                 | - > In some cases/vendors, this is not accurate   |
|                 |                   |                 |   > as findings are deleted every time new        |
|                 |                   |                 |   > findings are uploaded. In such cases, the     |
|                 |                   |                 |   > feature may not be accurate or supported      |
|                 |                   |                 |                                                   |
|                 |                   |                 | - > For SAST, the vendor does not support policy  |
|                 |                   |                 |   > in pull requests                              |
+-----------------+-------------------+-----------------+---------------------------------------------------+

> **Note**
>
> **Scanner updates and new detections**: When a security scanner is
> updated to support new languages, detection rules, or capabilities,
> any issues discovered by these new features for existing code are
> classified as part of the backlog.

###### Using Backlog

You can leverage the **Backlog** and **New** issue classifications
across the platform as follows.

- **Role-Based Access Control (RBAC) / Standard-Based Access Control (SBAC)**:
  Access and permissions will be managed systematically:

  - By default, only **AppSec Admins** have permission to configure the
    **issues on existing SBOM are considered new** setting

  - Permissions for all other capabilities, such as viewing issues or
    applying policies, are defined by the existing RBAC/SBAC policies
    and the user\'s specific issue management capabilities

- **Policies/Scope**: The system supports **Backlog** and **New**
  attributes for policies, allowing for differentiated enforcement.
  Refer to
  [/document/preview/1389192#UUID-2db04d9e-c3d5-2248-9187-29df40ffe081](/document/preview/1389192#UUID-2db04d9e-c3d5-2248-9187-29df40ffe081)
  for more information

- **Multi-Branch Support**: The Backlog/New classification is consistent
  across development workflows:

  - The Backlog/New classification is maintained independently for every
    branch

  - The system allows policies to be defined and applied for specific
    branches, enabling you to tailor security rules (for example,
    enforcing stricter policies for **New** critical issues on main
    branches, or allowing **Backlog** issues on development branches)
    based on their classification

- You can filter the **Application Security dashboard** to display
  information according to the Backlog/New classification

- **Issues and Findings**: The Backlog/New classification is
  standardized across data for both findings and issues under the
  **Backlog Status** field, which is found under the **Overview** tab of
  both findings and issues side cards. For example, refer to
  [/document/preview/1389491#UUID-15e391f8-9d2a-432c-4500-8a92929014f5](/document/preview/1389491#UUID-15e391f8-9d2a-432c-4500-8a92929014f5)

- The **API** provides comprehensive access to classified issue data:

  - You can retrieve all backlog issues, or filter them per scanner

  - You can retrieve all new issues, or filter them per scanner

  - You can retrieve new issues within the backlog, either all of them
    or filtered per scanner

  - You can disable the **issues on existing SBOM are considered new**
    flag programmatically, provided you have the required permissions

##### Applications

Applications are a single, holistic entity that encompasses their entire
lifecycle and all its components, from custom code to open-source
libraries and infrastructure configurations. This dynamic, logical
entity allows for focused monitoring and protection of high-priority
assets throughout your software delivery life-cycle (SDLC). Cortex XSIAM
provides you with the tools to build, manage, and gain visibility into
your applications.

- **Build applications to your needs**. You can create business
  applications by selecting and associating components, starting with
  either code or cloud assets

- **Manage application assets**: The business application assets
  inventory gives you a centralized view of all applications and their
  interconnected assets throughout your SDLC

- **Application management and visibility**: Cortex XSIAM provides tools
  for managing the security issues detected in your applications,
  allowing you to prioritize, analyze, and mitigate threats based on
  business criticality

By centralizing these functions, Cortex XSIAM helps you to identify,
prioritize, and remediate issues that could impact your most critical
business systems.

###### How to build an application

This section describes how to build an application. You can build your
application by adding assets, starting from either the code or run side.
This process covers your entire code-to-cloud journey: Code, Build,
Deploy, Run. Your application is then automatically built from the
assets you select on your chosen starting side.

> **Prerequisites**
>
> Before you begin, ensure you have connected the necessary data
> sources. Refer to
> [#UUID906c320913be7422beb596e15fa7af8f](#UUID906c320913be7422beb596e15fa7af8f)
> for more information.

1.  Under **Inventory**, select All Assets \> Applications \> Business
    Applications \> +New Application.

2.  In the **Add a New Application** dialog box:

    a.  Provide the required details:

        - **Application name** (required): A user-provided name

        - **Category** (required): Default - **Business Application**

        - **Description**: A description of the application. Provides
          context for users interacting with the application

        - **Business Criticality** (required): The level of importance
          of the application to your organization. This helps prioritize
          resources and attention based on the application\'s impact to
          your business objectives

        - **Business owner**: The individual or team responsible for the
          application from a business perspective

    b.  Click Create.

3.  On the **Applications** page: Add assets to your application,
    starting with either code or cloud assets:

    - **Add code assets from the Code pane**:

      i.  Select a version control system (VCS) from the list that is
          displayed.

      ii. Choose one or more of the following from their respective
          dropdown lists (multiple selections allowed): a specific VCS
          instance, an organization, or a repository.

      - > **Note**

        > These filters are represented by icons displayed on the
        > **Code** pane after selecting a VCS.

      iii. Click Done (on the Code pane).

      - After connecting your VCS, Prisma: Cortex automatically
        identifies and associates all build-time (such as source code,
        build scripts, Dockerfiles, CI tools), deploy (such as
        Kubernetes manifests, Helm charts, Terraform scripts), and
        runtime assets (such as running containers, virtual machines,
        cloud instances).

    - **Add cloud assets from the Run pane**:

      i.  Select an option:

          - Click **Add Assets by Provider** to select a cloud service
            provider

          - Click **Add Assets by Tag** to select a tagged cloud service
            provider

      ii. Select an instance of your connected provider from the list
          that is displayed.

      iii. Optional: Select **Kubernetes Namespace**,
           **Kubernetes Cluster**, **VPC**, **Organization** or
           **Resource tag** to automatically populate the application
           with runtime assets associated with those entities. These
           filters are represented by an icon displayed under **Run**
           (after selecting a cloud provider):

      iv. Click Done (on the Run pane).

      - After connecting your cloud service provider, Cortex XSIAM
        automatically identifies, associates and displays all Code (VCS
        repositories), build-time (such as source code, build scripts,
        Dockerfiles, CI/CD pipelines) and deploy assets (such as
        Kubernetes manifests, Helm charts, Terraform scripts).

4.  Click Finish to create the application.

- The application is displayed on both the All Applications and its
  dedicated asset page (business).

> **Note**
>
> To edit application assets, click the **Clear All** icon before
> clicking **Finish**. This clears all application data, allowing you to
> restart the application building process from the beginning.

###### Application management and visibility

You can view and manage your applications from the following interfaces:

- The **Business Applications** asset inventory provides a focused view
  that allows you to analyze and manage business assets, including
  seeing all of your interconnected assets, tracing their path to
  production, and managing issues directly from the asset\'s side card

- Dedicated **Application** tabs under Application Security asset
  categories (such as the **Application** tab under IaC resource
  assets - see
  [Applications](#Xceb5acfc250a4e896759e9d9d3331cfb6f74bb4))

###### Business application assets

The **Business Application** asset inventory provides visibility into
all business applications and their interconnected assets generated
throughout your software development lifecycle (SDLC), serving as a
centralized repository for business application inventory management.
Additionally, the interface details the risks detected in your business
applications, allowing you to prioritize, manage, and mitigate potential
threats based on business criticality.

To access the **Business Application** asset inventory, under
**Inventory**, select All Assets \> Business Application (under Assets).

The Business Application asset inventory includes a dashboard with a
widget of all issues detected in the application by severity level and a
table including a list of applications.

The following selected fields are displayed in the inventory table:

  ---------------------------------------------------------------------------------------
  Field                               Description
  ----------------------------------- ---------------------------------------------------
  Name                                The application name

  Business Owner                      The individual or team responsible for the
                                      application from a business perspective, as
                                      provided when creating the application

  Category                            The category that the application is classified
                                      under. Default is **Application**

  Risk                                Represents the overall assessed risk level for the
                                      application

  Business Criticality                The importance of the application to the business
                                      as defined when creating the application

  Coverage                            The application security posture. Refer to
                                      [Coverage](#UUID9257927ce4da38c03b37cb1b69f11ccd)
                                      for more information about Coverage

  Repositories Coverage               The amount of repositories associated with the
                                      application

  Pipelines                           The amount of pipelines associated with the
                                      application

  Workloads                           The amount of workloads associated with the
                                      application
  ---------------------------------------------------------------------------------------

####### Business application expanded asset details

Click an asset in the inventory table to open its side card, providing
in-depth information organized into several tabs. The **Overview** tab
(default display) offers highlights and a general summary. Additional
contextual tabs provide specific details, including a **Code to Cloud**
tab (providing context on the asset\'s path to production), an
**Applications** tab (displaying the applications in which the asset is
detected), and tabs such as **Configurations** and **Code** (focusing on
specific issue types detected within the asset).

Displayed at the top of the side panel, the asset summary provides
concise details of the asset\'s key attributes, including the name of
the application and its assigned categories.

######## Overview

The **Overview** tab summarizes application metadata and properties:

- Asset details, including **Asset Id**, **Asset Types** and
  **Asset Groups** associated with the application

- Application risks:

  - **Risk summary**: The amount of risks associated with the
    application assets grouped by category (cases, issues and findings)
    and their severity level. For more information about issues, refer
    to [Code Security scanners](#UUIDef3f0d8307c58a7d104f56cbfb606e01)

  - **Risk Score**: A value representing the overall security risk of an
    application, based on various underlying metrics. This helps in
    assessing and prioritizing the application\'s security posture and
    potential vulnerabilities

- **Visibility timeline**: When risks were first and last detected

- **Coverage**: Evaluate the application security coverage via its
  scanned asset percentage

- **Business Criticality**: As defined when creating the application.
  See [How to build an
  application](#UUID706e46b910aecb658f0f1289d068f39c) for more
  information

- **Criteria**:

- **Creation Method**: Indicates if the application was created through
  a manual selection of assets or automatically (such as via automation
  or discovery)

######## Application Topology

The **Application Topology** tab visually maps the interconnected assets
of the application---including code repositories, pipelines, registries,
and workloads---providing a comprehensive code-to-cloud representation
of their relationships across the entire code-to-cloud journey. You can
view the topology either as a visual representation or as an asset
inventory by selecting the **Graph** (default) or **Inventory** tabs
respectively. The application inventory provides these details of the
application assets:

> **Note**
>
> The topology graph is available only when all application components
> (code, pipeline, build and deploy), are configured.

######### Topology inventory

The topology inventory includes the following properties:

- The **Code Repositories** section includes these fields:

  - **Repository Name**: Displays the repository linked to the
    application, with a direct link to each repository

  - **Repository Org.**: Repository management entities such as
    **Organizations** for GitHub, **Groups** for GitLab, and
    **Workspaces** for Azure Bitbucket

  - **Provider**: The version control systems associated with the
    application, such as GitHub, GitLab, and Azure Bitbucket

  - **Scanned Branch**: The specific branch within the repository that
    is being actively scanned for security findings

  - **Repository Label**: Custom labels or tags applied to the
    repository for categorization or organizational purposes

  - **Is Repository Archived**: Indicates whether the repository is
    currently archived (Yes/No), meaning it\'s read-only and no longer
    actively developed

  - **First observed**: When the repository was initially detected

  - **Observation Time**: The date and time when the repository\'s
    status or data was last observed or updated by the system

- **CI Pipelines**: The application components providing continuous
  integration and delivery processes:

  - **Name**

  - **CI File Path**: The file path to the CI/CD configuration file
    within the repository (such as `.gitlab-ci.yml`,
    **.github/workflows/main.yml**)

  - **Repository**: The source code repository associated with this CI
    pipeline

  - **CI Instance**: The specific instance or server where the CI
    pipeline is executed (such as a Jenkins server URL or a GitLab SaaS
    instance)

  - **Provider**: The CI/CD platform used, such as GitHub Actions,
    GitLab CI/CD, or Jenkins

- Registries: Manages the application artifacts generated from the
  source code, such as container images, binaries, libraries, and other
  deployable assets

  - **Name**: The specific name of the registry instance (such as
    `my-docker-hub-repo`, `jfrog-dev`)

  - **Type**: The kind of registry technology or provider being used
    (such as Docker Hub, JFrog Artifactory, Azure Container Registry).

  - **Type Class**: A broader classification of the registry type, often
    indicating its primary function (such as Container Registry, Package
    Manager)

  - **Type Category**: A high-level categorization of the registry\'s
    purpose or environment (such as Public, Private, Cloud Managed)

  - **First Observed**: The date and time when this registry was
    initially detected and recorded by the system

- **Workloads**

  - **Workload Name**: The unique identifier or name of the specific
    workload instance (such as a pod name, container ID, or function
    name)

  - **Type**: The kind of workload technology or orchestration being
    used (such as Kubernetes Pod, Lambda Function, EC2 Instance, Azure
    Container Instance)

  - **Namespace**: The logical grouping or isolated environment within a
    cluster where the workload resides (common in Kubernetes)

  - **Cluster**: The name or identifier of the computing cluster where
    the workload is deployed and running (such as a Kubernetes cluster,
    ECS cluster)

  - **Account**: The cloud provider account or internal account under
    which the workload is deployed (such as AWS account ID, Azure
    subscription ID)

  - **First Observed**: The date and time when this specific workload
    instance was initially detected and recorded by the system

######### Topology graph

The topology graph displays the relationship between application assets
in the application path to production. Selecting an asset node in the
graph displays initial details in a popup modal. Click on View Details
in the popup to open the asset side-car, providing more comprehensive
information directly, without having to navigate to the dedicated asset
inventory.

**Controls**:

- Click on the **Layers** filter to view assets by their public internet
  exposure, related cases or associated runtime events within the graph
  results

- Click on **Group Nodes** to view the application\'s assets organized
  into logical clusters, simplifying the graph\'s complexity and
  highlighting key relationships

######## Vulnerabilities

The **Vulnerabilities** tab displays an inventory of SCA CVE
vulnerabilities across all application assets.

The table includes the following properties:

- **Severity** level (icon): Indicates the level of severity of the
  vulnerability

- **Issue Name**: The CVE identifier

- **CVSS Score**: The Common Vulnerability Scoring System score that
  quantifies the severity of the vulnerability

- **Assigned To**: The person or team responsible for addressing the
  vulnerability

- **Creation Date**: The date when the vulnerability was detected

For more information about SCA vulnerabilities, [Software Composition
Analysis (SCA) CVE vulnerability
issues](#UUIDd5b6e8c8c4b7665e8015abd242bfc0bf)

######## Configurations

The **Configurations** tab displays an inventory of IaC misconfiguration
across all application assets:

The table includes the following exposed properties:

- **Severity** level (icon): Indicates the level of severity of the IaC
  misconfiguration

- **Issue Name**: The IaC misconfiguration identifier

- **Asset Name**: The name of the IaC resource in which the
  misconfiguration occurred

- **Assigned To**: The person or team responsible for addressing the
  vulnerability

- **Creation Date**: The date when the vulnerability was detected

For more information about IaC misconfiguration, refer to
[#UUIDea3a4b5c9edd63f1e81f2658f83b1d38](#UUIDea3a4b5c9edd63f1e81f2658f83b1d38).

######## Secrets

The **Secrets** tab displays an inventory of exposed Secrets across all
applications.

The table includes the following exposed properties:

- **Severity** level (icon): Indicates the level of severity of the
  exposed Secrets

- **Issue Name**: The Secrets identifier

- **Assigned To**: The person or team responsible for addressing the
  Secrets

- **Creation Date**: The date when the Secrets were initially detected

For more information about Secrets, refer to
[#UUID7d638c37097525bfcd4f357fe65e4d0e](#UUID7d638c37097525bfcd4f357fe65e4d0e).

######## Code Weaknesses

The Code Weakness tab provides an inventory of ingested SAST (Static
Application Security Testing) CWEs (Common Weakness Enumerations)
identified within the application and its associated assets. Each CWE is
listed with its corresponding severity level, allowing you to prioritize
remediation efforts based on the potential impact on the application\'s
security posture.

The CWE table includes the following properties:

- **Severity** level (icon): Indicates the level of severity of the CWE
  issue

- **Issue Name**: The CWE identifier

- **Assigned To**: The person or team responsible for addressing the CWE
  issue

- **Creation Date**: The date when the CWE issue was detected

For more information about about third party code weaknesses, refer to
[#UUIDb22133d4c86db07a113993dd1e83e55c](#UUIDb22133d4c86db07a113993dd1e83e55c).

##### Repositories as assets

The **Repository** asset inventory provides comprehensive visibility of
all your repositories integrated with Application Security, providing
detailed information and insights into repository artifacts,
configurations, and dependencies. You can directly access issues, and
findings related to repository assets from the **Repository** assets
page, allowing you to prioritize and remediate them without having to
navigate to a separate remediation section.

###### Explore repository assets

To access repository assets, under **Inventory**, select All Assets \>
Repositories (under Code).

The **Repositories** assets page includes a dashboard and an inventory.

####### Repository dashboard

The dashboard includes two widgets:

- **Providers**: Displays connected version control providers (such as
  GitHub and GitLab) and the number of repositories found in each
  provider

- **Privacy State**: Shows the distribution between public and private
  repositories and the amount of repositories in each category

Selecting an item in either widget filters the table accordingly.

####### Repository asset inventory

The following table describes selected **Repository** properties of the
inventory table.

  -----------------------------------------------------------------------
  Property                            Description
  ----------------------------------- -----------------------------------
  Repository Name                     The name of the repository in the
                                      version control system (VCS).

  Repository Provider                 The VCS platform hosting the
                                      repository, such as GitHub, GitLab,
                                      or Bitbucket

  Repository Organization             The organizational structure (such
                                      as project, team, platform) that
                                      contains and manages the repository

  Repository labels                   Labels associated with the
                                      repository

  Application Ids                     The identifier of the application
                                      to which the repository belongs,
                                      indicating it is part of the
                                      application\'s assets.

  First observed                      The date the repository was
                                      initially detected in a scan

  Observation time                    The date the repository was last
                                      updated

  Scanned Branches                    The branch of the repository that
                                      is scanned (default: main/master)
  -----------------------------------------------------------------------

###### In-depth repository asset information

Click an asset in the inventory table to open its side card, providing
in-depth information organized into several tabs. The **Overview** tab
(default display) offers highlights and a general summary. Additional
contextual tabs provide specific details, including a **Code to Cloud**
tab (providing context on the asset\'s path to production), an
**Applications** tab (displaying the applications in which the asset is
detected), and tabs such as **Configurations** and **Code** (focusing on
specific issue types detected within the asset).

####### Repository asset summary

The repository asset summary, displayed at the top of the card, provides
concise details about the repository, including the organization and
repository and the version control system to which it belongs.

####### Overview

The **Overview** tab summarizes repository highlights and properties.

**Highlights** provide key security and operational insights related to
the repository:

- **Critical/ High issues**: An aggregation of critical and high issues
  discovered within the repository assets across all scan types (IaC,
  Secrets, SCA) as well as ingested third party SAST findings

- **Deployed**: Whether the repository is deployed

- **Public Repository**: Whether the repository is public

- **Risk summary**: The amount of cases, issues and findings and their
  severity associated with the repository. Each of these types includes
  two clickable values. The first value redirects to the corresponding
  type table sorted by the entry, while the second value opens the
  description card of the specific type within repository inventory
  without requiring redirection. For more information about risks, refer
  to
  [/document/preview/1090686#UUID-b8a3529c-c25d-b3a2-285b-deadcaf90678](/document/preview/1090686#UUID-b8a3529c-c25d-b3a2-285b-deadcaf90678)

- **Visibility timeline**: When the repository issues were first and
  last detected

**Properties**:

- Asset details, including the **Asset Id**, **Asset Category**,
  **Asset Group** and **Account ID** associated with the repository

- **Repository details**: Provides information about the repository.
  This includes the version control system hosting the repository (such
  as GitHub), the scanned branch, the programming languages or
  technologies used within the repository (such as Terraform), its
  visibility configuration (public or private), whether it\'s exposed to
  the internet, archived, the timestamp of the last commit, and a list
  of owners

- **Scan information**: A list of scans conducted on the repository.
  Scan details include the scan type (Periodic, CI, PR), the specific
  branch of the package that was scanned, the timestamp of the last
  scan, the health status of the scan (completed, failed, partially, in
  progress), and the PR/CI status of the scan (Passed, Failed).

<!-- -->

- For more information about scan management, refer to [How to access
  Application Security scan
  management](#UUIDb4dc61490e2b122efebc142ac1d9e635).

The **Highlights** section and other asset properties only display
attributes when their corresponding indicators are present. For example,
if an asset is not deployed, its deployment-related attributes will not
show up; similarly, if there are no detected issues, those highlights or
properties will not appear.

####### Code to Cloud

The **Code to Cloud** tab describes the integrated flow of a selected
repository, describing its journey from development to deployment. The
graph visualizes the path to production, showing the repository\'s role
from its initial commit, through the CI/CD system, to the image it
builds, and finally to the traced runtime resource it deploys.

####### Applications

The **Applications** tab provides an overview of the application
associated with the repository, including a graphical representation of
its path to production, which incorporates the repository role within
the workflow.

For more information about applications, refer to
[/document/preview/1417708#UUID-a80d1f52-9270-6a2c-78af-754f5d3cff0c](/document/preview/1417708#UUID-a80d1f52-9270-6a2c-78af-754f5d3cff0c).

####### Vulnerabilities

The **Vulnerabilities** tab provides a list of vulnerabilities
identified within the repository in your environment. Each vulnerability
includes details regarding its severity level, associated CVE
identifier, CVSS score, initial detection date, and assigned team member
or group responsible for remediation.

The table includes the following properties:

- **Severity** level (icon): Indicates the level of severity of the
  vulnerability

- **Issue Name**: The CVE identifier

- **CVSS Score**: The Common Vulnerability Scoring System score that
  quantifies the severity of the vulnerability

- **Assigned To**: The person or team responsible for addressing the
  vulnerability

- **Creation Date**: The date when the vulnerability was detected

For more information about SCA vulnerabilities, [Software Composition
Analysis (SCA) CVE vulnerability
issues](#UUIDd5b6e8c8c4b7665e8015abd242bfc0bf)

####### Configurations

The **Configurations** tab displays an inventory of IaC misconfiguration
across all repository assets:

The table includes the following exposed properties:

- **Severity** level (icon): Indicates the level of severity of the IaC
  misconfiguration

- **Issue Name**: The IaC misconfiguration identifier

- **Asset Name**: The name of the IaC resource in which the
  misconfiguration occurred

- **Assigned To**: The person or team responsible for addressing the
  vulnerability

- **Creation Date**: The date when the vulnerability was detected

For more information about IaC misconfiguration, refer to
[#UUIDea3a4b5c9edd63f1e81f2658f83b1d38](#UUIDea3a4b5c9edd63f1e81f2658f83b1d38).

####### Secrets

The **Secrets** tab displays an inventory of Secrets detected within the
repository.

The table includes the following exposed properties:

- **Severity** level (icon): Indicates the level of severity of the
  exposed Secrets

- **Issue Name**: The Secrets identifier

- **Assigned To**: The person or team responsible for addressing the
  Secrets

- **Creation Date**: The date when the Secrets were initially detected

For more information about Secrets, refer to
[#UUID7d638c37097525bfcd4f357fe65e4d0e](#UUID7d638c37097525bfcd4f357fe65e4d0e).

####### Package Integrity

The **Package Inventory** tab provides details about the popularity and
maintenance of packages identified within the repository. It also
includes an inventory of package operational risk issues and package
license issues, offering a comprehensive view of the package\'s overall
health and compliance.

The table includes the following properties:

- **Severity** level (icon): Indicates the level of severity of the
  package license miscompliance

- **Issue Name**: The package license miscompliance identifier

- **License Name**: The name of the license associated with the package.
  This indicates the specific license agreement that is potentially
  being violated

- **Asset Name**: The name of the asset that uses the package with the
  license miscompliance. This identifies where the license issue occurs

- **Branch**: The branch of the codebase where the asset with the
  license issue is located

The **Operational Risk Issues** table includes the following properties:

- **Severity**: Indicates the level of severity of the package
  operational risk

- **Issue Name**: The package operational risk identifier

- **Asset Name**: The name of the asset that uses the package with the
  package operational risk

- **Branch**: The branch of the codebase where the asset with the
  package operational risk is located

- **Assigned To**: The person or team responsible for addressing the
  package operational risk

- **Creation Date**: The date when the package operational risk was
  initially detected

For more information on Package Operational Risks, refer to [Package
Integrity](#UUID9d71749cd3dd94fb240492b0cdaddaeb).

####### Code Weaknesses

The **Code Weaknesses** tab provides an inventory of ingested SAST
(Static Application Security Testing) CWEs (Common Weakness
Enumerations) identified within the repository. Each CWE is listed with
its corresponding severity level, allowing you to prioritize remediation
efforts based on the potential impact on the repository\'s security
posture.

The CWE table includes the following properties:

- **Severity** level (icon): Indicates the level of severity of the CWE
  issue

- **Issue Name**: The CWE identifier

- **Assigned To**: The person or team responsible for addressing the CWE
  issue

- **Creation Date**: The date when the CWE issue was detected

For more information about about third party code weaknesses, refer to
[#UUIDb22133d4c86db07a113993dd1e83e55c](#UUIDb22133d4c86db07a113993dd1e83e55c).

###### Manage Repository assets

You can perform these actions on repository assets.

Right-click on a row in the inventory table to take the following
actions:

- **Open in new tab**: Opens the asset description card in a new tab

- **View asset data**: Display asset data. Formats: JSON, Tree View

- **Copy text to clipboard**: Duplicate selected text for easy pasting
  elsewhere

- **Copy entire row**: Duplicate the entire row of data for easy pasting
  elsewhere

- **Show/hide rows with \[Asset_Name\]**: Show/hide rows matching the
  \[asset name\] of the selected row

<!-- -->

- **Open in Copilot**: Displays the repository asset in Copilot.

- **Ingest Sarif**: Allows you to upload a file to ingest third party
  Sarif data

###### Export Software Bill of Materials (SBOM)

You can generate and export a Software Bill of Materials (SBOM) for a
specific repository to gain a comprehensive inventory of its software
components and their dependencies. To create a SBOM:

1.  Select a repository from the Repository asset inventory.

2.  Click **more options** (represented by three dots).

3.  Configure the following settings from the **Export SBOM** dialog
    box:

    a.  **Level**: Level of data: Select the scope of data to include in
        the SBOM: Options: Repository, Organization (downloads the SBOM
        for the entire VCS organization associated with the repository)

    b.  **Format**: Output format: Select the output format for the
        SBOM. Options:

        - `CycloneDX` v1.4: XML or JSON

        - `CycloneDX` v1.5: XML or JSON

        - `CycloneDX` v1.6: XML or JSON

        - `SDPX` v2.3: JSON

###### Manage issues detected in repositories

The **Repositories** assets inventory provides an overview of the
security issues identified by various scanners that analyze the
repository\'s code and configuration. This includes the number and
severity of issues detected in each repository.

You can remediate these issues directly from the asset inventory:

1.  Select a repository from the inventory table.

- A card is displayed with expanded repository details, including these
  types of issues detected during repository scans organized by tab
  according to category. Refer to [In-depth repository asset
  information](#UUID929bbcfbc88cc71456d696269fe944cb) for more details
  about available issue categories in repository assets.

2.  Click on a tab including an issue.

- A list of issues for the selected type is displayed.

3.  Select an issue from the list.

- A card with detailed issue information, including remediation options,
  is displayed.

4.  Remediate the issue:

    - For Secrets exposure, refer to [Secrets
      issues](#UUID534c4c85c2d2ed6b7951c5aa54775dd0)

    - For IaC misconfiguration, refer to [IaC misconfiguration
      issues](#UUID1e638129307480547e1aef2b0250be77)

    - SCA vulnerabilities:

      - For CVE vulnerabilities, refer to [Software Composition Analysis
        (SCA) CVE vulnerability
        issues](#UUIDd5b6e8c8c4b7665e8015abd242bfc0bf)

      - For package operational risks, refer to
        [/document/preview/1143473#UUID-5fc2ec31-3a01-432b-0341-c52144dbb6ee](/document/preview/1143473#UUID-5fc2ec31-3a01-432b-0341-c52144dbb6ee)

      - For package integrity (license miscompliance), refer to [License
        miscompliance issues](#UUID89645b7b3ae4ffec90c4bde04a122e6a)

    - For SAST CWE weaknesses, refer to
      [/document/preview/1126197#UUID-dc07deb4-383f-e487-1a84-786e72d0ce33](/document/preview/1126197#UUID-dc07deb4-383f-e487-1a84-786e72d0ce33)

> **Note**
>
> You can also find the repository issues in the general issue inventory
> table, and in the dedicated inventory of issues for each scanner type
> (*see step 4 above for details*).

##### Onboard data sources

Onboard your Version Control Systems (VCS), integrate your CI tools, and
ingest third-party data from external vendors to gain a comprehensive
view of your application and supply chain security.

###### Onboard VCS systems

By onboarding your VCS systems, you gain complete visibility into your
repositories and pipeline assets and out-of-the-box CI/CD system
capabilities.

- **Visibility**

  - **Asset mapping and inventory:** All repositories and their
    associated pipeline assets (such as GitHub Actions) are mapped,
    creating a complete inventory of your environment. This includes
    discovering forgotten or unauthorized devices and their connections

  - **Vulnerability management:** The inventory allows you to identify
    and prioritize security vulnerabilities since you can\'t secure what
    you don\'t know exists

  - **Compliance and auditing:** It provides the necessary data and logs
    to prove compliance during audits

  - **Attack surface understanding:** It helps you understand and manage
    your potential attack surface

- **CI/CD system capabilities**: Onboarding a VCS automatically
  integrates with specific CI/CD systems, triggering automated scans
  that identify supply chain security risks within your pipelines. For
  more information see [Onboard CI/CD
  systems](#Xf81d01d11609efdfa456b807675fde241183bc5) below

To onboard VCS systems, refer to [Onboard version control
systems](#UUID1f02af66fecaa451e412b0be7cefe18b).

###### Onboard CI/CD systems

You can onboard CI/CD systems to scan for configuration threats in your
organization\'s instance, pipelines, and individual repositories. While
onboarding supported version control systems includes out-of-the-box
CI/CD capabilities, you must explicitly onboard CircleCI and Jenkins to
get code scanning for these systems. Onboarding CI/CD systems provides
the following scans.

- **Organization instance configuration threats:** This type of scan
  detects security issues at the level of the overall organization\'s
  instance of a version control system (VCS), such as GitHub. For
  example, it can flag risks such as
  **Project webhook SSL verification disabled** or
  **Variable is not scoped to an environment**.

- **Pipeline configuration risks:** This scan identifies security risks
  within the configuration of your pipelines. Examples of risks it
  detects include
  **Excessive GitHub Action permissions, using an unpinned container image in a pipeline**,
  or
  **CI instance accesses cloud provider using insecure long-term credentials**

- **Repository configuration issues:** This scan checks problems with
  the settings and configurations of individual code repositories.
  Examples include **Forking of a private repository is allowed** and
  **A change in settings so that a review is no longer required before merging code**

To onboard CI/CD systems, refer to [Onboard CI/CD
systems](#UUID251194d617736d7e1c6ddcb9542c03ee).

###### Integrate CI tools to enable code scans through Cortex CLI

By integrating CI tools, you get two main benefits: code scans and
streamlined security workflows. This is achieved by inserting code
snippets directly into your existing CI workflows, which then run
through the unified Cortex CLI to trigger automated security checks.

- **Code scans**:

  - **Code scanning for IaC (Infrastructure as Code):** Finds
    misconfigurations in your IaC files, ensuring your cloud and
    infrastructure environments are secure from the start

  - **Software Composition Analysis (SCA) scans:** Identify
    vulnerabilities in open-source libraries and third-party components,
    along with license misconfigurations and package integrity issues

  - **Secrets detection:** Finds hardcoded secrets, such as API keys and
    passwords, in your code and pipelines to prevent unauthorized access
    and data breaches

- **Streamlined workflows:** By integrating security scans directly into
  your CI/CD pipelines, you achieve a shift-left security model, moving
  security from a final check to an early, continuous process within the
  development lifecycle.

  - **Early threat detection:** You can identify and fix security
    threats as soon as they are introduced

  - **Automated and seamless integration:** The use of code snippets and
    a unified CLI makes the security checks a seamless part of your
    existing CI process, requiring no manual intervention

To integrate CI tools through code snippets, refer to [CLI pipeline code
snippets](#UUID5830ae85d09425056be82342bd3d52eb)

###### Ingest third-party data

- **Expanded security coverage:** While Application Security provides
  robust native scanning, ingesting data from other security tools (such
  as SAST) expands your overall coverage. This creates a more
  comprehensive security profile, leaving no potential vulnerabilities
  unmonitored

- **Contextual Enrichment:** Third-party data adds context to your
  existing security information. By ingesting this data, Cortex XSIAM
  automatically correlates its findings with threats detected by
  Application Security scans. This helps you prioritize which
  vulnerabilities to address first based on the actual risks they pose,
  enabling more strategic and efficient remediation

- **Leveraging existing investments:** You can maximize the value of
  your current security tools through Cortex XSIAM , which powers the
  consolidation of your security data. Instead of operating in separate
  silos, your tools\' data is integrated into a single, consolidated
  view of your security state within Cortex XSIAM. This ensures that the
  data you have already collected from various sources is actively used
  to inform and strengthen your overall security strategy

<!-- -->

- To ingest third-party data, refer to [Ingest third-party
  data](#UUID555b56a837f1c33b635d61223f135577).

###### Code replication and retention policies

Cortex XSIAM does not replicate or store your application code unless
your organization has subscribed to the Application Security add-on
license. The data collected and displayed relates only to security
findings and metadata, preserving the integrity and location of your
source code.

###### Disclaimer

While Application Security provides guidance during integration and
explain the steps involved when you are redirected to third party
version control systems (such as GitHub SaaS , GitLab SaaS and so on),
Application Security does not assume responsibility for changes or
variations in these platform processes. Always refer to the official
documentation of the third party to ensure you are following their most
current and precise instructions.

###### Onboard version control systems

Connect Application Security with your version control systems (VCS) to
gain comprehensive visibility into, and monitor, the systems,
technologies, configurations, and pipelines that make your VCS platform.

These integrations trigger both periodic scans and scans on pull
requests (PRs) via a webhook, enabling security scans to identify and
remediate Infrastructure-as-Code (IaC) misconfigurations, exposed
secrets and license non-compliance in your VCS environment. Scan results
are displayed directly in PR comments and reports, allowing you to
analyze, prioritize and fix issues as soon as they are detected.

> **Note**
>
> Application Security (which includes IaC and Secrets scanning), is an
> add-on to a license (such as Posture Security) that must be purchased
> separately.

####### Supported VCS data sources

Application Security currently supports the following VCS data source
integrations:

- [AWS CodeCommit](#UUID65d262daa75889789eb54a189809a789)

- [Azure Repos](#UUIDcfbecede225f7132145b6f32cf01df19)

- [/document/preview/1287436#UUID-611334b1-f8cd-d432-4bcf-ba789ad897d8](/document/preview/1287436#UUID-611334b1-f8cd-d432-4bcf-ba789ad897d8)

- [Bitbucket Data Center](#UUID0c9084d51db34486233acfcb36a26cde)

- [GitHub Cloud](#UUID509529492d600667a7f97282667588bc)

- [GitHub Server](#UUID64f4aabf496bce0b2f6d8556bc6bc491)

- [GitLab SaaS](#UUID3e74abcee5ae08707efedeccd983ad82)

- [GitLab self-managed](#UUID0ca8b2d9b36f0bb97fa357e3d97524a8)

Each integration requires a unique set of permissions and subscribed
events.

####### How to onboard a VCS data source

VCS data sources are listed in the Cortex data source catalog.

1.  Navigate to Settings \> Data Sources (under Data Collections) \> +
    Data Source \> Show More \> Code Repositories.

- > **Tip**

  > Navigate to Settings \> Data Sources (under Data Collections) \> +
  > Data Source \> enter your VCS data source in the search bar.

2.  Select a data source and follow the instructions in its integration
    wizard to complete the integration process.

- > **Note**

  > **Disclaimer**: When onboarding with third-party data sources, we
  > outline the required steps for setup, but we do not monitor these
  > external resources, and they may change over time. Always refer to
  > the relevant third-party documentation for the most current
  > integration steps.

####### Onboard an additional data source instance

To onboard an additional data source instance:

1.  Access [How to onboard a VCS data
    source](#X28a4b667ae5e4b417de5771f465b743c765d876) above, hover over
    a data source and click **Connect another instance**.

2.  On the Data Sources page, select the menu in a Data Source row, and
    click **+ Add New Instance**.

3.  Complete the onboarding through the wizard.

####### Verify data source connectivity status and connected repositories

You can verify the connectivity status of data source instances and
their connected repositories through one of these methods:

- Select . This displays all data sources with their connected
  instances, including connectivity status. Hover over a data source and
  click **View Details** to view additional details about a data source
  instance, including its status and the amount of connected
  repositories

- When browsing the Data Source catalog, hover over a data source and
  select **View Details** to to navigate back to the detailed view of
  that instance

####### Manage VCS instances

You can manage VCS data source instances. Hover over an instance and
right-click to access the following actions:

1.  Select Settings \> Data Sources.

2.  Hover over a data source and click **View Details** to see a list of
    the connected instances of the data source.

3.  Hover over an instance and right-click to access the following
    actions:

    - **Details**: View details of the data source instance, including a
      list of connected repositories and organization, connectivity
      status, last scan date, and when initially connected.

    - **Edit instance**: Opens the Select Repositories step of the
      integration wizard, allowing you to edit connected repositories.
      You can also edit the instance configuration by navigating back to
      the previous step of the wizard and modifying relevant details

    - **Delete instance**: Deletes the entire instance

    - Remove a connected repository: Right-click on a repository in the
      list, and click **Remove Repository**

####### Manage findings and issues

For information about managing findings detected after onboarding data
sources, and issues generated from findings refer to
[/document/preview/1342213#UUID-ff383479-9ecf-fd0a-d827-05439dc4bc74](/document/preview/1342213#UUID-ff383479-9ecf-fd0a-d827-05439dc4bc74)

####### AWS CodeCommit

Integrate Application Security with your AWS CodeCommit Integrate
Application Security with your AWS CodeCommit version control system
(VCS) to enable security scans for exposed secrets,
infrastructure-as-code (IaC) misconfigurations, vulnerabilities, package
operational risks, and license compliance issues in your repositories.
This integration allows you to analyze, prioritize, and resolve detected
issues efficiently.

######## Authorization process overview

During integration, Application Security provides you with a
CloudFormation (CFN) template for deploying your AWS account. Once
deployed, the CFN template will establish the following components in
your environment:

- An IAM role configured with access to AWS CodeCommit

- A Simple Notification Service (SNS) topic with an HTTP subscription to
  the Application Security webhook URL

######## How to integrate AWS CodeCommit

> **Prerequisite**
>
> Before you begin:

- > Authorize the user integrating Application Security with your AWS
  > CodeCommit instances with the following permissions:

  - > **codecommit:GitPull**: Allows users to pull Git repository
    > changes

  - > **codecommit:ListBranches**: Grants the ability to list branches
    > within a repository

  - > **codecommit:GetBranch**: Required to get details about a branch
    > in a repository

  - > **codecommit:GetPullRequest**: Enables fetching details of a
    > specific pull request

  - > **codecommit:GetFolder**: Required to view the contents of a
    > specified folder in a repository from the CodeCommit console

  - > **codecommit:GetFile**: Required to view the encoded content of an
    > individual file and its metadata in a repository from the
    > CodeCommit console

  - > **codecommit:GetBlob**: Allows fetching of an object (such as a
    > file) from a repository

  - > **codecommit:GetCommitsFromMergeBase**: Grants access to commits
    > from the merge base of a branch

  - > **codecommit:GetCommentsForPullRequest**: Allows retrieval of
    > comments associated with a pull request

  - > **codecommit:PostCommentReply**: Required to create a reply to a
    > comment on a comparison between commits or on a pull request

  - > **codecommit:UpdateComment**: Allows updating of comments on pull
    > requests

  - > **codecommit:PostCommentForPullRequest**: Required to post a
    > comment on a pull request in a repository

  - > **codecommit:GetComment**: Permits retrieval of a specific comment
    > on a pull request

  - > **codecommit:GetCommit**: Allows fetching details of a specific
    > commit

  - > **codecommit:GetDifferences**: Grants access to differences
    > (changes) between commits, branches, and so on

  - > **codecommit:BatchGetRepositories**: Enables batch retrieval of
    > repository details

  - > **codecommit:GetRepository:** Permits fetching details of a
    > specific repository

  - > **codecommit:ListRepositories**: Grants the ability to list
    > repositories within an account

  - > **codecommit:GetRepositoryTriggers**: Allows fetching of triggers
    > configured for a repository

  - > **codecommit:PutRepositoryTriggers:** Enables configuration of
    > repository triggers

  - > **codecommit:TestRepositoryTriggers**: Allows testing of
    > repository triggers

  - > **codecommit:GetTree**: Required to view the contents of a
    > specified tree in a repository from the CodeCommit console. This
    > is an IAM policy permission only, not an API action that you can
    > call

  - > **codecommit:GetReferences:** Permits fetching of references
    > (branches, tags, etc.) in a repository

  - > **codecommit:GetObjectIdentifier**: Grants access to object
    > identifiers within a repository

  - > **codecommit:GetCommitHistory**: Allows fetching of commit history
    > for a repository

  - > **codecommit:BatchGetPullRequests:** Required to return
    > information about one or more pull requests in a repository. This
    > is an IAM policy permission only, not an API action that you can
    > call

  - > **codecommit:BatchGetCommits**: Enables batch retrieval of commit
    > details

  - > **codecommit:GetCommentsForComparedCommit**: Required to return
    > information about comments made on the comparison between two
    > commits in a repository

  - > **codecommit:PostCommentForComparedCommit**: Required to create a
    > comment on the comparison between two commits in a repository

  - > **codecommit:PostCommentReply:** Enables posting replies to
    > comments on pull requests

  - > **codecommit:ListPullRequests**: Required to return information
    > about the pull requests for a repository

  - > **codecommit:DeleteCommentContent:** Required to delete the
    > content of a comment made on a change, file, or commit in a
    > repository. Comments cannot be deleted, but the content of a
    > comment can be removed if the user has this permission

  - > **codecommit:CreateBranch**: Permits creation of branches within a
    > repository

  - > **codecommit:GetBranch**: Permits retrieval of branch details

  - > **codecommit:CreateCommit**: Allows creation of commits in a
    > repository

  - > **codecommit:CreatePullRequest**: Enables creation of pull
    > requests in a repository

  - > **codecommit:PutFile**: Required to add a new or modified file to
    > a repository from the CodeCommit console, CodeCommit API, or the
    > AWS CLI

  - > **codecommit:ListAssociatedApprovalRuleTemplatesForRepository**:
    > Grants access to associated approval rule templates for a
    > repository

  - > **codecommit:ListApprovalRuleTemplates**: Allows listing of
    > approval rule templates

  - > **codecommit:GetApprovalRuleTemplate**: Required to return
    > information about an approval rule template in an Amazon Web
    > Services account

  - > **codecommit:ListRepositoriesForApprovalRuleTemplate**: Permits
    > listing of repositories associated with an approval rule template

- > Create an egress path to establish the designated route for outbound
  > data transmission from Cortex XSIAM to third party services. For
  > more information about configuring egress paths, refer to
  > [/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2](/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2)

- > Create an SNS topic for each required region if the customer's
  > Prisma Cloud account and stack are in different regions. This
  > ensures compliance with CloudFormation constraints, which mandate
  > that SNS events for creations, deletions, and other actions must
  > reside in the same region as the stack

<!-- -->

- > **Note**

  > In the context of AWS, a \'stack\' refers to a collection of AWS
  > resources that are created, updated, and deleted together as a
  > single unit. This allows for the management of related resources as
  > a cohesive unit, making it easier to provision and manage complex
  > infrastructure deployments.

1.  On the Cortex XSIAM console.

    a.  Select Settings \> Data Sources (under Data Collections) \> +
        Data Source.

    b.  Enter AWS CodeCommit in the search bar \> Hover over the
        displayed search result \> Connect.

    - > **Note**

      > Select **Connect Another Instance** if an instance has already
      > been configured.

2.  Create a stack on the **AWS** console.

    a.  Click the
        [CloudFormation](https://console.aws.amazon.com/cloudformation/home#/stacks/create/review?templateURL=https://s3.us-east-1.amazonaws.com/cas-cf-template-469330042197-prod/aws_code_commit_template.json&param_ExternalID=U2FsdGVkX1/U4ziNj65RoiKB/FDuP1IyMwam8eOuMq9/W2NMAzmq+I+8LTS32A0q) 
        link in the wizard or copy and send the link to your
        administrator.

    - A stack template pre-populated by AWS CodeCommit is displayed.

    b.  Provide the stack name.

    - > **Note**

      > The **Resource Name Prefix** and **ExternalID** fields are
      > pre-populated. You can modify the Resource Name Prefix,
      > but **DO NOT** change the ExternalID!

    c.  Click Create Stack.

3.  Verify integration. Options include:

    - On the Cortex XSIAM console: On **Data Sources**, select Code
      Providers \> AWS CodeCommit \> View more and confirm that the
      status of your integrated AWS CodeCommit instance is
      **Connected**.

    - On AWS: Open CloudFormation \> Stacks. Verify that the integration
      is displayed with a success status.

> **Note**
>
> To create an additional AWS CodeCommit instance: Hover over the AWS
> CodeCommit card in the catalog and click **Connect Another**.

####### Azure Repos

Integrate Application Security with your Azure Repos version control
system (VCS) to enable security scans for exposed secrets,
infrastructure-as-code (IaC) misconfigurations, vulnerabilities, package
operational risks and license compliance issues in your repositories.
This integration allows you to analyze, prioritize, and resolve detected
issues efficiently.

######## Multi-token integration

Application Security supports multiple Azure Repos accounts for a single
tenant using multiple OAuth user tokens, without having to change any
permission settings in Azure Repos. You can connect multiple
organizations from the same Azure Repos account (using a single VCS user
token), or use multiple tokens to connect multiple organizations,
regardless whether they belong to the same Azure Repos account. This
capability increases your organization's readiness and scale.

######## How to integrate Azure Repos

> **Prerequisite**
>
> Before you begin:

- > Authorize the user integrating Application Security with your Azure
  > Repos instances with the following permissions and scopes.

+-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+
| > Permission                      | > Description                                                                                                                                             |
+===================================+===========================================================================================================================================================+
| > Project Administrator           | > This permission is required to subscribe to webhooks. For more information, refer to the [Microsoft Integrate with                                      |
|                                   | > service](https://learn.microsoft.com/en-us/azure/devops/service-hooks/overview?view=azure-devops#q-what-permissions-do-i-need-to-set-up-a-subscription) |
|                                   | > hooks documentation                                                                                                                                     |
+-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+
| > Repository Administrator        | > In order to scan pull requests (PRs), the user performing the integration must have administrative privileges for the repositories. This enables Cortex |
|                                   | > XSIAM to set up subscription webhooks for the selected repositories                                                                                     |
+-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+
| > Member of Project Collection    | > Required to subscribe to the `build.complete` event and download the permissions report for CI/CD scans                                                 |
| > Administrators                  | >                                                                                                                                                         |
|                                   | > **Note**                                                                                                                                                |
|                                   | >                                                                                                                                                         |
|                                   | > As Organization owners are automatically part of this group, they also possess this permission                                                          |
+-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+

+-----------------------------------+-----------------------------------+
| > Scope                           | > Description                     |
+===================================+===================================+
| > Identity (read)                 | > This permission grants read     |
| > \[vso.identity\]                | > access to identity-related      |
|                                   | > information or configurations   |
|                                   | > within Azure DevOps. It allows  |
|                                   | > the user to view details about  |
|                                   | > users, groups, or other         |
|                                   | > identity-related entities       |
+-----------------------------------+-----------------------------------+
| > Build (read) \[vso.build\]      | > This permission grants read     |
|                                   | > access to information related   |
|                                   | > to builds in Azure DevOps. It   |
|                                   | > allows the user to view details |
|                                   | > about build pipelines, build    |
|                                   | > definitions, and build          |
|                                   | > execution status                |
+-----------------------------------+-----------------------------------+
| > Packaging (read)                | > This permission grants read     |
| > \[vso.packaging\]               | > access to information related   |
|                                   | > to package management in Azure  |
|                                   | > DevOps. It allows the user to   |
|                                   | > view details about packages,    |
|                                   | > feeds, and package versions     |
|                                   | > stored in Azure Artifacts       |
+-----------------------------------+-----------------------------------+
| > Extensions (read)               | > This permission grants read     |
| > \[vso.extension\]               | > access to information related   |
|                                   | > to extensions in Azure DevOps.  |
|                                   | > It allows the user to view      |
|                                   | > details about installed         |
|                                   | > extensions, extension           |
|                                   | > configurations, and extension   |
|                                   | > marketplace                     |
+-----------------------------------+-----------------------------------+
| > Release (read) \[vso.release\]  | > This permission grants read     |
|                                   | > access to information related   |
|                                   | > to release pipelines in Azure   |
|                                   | > DevOps. It allows the user to   |
|                                   | > view details about release      |
|                                   | > definitions, release            |
|                                   | > environments, and release       |
|                                   | > execution status                |
+-----------------------------------+-----------------------------------+
| > Project and team (read)         | > This permission grants read     |
| > \[vso.project\]                 | > access to information related   |
|                                   | > to projects and teams in Azure  |
|                                   | > DevOps. It allows the user to   |
|                                   | > view details about projects,    |
|                                   | > teams, team membership, and     |
|                                   | > project settings                |
+-----------------------------------+-----------------------------------+
| > Graph (read) \[vso.graph\]      | > This permission grants read     |
|                                   | > access to the Azure DevOps      |
|                                   | > Graph API. It allows the user   |
|                                   | > to query and retrieve           |
|                                   | > information about users,        |
|                                   | > groups, and other entities      |
|                                   | > using the Graph API             |
+-----------------------------------+-----------------------------------+
| > User profile (write)            | > This permission grants write    |
| > \[vso.profile_write\]           | > access to the user's profile    |
|                                   | > information in Azure DevOps. It |
|                                   | > allows the user to update their |
|                                   | > own profile details such as     |
|                                   | > display name, email address,    |
|                                   | > and profile picture             |
+-----------------------------------+-----------------------------------+
| > Work items (read and write)     | > This permission grants read and |
| > \[vso.work_write\]              | > write access to work items in   |
|                                   | > Azure DevOps. It allows the     |
|                                   | > user to view, create, update,   |
|                                   | > and delete work items such as   |
|                                   | > user stories, bugs, tasks, and  |
|                                   | > epics                           |
+-----------------------------------+-----------------------------------+
| > Code (read and write)           | > This permission grants read and |
| > \[vso.code_write\]              | > write access to source code     |
|                                   | > repositories in Azure DevOps.   |
|                                   | > It allows the user to view,     |
|                                   | > create, modify, and delete      |
|                                   | > source code files, branches,    |
|                                   | > and pull requests               |
+-----------------------------------+-----------------------------------+
| > Task Groups (read, create)      | > This permission grants read and |
| > \[vso.taskgroups_write\]        | > create access to task groups in |
|                                   | > Azure DevOps. It allows the     |
|                                   | > user to view existing task      |
|                                   | > groups and create new ones for  |
|                                   | > use in pipelines                |
+-----------------------------------+-----------------------------------+
| > Code (status)                   | > This permission grants access   |
| > \[vso.code_status\]             | > to the status of source code    |
|                                   | > repositories in Azure DevOps.   |
|                                   | > It allows the user to view the  |
|                                   | > status of commits, branches,    |
|                                   | > and pull requests, including    |
|                                   | > build and test status           |
+-----------------------------------+-----------------------------------+

- > Permissions for CI/CD modules:

+-----------------------------------+-----------------------------------+
| > Permission                      | > Description                     |
+===================================+===================================+
| > Agent Pools (Read)              | > Grants access to view           |
|                                   | > information about agent pools   |
|                                   | > used for CI/CD pipelines.       |
+-----------------------------------+-----------------------------------+
| > Analytics (Read)                | > Provides access to view         |
|                                   | > analytics data related to CI/CD |
|                                   | > pipelines and their             |
|                                   | > performance.                    |
+-----------------------------------+-----------------------------------+
| > Auditing (Read Audit Log)       | > Allows access to read the audit |
|                                   | > log, which records actions and  |
|                                   | > events related to CI/CD         |
|                                   | > processes for auditing          |
|                                   | > purposes.                       |
+-----------------------------------+-----------------------------------+
| > Member Entitlement Management   | > Grants access to view and       |
| > (Read)                          | > manage member entitlements      |
|                                   | > related to CI/CD features and   |
|                                   | > resources.                      |
+-----------------------------------+-----------------------------------+
| > Pull Request Threads (Read &    | > Provides permissions to view    |
| > write)                          | > and interact with pull request  |
|                                   | > threads, including adding       |
|                                   | > comments and making             |
|                                   | > modifications.                  |
+-----------------------------------+-----------------------------------+
| > Service Connections (Read)      | > Allows access to view service   |
|                                   | > connections configured for      |
|                                   | > CI/CD pipelines, which are used |
|                                   | > to connect to external services |
|                                   | > and resources.                  |
+-----------------------------------+-----------------------------------+
| > Tokens (Read & manage)          | > Grants permissions to view and  |
|                                   | > manage tokens used for          |
|                                   | > authentication and              |
|                                   | > authorization in CI/CD          |
|                                   | > processes.                      |
+-----------------------------------+-----------------------------------+
| > Variable Groups (Read)          | > Provides access to view         |
|                                   | > variable groups, which contain  |
|                                   | > sets of variables used in CI/CD |
|                                   | > pipelines for configuring and   |
|                                   | > parameterizing builds and       |
|                                   | > releases.                       |
+-----------------------------------+-----------------------------------+

- > Create an egress path to establish the designated route for outbound
  > data transmission from Cortex XSIAM to third party services. For
  > more information about configuring egress paths, refer to
  > [/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2](/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2)

1.  On the Cortex XSIAM console.

    a.  Select Settings \> Data Sources (under Data Collections) \> +
        Data Source.

    b.  Enter Azure Repos in the search bar \> Hover over the displayed
        search result \> Connect.

    - > **Note**

      > Select **Connect Another Instance** if an instance has already
      > been configured.

2.  On the Azure DevOps console.

    a.  Navigate to Organization Settings \> Policies (under Security).

    b.  Enable Third-party application access via OAuth to configure
        integration for both single organization and multiple
        organizations using a single user token.

    - > **Caution**

      > Do not limit authorization scope.

    c.  Navigate to Project Settings \> Settings \> General, and set
        Limit job authorization scope to current project for non-release
        pipelines to Off.

    - This step ensures that Application Security has access to your
      Azure repositories.

- > **Note**

  > For information on Application Security access to all organizations
  > associated with your user token, refer to the Azure [Third party
  > application access via
  > OAuth](https://docs.microsoft.com/en-us/azure/devops/organizations/accounts/change-application-access-policies?view=azure-devops)
  > documentation.

3.  On the Cortex XSIAMconsole.

    a.  Click Authorize.

    b.  Under **Selection Options**, select the repositories to be
        connected to the instance:

        - Permit all existing repositories

        - Permit all existing and future repositories

        - Choose from repository list and select repositories from the
          list

    c.  Click Save.

4.  Verify integration and confirm that the your integrated Azure Repos
    instance has a status of **Connected**.

    a.  On **Data Sources**, search for Azure Repos in the search bar.

    b.  Hover over the resulting entry and click View More.

    c.  Verify that the status of your Azure Repos instance is
        **Connected**.

5.  Next step: View repository assets and mitigate detected issues.

> **Note**
>
> To create an additional Azure Repos instance: Hover over the Azure
> Repos card in the catalog and click **Connect Another**.

######### Manage Azure Repos integrations

To manage Azure Repos integrations, refer to [Manage data source
integrations](#UUIDd7acf796bef8542cb208fac4259fa7ea).

######### Subscribed events

Below is a comprehensive list of events to which Application Security is
subscribed. These events encompass various actions and changes occurring
within your Azure Repos environment that trigger notifications and
integrations with Application Security.

  ---------------------------------------------------------------------------
  Category                Event                       Description
  ----------------------- --------------------------- -----------------------
  Repositories            ---                         ---

  ---                     `git.pullrequest.created`   This event is triggered
                                                      when a new pull request
                                                      is created in a Git
                                                      repository. It allows
                                                      systems to be notified
                                                      whenever a new pull
                                                      request is initiated,
                                                      enabling integration
                                                      with other services or
                                                      actions

  ---                     `git.pullrequest.updated`   This event is triggered
                                                      when an existing pull
                                                      request is updated with
                                                      new changes, comments,
                                                      or other modifications.
                                                      It allows systems to
                                                      stay synchronized with
                                                      the latest changes in
                                                      pull requests

  ---                     `git.push`                  This event is triggered
                                                      when new commits are
                                                      pushed to a Git
                                                      repository. It enables
                                                      systems to track
                                                      changes to the
                                                      repository and perform
                                                      actions such as
                                                      triggering builds or
                                                      running tests

  ---                     `git.pullrequest.merged`    This event is triggered
                                                      when a pull request is
                                                      successfully merged
                                                      into the target branch.
                                                      It allows systems to
                                                      take action after a
                                                      pull request has been
                                                      merged, such as
                                                      deploying changes or
                                                      updating related tasks

  Organizations           ---                         ---

  ---                     `build.complete`            This event is triggered
                                                      when a build process is
                                                      completed within an
                                                      Azure DevOps
                                                      organization. It allows
                                                      systems to react to the
                                                      completion of build
                                                      tasks, such as
                                                      notifying stakeholders
                                                      or triggering
                                                      subsequent stages in a
                                                      deployment pipeline
  ---------------------------------------------------------------------------

####### Bitbucket Cloud

Integrate Application Security with your Bitbucket Cloud version control
system (VCS) to enable security scans for exposed secrets,
infrastructure-as-code (IaC) misconfigurations, vulnerabilities, package
operational risks, and license compliance issues in your repositories.
This integration allows you to analyze, prioritize, and resolve detected
issues efficiently.

######## How to integrate Bitbucket Cloud

> **Prerequisite**
>
> Before you begin:

- > Authorize the user with the following required permissions and
  > scopes to integrate Application Security with your Bitbucket Cloud
  > instances.

<!-- -->

- > **Note**

  > For write access, go to Bitbucket \> **Repository Settings** and
  > grant the user write access to the relevant repositories.

  - > ***Permissions***

    - > **Repository Administrator**: To scan pull requests (PRs), the
      > user performing the integration must have administrative
      > privileges for the repositories. This enables Application
      > Security to set up subscription webhooks for the selected
      > repositories. Additionally, these permissions allow the user to
      > retrieve a comprehensive list of all available repositories

    - > **Member of Project Collection Administrators**: Required to
      > subscribe to the `build.complete` event and download the
      > permissions report for CI/CD scans. As **Organization** owners
      > are automatically part of this group, they also possess this
      > permission

  - > ***Scopes***

    - > **project**: Provides access to view the project or projects.
      > This scope implies the repository scope, giving read access to
      > all the repositories in a project or projects

    - > **Administrator repository permissions**: In order to scan pull
      > requests (PRs), the user performing the integration must have
      > administrative privileges for the repositories. This enables
      > Cortex XSIAM to set up subscription webhooks for the selected
      > repositories

    - > **repository**: Provides read access to a repository or
      > repositories. Note that this scope does not give access to a
      > repository's pull requests. Includes \'access to the repo's
      > source code\', \'clone over HTTPS\', \'access the file browsing
      > API\', \'download zip archives of the repo's contents\', \'the
      > ability to view and use the issue tracker on any repo (created
      > issues, comment, vote, etc)\', \'the ability to view and use the
      > wiki on any repo (create/edit pages)\'

    - > **repository:write**: Provides write (not admin) access to a
      > repository or repositories. No distinction is made between
      > public and private repositories. This scope implicitly grants
      > the **repository** scope, which does not need to be requested
      > separately. This scope alone does not give access to the pull
      > requests API. Includes \'push access over HTTPS\' and \'fork
      > repos\'

    - > **pullrequest**: Provides read access to pull requests. This
      > scope implies the repository scope, giving read access to the
      > pull request's destination repository. Includes \'see and list
      > pull requests\', \'create and resolve tasks\' and \'comment on
      > pull requests\'

    - > **pullrequest:write**: Implicitly grants
      > the **pullrequest** scope and adds the ability to create, merge
      > and decline pull requests. This scope also implicitly grants
      > the **repository:write** scope, giving write access to the pull
      > request's destination repository. This is necessary to allow
      > merging. Includes \'merge pull requests\', \'decline pull
      > requests\', \'create pull requests\' and \'approve pull
      > requests\'

    - > **issue**: The ability to interact with issue trackers the way
      > non-repo members can. This scope doesn't implicitly grant any
      > other scopes and doesn't give implicit access to the repository.
      > Includes \'view, list and search issues\', \'create new
      > issues\', \'comment on issues\', \'watch issues\' and \'vote for
      > issues\'

    - > **issue:write**: This scope implicitly grants the issue scope
      > and adds the ability to transition and delete issues. This scope
      > doesn't implicitly grant any other scopes and doesn't give
      > implicit access to the repository. Includes \'transition
      > issues\' and \'delete issues\'

    - > **webhook**: Gives access to webhooks. This scope is required
      > for any webhook-related operation.

    <!-- -->

    - > This scope gives read access to existing webhook subscriptions
      > on all resources the authorization mechanism can access, without
      > needing further scopes. For example, a client can list all
      > existing webhook subscriptions on a repository. The repository
      > scope is not required. Existing webhook subscriptions for the
      > issue tracker on a repo can be retrieved without the issue
      > scope. All that is required is the webhook scope.

      > To create webhooks, the client will need read access to the
      > resource. Such as: for issue:created, the client will need to
      > have both the webhook and the issue scope. Includes \'list
      > webhook subscriptions on any accessible repository, user, team,
      > or snippet\' and \'create/update/delete webhook subscriptions\'

    <!-- -->

    - > **snippet**: Provides read access to snippets. No distinction is
      > made between public and private snippets (public snippets are
      > accessible without any form of authentication). Includes \'view
      > any snippet\' and \'create snippet comments\'

    - > **email**: Ability to see the user's primary email address. This
      > should make it easier to use Bitbucket Cloud as a login provider
      > for apps or external applications

    - > **account**: When used for:

      - > **user-related API**s: Gives read-only access to the user's
        > account information. Note that this doesn't include any
        > ability to change any of the data. This scope allows you to
        > view the user's: email addresses,language, location, website,
        > full name, SSH keys, user groups

      - > **workspace-related API**s: Grants access to view the
        > workspace's: users, user permissions, projects

    - > **pipeline**: Gives read-only access to pipelines, steps,
      > deployment environments and variables

    - > **pipeline:write**: Gives write access to pipelines. This scope
      > allows a user to: stop pipelines, rerun failed pipelines, resume
      > halted pipelines and trigger manual pipelines

  > For more information on Bitbucket Cloud permissions refer to the
  > [Bitbucket Authentication](https://developer.atlassian.com/cloud/bitbucket/rest/intro/?branch=code-editor-not-limitation#authentication)
  > methods documentation.

<!-- -->

- > CI/CD module permissions: **Administrator** permissions for
  > **projects** and **repositories**

- > Create an egress path to establish the designated route for outbound
  > data transmission from Cortex XSIAM to third party services. For
  > more information about configuring egress paths, refer to
  > [/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2](/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2)

- > Log in to Bitbucket Cloud with the correct user credentials before
  > integrating with Application Security, as Application Security uses
  > OAuth for authorizing access.

1.  On the Cortex XSIAM console.

    a.  Select Settings \> Data Sources (under Data Collections) \> +
        Data Source.

    b.  Enter Bitbucket Cloud in the search bar \> Hover over the
        displayed search result \> Connect.

    - > **Note**

      > Select **Connect Another Instance** if an instance has already
      > been configured.

    c.  Click on the **Configure account** step of the Bitbucket Cloud
        onboarding wizard.

    - You are redirected to Bitbucket Cloud to authorize Application
      Security access.

2.  Authorize Application Security on Bitbucket Cloud: Review the
    requested permissions and then select **Grant access**.

- You are redirected to the **Select Repositories** step of the
  integration wizard.

3.  Choose the repositories to be connected to the instance:

    - Permit all existing repositories

    - Permit all existing and future repositories

    - Choose from repository list and select repositories from the list

4.  Select **Save** to confirm the repository selection and
    then **Close** on the final step of the wizard.

- > **Note**

  > Ensure that you receive the **Instance Successfully Created**
  > message on this step, indicating successful instance creation.

5.  Verify integration and confirm that the your integrated Bitbucket
    Cloud instance has a status of **Connected**.

    a.  On **Data Sources**, search for Bitbucket Cloud in the search
        bar.

    b.  Hover over the resulting entry and click View More.

    c.  Verify that the status of your Bitbucket Cloud instance is
        **Connected**.

6.  Next step: View repository assets and mitigate detected issues.

> **Note**
>
> To create an additional Bitbucket Cloud instance: Hover over the
> Bitbucket Cloud card in the catalog and click **Connect Another**.

######## Manage Bitbucket Cloud integrations

To manage Bitbucket Cloud integrations, refer to [Manage data source
integrations](#UUIDd7acf796bef8542cb208fac4259fa7ea).

######## Subscribed events

Below is a comprehensive list of events to which Application Security is
subscribed (excluding events for the CI/CD module - see below). These
events encompass various actions and changes occurring within your
Bitbucket Cloud environment that trigger notifications and integrations
with Application Security.

- **repo:push**: This event is triggered whenever a push operation
  occurs within a repository, indicating that new commits have been
  added or existing commits have been updated

- **repo:fork**: This event occurs when a repository is forked, creating
  a copy of the original repository within the same or a different
  workspace

- **repo:updated**: This event is triggered when there are updates or
  changes made to the repository settings or configuration

- **repo:commit_comment_created**: This event occurs when a new comment
  is created on a commit within the repository

- **repo:commit_status_created**: This event is triggered when a new
  status or check is created for a commit within the repository

- **repo:commit_status_updated**: This event occurs when the status or
  check of a commit within the repository is updated

- **issue:created**: This event is triggered when a new issue is created
  within the repository

- **issue:comment_created**: This event occurs when a new comment is
  added to an existing issue within the repository

- **issue:updated**: This event is triggered when an existing issue
  within the repository is updated or modified

- **pullrequest:created**: This event occurs when a new pull request is
  created within the repository

- **pullrequest:updated**: This event is triggered when an existing pull
  request within the repository is updated or modified

- **pullrequest:fulfilled**: This event occurs when a pull request is
  fulfilled or merged into the target branch

- **pullrequest:rejected**: This event is triggered when a pull request
  is rejected or closed without being merged

####### Bitbucket Data Center

Integrate Application Security with your Bitbucket Data Center version
control system (VCS) to enable security scans for exposed secrets,
infrastructure-as-code (IaC) misconfigurations, vulnerabilities, package
operational risks, and license compliance issues in your repositories.
This integration allows you to analyze, prioritize, and resolve detected
issues efficiently.

**Supported versions**: This integration supports Bitbucket Data Center
and Data Center Server versions 6.7 and later.

######## How to integrate Bitbucket Data Center

> **Prerequisite**
>
> Before you begin:

- > Authorize the user integrating Application Security with your
  > Bitbucket Data Center instances with the following permissions:

  - > **Member of Project Collection Administrators**: Required to
    > subscribe to the`build.complete` event and download the
    > permissions report for CI/CD scans. As **Organization** owners are
    > automatically part of this group, they also possess this
    > permission

  - > **Read** permissions for projects

  - > **Administrator** permissions for repositories

- > Create an egress path to establish the designated route for outbound
  > data transmission from Cortex XSIAM to third party services. For
  > more information about configuring egress paths, refer to
  > [/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2](/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2)

1.  On Bitbucket Server, create and copy
    a **Personal Access Token** (PAT).

    a.  Navigate to Bitbucket Server \> Manage account \> Account
        settings \> Personal access tokens.

    b.  Provide a token name.

    c.  Select the **Permissions** scope.

        - **Projects**: Read permissions

        - **Repositories**: Administrator permissions

    - > **Note**

      - > By default, the permissions of the access token are set
        > according to your current access level. It is essential to
        > define two levels of
        > permissions, Project and Repository permissions. The
        > Repository permissions inherit from Project permissions,
        > requiring Repository permissions to match or exceed Project
        > permissions

      - > Providing read and write permissions to the necessary
        > repositories enables Application Security to copy files for
        > scanning and access repository settings. This enables
        > automated responses to pull requests, including creating fix
        > PRs and adding comments

    d.  Select the **Expire automatically** option.

    - > **Note**

      > For additional security, it is recommended to set an expiry
      > automatically. The expiry date of a token cannot be changed
      > after it is created. You can see the expiry dates for all your
      > tokens on Profile picture \> Manage account \> Personal access
      > tokens.

    e.  Click Create.

    f.  Copy the generated token from the dialog.

- > **Important**

  > Always refer to
  > the [Bitbucket documentation](https://confluence.atlassian.com/bitbucketserver072/personal-access-tokens-1005335924.html)
  > for information relating to creating a PAT.

2.  On the Cortex XSIAM console.

    a.  Select Settings \> Data Sources (under Data Collections) \> +
        Data Source.

    b.  Enter Bitbucket Data Center in the search bar \> Hover over the
        displayed search result \> Connect.

    - > **Note**

      > Select **Connect Another Instance** if an instance has already
      > been configured.

    c.  Enter your domain in the **Configure Domain** step of the wizard
        and click **Next**.

    d.  Optional: Connect a Transporter: Select your Broker VM and
        associated Transporter applet from the provided menus.

    - > **Note**

      > For more information about the Transporter, including
      > requirements and setup instructions, refer to [Transporter over
      > Broker VM](#UUID5f77f2ed163fe31d458422d9593de4a1).

    e.  Click Next.

    f.  On the **Create a Personal Access Token** step of the wizard:
        Paste the Bitbucket PAT generated in **step 1** above in
        the provided field, and click **Next**.

    g.  Under **Selection Options** of the **Select Repositories** step
        of the wizard:

        - Choose the repositories to be connected to the instance:

          - Permit all existing repositories

          - Permit all existing and future repositories

          - Choose from repository list and select repositories from the
            list

        - Click **Save**.

    h.  Click **Close** on the final step of the wizard.

    - > **Note**

      > Ensure that you receive the **Instance Successfully Created**
      > message on this step, indicating successful instance creation.

3.  Verify integration and confirm that the your integrated Bitbucket
    Data Center instance has a status of **Connected**.

    a.  On **Data Sources**, search for Bitbucket Data Center in the
        search bar.

    b.  Hover over the resulting entry and click View More.

    c.  Verify that the status of your Bitbucket Data Center instance is
        **Connected**.

4.  Next step: View repository assets and mitigate detected issues.

> **Note**
>
> To create an additional Bitbucket Data Center instance: Hover over the
> Bitbucket Data Center card in the catalog and click
> **Connect Another**.

######## Manage Bitbucket Data Center integrations

To manage Bitbucket Data Center integrations, refer to [Manage data
source integrations](#UUIDd7acf796bef8542cb208fac4259fa7ea).

######### Rotate integration tokens

Rotate integration tokens to enhance security and prevent unauthorized
access.

Create
a **PUT** request: `PUT /code/api/v1/integration/token/&<integration_id>` with
the following body:

    {
    "token": "new token"
    }

To locate your integration id:

1.  Under Application Security select Settings \> Data Sources.

2.  Enter Bitbucket Data Center in the search bar \> Hover over the
    displayed search result \> Connect.

- > **Note**

  > Select **Connect Another Instance** if an instance has already been
  > configured.

3.  Select the required instance from the list and retrieve the
    **cas_connector_id ** from the URL.

######## Subscribed events

Below is a comprehensive list of events to which Application Security is
subscribed to within your Bitbucket Data Center environment. The events
are related to core repository and code management actions, but do not
include CI/CD-specific events (For CI/CD events see below). They include
various actions and changes occurring within your Bitbucket Data Center
environment that trigger notifications and integrations with Application
Security.

- **pr:merged**: This event occurs when a pull request is successfully
  merged into the repository

- **pr:updated**: This event happens when the reviewer list for a pull
  request is updated

- **pr:opened**: This event occurs when a new pull request is opened

- **repo:added**: This event happens when a comment is added to the
  repository

- **repo:forked**: This event occurs when a repository is forked

- **repo:refs_changed**: This event happens when references in the
  repository are changed

- **repo:edited**: This event occurs when a comment in the repository is
  edited

- **pr:decline**d: This event occurs when a pull request is declined

- **pr:deleted**: This event happens when a pull request is deleted

- **pr:deleted**: This event occurs when a comment on a pull request is
  deleted

- **repo:deleted**: This event happens when a comment in the repository
  is deleted

- **pr:edited**: This event occurs when a comment on a pull request is
  edited

- **pr:unapproved**: This event happens when a reviewer unapproves a
  pull request

- **pr:modified**: This event occurs when a pull request is modified

- **mirror:repo_synchronized**: This event occurs when a mirrored
  repository is synchronized

- **pr:needs_work**: This event happens when a reviewer marks a pull
  request as needing work

- **pr:approved**: This event occurs when a reviewer approves a pull
  request

- **repo:modified**: This event occurs when the repository is modified

- **pr:added**: This event occurs when a comment is added to a pull
  request

######## Subscribed events for the CI/CD module

These events are specific to the CI/CD module to which Cortex XSIAM is
subscribed. They encompass various actions and changes occurring within
your CI/CD environment that trigger notifications and integrations with
Cortex XSIAM.

  -----------------------------------------------------------------------
  Event                               Description
  ----------------------------------- -----------------------------------
  Project: proj:modified              This event occurs when a project
                                      undergoes modifications, such as
                                      changes to its name, description,
                                      or configuration settings.

  Repository: repo:refs_changed       This event occurs when a push
                                      operation is performed, typically
                                      resulting in changes to the
                                      repository's references.

  Repository: repo:forked             This event occurs when a repository
                                      is forked, creating a separate copy
                                      of the repository under a different
                                      user or organization.

  Repository: repomodified            This event occurs when the
                                      repository itself undergoes
                                      modifications, such as changes to
                                      its settings or configuration.

  Repository: repoadded               This event occurs when a new
                                      comment is added to a commit within
                                      the repository.

  Repository: repoedited              This event occurs when an existing
                                      comment on a commit is edited
                                      within the repository.

  Repository: repodeleted             This event occurs when a comment on
                                      a commit is deleted within the
                                      repository.

  Pull Request: pr:opened             This event occurs when a pull
                                      request is opened, indicating the
                                      initiation of a request to merge
                                      changes into the repository.

  Pull Request: pr:from_ref_updated   This event occurs when the source
                                      branch of a pull request is updated
                                      with new changes.

  Pull Request: pr:to_ref_updated     This event occurs when the target
                                      branch of a pull request is updated
                                      with new changes.

  Pull Request: pr:modified           This event occurs when a pull
                                      request undergoes modifications,
                                      such as changes to its title,
                                      description, or metadata.

  Pull Request: prupdated             This event occurs when the list of
                                      reviewers assigned to a pull
                                      request is updated.

  Pull Request: prapproved            This event occurs when a reviewer
                                      approves a pull request.

  Pull Request: prunapproved          This event occurs when a previously
                                      approved review on a pull request
                                      is revoked.

  Pull Request: prneeds               This event occurs when a reviewer
                                      requests changes to be made to a
                                      pull request before it can be
                                      approved.

  Pull Request: pr:merged             This event occurs when a pull
                                      request is successfully merged into
                                      the repository.

  Pull Request: pr:declined           This event occurs when a pull
                                      request is declined or rejected,
                                      typically due to not meeting
                                      certain criteria or requirements.

  Pull Request: pr:deleted            This event occurs when a pull
                                      request is deleted, either
                                      intentionally by a user or
                                      automatically due to certain
                                      conditions.

  Pull Request: pradded               This event occurs when a new
                                      comment is added to a pull request.

  Pull Request: predited              This event occurs when an existing
                                      comment on a pull request is
                                      edited.

  Pull Request: prdeleted             This event occurs when a comment on
                                      a pull request is deleted.
  -----------------------------------------------------------------------

####### GitHub Cloud

Integrate Application Security with your GitHub SaaS version control
system (VCS) to enable security scans for exposed secrets,
infrastructure-as-code (IaC) misconfigurations, vulnerabilities, package
operational risks, and license compliance issues in your repositories.
This integration allows you to analyze, prioritize, and resolve detected
issues efficiently.

######## How to integrate GitHub SaaS

> **Prerequisite**
>
> Before you begin:

- > Authorize the user integrating Application Security with your GitHub
  > SaaS instances with the following permissions:

  - > **Read ** access to Dependabot alerts, actions, actions variables,
    > administration, deployments, discussions, metadata, packages,
    > repository hooks, secret scanning alerts, secrets, and security
    > events

  - > **Read and write** access to checks, code, commit statuses,
    > issues, and pull requests

  <!-- -->

  - > **Note**

    > In contrast to GitLab SaaS, GitLab self-managed and Azure Repos,
    > there is no individual record of each token used for
    > authentication on the integrations page. However, Application
    > Security retains and uses these tokens for necessary actions.
    > Removing an integration will delete all associated tokens.

- > Create an egress path to establish the designated route for outbound
  > data transmission from Cortex XSIAM to third party services. For
  > more information about configuring egress paths, refer to
  > [/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2](/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2)

1.  On the Cortex XSIAM console.

    a.  Select Settings \> Data Sources (under Data Collections) \> +
        Data Source.

    b.  Enter GitHub (Code Scanning) in the search bar \> Hover over the
        displayed search result \> Connect.

    - > **Note**

      > Select **Connect Another Instance** if an instance has already
      > been configured.

    c.  Click on the **Configure account** step of the GitHub SaaS
        onboarding wizard.

    - You are redirected to your GitHub SaaS account in order to install
      and authorize Cortex AppSec), the GitHub App application handling
      the Application Security functionality.

2.  Install and authorize Cortex AppSec on GitHub SaaS.

    a.  Select your organization on which will be installed.

    b.  Select the repositories to be authorized.

    c.  Review the permissions granted the application.

    d.  Click Install & Authorize.

    - You are redirected to the **Select Repositories** step of the
      GitHub SaaS installation wizard on the console.

      Refer to the [GitHub
      documentation](https://docs.github.com/en/apps/using-github-apps/installing-a-github-app-from-a-third-party)
      for more on authorizing and installing GitHub SaaS Apps.

3.  On the Cortex XSIAM console.

    a.  Under **Selection Options**, choose the repositories to be
        connected to the instance:

        - Permit all existing repositories

        - Permit all existing and future repositories

        - Choose from repository list and select repositories from the
          list

    b.  Click **Save**.

4.  Verify integration: On **Data Sources**, select Code Providers \>
    GitHub SaaS \> View more and confirm that the status of your
    integrated GitHub instance is \'Connected\'.

5.  Verify integration and confirm that the your integrated GitHub SaaS
    instance has a status of **Connected**.

    a.  On **Data Sources**, search for GitHub SaaS in the search bar.

    b.  Hover over the resulting entry and click View More.

    c.  Verify that the status of your GitHub SaaS instance is
        **Connected**.

6.  Next step: View repository assets and mitigate detected issues.

> **Note**
>
> To create an additional GitHub SaaS instance: Hover over the GitHub
> SaaS card in the catalog and click **Connect Another**.

######### Manage GitHub SaaS integrations

To manage GitHub SaaS integrations, refer to [Manage data source
integrations](#UUIDd7acf796bef8542cb208fac4259fa7ea).

######### Subscribed events

Below is a comprehensive list of events to which Application Security is
subscribed. These events encompass various actions and changes occurring
within your GitHub SaaS environment that trigger notifications and
integrations with Application Security.

  -----------------------------------------------------------------------
  Event                               Description
  ----------------------------------- -----------------------------------
  Create                              Indicates the creation of a branch
                                      or tag

  Commit comment                      Refers to comments made on a commit
                                      or a \'diff\' comment, which
                                      compares changes within a commit

  Issues                              Includes a wide range of actions
                                      such as opening, editing, deleting,
                                      transferring, pinning, unpinning,
                                      closing, reopening, assigning,
                                      unassigning, labeling, unlabeling,
                                      milestone management (milestoned,
                                      demilestoned), and locking or
                                      unlocking an issue

  Public                              Denotes changes made to a
                                      repository from private to public

  Pull request                        Represents actions related to pull
                                      requests, including assignment,
                                      enabling or disabling auto merge,
                                      closing, conversion to draft,
                                      demilestoning, dequeuing, editing,
                                      enqueuing, labeling, locking,
                                      milestone assignment, opening,
                                      readiness for review, reopening,
                                      removal of review requests, request
                                      for review, synchronization,
                                      unassignment, unlabeling, and
                                      unlocking

  Pull request review comment         Indicates the creation, editing, or
                                      deletion of a comment on a pull
                                      request's diff

  Push                                Refers to a Git push operation
                                      performed on a repository

  Repository                          Includes actions such as creation,
                                      deletion, archiving, unarchiving,
                                      publicizing, privatizing, editing,
                                      renaming, or transferring of a
                                      repository
  -----------------------------------------------------------------------

####### GitHub Server

Integrate Application Security with your GitHub Server version control
system (VCS) to enable security scans for exposed secrets,
infrastructure-as-code (IaC) misconfigurations, vulnerabilities, package
operational risks, and license compliance issues in your repositories.
This integration allows you to analyze, prioritize, and resolve detected
issues efficiently.

######## How to integrate GitHub Server

> **Prerequisite**
>
> Before you begin:

- > Authorize the user integrating Application Security with your GitHub
  > Server instances with the following permissions and scopes:

  - > **Permissions**

    - > **Organization owner** permissions

    - > **Administrator repository permissions**: In order to scan pull
      > requests (PRs), the user performing the integration must have
      > administrative privileges for the repositories. This enables
      > Cortex XSIAM to set up subscription webhooks for the selected
      > repositories

  - > **Scopes**

    - > **repo**: Grants full access to public and private repositories,
      > including read and write access to code, commit statuses,
      > repository invitations, collaborators, deployment statuses, and
      > the capability to subscribe the repository to receive new
      > webhook notifications or events

    <!-- -->

    - > **Note**

      > In addition to repository-related resources, the repository
      > scope also grants access to manage organization-owned resources,
      > including projects, invitations, team memberships, and webhooks.
      > This scope also grants the ability to manage projects owned by
      > users

    <!-- -->

    - > **read:user**: Grants access to read a user's profile data

    - > **read:repo_hook**: Grants read and ping access to hooks in
      > public or private repositories

    - > **read:org**: Provides read-only access to organization
      > membership, organization projects, and team membership

    - > **read:public_key:** Allows listing and viewing details for
      > public keys

    - > **workflow**: Provides the ability to add and update GitHub
      > Actions workflow files. Workflow files can be committed without
      > this scope if the same file (with both the same path and
      > contents) exists on another branch in the same repository.
      > Workflow files can expose GITHUB_TOKEN, which may have a
      > different set of scopes. For more information, refer to the
      > [GitHub Actions Automatic token
      > authentication](https://docs.github.com/en/actions/security-guides/automatic-token-authentication#permissions-for-the-github_token)
      > token authentication documentation

    - > **admin:org_hook**: Grants read, write, ping, and delete access
      > to organization hooks. Note: OAuth tokens will only be able to
      > perform these actions on organization hooks created by the OAuth
      > app. Personal access tokens will only be able to perform these
      > actions on organization hooks created by a user

- > Create an egress path to establish the designated route for outbound
  > data transmission from Cortex XSIAM to third party services. For
  > more information about configuring egress paths, refer to
  > [/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2](/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2)

1.  On the Cortex XSIAM console.

    a.  Select Settings \> Data Sources (under Data Collections) \> +
        Data Source.

    b.  Enter GitHub Server in the search bar \> Hover over the
        displayed search result \> Connect.

    - > **Note**

      > Select **Connect Another Instance** if an instance has already
      > been configured.

    c.  Enter your domain in the **Configure Domain** step of the
        wizard.

    - > **Note**

      > The domain is the hostname associated with your GitHub Server
      > instance.

    d.  Optional: Connect a Transporter: Select your Broker VM and
        associated Transporter applet from the provided menus.

    - > **Note**

      > For more information about the Transporter, including
      > requirements and setup instructions, refer to [Transporter over
      > Broker VM](#UUID5f77f2ed163fe31d458422d9593de4a1).

    e.  Click Register.

    - You are redirected to your GitHub Server instance to register
      Cortex AppSec as an OAuth application. Additionally, the
      **Register OAUTH App** step of the integration wizard is
      displayed.

    f.  Copy the **Application Name**, **Homepage URL** and
        **Authorization Callback URL** values from their respective
        fields.

2.  On the **Register a new OAuth application** screen of the GitHub
    Server console:

    a.  Paste the values copied in** step 1d** above in their respective
        fields.

    b.  Click Register application.

    c.  Once created, copy and save the the **Client ID **
        and **Client Secret** values for the new Cortex AppSec
        application.

    - Click Authorize to complete the setup.

3.  On the Cortex XSIAM console.

    a.  Select **Next** on the the **Register OAUTH App** step of the
        integration wizard.

    - The **Set Client ID and Secret** step of the wizard is displayed.

    b.  Paste the **Client ID ** and **Client Secret** values copied in
        *step 2c* above, and click Authorize.

    c.  Under **Selection Options** of the Select Repositories step of
        the wizard, choose the repositories to be connected to the
        instance:

        - **Permit all existing repositories**

        - **Permit all existing and future repositories**

        - **Choose from repository list** and select repositories from
          the list

    d.  Click Save.

    e.  Click **Close** on the final step of the wizard.

    - > **Note**

      > Ensure that you receive the **Instance Successfully Created**
      > message on this step, indicating successful instance creation.

4.  Verify integration: On **Data Sources**, select Code ProvidersGitHub
    Server, and confirm the status is \'Connected\'.

5.  Next step: View repository assets and mitigate detected issues.

> **Note**
>
> To create an additional GitHub Server instance: Hover over the GitHub
> Server card in the catalog and click **Connect Another**.

######### Manage GitHub Server integrations

To manage GitHub Server integrations, refer to [Manage data source
integrations](#UUIDd7acf796bef8542cb208fac4259fa7ea).

######### Subscribed events

The following list describes events that Application Security monitors
on your GitHub Server, covering actions and changes that trigger
notifications and integrations.

- **Repository** events: All events related to repositories

- **Organization** events: Includes \[\'`organization`\',
  `'membership`\', \'`team`\'\] events

####### GitLab SaaS

Integrate Application Security with your GitLab SaaS version control
system (VCS) to enable security scans for exposed secrets,
infrastructure-as-code (IaC) misconfigurations, vulnerabilities, package
operational risks, and license compliance issues in your repositories.
This integration allows you to analyze, prioritize, and resolve detected
issues efficiently.

######## How to integrate GitLab SaaS

> **Prerequisite**
>
> Before you begin:

- > Authorize the user integrating Application Security with your GitLab
  > SaaS instances with the following permissions:

  - > **Maintainer** permissions. Grants sufficient permissions to
    > configure external integrations, manage repository access, and
    > adjust CI/CD settings

  - > **api**: Grants full read and write access to the API, including
    > all groups and projects, as well as permissions to interact with
    > the container registry, the dependency proxy, and the package
    > registry

  - > **Administrator repository** permissions: In order to scan pull
    > requests (PRs), the user performing the integration must have
    > administrative privileges for the repositories. This enables
    > Prisma: product_name to set up subscription webhooks for the
    > selected repositories

- > Create an egress path to establish the designated route for outbound
  > data transmission from Cortex XSIAM to third party services. For
  > more information about configuring egress paths, refer to
  > [/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2](/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2)

1.  On the Cortex XSIAM console.

    a.  Select Settings \> Data Sources (under Data Collections) \> +
        Data Source.

    b.  Enter GitLab (Code Scanning) in the search bar \> Hover over the
        displayed search result \> Connect.

    - > **Note**

      > Select **Connect Another Instance** if an instance has already
      > been configured.

    c.  Click on the **Configure account** step of the GitLab SaaS
        onboarding wizard.

    - You are redirected to your GitLab SaaS account in order to install
      and authorize Cortex AppSec, the GitLab App application handling
      the Application Security functionality.

2.  On GitLab SaaS: Review the requested permissions and click
    **Authorize Cortex AppSec**.

- You are redirected to the **Select Repositories** step of the
  installation wizard on the console.

3.  On the Cortex XSIAM console.

    a.  Under **Selection Options**, choose the repositories to be
        connected to the instance:

        - Permit all existing repositories

        - Permit all existing and future repositories

        - Choose from repository list \> select repositories from the
          list

    b.  Click Save.

    - > **Note**

      > A repository can only be integrated with a single instance. The
      > first instance that connects with the repository will be the one
      > that the repository is assigned to. This means that if multiple
      > integrations attempt to connect to the same repository, only the
      > first integration to establish the connection will be associated
      > with that repository.

4.  Verify integration and confirm that the your integrated GitLab SaaS
    instance has a status of **Connected**.

    a.  On **Data Sources**, search for GitLab SaaS in the search bar.

    b.  Hover over the resulting entry and click View More.

    c.  Verify that the status of your GitLab SaaS instance is
        **Connected**.

5.  Next step: View repository assets and mitigate detected issues.

> **Note**
>
> To create an additional GitLab SaaS instance: Hover over the GitLab
> SaaS card and click in the catalog and **Connect Another**.

######## Manage GitLab SaaS integrations

To manage GitLab SaaS integrations, see [Manage VCS
instances](#X027c70e8302f905f654c4928d6cf1923412b1bc).

######## Subscribed events

Below is a comprehensive list of events to which Application Security is
subscribed. These events encompass various actions and changes occurring
within your GitLab SaaS environment that trigger notifications and
integrations with Application Security:

  ----------------------------------------------------------------------------
  Category                Event                        Description
  ----------------------- ---------------------------- -----------------------
  Projects                ---                          ---

  ---                     merge_requests_events        This event is triggered
                                                       when merge or pull
                                                       requests are created,
                                                       updated, merged,
                                                       closed, or have changes
                                                       made to them

  ---                     push_events                  This event occurs
                                                       whenever code changes
                                                       are pushed to a
                                                       repository, indicating
                                                       new commits being added
                                                       to the version control
                                                       history

  ---                     tag_push_events              This event is triggered
                                                       when new tags are
                                                       pushed to a repository

  ---                     note_events                  This event is generated
                                                       when comments or notes
                                                       are added to various
                                                       objects within GitLab,
                                                       such as issues, merge
                                                       requests, or commits

  ---                     confidential_note_events     Similar to note_events,
                                                       but specifically for
                                                       confidential comments
                                                       or notes that are
                                                       restricted to certain
                                                       users or groups

  ---                     issues_events                This event is triggered
                                                       when issues are
                                                       created, updated,
                                                       closed, or have changes
                                                       made to them

  ---                     confidential_issues_events   Similar
                                                       to issues_events, but
                                                       specifically for
                                                       confidential issues
                                                       that are restricted to
                                                       certain users or groups

  ---                     job_events                   This event occurs when
                                                       jobs defined in CI/CD
                                                       pipelines are created,
                                                       updated, started,
                                                       finished, or have
                                                       changes made to them

  ---                     pipeline_events              This event is generated
                                                       when pipelines are
                                                       created, updated,
                                                       started, finished, or
                                                       have changes made to
                                                       them

  ---                     wiki_page_events             This event occurs when
                                                       changes are made to
                                                       wiki pages within
                                                       GitLab, including
                                                       creation, updates, and
                                                       deletions

  ---                     deployment_events            This event is triggered
                                                       when deployments are
                                                       created, updated,
                                                       started, finished, or
                                                       have changes made to
                                                       them

  ---                     releases_events              This event occurs when
                                                       releases are created,
                                                       updated, published, or
                                                       have changes made to
                                                       them

  Groups                  ---                          ---

  ---                     subgroup_events              This event is specific
                                                       to GitLab groups and
                                                       occurs when changes are
                                                       made to subgroups
                                                       within a group
                                                       hierarchy
  ----------------------------------------------------------------------------

####### GitLab self-managed

Integrate Application Security with your GitLab self-managed version
control system (VCS) to enable security scans for exposed secrets,
infrastructure-as-code (IaC) misconfigurations, vulnerabilities, package
operational risks, and license compliance issues in your repositories.
This integration allows you to analyze, prioritize, and resolve detected
issues efficiently.

######## How to integrate GitLab self-managed

> **Prerequisite**

- > Authorize the user integrating Application Security with your GitLab
  > self-managed instances with the following permissions:

  - > **Maintainer** permissions. Grants sufficient permissions to
    > configure external integrations, manage repository access, and
    > adjust CI/CD settings

  - > **api**: Grants full read and write access to the API, including
    > all groups and projects, as well as permissions to interact with
    > the container registry, the dependency proxy, and the package
    > registry

  - > **Administrator repository permissions**: In order to scan pull
    > requests (PRs), the user performing the integration must have
    > administrative privileges for the repositories. This enables
    > Application Security to set up subscription webhooks for the
    > selected repositories

- > Create an egress path to establish the designated route for outbound
  > data transmission from Cortex XSIAM to third party services. For
  > more information about configuring egress paths, refer to
  > [/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2](/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2)

1.  On the Cortex XSIAM console.

    a.  Select Settings \> Data Sources (under Data Collections) \> +
        Data Source.

    b.  Enter GitLab self-managed in the search bar \> Hover over the
        displayed search result \> Connect.

    - > **Note**

      > Select **Connect Another Instance** if an instance has already
      > been configured.

    c.  Enter your domain in the **Configure Domain** step of the wizard
        and click Register.

    - > **Note**

      > The domain is the hostname associated with your GitLab
      > self-managed instance.

      You are redirected to your GitLab self-managed instance to
      register Cortex AppSec as an application. Additionally, the
      **Register OAUTH App** step of the integration wizard is
      displayed.

    d.  Optional: Connect a Transporter: Select your Broker VM and
        associated Transporter applet from the provided menus.

    - > **Note**

      > For more information about the Transporter, including
      > requirements and setup instructions, refer to [Transporter over
      > Broker VM](#UUID5f77f2ed163fe31d458422d9593de4a1).

    e.  Copy the **Application Name**, **Homepage URL** and
        **Authorization Callback URL** values from their respective
        fields.

2.  On the GitLab self-managed console:

    a.  Access GitLab self-managed \> User Settings \> Applications.

    b.  Paste the values copied in** step 1d** above in their respective
        fields.

    c.  Select **api** as the application scope and then Save.

    d.  Once created, copy and save the
        generated **Application ID** and **Secret** values for the new
        Cortex AppSec application.

3.  On the Cortex XSIAM console.

    a.  Select **Next** on the **Register OAUTH App** step of the
        wizard.

    - The **Set Client ID and Secret** step of the wizard is displayed.

    b.  Paste the GitLab self-managed
        **Application ID** and **Secret** values copied in *step 2d*
        above and click Next.

    c.  Under **Selection Options** of the **Select Repositories** step
        of the wizard, choose the repositories to be connected to the
        instance:

        - Permit all existing repositories

        - Permit all existing and future repositories

        - Choose from repository list and select repositories from the
          list

    d.  Click Save.

    e.  Click **Close** on the final step of the wizard.

    - > **Note**

      > Ensure that you receive the **Instance Successfully Created**
      > message on this step, indicating successful instance creation.

4.  Verify integration and confirm that the your integrated GitLab
    self-managed instance has a status of **Connected**.

    a.  On **Data Sources**, search for GitLab self-managed in the
        search bar.

    b.  Hover over the resulting entry and click View More.

    c.  Verify that the status of your GitLab self-managed instance is
        **Connected**.

5.  Next step: View repository assets and mitigate detected issues.

> **Note**
>
> To create an additional GitLab self-managed instance: Hover over the
> GitLab self-managed card in the catalog and click **Connect Another**.

######## Manage GitLab self-managed integrations

To manage GitLab self-managed integrations, refer to [Manage data source
integrations](#UUIDd7acf796bef8542cb208fac4259fa7ea).

######## Subscribed events

Below is a comprehensive list of events to which Application Security is
subscribed. These events encompass various actions and changes occurring
within your GitLab self-managed environment that trigger notifications
and integrations with Application Security.

  ----------------------------------------------------------------------------
  Category                Event                        Description
  ----------------------- ---------------------------- -----------------------
  Projects                ---                          ---

  ---                     merge_requests_events        This event is triggered
                                                       when merge or pull
                                                       requests are created,
                                                       updated, merged,
                                                       closed, or have changes
                                                       made to them

  ---                     push_events                  This event occurs
                                                       whenever code changes
                                                       are pushed to a
                                                       repository, indicating
                                                       new commits being added
                                                       to the version control
                                                       history

  ---                     tag_push_events              This event is triggered
                                                       when new tags are
                                                       pushed to a repository

  ---                     note_events                  This event is generated
                                                       when comments or notes
                                                       are added to various
                                                       objects within GitLab,
                                                       such as issues, merge
                                                       requests, or commits

  ---                     confidential_note_events     Similar to note_events,
                                                       but specifically for
                                                       confidential comments
                                                       or notes that are
                                                       restricted to certain
                                                       users or groups

  ---                     issues_events                This event is triggered
                                                       when issues are
                                                       created, updated,
                                                       closed, or have changes
                                                       made to them

  ---                     confidential_issues_events   Similar
                                                       to issues_events, but
                                                       specifically for
                                                       confidential issues
                                                       that are restricted to
                                                       certain users or groups

  ---                     job_events                   This event occurs when
                                                       jobs defined in CI/CD
                                                       pipelines are created,
                                                       updated, started,
                                                       finished, or have
                                                       changes made to them

  ---                     pipeline_events              This event is generated
                                                       when pipelines are
                                                       created, updated,
                                                       started, finished, or
                                                       have changes made to
                                                       them

  ---                     wiki_page_events             This event occurs when
                                                       changes are made to
                                                       wiki pages within
                                                       GitLab, including
                                                       creation, updates, and
                                                       deletions

  ---                     deployment_events            This event is triggered
                                                       when deployments are
                                                       created, updated,
                                                       started, finished, or
                                                       have changes made to
                                                       them

  ---                     releases_events              This event occurs when
                                                       releases are created,
                                                       updated, published, or
                                                       have changes made to
                                                       them

  Groups                  ---                          ---

  ---                     subgroup_events              This event is specific
                                                       to GitLab groups and
                                                       occurs when changes are
                                                       made to subgroups
                                                       within a group
                                                       hierarchy

  System                  repository_update_events     This event occurs
                                                       whenever there are
                                                       updates or changes made
                                                       to a GitLab repository,
                                                       including actions such
                                                       as new commits, branch
                                                       operations, tag
                                                       updates, and
                                                       modifications to
                                                       repository settings
  ----------------------------------------------------------------------------

###### Onboard CI/CD systems

Onboard CI/CD systems to scan for configuration threats in your
organization\'s instance, pipelines, and individual repositories. By
onboarding supported version control systems (such as GitHub and GitLab)
, you gain out-of-the-box CI/CD scanning capabilities. However, you must
explicitly onboard CircleCI and Jenkins to enable scanning for these
systems.

####### Onboard CircleCI for CI/CD pipeline scans

Integrate Application Security CI/CD Security with your CircleCI system
to enable automated and continuous scanning of your CI/CD pipelines.
This integration provides proactive security checks, triggered by
pipeline events or configuration changes, ensuring security issues are
detected and remediated throughout the entire deployment lifecycle.

Pipeline scans are executed using the Cortex CLI, and include automated
actions based on scan results to enforce security policies and prevent
vulnerable deployments.

> **Note**
>
> CircleCI onboarding offers both code and CI/CD scanning. A single
> integrated instance supports either code or CI scanning, but not both.
> If you require both code and CI scanning for your CircleCi
> environment, you must create two separate integrations, selecting the
> appropriate scanning type for each. To onboard CircleCI for code
> scans, refer to [Onboard CircleCI for code
> scans](#UUID87c2045b6c2dcc2f66afde730c2f231c).
>
> **Prerequisite**
>
> Before you begin:

- > User requirements:

  - > **Permissions**: To enable Cortex XSIAM visibility for all
    > CircleCI projects, a version control system (VCS) user with
    > integration permissions must be authorized. This is because
    > CircleCI\'s user base integrates with the VCS, inheriting its user
    > permissions. For example, if a GitHub user has access to specific
    > organizations and repositories, these entities are visible and
    > available in CircleCI

  - > Best practice: Create a dedicated VCS user to integrate CircleCI
    > with Cortex XSIAM, to prevent the integration breaking if the user
    > leaves the organization

  - > Ensure that the dedicated user follows all the organization's
    > projects in CircleCI

- > Create a personal API token in CircleCI (see step 1 below). This is
  > required to allow reading the configurations from CircleCI for all
  > projects the user has access to

1.  Generate a personal API token on CircleCI.

    a.  Login to your CircleCI instance with your VCS user credentials.

    b.  Create and save a personal API token. For more information about
        CircleCI tokens, refer to
        <https://circleci.com/docs/managing-api-tokens/#creating-a-personal-api-token>.

2.  On the Cortex XSIAM console:

    a.  Select Settings \> Data Sources (under Data Collections) \> +
        Data Source.

    b.  Enter CircleCI in the search bar \> Hover over the displayed
        search result \> Connect.

    - > **Note**

      > Select **Connect Another Instance** if an instance has already
      > been configured.

    c.  On the **Select Integration** step of the integration wizard,
        select CI/CD System Scan \> Next.

    d.  On the **Enable CI/CD system scanning** step of the integration
        wizard:

        i.  Enter an instance name: This can be any name you choose; it
            serves as an alias for your integration.

        ii. Paste the CircleCI personal API token that you generated in
            step 1 above \> Done.

    e.  Verify that the **Instance Successfully Created** message is
        displayed in the last step of the wizard and click Close.

3.  Verify integration and confirm that the your integrated CircleCI
    instance has a status of **Connected**.

    a.  On **Data Sources**, enter **CircleCI** in the search bar.

    b.  Hover over the resulting entry and click
        **\[number of instances\] Configured**.

    - Verified that your connected CircleCI instance displays a
      **Connected** status.

    c.  Hover over the CircleCI instance and select View Details.

    d.  Verify that the status of your CircleCI instance is
        **Connected** and that **Pipeline Risks** is the instance type.

4.  Next step: View scan results and mitigate issues.

> **Note**
>
> To add an additional CircleCI instance, navigate to Settings \> Data
> Sources \> select the menu for your connected CircleCI instance \> +
> New Instance, and repeat the onboarding steps above.

####### Onboard Jenkins for CI/CD pipeline scans

Integrate Application Security CI/CD Security with your Jenkins servers
to enable automated and continuous scanning of your CI/CD pipelines.
This integration provides proactive security checks, triggered by
pipeline events or configuration changes, ensuring security issues are
detected and remediated throughout the entire deployment lifecycle.

Pipeline scans are executed using the Cortex CLI, and include automated
actions based on scan results to enforce security policies and prevent
vulnerable deployments.

> **Note**
>
> Jenkins onboarding offers both code and CI/CD scanning. A single
> integrated instance supports either code or CI scanning, but not both.
> If you require both code and CI scanning for your Jenkins servers, you
> must create two separate integrations, selecting the appropriate
> scanning type for each. To onboard Jenkins for code scans, refer to
> [Onboard Jenkins for code
> scans](#UUIDe19ef3bfa20962cafdd7c839ab6318fe).
>
> **Prerequisite**

- > Permissions

- > Create an egress path to establish the designated route for outbound
  > data transmission from Cortex XSIAM to third party services. For
  > more information about configuring egress paths, refer to
  > [/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2](/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2)

The Application Security plugin is integrated with your Jenkins system.

> **Note**
>
> Always refer to the official [Jenkins
> documentation](https://www.jenkins.io/doc/book/managing/plugins/) when
> installing plugins on Jenkins servers.

1.  On the Cortex XSIAM console:

    a.  Select Settings \> Data Sources (under Data Collections) \> +
        Data Source.

    b.  Enter Jenkins in the search bar \> Hover over the displayed
        search result \> Connect.

    - > **Note**

      > Select **Connect Another Instance** if an instance has already
      > been configured.

2.  On the Select Integration step of the wizard, select CI/CD System
    Scan \> Next.

3.  On the **Create Instance** step of the integration wizard: Provide
    a Jenkins plugin connector name \> Next.

4.  On the **Plugin installation** step of the wizard:

    a.  Click Download to download the Application Security
        Jenkins `prisma-cloud.hpi` plugin file.

    b.  Copy and save the generated **JWT** token.

    c.  Click Done.

    - > **Note**

      > The integration is added on the console but integration is
      > pending, and will only be completed after completing step 5
      > below. You can view the pending integration on the Jenkins
      > Instances page: Select Data Sources \> Jenkins \> View Details.
      > The type of integration is **Pipeline Risks**

5.  Install and configure the Cortex XSIAM plugin on your Jenkins
    server:

    a.  Open Jenkins and select: Manage Jenkins \> Plugins (under System
        Configuration) \> Advanced settings.

    b.  Select Choose File (under the Deploy Plugin section) \> browse
        for the PrismaCloud Plugin.hpi file \> Upload \> Deploy.

    c.  Configure the plugin:

        i.  Open Jenkins \> Select Manage Jenkins \>
            System (under System Configuration) \> Cortex XSIAM.

        ii. Fill in the provided fields:

            - **Cortex JWT Token**: Paste the JWT token copied in
              *step 4b* above.

            - **Cortex Reports Recurrence Period** (Value: minutes): The
              frequency with which reports are generated. We recommend
              that you do not change the default value

        iii. Click Save.

> **Note**
>
> To add an additional Jenkins instance, navigate to Settings \> Data
> Sources \> select the menu for your connected Jenkins instance \> +
> New Instance, and repeat the onboarding steps above.

###### Integrate CI tools

By integrating CI tools, you get two main benefits: code scans and
streamlined security workflows. This is achieved by inserting code
snippets directly into your existing CI workflows, which then use the
Cortex CLI to trigger automated security checks. This integration
enables the platform to scan and detect exposed secrets,
misconfigurations in your infrastructure-as-code (IaC) files,
vulnerabilities in your Software Composition Analysis (SCA) packages and
license non-compliance within your CI/CD pipelines.

You can integrate your CI tools and systems through the platform wizard
or by directly adding a code snippet to your pipelines in supported
systems.

####### Integrate CI tools via the tenant UI wizard

Application Security supports the following CI tools for onboarding via
the UI wizard:

- [AWS CodeBuild](#UUID7a2f8cf64d3188dc808984df3f4643d4)

- [CircleCI](#UUID87c2045b6c2dcc2f66afde730c2f231c)

<!-- -->

- > **Note**

  > For CircleCI CI/CD pipeline scans, refer to
  > [CI/CD](#UUID3fdd5b7adedbf4d17bdb9f062d7a5959) .

<!-- -->

- [Cortex CLI](#UUIDb88d52a7f91d2740c00cf7756a227ae8). For information
  about Cortex CLI usage, refer to
  [#UUID479c01b6c5644b12c22da36a823a69af](#UUID479c01b6c5644b12c22da36a823a69af)

- [GitHub Actions](#UUIDa9c761fc593d1f91c877f88d5a18ddde)

- [Jenkins](#UUIDe19ef3bfa20962cafdd7c839ab6318fe)

<!-- -->

- > **Note**

  > For Jenkins CI/CD pipeline scans, refer to
  > [CI/CD](#UUIDc6e57072fd95993a6cc924683c352ad6) .

<!-- -->

- [/document/preview/1085339#UUID-536df3d4-0394-7605-8cf1-573622359880](/document/preview/1085339#UUID-536df3d4-0394-7605-8cf1-573622359880)

- [/document/preview/1085341#UUID-f094c5dd-d64a-81b8-9ac8-16b33e994618](/document/preview/1085341#UUID-f094c5dd-d64a-81b8-9ac8-16b33e994618)

You can perform the following actions on CI tools. To access CI tool
management, navigate to Settings \> Data Sources \> hover over a CI tool
and click View Details.

- **Delete an instance**: Right-click on an instance of the CI tool \>
  Delete instance \> Delete

- **Remove a connected repository**: Select an instance of the CI \>
  right-click on a repository \> Remove Repository

- **Select the repository branches** to be scanned: Select an instance
  of the CI \> right-click on a repository \> Set Scanned Branches \>
  select a branch/multiple branches \> Save

- Perform a **manual scan** of the repository: Select an instance of the
  CI \> right-click on a repository \> Scan Repository \> select a
  branch/multiple branches

####### AWS CodeBuild

Integrate Application Security with your AWS CodeBuild instance to allow
dynamic, automated, and context-specific scans within your development
workflow. This includes continuous scanning of your workflow whenever
changes are pushed or triggered, integrating security checks, and
catching issues as soon as they are introduced. Additionally, it
automates shift-left actions such as notifying developers or creating
tickets, based on scan results.

> **Prerequisite**
>
> Before you begin:

- > Grant **Administrator ** permissions to the user integrating AWS
  > CodeBuild with Application Security

- > Create an egress path to establish the designated route for outbound
  > data transmission from Cortex XSIAM to third party services. For
  > more information about configuring egress paths, refer to
  > [/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2](/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2)

1.  On the Cortex XSIAM console:

    a.  Select Settings \> Data Sources (under Data Collections) \> +
        Data Source.

    b.  Enter AWS CodeBuild in the search bar \> Hover over the
        displayed search result \> Connect.

    - > **Note**

      > Select **Connect Another Instance** if an instance has already
      > been configured.

    c.  On the **Add Environment Variables** step of the AWS CodeBuild
        integration wizard.

        i.  Select Generate API key.

        - The API key secret and API key ID values are generated and
          populate their respective fields.

        ii. Select the system architecture that your tool runs on.

        iii. Click Next.

2.  Store your generated Cortex XSIAM API key and API key ID in AWS
    Secrets Manager.

    - If you have an API key.

      i.  Copy the **CORTEX_API_KEY** and **CORTEX_API_KEY_ID** variable
          names from their respective fields in the wizard.

      ii. Add the **CORTEX_API_KEY** and **CORTEX_API_KEY_ID** and their
          corresponding values as separate environment variables
          (secrets) to the AWS Secrets Manager.

    - If you do not have an API key:

      i.  Click Generate API key \> Copy the CORTEX_API_KEY and
          CORTEX_API_KEY_ID and their corresponding values from their
          respective fields.

      ii. Add the **CORTEX_API_KEY** and **CORTEX_API_KEY_ID** and their
          corresponding values as separate environment variables
          (secrets) to the AWS Secrets Manager.

- > **Note**

  > Do not change the names of the environment variables provided by
  > Cortex XSIAM. They are required for proper integration and
  > functionality.

  For more information on storing secrets in AWS Secrets Manager, refer
  to [AWS Secrets Manager
  Documentation](https://docs.aws.amazon.com/secretsmanager/).

3.  Grant the **IAM service role** associated with your AWS CodeBuild
    project the necessary permissions to read the Cortex XSIAM API key
    and Cortex XSIAM API key ID from AWS Secrets Manager.

4.  Copy and paste the pre-populated sample code from
    the **Configure Subscription** step of the integration wizard into
    your `buildspec.yaml` configuration.

- > **Note**

  > The code is only a reference. Replace the placeholder values with
  > your build-specific values.

5.  Select Done in the wizard.

6.  Ensure that the **Connector Created Successfully** message is
    displayed in the final step of the wizard, and click **Close**.

7.  Verify integration and confirm that the your integrated AWS
    CodeBuild instance has a status of **Connected**.

    a.  On **Data Sources**, search for AWS CodeBuild in the search bar.

    b.  Hover over the resulting entry and click View Details.

    c.  Verify that the status of your AWS CodeBuild instance is
        **Connected**.

8.  Next step: View scan results and mitigate issues.

> **Note**
>
> To add an additional AWS CodeBuild instance, navigate to Settings \>
> Data Sources \> select the menu for your connected AWS CodeBuild
> instance \> + New Instance, and repeat the onboarding steps above.

######## AWS CodeBuild code scan workflow template

This AWS CodeBuild workflow example automates code scanning using the
Cortex CLI. The workflow contains placeholder values (often in brackets)
and generic terms (such as dev) that you must replace with your
environment-specific information before use.

    version: 0.2

    env:
      variables:
        CORTEX_API_URL: "https://api-viso-hdkbzk6qphxpbehy758elo.xdr-qa2-uat.us.paloaltonetworks.com"
        CORTEX_CLI_VERSION: "0.8.11"
      secrets-manager:
        CORTEX_API_KEY: "CORTEX_API_KEY"
        CORTEX_API_KEY_ID: "CORTEX_API_KEY_ID"

    phases:
      install:
        runtime-versions:
          docker: 19
        commands:
          - echo "Installing dependencies"
          - yum -y update
          - yum -y install jq curl

      pre_build:
        commands:
          - echo "Fetching temporary token"
          - |
            export TOKEN_RESPONSE=$(curl --location "${CORTEX_API_URL}/public_api/cas/v1/cortex-cli/create-token" \
                                     --header "Authorization: ${CORTEX_API_KEY}" \
                                     --header "x-xdr-auth-id: ${CORTEX_API_KEY_ID}" \
                                     --header "Content-Type: application/json" \
                                     --data "{}" -s)
          - export TEMP_TOKEN=$(echo "$TOKEN_RESPONSE" | jq -r '.token')
          - echo "Temporary token fetched"

          - echo "Pulling Docker image"
          - docker pull --platform linux/arm64 distributions-dev.traps.paloaltonetworks.com/cli-docker/${TEMP_TOKEN}/method:arm64-${CORTEX_CLI_VERSION}-dev

          - echo "Tagging Docker image"
          - docker tag distributions-dev.traps.paloaltonetworks.com/cli-docker/${TEMP_TOKEN}/method:arm64-${CORTEX_CLI_VERSION}-dev cortexcli:${CORTEX_CLI_VERSION}

          - echo "Setting Extra Environment Variables"
          - |
            export CODEBUILD_ACCOUNT_ID=$(aws sts get-caller-identity --query 'Account' --output text)
            export CODEBUILD_GIT_BRANCH="$(git symbolic-ref HEAD --short 2>/dev/null)"
            if [ "$CODEBUILD_GIT_BRANCH" = "" ] ; then
              export CODEBUILD_GIT_BRANCH="$(git rev-parse HEAD | xargs git name-rev | cut -d' ' -f2 | sed 's/remotes\/origin\///g')"
            fi
            export CODEBUILD_PROJECT=${CODEBUILD_BUILD_ID%:$CODEBUILD_LOG_PATH}

            echo "==> AWS CodeBuild Extra Environment Variables:"
            echo "==> CODEBUILD_ACCOUNT_ID = $CODEBUILD_ACCOUNT_ID"
            echo "==> CODEBUILD_GIT_BRANCH = $CODEBUILD_GIT_BRANCH"
            echo "==> CODEBUILD_PROJECT = $CODEBUILD_PROJECT"

      build:
        commands:
          - echo "Running Docker container"
          - |
            docker run --rm --platform linux/arm64 cortexcli:${CORTEX_CLI_VERSION} \
                       --api-base-url ${CORTEX_API_URL} \
                       --api-key ${CORTEX_API_KEY} \
                       --api-key-id ${CORTEX_API_KEY_ID} \
                       code scan \
                       --directory . \
                       --repo-id $CODEBUILD_ACCOUNT_ID/$CODEBUILD_PROJECT \
                       --branch $CODEBUILD_GIT_BRANCH

####### Onboard CircleCI for code scans

Integrate Application Security with your CircleCI system to allow
dynamic, automated, and context-specific code scans across your
codebase. This integration provides continuous scanning of your
workflows, triggered by code changes or pipeline events, ensuring
security checks are performed and issues are detected as early as
possible.

Code scans are executed using the Cortex CLI, and include automated
shift-left actions based on scan results.

> **Note**
>
> CircleCI onboarding offers both code and CI/CD scanning. A single
> integrated instance supports either code or CI scanning, but not both.
> If you require both code and CI scanning for your CircleCi
> environment, you must create two separate integrations, selecting the
> appropriate scanning type for each. To onboard CircleCI for CI/CD
> scans, refer to [Onboard CircleCI for CI/CD pipeline
> scans](#UUID3fdd5b7adedbf4d17bdb9f062d7a5959).
>
> **Prerequisite**
>
> Before you begin:

- > Grant **Administrator** permissions to the user integrating
  > Application Security with CircleCI

- > Create an egress path to establish the designated route for outbound
  > data transmission from Cortex XSIAM to third party services. For
  > more information about configuring egress paths, refer to
  > [/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2](/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2)

1.  On the Cortex XSIAM console:

    a.  Select Settings \> Data Sources (under Data Collections) \> +
        Data Source.

    b.  Enter CircleCI in the search bar \> Hover over the displayed
        search result \> Connect.

    - > **Note**

      > Select **Connect Another Instance** if an instance has already
      > been configured.

2.  On the **Select Integration** step of the CircleCI integration
    wizard, select Code Scan \> Next.

3.  On the **Add Environment Variables** step of the wizard.

    a.  Select Generate API key.

    - The API key secret and API key ID values are generated and
      populate their respective fields.

    b.  Select your system architecture.

    c.  Click Next.

4.  Create a context in CircleCI and name it **cortex-secrets**.

- > **Important**

  > The **cortex-secrets** naming convention for the context is
  > mandatory to ensure functionality and must not be changed.

5.  Store your Cortex XSIAM API Key and API ID within the
    **cortex-secrets** context.

    - If you have an API key:

      i.  Copy the **CORTEX_API_KEY** and **CORTEX_API_KEY_ID** variable
          names from their respective fields in the wizard.

      ii. Add the **CORTEX_API_KEY** and **CORTEX_API_KEY_ID** and their
          corresponding values as separate environment variables
          (secrets) to the **cortex-secrets** context.

    - If you do not have an API key:

      i.  Click Generate API key \> Copy the CORTEX_API_KEY and
          CORTEX_API_KEY_ID and their corresponding values from their
          respective fields.

      ii. Add the **CORTEX_API_KEY** and **CORTEX_API_KEY_ID** and their
          corresponding values as separate environment variables to the
          **cortex-secrets** context.

- > **Note**

  > Do not change the names of the environment variables provided by
  > Cortex XSIAM. They are required for proper integration and
  > functionality.

  For more information on context in CircleCI, refer to [Using contexts
  in CircleCI](https://circleci.com/docs/contexts/).

6.  Copy and paste the pre-populated code from the
     **Configure Job** step of the integration wizard into your
    `.circleci/config.yaml` file, and click Done.

7.  In your `.circleci/config.yaml` file:

    - Verify that the YAML file includes a Docker container image

    - Verify that the context is `cortex-secrets`

    - In the `docker run` command, replace
      `--repo-id REPO_OWNER/REPO_NAME` values with your repository owner
      and repository name

8.  Check that the
    **The integration will be created once CircleCI authorizes** message
    is displayed in the final step of the wizard and click Close .

9.  Verify integration and confirm that the your integrated CircleCI
    instance has a status of **Connected**.

    a.  On **Data Sources**, search for CircleCI in the search bar.

    b.  Hover over the resulting entry and click View Details.

    c.  Verify that the status of your CircleCI instance is
        **Connected** and that the instance type **Code** is displayed.

10. Next step: View scan results and mitigate issues.

> **Note**
>
> To add an additional CircleCI instance, navigate to Settings \> Data
> Sources \> select the menu for your connected CircleCI instance \> +
> New Instance, and repeat the onboarding steps above.

######## CircleCI code scan workflow template

This circle workflow example automates code scanning using the Cortex
CLI. The workflow contains placeholder values (often in brackets) and
generic terms (such as dev) that you must replace with your
environment-specific information before use

    version: 2.1

    executors:
      docker-executor:
        docker:
          - image: cimg/base:stable  # Replace with a suitable image or executor
        environment:
          CORTEX_API_URL: "https://{CORTEX_URL}
          CORTEX_CLI_VERSION: "0.8.11"

    jobs:
      setup-environment:
        executor: docker-executor
        steps:
          - checkout
          - setup_remote_docker
          - run:
              name: Get Temporary Token and Pull Docker Image
              command: |
                export TOKEN_RESPONSE=$(curl --location "${CORTEX_API_URL}/public_api/cas/v1/cortex-cli/create-token" \
                                            --header "Authorization: ${CORTEX_API_KEY}" \
                                            --header "x-xdr-auth-id: ${CORTEX_API_KEY_ID}" \
                                            --header "Content-Type: application/json" \
                                            --data "{}" -s)
                export TEMP_TOKEN=$(echo "$TOKEN_RESPONSE" | jq -r '.token')
                docker pull distributions-dev.traps.paloaltonetworks.com/cli-docker/${TEMP_TOKEN}/method:amd64-${CORTEX_CLI_VERSION}-dev
                docker tag distributions-dev.traps.paloaltonetworks.com/cli-docker/${TEMP_TOKEN}/method:amd64-${CORTEX_CLI_VERSION}-dev cortexcli:${CORTEX_CLI_VERSION}
          - run:
              name: Run Cortex CLI Container
              # Replace owner/repo with your actual repository information
              command: |
                docker run --rm cortexcli:${CORTEX_CLI_VERSION} \
                            --api-base-url ${CORTEX_API_URL} \
                            --api-key ${CORTEX_API_KEY} \
                            --api-key-id ${CORTEX_API_KEY_ID} \
                            code scan \
                            --directory . \
                            --repo-id <REPLACE WITH REPO_OWNER/REPO_NAME> \
                            --branch "${CIRCLE_BRANCH}"

    workflows:
      version: 2
      build:
        jobs:
          - setup-environment:
              context: cortex-secrets

####### Connect Cortex CLI

Connect Cortex CLI to scan supported Cortex Cloud modules and gain
insights into your security posture, enabling you to identify, analyze
and address potential risks.

> **Prerequisite**

- > Permissions: Grant the user installing the CLI required permissions.
  > For more information refer to
  > [/document/preview/1203998#UUID-5f83dcd6-a392-b2c7-a864-65407ab6bfa6_section-idm234735378274209](/document/preview/1203998#UUID-5f83dcd6-a392-b2c7-a864-65407ab6bfa6_section-idm234735378274209)

- > Create an egress path to establish the designated route for outbound
  > data transmission from Cortex XSIAM to third party services. For
  > more information about configuring egress paths, refer to
  > [/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2](/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2)

- > Best Practice (Mandatory for SCA vulnerability suppression):

  - > Run the CLI within your current working directory
    > (\<current_directory_path\>). It is recommended to use the
    > absolute file path for your current working directory

  - > Ensure that the `--repo-id` parameter includes
    > the `<repo_owner_name>/<repo_name>` structure, with
    > the `<repo_name>` matching the exact name of the directory

  <!-- -->

  - Example
    > The present working directory is `Users/test/<repo_name>`.
    > Therefore, the `--repo-id` parameter must
    > be `--repo-id <repo_owner_name>/<repo_name>`, ensuring
    > that `<repo_name>` precisely matches the directory name within the
    > structure.

1.  Navigate to Settings \> Data Sources (Under Data Collections) \> +
    Data Source \> Show More \> CI/CD.

- > **Tip**

  > You can also locate your CI tool by typing its name (such as
  > Jenkins) into the search bar on the **Add Data Source** page after
  > selecting **+ Data Sources**.

2.  Hover over **Cortex CLI** and click Connect.

- > **Tip**

  > You can enter \'CLI\' in the search bar to locate the Cortex CLI
  > tool.

3.  In the **Configure** step of the integration wizard: Select your
    operating system \> Next.

- > **Note**

  > You can view the latest version of the selected OS.

4.  On The **Authenticate** step of the wizard.

    a.  Generate an API:

        i.  Select Generate API key.

        - > **Note**

          - > Recommended: Select **With upload results permissions**
            > before generating the API key. This option grants the key
            > permission to not only access data but also
            > to upload or send data back. In the API Keys page, the
            > role associated with these permissions is `CLI`. If you
            > choose to upload without results permissions, the
            > associated role is `CLI Read Only`

          - > **Warning**: Using **With upload results** permissions may
            > incur additional costs as per the license agreement

        ii. Copy the the generated `API Key ID` and `API key` that are
            displayed in their respective fields.

    b.  Download and save the CLI tool to your system: Options:

        - Download the binary: Click the download button next to the
          curl command

        - Copy the curl command and paste it in your terminal. Replace
          the `${CORTEX_API_KEY_ID}` and `${CORTEX_API_KEY}` in the code
          with the values generated in **step 4 a** above

    c.  Click Done.

5.  Make the `cortexcli` file executable: In your terminal, run
    `chmod +x cortexcli`

> **Note**
>
> To add an additional CLI instance, navigate to Settings \> Data
> Sources \> select the menu for your connected CLI instance \> + New
> Instance, and repeat the onboarding steps.

######## Cortex CLI usage

To execute a Cortex CLI scan, run
`cortexcli [global flags] [module name] scan [module flags]`.

     cortexcli --api-base-url<value> --api-key <value> --api-key-id <value> code scan --branch
       <value> --repo-id <value> --directory <value> <more flags as needed>

**Command breakdown**

- `cortexcli` acts as the global option, establishing the environment
  for subsequent Cortex CLI commands

- **Global flags**:

  - `--api-base-url<value>`

  - `--api-key<value>`

  - `--api-key-id<value>`

- **Module Name**: Select the module (environment) to be scanned:

  - `api` for API Security. For more information on API Security scans,
    refer to [Cortex CLI for API
    Security](#UUIDb1ffc59aa0e6d095fb27175615393ebe)

  - `image` for CWP. For more information on CWP scans, refer to [Cortex
    CLI for Cloud Workload
    Protection](#UUID2aaaaa4730b7203d8fe6833d61c99f3d)

- **Module flags**: The flags available for the selected command. There
  are flags common to all environments - refer to [Cortex CLI common
  command line reference guide](#UUID692df6034f88296f74eba572bb9ff237),
  and specific flags for individual environments

####### GitHub Actions

Integrate Application Security with GitHub Actions to allow dynamic,
automated, and context-specific scans within your development workflow.
This includes continuous scanning of your workflows whenever changes are
pushed or triggered, integrating security checks, and detecting issues
as soon as they are introduced.

######## How to integrate GitHub Actions

> **Prerequisite**
>
> Before you begin:

- > Grant **Administrator ** permissions to the user integrating GitHub
  > Actions with Application Security

- > Create an egress path to establish the designated route for outbound
  > data transmission from Cortex XSIAM to third party services. For
  > more information about configuring egress paths, refer to
  > [/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2](/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2)

1.  On the Cortex XSIAM console:

    a.  Select Settings \> Data Sources (under Data Collections) \> +
        Data Source.

    b.  Enter GitHub Actions in the search bar \> Hover over the
        displayed search result \> Connect.

    - > **Note**

      > Select **Connect Another Instance** if an instance has already
      > been configured.

2.  On the **Add Environment Variables** step of the wizard.

    a.  Select Generate API key.

    - The API key secret and API key ID values are generated and
      populate their respective fields.

    b.  Optional: Change the default system architecture detected by the
        system.

    c.  Click Next.

3.  Store your Cortex XSIAM API key and API key ID in the GitHub Actions
    Secrets credential store.

    - If you have an API key:

      i.  Copy the **CORTEX_API_KEY** and **CORTEX_API_KEY_ID** variable
          names from their respective fields in the wizard.

      ii. Add the **CORTEX_API_KEY** and **CORTEX_API_KEY_ID** and their
          corresponding values as separate environment variables
          (secrets) to the GitHub Actions Secrets credential store.

    - If you do not have an API key:

      i.  Click Generate API key \> Copy the CORTEX_API_KEY and
          CORTEX_API_KEY_ID and their corresponding values from their
          respective fields.

      ii. Add the **CORTEX_API_KEY** and **CORTEX_API_KEY_ID** and their
          corresponding values as separate environment variables
          (secrets) to the GitHub Actions Secrets credential store.

- > **Note**

  > Do not change the names of the environment variables provided by
  > Cortex XSIAM. They are required for proper integration and
  > functionality.

  For more information on passing secrets as environment variables to
  GitHub Actions, refer to [Using secrets in GitHub
  Actions](https://docs.github.com/actions/security-guides/encrypted-secrets).

4.  Copy and paste the pre-populated sample code from the Configure Job
    step of the integration wizard into your GitHub Actions job
    configuration \> Done.

- > **Note**

  > The code is only a reference. Replace the placeholder values with
  > your build-specific values.

5.  Ensure that the **Connector Created Successfully** message is
    displayed in the final step of the wizard, and click **Close**.

6.  Verify integration and confirm that the your integrated GitHub
    Actions instance has a status of **Connected**.

    a.  On **Data Sources**, search for GitHub Actions in the search
        bar.

    b.  Hover over the resulting entry and click View Details.

    c.  Verify that the status of your GitHub Actions instance is
        **Connected**.

7.  Next step: View scan results and mitigate issues.

> **Note**
>
> To add an additional GitHub Actions instance, navigate to Settings \>
> Data Sources \> select the menu for your connected GitHub Actions
> instance \> + New Instance, and repeat the onboarding steps above.

######## GitHub Actions code scan workflow template

This GitHub Actions workflow example automates code scanning using the
Cortex CLI. The workflow contains placeholder values (often in brackets)
and generic terms (such as `dev`) that you must replace with your
environment-specific information before use.

    name: Cortex CLI Code Scan

    on:
      push:
        branches:
          - main
      workflow_dispatch:

    env:
      CORTEX_API_KEY: ${{secrets.CORTEX_API_KEY}}
      CORTEX_API_KEY_ID: ${{secrets.CORTEX_API_KEY_ID}}
      CORTEX_API_URL: https://<CORTEX_URL>
      CORTEX_CLI_VERSION: 0.8.11
      
    jobs:
      download-and-execute:
        runs-on: ubuntu-latest

        steps:
        - name: Checkout Repository
          uses: actions/checkout@v2
        
        - name: Set up QEMU
          uses: docker/setup-qemu-action@v2
          with:
            platforms: arm64
            
        - name: Install Dependencies
          run: |
            sudo apt-get update
            sudo apt-get install -y jq curl

        - name: Get Temporary Token
          run: |
            TOKEN_RESPONSE=$(curl --location "${CORTEX_API_URL}/public_api/cas/v1/cortex-cli/create-token" \
              --header "Authorization: ${CORTEX_API_KEY}" \
              --header "x-xdr-auth-id: ${CORTEX_API_KEY_ID}" \
              --header 'Content-Type: application/json' \
              --data '{}')
            TEMP_TOKEN=$(echo $TOKEN_RESPONSE | jq -r '.token')
            echo "TEMP_TOKEN=$TEMP_TOKEN" >> $GITHUB_ENV

        - name: Pull Docker Image
          run: |
            docker pull distributions-dev.traps.paloaltonetworks.com/cli-docker/${{env.TEMP_TOKEN}}/method:arm64-${{env.CORTEX_CLI_VERSION}}-dev
            docker tag distributions-dev.traps.paloaltonetworks.com/cli-docker/${{env.TEMP_TOKEN}}/method:arm64-${{env.CORTEX_CLI_VERSION}}-dev cortexcli:${{env.CORTEX_CLI_VERSION}}

        - name: Run Docker Container
          run: |
            docker run --rm --platform linux/arm64 cortexcli:${{env.CORTEX_CLI_VERSION}} \
              --api-base-url ${CORTEX_API_URL} \
              --api-key ${CORTEX_API_KEY} \
              --api-key-id ${CORTEX_API_KEY_ID} \
              code scan \
              --directory . \
              --repo-id ${{github.repository}}

####### Onboard Jenkins for code scans

Integrate Application Security with your Jenkins server to allow
dynamic, automated, and context-specific code scans across your
codebase. This integration provides continuous scanning of your
workflows, triggered by code changes or pipeline events, ensuring
security checks are performed and issues are detected as early as
possible.

Code scans are executed using the Cortex CLI, and include automated
shift-left actions based on scan results.

> **Note**
>
> Jenkins onboarding offers both code and CI/CD scanning. A single
> integrated instance supports either code or CI scanning, but not both.
> If you require both code and CI scanning for your Jenkins servers, you
> must create two separate integrations, selecting the appropriate
> scanning type for each. To onboard Jenkins for CI/CD scans, refer to
> [Onboard Jenkins for CI/CD pipeline
> scans](#UUIDc6e57072fd95993a6cc924683c352ad6).
>
> **Prerequisite**

- > Grant **Administrator** permissions to the user integrating
  > Application Security with Jenkins

- > Create an egress path to establish the designated route for outbound
  > data transmission from Cortex XSIAM to third party services. For
  > more information about configuring egress paths, refer to
  > [/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2](/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2)

1.  On the Cortex XSIAM console:

    a.  Select Settings \> Data Sources (under Data Collections) \> +
        Data Source.

    b.  Enter Jenkins in the search bar \> Hover over the displayed
        search result \> Connect.

    - > **Note**

      > Select **Connect Another Instance** if an instance has already
      > been configured.

2.  On the **Select Integration** step of the Jenkins integration,
    select Code Scan \> Next.

3.  On the **Add Environment Variables** step of the wizard.

    a.  Select Generate API key.

    - The API key secret and API key ID values are generated and
      populate their respective fields.

    b.  Select your system architecture.

    c.  Click Next.

4.  Store your Cortex XSIAM API Key and API ID in the Jenkins
    Credentials store.

- > **Warning**

  - > For Application Security CI tools, you must store secrets in
    > Jenkins Credentials for use in your Jenkins pipelines using either
    > of these methods:

    - > **Plain text storage**: Store secrets directly as plain text in
      > Jenkins Credentials. Access them in your pipeline using the
      > `credentials` function, which retrieves the secret directly as
      > plain text

    - > **Credentials Binding Plugin**: Use the `withCredentials`
      > function (requires installing the Credentials Binding Plugin) to
      > securely bind credentials to environment variables within your
      > pipeline

  - > The variable names **CORTEX_API_KEY** and **CORTEX_API_KEY_ID**
    > must be used exactly as provided. They are part of a predefined
    > system and cannot be changed without causing errors

  <!-- -->

  - If you have an API key:

    i.  Copy the **CORTEX_API_KEY** and **CORTEX_API_KEY_ID** variable
        names from their respective fields in the wizard.

    ii. Add the **CORTEX_API_KEY** and **CORTEX_API_KEY_ID** names and
        their corresponding values as separate environment variables
        (secrets) to the Jenkins Credentials store.

  - If you do not have an API key:

    i.  Click Generate API key \> Copy the CORTEX_API_KEY and
        CORTEX_API_KEY_ID and their corresponding values from their
        respective fields.

    ii. Add the **CORTEX_API_KEY** and **CORTEX_API_KEY_ID** names and
        their corresponding values as separate environment variables
        (secrets) to the Jenkins Credentials store.

5.  On the **Set repository** step of the wizard: (Optional): Add the
    URL of the repository to be scanned, or skip this step if you are
    adding code scanning to an existing pipeline \> Next.

- > **Note**

  - > This step is only required for new pipelines

  - > For private repositories, ensure the necessary credentials are
    > configured in Jenkins Credentials

6.  On the **Configure Subscription** step of the integration wizard.

    a.  Copy and paste the code from the **Configure Subscription** step
        of the integration wizard into your Jenkins pipeline.

    b.  In the `labels` property of your Jenkins configuration file,
        enter the label of a Jenkins node that is configured with
        Docker.

    - > **Note**

      > This ensures your build runs within a Docker environment. If a
      > node without Docker is used, the build will fail.

    c.  Optional: The provided code assumes that your Cortex XSIAM
        access key and ID are stored as plain text in Jenkins
        Credentials. You can replace this method with your preferred
        secret management solution (such as the `withCredentials`
        function).

    d.  Click Done.

7.  Verify you receive the confirmation message on the last step of the
    wizard \> Close.

8.  Verify integration and confirm that the your integrated Jenkins
    instance has a status of **Connected**.

    a.  On **Data Sources**, search for Jenkins in the search bar.

    b.  Hover over the resulting entry and click View More.

    c.  Verify that the status of your Jenkins instance is **Connected**
        and that the instance type **Code ** is displayed.

9.  Next step: View scan results and mitigate issues.

> **Note**
>
> To add an additional Jenkins instance, navigate to Settings \> Data
> Sources \> select the menu for your connected Jenkins instance \> +
> New Instance, and repeat the onboarding steps.

######## Jenkins code scan workflow template (without checkout)

This Jenkins workflow example automates code scanning using the Cortex
CLI. It does not include a step to checkout a repository. The workflow
contains placeholder values (often in brackets) and generic terms (such
as dev) that you must replace with your environment-specific information
before use.

    pipeline {
        agent {
            docker {
                image 'jenkins/agent:alpine'
                args '-u root --privileged -v /var/run/docker.sock:/var/run/docker.sock'
                label '<REPLACE WITH LABEL OF NODE WITH DOCKER INSTALLED>' // Use a docker agent with docker installed
            }
        }

        environment {
            CORTEX_API_KEY = credentials('CORTEX_API_KEY')
            CORTEX_API_KEY_ID = credentials('CORTEX_API_KEY_ID')
            CORTEX_API_URL = 'https://api-viso-hdkbzk6qphxpbehy758elo.xdr-qa2-uat.us.paloaltonetworks.com'
            CORTEX_CLI_VERSION = '0.8.11'
        }

        stages {

            stage('Install Dependencies') {
                steps {
                    sh '''
                    apk add --no-cache jq docker
                    '''
                }
            }

            stage('Get Temporary Token') {
                environment {
                    TEMP_TOKEN = ""
                }
                steps {
                    script {
                        def response = sh(script: """
                            curl --location '${env.CORTEX_API_URL}/public_api/cas/v1/cortex-cli/create-token' \
                              --header 'Authorization: ${env.CORTEX_API_KEY}' \
                              --header 'x-xdr-auth-id: ${env.CORTEX_API_KEY_ID}' \
                              --header 'Content-Type: application/json' \
                              --data '{}' \
                              -s
                        """, returnStdout: true).trim()

                        env.TEMP_TOKEN = sh(script: """echo '${response}' | jq -r '.token'""", returnStdout: true).trim()
                    }
                }
            }

            stage('Pull Docker Image') {
                steps {
                    sh """
                    docker pull distributions-dev.traps.paloaltonetworks.com/cli-docker/${env.TEMP_TOKEN}/method:amd64-${env.CORTEX_CLI_VERSION}-dev
                    docker tag distributions-dev.traps.paloaltonetworks.com/cli-docker/${env.TEMP_TOKEN}/method:amd64-${env.CORTEX_CLI_VERSION}-dev cortexcli:${env.CORTEX_CLI_VERSION}
                    """
                }
            }

            stage('Run Docker Container') {
                // Replace the repo-id with your repository like: owner/repo
                steps {
                    unstash 'source'
                    env.BRANCH = sh(script: "git rev-parse --abbrev-ref HEAD", returnStdout: true).trim()
                    sh """
                    docker run --rm --platform linux/amd64 cortexcli:${env.CORTEX_CLI_VERSION} \
                      --api-base-url ${env.CORTEX_API_URL} \
                      --api-key ${env.CORTEX_API_KEY} \
                      --api-key-id ${env.CORTEX_API_KEY_ID} \
                      code scan \
                      --directory . \
                      --repo-id <REPLACE WITH REPO_OWNER/REPO_NAME> \
                      --branch $BRANCH
                    """
                }
            }
        }
    }

######### Jenkins code scan workflow template (with checkout)

This Jenkins workflow example automates code scanning using the Cortex
CLI. It includes a step to checkout a repository. The workflow contains
placeholder values (often in brackets) and generic terms (such as dev)
that you must replace with your environment-specific information before
use.

    pipeline {
        agent {
            docker {
                image 'jenkins/agent:alpine'
                args '-u root --privileged -v /var/run/docker.sock:/var/run/docker.sock'
                label '<REPLACE WITH LABLE OF NODE WITH DOCKER INSTALLED>' // Use a docker agent with docker installed
            }
        }

        environment {
            CORTEX_API_KEY = credentials('CORTEX_API_KEY')
            CORTEX_API_KEY_ID = credentials('CORTEX_API_KEY_ID')
            CORTEX_API_URL = 'https://api-viso-hdkbzk6qphxpbehy758elo.xdr-qa2-uat.us.paloaltonetworks.com'
            CORTEX_CLI_VERSION = '0.8.11'
        }

        stages {
            stage('Checkout Repository') {
                steps {
                    git branch: 'main', url: 'https://github-example.com/example-repo'
                    stash includes: '**/*', name: 'source'
                }
            }

            stage('Install Dependencies') {
                steps {
                    sh '''
                    apk add --no-cache jq docker
                    '''
                }
            }

            stage('Get Temporary Token') {
                environment {
                    TEMP_TOKEN = ""
                }
                steps {
                    script {
                        def response = sh(script: """
                            curl --location '${env.CORTEX_API_URL}/public_api/cas/v1/cortex-cli/create-token' \
                              --header 'Authorization: ${env.CORTEX_API_KEY}' \
                              --header 'x-xdr-auth-id: ${env.CORTEX_API_KEY_ID}' \
                              --header 'Content-Type: application/json' \
                              --data '{}' \
                              -s
                        """, returnStdout: true).trim()

                        env.TEMP_TOKEN = sh(script: """echo '${response}' | jq -r '.token'""", returnStdout: true).trim()
                    }
                }
            }

            stage('Pull Docker Image') {
                steps {
                    sh """
                    docker pull distributions-dev.traps.paloaltonetworks.com/cli-docker/${env.TEMP_TOKEN}/method:amd64-${env.CORTEX_CLI_VERSION}-dev
                    docker tag distributions-dev.traps.paloaltonetworks.com/cli-docker/${env.TEMP_TOKEN}/method:amd64-${env.CORTEX_CLI_VERSION}-dev cortexcli:${env.CORTEX_CLI_VERSION}
                    """
                }
            }

            stage('Run Docker Container') {
                // Replace the repo-id with your repository like: owner/repo
                steps {
                    unstash 'source'
                    env.BRANCH = sh(script: "git rev-parse --abbrev-ref HEAD", returnStdout: true).trim()
                    sh """
                    docker run --rm --platform linux/amd64 cortexcli:${env.CORTEX_CLI_VERSION} \
                      --api-base-url ${env.CORTEX_API_URL} \
                      --api-key ${env.CORTEX_API_KEY} \
                      --api-key-id ${env.CORTEX_API_KEY_ID} \
                      code scan \
                      --directory . \
                      --repo-id <REPLACE WITH REPO_OWNER/REPO_NAME> \
                      --branch $BRANCH
                    """
                }
            }
        }
    }

####### Onboard Terraform Cloud (Run Tasks)

Integrate Application Security with Terraform Cloud (Run Tasks) to
enable dynamic, automated, and context-specific scans in your Terraform
workspace. Application Security scans Terraform (TF) frameworks for
misconfigurations based on default and custom policies whenever changes
are triggered, ensuring seamless security checks. It identifies issues
such as infrastructure-as-code (IaC) misconfigurations, Software
Composition Analysis (SCA ) vulnerabilities^\*^, exposed secrets, and
license non-compliance, depending on the security scanners that you have
subscribed to.

> **Note**
>
> ^\*^ Application Security performs **Image Referencer** scans for
> container image vulnerabilities, as full SCA scans are not supported
> for Terraform Enterprise (Run Tasks).

You can monitor and remediate issues directly in the Application
Security console. Run statuses and violation details can be tracked in
both Application Security and Terraform Cloud through streamlined run
task reviews. For more information about streamlined tasks, refer
to <https://www.hashicorp.com/blog/terraform-cloud-adds-streamlined-run-task-reviews>.

> **Prerequisite**
>
> Before you begin:

- > Procure a [Terraform cloud
  > license](https://www.hashicorp.com/products/terraform/pricing) that
  > is either a trial license or a TF Cloud license at the TEAM &
  > GOVERNANCE level

- > Grant the user or team the following permissions, depending on
  > integration:

  - > *Manage Workspaces* permissions at the organization level. These
    > permissions are required to attach and manage the run task on
    > workspaces or:

  - > *Administrator* permissions on the workspace(s)

- > Create a Terraform **Organization**. For more information, refer to
  > the[Terraform
  > documentation](https://developer.hashicorp.com/terraform/cloud-docs/workspaces#creating-workspaces)

- > Create a Terraform **Workspace**: For more information, refer to the
  > [Terraform
  > documentation](https://developer.hashicorp.com/terraform/cloud-docs/workspaces#creating-workspaces)

1.  On your Terraform Cloud platform, create a Terraform **api token**.

    a.  Select your user/profile icon \> User Settings.

    b.  Select the **Tokens** section from the left side menu.

    c.  Click Create an API token \> provide a description \> Create API
        token .

    d.  Copy and save the token.

    - > **Note**

      > Skip this step if you plan on using an existing token.

- For more information about Terraform API tokens, refer to the
  [Terraform API
  Tokens](https://developer.hashicorp.com/terraform/cloud-docs/users-teams-organizations/api-tokens)
  documentation.

2.  On the Cortex XSIAM console.

    a.  Select Settings \> Data Sources (under Data Collections) \> +
        Data Source.

    b.  Enter Terraform Cloud (Run Tasks) in the search bar \> Hover
        over the displayed search result \> Connect.

    - > **Note**

      > Select **Connect Another Instance** if an instance has already
      > been configured.

3.  Provide your Terraform user or team API token on the Configure
    Account step of the wizard \> Next.

4.  Select an organization from the Select Organization step of the
    wizard \> Next.

5.  On the **Select Workspace** step of the wizard.

    a.  Select repositories from the Selection Options field.

        - Permit all existing repositories

        - Permit all existing and future repositories

        - Choose from repository list

    b.  Select a run plan from the **Run Stage** field.

        - **Pre-plan**: The scan runs before Terraform generates the
          plan

        - **Post-plan**: The scan runs after Terraform generates the
          plan

    - > **Note**

      > Application Security performs a scan of Terraform templates on
      > selected workspaces based on the **Run Stage**.

    c.  Click Save and then **Close** in the final verification step of
        the wizard.

6.  Verify integration and confirm that the your integrated Terraform
    Cloud (Run Tasks) instance has a status of **Connected**.

    a.  On **Data Sources**, search for Terraform Cloud (Run Tasks) in
        the search bar.

    b.  Hover over the resulting entry and click View Details.

    c.  Verify that the status of your Terraform Cloud (Run Tasks)
        instance is **Connected**.

7.  Next step: View scan results and mitigate issues.

> **Note**
>
> To add an additional Terraform Cloud (Run Tasks) instance, navigate to
> Settings \> Data Sources \> select the menu for your connected your
> Terraform Cloud (Run Tasks) instance \> + New Instance, and repeat the
> onboarding steps.

####### Onboard Terraform Enterprise (Run Tasks)

Integrate Application Security with Terraform Enterprise (Run Tasks) to
enable dynamic, automated, and context-specific scans in your Terraform
workspace. Application Security scans Terraform (TF) frameworks for
misconfigurations based on default and custom policies whenever changes
are triggered, ensuring seamless security checks. It identifies
infrastructure-as-code (IaC) misconfigurations, Software Composition
Analysis (SCA ) vulnerabilities^\*^, exposed secrets, and license
non-compliance issues, depending on the security scanners that you have
subscribed to.

> **Note**
>
> ^\*^ For container image vulnerabilities, Application Security
> performs \'Image Referencer\' scans within Terraform Enterprise (Run
> Tasks), as full SCA scans are not currently supported.

You can monitor and remediate issues directly in the Application
Security console. Run statuses and violation details can be tracked in
both Application Security and Terraform Enterprise through streamlined
run task reviews. For more information about streamlined tasks, refer
to <https://www.hashicorp.com/blog/terraform-cloud-adds-streamlined-run-task-reviews>.

> **Prerequisite**
>
> Before you begin:

- > Ensure access to a Terraform Enterprise console to enable you to
  > provide a user or team token that authorizes Application Security to
  > access workspaces and helps regulate run configurations

- > Terraform Enterprise version compatibility: Ensure *Run Tasks* for
  > workspaces on is compatible with version 1.1.9 and above

- > Terraform Enterprise user or team permissions: For a workspace
  > integration of run tasks you need to ensure that the token used has
  > the following permissions. These permissions enable Cortex XSIAM to
  > configure run tasks in the environment and scan plan files from your
  > runs:

  - > **Manage run tasks** permissions at the organizational level.
    > These permissions are required to create and manage the run task
    > in the organization

  - > **Manage Workspaces** permissions at the organization level. These
    > permissions are required to attach and manage the run task on
    > workspaces or:

  - > **Administrator** permissions on the workspace(s)

  <!-- -->

  - > **Note**

    > For more on Terraform Run Task permissions refer to [Manage Run
    > Tasks
    > permissions](https://developer.hashicorp.com/terraform/enterprise/users-teams-organizations/permissions#organization-permissions).

- > Create a Terraform **Organization**. For more information, refer to
  > the[Terraform
  > documentation](https://developer.hashicorp.com/terraform/cloud-docs/workspaces#creating-workspaces)

- > Create a Terraform **Workspace**: For more information, refer to the
  > [Terraform
  > documentation](https://developer.hashicorp.com/terraform/cloud-docs/workspaces#creating-workspaces)

1.  On your Terraform Enterprise platform, create a
    Terraform **api token**.

    a.  Select your user/profile icon \> User Settings.

    b.  Select the **Tokens** section from the left side menu.

    c.  Click Create an API token \> provide a description \> Create API
        token .

    d.  Copy and save the token.

    - > **Note**

      > Skip this step if you plan on using an existing token.

- For more information about Terraform API tokens, refer to the
  [Terraform API
  Tokens](https://developer.hashicorp.com/terraform/cloud-docs/users-teams-organizations/api-tokens)
  documentation.

2.  On the Cortex XSIAM console:

    a.  Select Settings \> Data Sources (under Data Collections) \> +
        Data Source.

    b.  Enter Terraform Enterprise (Run Tasks) in the search bar \>
        Hover over the displayed search result \> Connect.

    - > **Note**

      > Select **Connect Another Instance** if an instance has already
      > been configured.

3.  Provide your Terraform user or team API token on the Configure
    Account step of the wizard \> Next.

4.  Select an organization from the Select Organization step of the
    wizard \> Next.

5.  On the**Select Workspace** step of the wizard:

    a.  Select repositories from the Selection Options field.

        - Permit all existing repositories

        - Permit all existing and future repositories

        - Choose from repository list

    b.  Select a run plan from the **Run Stage** field.

        - **Pre-plan**: The scan runs before Terraform generates the
          plan

        - **Post-plan**: The scan runs after Terraform generates the
          plan

    - > **Note**

      > Application Security performs a scan of Terraform templates on
      > selected workspaces based on the **Run Stage**.

    c.  Click Save.

6.  Click **Save** and then **Close** in the final verification step of
    the wizard.

7.  Verify integration and confirm that the your integrated Terraform
    Enterprise (Run Tasks) instance has a status of **Connected**.

    a.  On **Data Sources**, search for Terraform Enterprise (Run Tasks)
        in the search bar.

    b.  Hover over the resulting entry and click View More.

    c.  Verify that the status of your Terraform Enterprise (Run Tasks)
        instance is **Connected**.

8.  Next step: View scan results and mitigate issues.

> **Note**
>
> To add an additional Terraform Enterprise (Run Tasks) instance,
> navigate to Settings \> Data Sources \> select the menu for your
> connected Terraform Enterprise (Run Tasks) instance \> + New Instance,
> and repeat the onboarding steps above.

###### CLI pipeline code snippets

You can integrate the Cortex CLI directly into your CI/CD pipelines to
enable automated code scans by adding code snippets to your to your
build script or pipeline configuration, such as a `YAML` or `Groovy`
file. Both `ARM` and `AMD` architectures are supported, ensuring you can
scan your codebase regardless of your runner's environment.

You must replace placeholder variables with your own credentials and
environment-specific details.

####### AWS CodeBuild

- For AMD architecture

<!-- -->

- version: 0.2
      env:
        variables:
          CORTEX_API_URL: "https://api-viso-cq3sdpg7uyd6vqk66ccjyv.xdr-qa2-uat.us.paloaltonetworks.com"
          CORTEX_CLI_VERSION: "0.13.14"
        secrets-manager:
          CORTEX_API_KEY: "CORTEX_API_KEY"   
          CORTEX_API_KEY_ID: "CORTEX_API_KEY_ID"
      phases:
        install:
          commands:
            - apt-get update
            - apt-get install -y curl jq git
        pre_build:
          commands:
            - echo "Getting repo name"
            - export CODEBUILD_ACCOUNT_ID=$(aws sts get-caller-identity --query 'Account' --output text)  
            - export CODEBUILD_GIT_BRANCH="$(git symbolic-ref HEAD --short 2>/dev/null)"
            - |
              if [ "$CODEBUILD_GIT_BRANCH" = "" ] ; then
                export CODEBUILD_GIT_BRANCH="$(git rev-parse HEAD | xargs git name-rev | cut -d' ' -f2 | sed 's/remotes\/origin\///g')";
              fi
            - export CODEBUILD_PROJECT=${CODEBUILD_BUILD_ID%:$CODEBUILD_LOG_PATH}
            - echo "Downloading cortexcli"
            - |
              crtx_resp=$(curl "${CORTEX_API_URL}/public_api/v1/unified-cli/releases/download-link?os=linux&architecture=amd64" \
                -H "x-xdr-auth-id: ${CORTEX_API_KEY_ID}" \
                -H "Authorization: ${CORTEX_API_KEY}")
            - crtx_url=$(echo "$crtx_resp" | jq -r ".signed_url")
            - curl -o cortexcli "$crtx_url"
            - chmod +x cortexcli
            - ./cortexcli --version
            
        build:
          commands:
            - |
              ./cortexcli \
                         --api-base-url "${CORTEX_API_URL}" \
                         --api-key "${CORTEX_API_KEY}" \
                         --api-key-id "${CORTEX_API_KEY_ID}" \
                         code scan \
                         --directory "$(pwd)" \
                         --repo-id $CODEBUILD_ACCOUNT_ID/$CODEBUILD_PROJECT \
                         --branch $CODEBUILD_GIT_BRANCH \
                         --source AWS_CODE_BUILD \
                         --create-repo-if-missing
      artifacts:
        files:
          - '**/*'

<!-- -->

- For ARM architecture

<!-- -->

- version: 0.2
      env:
        variables:
          CORTEX_API_URL: "https://api-viso-89wjoyyvubntuqjnq8mfub.xdr-qa2-uat.us.paloaltonetworks.com"
          CORTEX_CLI_VERSION: "0.13.16"
        secrets-manager:
          CORTEX_API_KEY: "CORTEX_API_KEY"   
          CORTEX_API_KEY_ID: "CORTEX_API_KEY_ID"
      phases:
        install:
          commands:
            - apt-get update
            - apt-get install -y curl jq git
        pre_build:
          commands:
            - echo "Getting repo name"
            - export CODEBUILD_ACCOUNT_ID=$(aws sts get-caller-identity --query 'Account' --output text)  
            - export CODEBUILD_GIT_BRANCH="$(git symbolic-ref HEAD --short 2>/dev/null)"
            - |
              if [ "$CODEBUILD_GIT_BRANCH" = "" ] ; then
                export CODEBUILD_GIT_BRANCH="$(git rev-parse HEAD | xargs git name-rev | cut -d' ' -f2 | sed 's/remotes\/origin\///g')";
              fi
            - export CODEBUILD_PROJECT=${CODEBUILD_BUILD_ID%:$CODEBUILD_LOG_PATH}
            - echo "Downloading cortexcli"
            - |
              crtx_resp=$(curl "${CORTEX_API_URL}/public_api/v1/unified-cli/releases/download-link?os=linux&architecture=arm64" \
                -H "x-xdr-auth-id: ${CORTEX_API_KEY_ID}" \
                -H "Authorization: ${CORTEX_API_KEY}")
            - crtx_url=$(echo "$crtx_resp" | jq -r ".signed_url")
            - curl -o cortexcli "$crtx_url"
            - chmod +x cortexcli
            - ./cortexcli --version
            
        build:
          commands:
            - |
              ./cortexcli \
                         --api-base-url "${CORTEX_API_URL}" \
                         --api-key "${CORTEX_API_KEY}" \
                         --api-key-id "${CORTEX_API_KEY_ID}" \
                         code scan \
                         --directory "$(pwd)" \
                         --repo-id $CODEBUILD_ACCOUNT_ID/$CODEBUILD_PROJECT \
                         --branch $CODEBUILD_GIT_BRANCH \
                         --source AWS_CODE_BUILD \
                         --create-repo-if-missing
      artifacts:
        files:
          - '**/*'

####### Azure Pipelines

- For AMD architecture

<!-- -->

- trigger:
        branches:
          include: ['*']
      pr:
        branches:
          include: ['*']
      pool:
        vmImage: ubuntu-latest
      variables:
        CORTEX_API_URL: "https://api-viso-ddk8ww8iuhyvvnnq5ayhr4.xdr-qa2-uat.us.paloaltonetworks.com"
        MIN_LOG_LEVEL: "DEBUG"
      steps:
      - checkout: self
        clean: true
      - task: NodeTool@0
        displayName: "Use Node.js 22.x"
        inputs:
          versionSpec: "22.x"
      - bash: |
          set -euo pipefail
          sudo apt-get update
          sudo apt-get install -y --no-install-recommends jq ca-certificates curl
          BASE="${CORTEX_API_URL%/}"
          URL="$BASE/public_api/v1/unified-cli/releases/download-link?os=linux&architecture=amd64"
          set +x
          CRTX_URL=$(curl -fsSL "$URL" \
            -H "x-xdr-auth-id: ${CORTEX_API_KEY_ID}" \
            -H "Authorization: ${CORTEX_API_KEY}" | jq -r '.signed_url')
          set -x
          curl -fsSL -o cortexcli "$CRTX_URL"
          chmod +x cortexcli
        displayName: "Download cortexcli (amd64)"
        env:
          CORTEX_API_URL: $(CORTEX_API_URL)
          CORTEX_API_KEY_ID: $(CORTEX_API_KEY_ID)
          CORTEX_API_KEY: $(CORTEX_API_KEY)
      - bash: |
          set -euo pipefail
          ./cortexcli \
            --api-base-url "${CORTEX_API_URL}" \
            --api-key "${CORTEX_API_KEY}" \
            --api-key-id "${CORTEX_API_KEY_ID}" \
            code scan \
            --directory "$(Build.SourcesDirectory)" \
            --repo-id "$(Build.Repository.Name)" \
            --branch "$(Build.SourceBranchName)" \
            --source "CORTEX_CLI" \
            --create-repo-if-missing
        displayName: "Cortex CLI Code Scan"
        env:
          CORTEX_API_URL: $(CORTEX_API_URL)
          CORTEX_API_KEY_ID: $(CORTEX_API_KEY_ID)
          CORTEX_API_KEY: $(CORTEX_API_KEY)
          MIN_LOG_LEVEL: $(MIN_LOG_LEVEL)

<!-- -->

- For ARM architecture

<!-- -->

- trigger:
        branches:
          include: ['*']
      pr:
        branches:
          include: ['*']
      variables:
        CORTEX_API_URL: "https://api-viso-ddk8ww8iuhyvvnnq5ayhr4.xdr-qa2-uat.us.paloaltonetworks.com"
      pool:
        name: arm
        demands:
          - Agent.OS -equals Linux
      steps:
      - checkout: self
        clean: true
      - task: NodeTool@0
        displayName: "Use Node.js 22.x"
        inputs: { versionSpec: "22.x" }
      - bash: |
          set -euo pipefail
          BASE="${CORTEX_API_URL%/}"
          URL="$BASE/public_api/v1/unified-cli/releases/download-link?os=linux&architecture=arm64"
          set +x
          CRTX_URL=$(curl -fsSL "$URL" \
            -H "x-xdr-auth-id: ${CORTEX_API_KEY_ID}" \
            -H "Authorization: ${CORTEX_API_KEY}" | jq -r '.signed_url')
          set -x
          curl -fsSL -o cortexcli "$CRTX_URL"
          chmod +x cortexcli
        displayName: "Download cortexcli (arm64)"
        env:
          CORTEX_API_URL: $(CORTEX_API_URL)
          CORTEX_API_KEY_ID: $(CORTEX_API_KEY_ID)
          CORTEX_API_KEY: $(CORTEX_API_KEY)
      - bash: |
          set -euo pipefail
          ./cortexcli \
            --api-base-url "${CORTEX_API_URL}" \
            --api-key "${CORTEX_API_KEY}" \
            --api-key-id "${CORTEX_API_KEY_ID}" \
            code scan \
            --directory "$(Build.SourcesDirectory)" \
            --repo-id "$(Build.Repository.Name)" \
            --branch "$(Build.SourceBranchName)" \
            --source "CORTEX_CLI" \
            --create-repo-if-missing
        displayName: "Cortex CLI Code Scan (ARM64)"
        env:
          CORTEX_API_URL: $(CORTEX_API_URL)
          CORTEX_API_KEY_ID: $(CORTEX_API_KEY_ID)
          CORTEX_API_KEY: $(CORTEX_API_KEY)

####### Bitbucket

- For AMD architecture

<!-- -->

- image: ubuntu:24.04
      clone:
        depth: full
      pipelines:
        default:
          - step:
              name: Cortex CLI Code Scan (Hosted AMD64)
              script:
                - set -euo pipefail
                - apt-get update && apt-get install -y --no-install-recommends curl jq ca-certificates tar gzip file
                - curl -fsSL https://deb.nodesource.com/setup_22.x | bash -
                - apt-get install -y nodejs
                - node -v && npm -v
                - export CORTEXCLI_HOME="/root/.cortexcli"; rm -rf "$CORTEXCLI_HOME" || true; mkdir -p "$CORTEXCLI_HOME"
                - |
                  CRTX_URL=$(curl -fsSL "${CORTEX_API_URL}/public_api/v1/unified-cli/releases/download-link?os=linux&architecture=amd64" \
                    -H "x-xdr-auth-id: ${CORTEX_API_KEY_ID}" \
                    -H "Authorization: ${CORTEX_API_KEY}" | jq -r '.signed_url')
                  curl -fsSL -o cortexcli "$CRTX_URL"
                  chmod +x cortexcli
                  ./cortexcli --version
                - |
                  ./cortexcli \
                    --api-base-url "${CORTEX_API_URL}" \
                    --api-key "${CORTEX_API_KEY}" \
                    --api-key-id "${CORTEX_API_KEY_ID}" \
                    code scan \
                    --directory "${BITBUCKET_CLONE_DIR}" \
                    --repo-id "${BITBUCKET_REPO_FULL_NAME}" \
                    --branch "${BITBUCKET_BRANCH}" \
                    --source "CORTEX_CLI" \
                    --create-repo-if-missing \
                    --upload-mode no-upload
              artifacts:
                - cortexcli

<!-- -->

- For ARM architecture

<!-- -->

- image: node:22-bookworm

      pipelines:
        default:
          - step:
              name: Cortex CLI Code Scan
              runs-on:
                - self.hosted
                - linux.arm64 
              script:
                - set -euo pipefail
                - apt-get update && apt-get install -y --no-install-recommends curl jq ca-certificates file
                - export CORTEXCLI_HOME="/root/.cortexcli"; rm -rf "$CORTEXCLI_HOME" || true; mkdir -p "$CORTEXCLI_HOME"

                - |
                  set +x
                  CRTX_URL=$(curl -fsSL "${CORTEX_API_URL%/}/public_api/v1/unified-cli/releases/download-link?os=linux&architecture=arm64" \
                    -H "x-xdr-auth-id: ${CORTEX_API_KEY_ID}" \
                    -H "Authorization: ${CORTEX_API_KEY}" | jq -r '.signed_url')
                  set -x
                  curl -fsSL -o cortexcli "$CRTX_URL"
                  chmod +x cortexcli
                  ./cortexcli --version

                # Run the scan
                - |
                  ./cortexcli \
                    --api-base-url "${CORTEX_API_URL}" \
                    --api-key "${CORTEX_API_KEY}" \
                    --api-key-id "${CORTEX_API_KEY_ID}" \
                    code scan \
                    --directory "${BITBUCKET_CLONE_DIR}" \
                    --repo-id "${BITBUCKET_REPO_FULL_NAME}" \
                    --branch "${BITBUCKET_BRANCH}" \
                    --source "CORTEX_CLI" \
                    --create-repo-if-missing
              artifacts:
                - cortexcli

####### CircleCI

- For AMD architecture

<!-- -->

- version: 2.1
      jobs:
        cortex-code-scan:
          docker:
            - image: cimg/node:22.17.0  # Replace with a suitable image or executor
          environment:
            CORTEX_API_URL: https://api-viso-cq3sdpg7uyd6vqk66ccjyv.xdr-qa2-uat.us.paloaltonetworks.com
          steps:
            - checkout
            - run:
                name: Download cortexcli
                command: |
                  set -x
                  crtx_resp=$(curl "${CORTEX_API_URL}/public_api/v1/unified-cli/releases/download-link?os=linux&architecture=amd64" \
                    -H "x-xdr-auth-id: ${CORTEX_API_KEY_ID}" \
                    -H "Authorization: ${CORTEX_API_KEY}")
                  crtx_url=$(echo $crtx_resp | jq -r ".signed_url")
                  curl -o cortexcli $crtx_url
                  chmod +x cortexcli
                  ./cortexcli --version
            - run:
                name: Run Cortex CLI Code Scan
                command: |
                  ./cortexcli \
                    --api-base-url "${CORTEX_API_URL}" \
                    --api-key "${CORTEX_API_KEY}" \
                    --api-key-id "${CORTEX_API_KEY_ID}" \
                    code scan \
                    --directory "$(pwd)" \
                    --repo-id "${CIRCLE_PROJECT_USERNAME}/${CIRCLE_PROJECT_REPONAME}" \
                    --branch "${CIRCLE_BRANCH}" \
                    --source "CIRCLE_CI" \
                    --create-repo-if-missing
      workflows:
        cortex-scan-workflow:
          jobs:
            - cortex-code-scan:
                context: cortex-secrets

<!-- -->

- For ARM architecture

<!-- -->

- version: 2.1
      jobs:
        cortex-code-scan:
          docker:
            - image: <Replace with image supporting node js version 22 or higher>
          environment:
            CORTEX_API_URL: https://api-viso-89wjoyyvubntuqjnq8mfub.xdr-qa2-uat.us.paloaltonetworks.com
          steps:
            - checkout
            - run:
                name: Download cortexcli
                command: |
                  set -x
                  crtx_resp=$(curl "${CORTEX_API_URL}/public_api/v1/unified-cli/releases/download-link?os=linux&architecture=arm64" \
                    -H "x-xdr-auth-id: ${CORTEX_API_KEY_ID}" \
                    -H "Authorization: ${CORTEX_API_KEY}")
                  crtx_url=$(echo $crtx_resp | jq -r ".signed_url")
                  curl -o cortexcli $crtx_url
                  chmod +x cortexcli
                  ./cortexcli --version
            - run:
                name: Run Cortex CLI Code Scan
                command: |
                  ./cortexcli \
                    --api-base-url "${CORTEX_API_URL}" \
                    --api-key "${CORTEX_API_KEY}" \
                    --api-key-id "${CORTEX_API_KEY_ID}" \
                    code scan \
                    --directory "$(pwd)" \
                    --repo-id "${CIRCLE_PROJECT_USERNAME}/${CIRCLE_PROJECT_REPONAME}" \
                    --branch "${CIRCLE_BRANCH}" \
                    --source "CIRCLE_CI" \
                    --create-repo-if-missing
      workflows:
        cortex-scan-workflow:
          jobs:
            - cortex-code-scan:
                context: cortex-secrets

####### GitHub Actions

- For AMD architecture

<!-- -->

- name: Cortex CLI Code Scan
      on:
        push:
          branches:
            - main
        workflow_dispatch:
      env:
        CORTEX_API_KEY: ${{secrets.CORTEX_API_KEY}}
        CORTEX_API_KEY_ID: ${{secrets.CORTEX_API_KEY_ID}}
        CORTEX_API_URL: https://api-viso-cq3sdpg7uyd6vqk66ccjyv.xdr-qa2-uat.us.paloaltonetworks.com
        
      jobs:
        cortex-code-scan:
          runs-on: ubuntu-latest
          steps:
          - name: Checkout Repository
            uses: actions/checkout@v2
          
          - name: Set up Node.js
            uses: actions/setup-node@v4
            with:
              node-version: 22
          - name: Verify Node.js Version
            run: node -v
          - name: Download cortexcli
            run: |
              set -x
              crtx_resp=$(curl "${CORTEX_API_URL}/public_api/v1/unified-cli/releases/download-link?os=linux&architecture=amd64" \
                -H "x-xdr-auth-id: ${CORTEX_API_KEY_ID}" \
                -H "Authorization: ${CORTEX_API_KEY}")
              crtx_url=$(echo $crtx_resp | jq -r ".signed_url")
              curl -o cortexcli $crtx_url
              chmod +x cortexcli
              ./cortexcli --version
          - name: Run Cortex CLI Code Scan
            run: |
              ./cortexcli \
                --api-base-url "${CORTEX_API_URL}" \
                --api-key "${CORTEX_API_KEY}" \
                --api-key-id "${CORTEX_API_KEY_ID}" \
                code scan \
                --directory "${{github.workspace}}" \
                --repo-id "${{github.repository}}" \
                --branch "${{github.ref_name}}" \
                --source "GITHUB_ACTIONS" \
                --create-repo-if-missing

<!-- -->

- For ARM architecture

<!-- -->

- name: Cortex CLI Code Scan
      on:
        push:
          branches:
            - main
        workflow_dispatch:
      env:
        CORTEX_API_KEY: ${{secrets.CORTEX_API_KEY}}
        CORTEX_API_KEY_ID: ${{secrets.CORTEX_API_KEY_ID}}
        CORTEX_API_URL: https://api-viso-89wjoyyvubntuqjnq8mfub.xdr-qa2-uat.us.paloaltonetworks.com
        
      jobs:
        cortex-code-scan:
          runs-on: ubuntu-latest
          steps:
          - name: Checkout Repository
            uses: actions/checkout@v2
          
          - name: Set up Node.js
            uses: actions/setup-node@v4
            with:
              node-version: 22
          - name: Verify Node.js Version
            run: node -v
          - name: Download cortexcli
            run: |
              set -x
              crtx_resp=$(curl "${CORTEX_API_URL}/public_api/v1/unified-cli/releases/download-link?os=linux&architecture=arm64" \
                -H "x-xdr-auth-id: ${CORTEX_API_KEY_ID}" \
                -H "Authorization: ${CORTEX_API_KEY}")
              crtx_url=$(echo $crtx_resp | jq -r ".signed_url")
              curl -o cortexcli $crtx_url
              chmod +x cortexcli
              ./cortexcli --version
          - name: Run Cortex CLI Code Scan
            run: |
              ./cortexcli \
                --api-base-url "${CORTEX_API_URL}" \
                --api-key "${CORTEX_API_KEY}" \
                --api-key-id "${CORTEX_API_KEY_ID}" \
                code scan \
                --directory "${{github.workspace}}" \
                --repo-id "${{github.repository}}" \
                --branch "${{github.ref_name}}" \
                --source "GITHUB_ACTIONS" \
                --create-repo-if-missing

####### GitLab Runner

- For AMD architecture

<!-- -->

- stages: [scan]
      variables:
        CORTEX_API_URL: "https://api-viso-8vocygkchsephm7mczadnc.xdr-qa2-uat.us.paloaltonetworks.com"
      cortex_code_scan:
        image: node:22-bookworm@sha256:bb6834c0669aa71cbc8d94606561a721adf489f6b93d7b8b825f0cf1b498c2c4
        tags: ["amd64"]
        stage: scan
        rules:
          - when: on_success
        before_script:
          - uname -m
          - set -euo pipefail
          - apt-get update
          - apt-get install -y --no-install-recommends curl jq ca-certificates tar gzip file
          - export CORTEXCLI_HOME="/root/.cortexcli"; rm -rf "$CORTEXCLI_HOME" || true; mkdir -p "$CORTEXCLI_HOME"
          - |
            # avoid leaking secrets in logs
            set +x
            CRTX_URL=$(curl -fsSL "${CORTEX_API_URL}/public_api/v1/unified-cli/releases/download-link?os=linux&architecture=amd64" \
              -H "x-xdr-auth-id: ${CORTEX_API_KEY_ID}" \
              -H "Authorization: ${CORTEX_API_KEY}" | jq -r '.signed_url')
            set -x
            curl -fsSL -o cortexcli "$CRTX_URL"
            chmod +x cortexcli
            ./cortexcli --version
        script:
          - |
            ./cortexcli \
              --api-base-url "${CORTEX_API_URL}" \
              --api-key "${CORTEX_API_KEY}" \
              --api-key-id "${CORTEX_API_KEY_ID}" \
              code scan \
              --directory "${CI_PROJECT_DIR}" \
              --repo-id "${CI_PROJECT_PATH}" \
              --branch "${CI_COMMIT_REF_NAME}" \
              --source "CORTEX_CLI" \
              --upload-mode no-upload \
              --create-repo-if-missing
        artifacts:
          when: always
          paths: [cortexcli]
          expire_in: 1 day

<!-- -->

- For ARM architecture

<!-- -->

- stages: [scan]
      variables:
        CORTEX_API_URL: "https://api-viso-8vocygkchsephm7mczadnc.xdr-qa2-uat.us.paloaltonetworks.com"
      cortex_code_scan:
        image: node:22-bookworm
        stage: scan
        rules:
          - when: on_success
        before_script:
          - set -euo pipefail
          - apt-get update
          - apt-get install -y --no-install-recommends curl jq ca-certificates tar gzip file
          - export CORTEXCLI_HOME="/root/.cortexcli"; rm -rf "$CORTEXCLI_HOME" || true; mkdir -p "$CORTEXCLI_HOME"
          - |
            # avoid leaking secrets in logs
            set +x
            CRTX_URL=$(curl -fsSL "${CORTEX_API_URL}/public_api/v1/unified-cli/releases/download-link?os=linux&architecture=arm64" \
              -H "x-xdr-auth-id: ${CORTEX_API_KEY_ID}" \
              -H "Authorization: ${CORTEX_API_KEY}" | jq -r '.signed_url')
            set -x
            curl -fsSL -o cortexcli "$CRTX_URL"
            chmod +x cortexcli
            ./cortexcli --version
        script:
          - |
            ./cortexcli \
              --api-base-url "${CORTEX_API_URL}" \
              --api-key "${CORTEX_API_KEY}" \
              --api-key-id "${CORTEX_API_KEY_ID}" \
              code scan \
              --directory "${CI_PROJECT_DIR}" \
              --repo-id "${CI_PROJECT_PATH}" \
              --branch "${CI_COMMIT_REF_NAME}" \
              --source "CORTEX_CLI" \
              --upload-mode no-upload \
              --create-repo-if-missing
        artifacts:
          when: always
          paths: [cortexcli]
          expire_in: 1 day

####### Jenkins

- For AMD architecture

<!-- -->

- pipeline {
          agent {
              docker {
                  image 'cimg/node:22.17.0' // Replace with a suitable image or executor
                  args '-u root'
              }
          }
          environment {
              CORTEX_API_KEY = credentials('CORTEX_API_KEY')
              CORTEX_API_KEY_ID = credentials('CORTEX_API_KEY_ID')
              CORTEX_API_URL = 'https://api-viso-cq3sdpg7uyd6vqk66ccjyv.xdr-qa2-uat.us.paloaltonetworks.com'
          }
          stages {
              stage('Checkout Repository') {
                  steps {
                        git branch: 'main', url: 'this-is-repository-url-example'
                        stash includes: '**/*', name: 'source'
                  }
              }
              stage('Install Dependencies') {
                  steps {
                      sh '''
                      apt update
                      apt install -y curl jq git
                      '''
                  }
              }
              stage('Download cortexcli') {
                  steps {
                      script {
                          def response = sh(script: """
                              curl --location '${env.CORTEX_API_URL}/public_api/v1/unified-cli/releases/download-link?os=linux&architecture=amd64' \
                                --header 'Authorization: ${env.CORTEX_API_KEY}' \
                                --header 'x-xdr-auth-id: ${env.CORTEX_API_KEY_ID}' \
                                --silent
                          """, returnStdout: true).trim()
                          def downloadUrl = sh(script: """echo '${response}' | jq -r '.signed_url'""", returnStdout: true).trim()
                          sh """
                              curl -o cortexcli '${downloadUrl}'
                              chmod +x cortexcli
                              ./cortexcli --version
                          """
                      }
                  }
              }
              stage('Run Scan') {
              // Replace the repo-id with your repository like: owner/repo
                  steps {
                      script {
                          unstash 'source'
                          sh """
                          ./cortexcli \
                            --api-base-url "${env.CORTEX_API_URL}" \
                            --api-key "${env.CORTEX_API_KEY}" \
                            --api-key-id "${env.CORTEX_API_KEY_ID}" \
                            code scan \
                            --directory "\$(pwd)" \
                            --repo-id <REPLACE WITH REPO_OWNER/REPO_NAME> \
                            --branch <REPLACE WITH BRANCH> \
                            --source "JENKINS" \
                            --create-repo-if-missing
                          """
                      }
                  }
              }
          }
      }

<!-- -->

- For ARM architecture

<!-- -->

- pipeline {
          agent {
              docker {
                  image 'cimg/node:22.17.0' // Replace with a suitable image or executor
                  args '-u root'
              }
          }
          environment {
              CORTEX_API_KEY = credentials('CORTEX_API_KEY')
              CORTEX_API_KEY_ID = credentials('CORTEX_API_KEY_ID')
              CORTEX_API_URL = 'https://api-viso-89wjoyyvubntuqjnq8mfub.xdr-qa2-uat.us.paloaltonetworks.com'
          }
          stages {
              stage('Checkout Repository') {
                  steps {
                        git branch: 'main', url: 'this-is-repository-url-example'
                        stash includes: '**/*', name: 'source'
                  }
              }
              stage('Install Dependencies') {
                  steps {
                      sh '''
                      apt update
                      apt install -y curl jq git
                      '''
                  }
              }
              stage('Download cortexcli') {
                  steps {
                      script {
                          def response = sh(script: """
                              curl --location '${env.CORTEX_API_URL}/public_api/v1/unified-cli/releases/download-link?os=linux&architecture=arm64' \
                                --header 'Authorization: ${env.CORTEX_API_KEY}' \
                                --header 'x-xdr-auth-id: ${env.CORTEX_API_KEY_ID}' \
                                --silent
                          """, returnStdout: true).trim()
                          def downloadUrl = sh(script: """echo '${response}' | jq -r '.signed_url'""", returnStdout: true).trim()
                          sh """
                              curl -o cortexcli '${downloadUrl}'
                              chmod +x cortexcli
                              ./cortexcli --version
                          """
                      }
                  }
              }
              stage('Run Scan') {
              // Replace the repo-id with your repository like: owner/repo
                  steps {
                      script {
                          unstash 'source'
                          sh """
                          ./cortexcli \
                            --api-base-url "${env.CORTEX_API_URL}" \
                            --api-key "${env.CORTEX_API_KEY}" \
                            --api-key-id "${env.CORTEX_API_KEY_ID}" \
                            code scan \
                            --directory "\$(pwd)" \
                            --repo-id <REPLACE WITH REPO_OWNER/REPO_NAME> \
                            --branch <REPLACE WITH BRANCH> \
                            --source "JENKINS" \
                            --create-repo-if-missing
                          """
                      }
                  }
              }
          }
      }

###### Ingest third-party data

Cortex XSIAM supports third-party data ingestion, which augments native
findings with additional context to strengthen your security posture.
Application Security supports the following third party ingestions:

- [Ingest Veracode SAST data](#UUIDd962ba0a04ee540d00f83944be25c90f)

- [Ingest SonarQube SAST data](#UUID626bee24f4e7d4a06e2605505c84047b)

- [Ingest Semgrep data](#UUID13f41fd68814b45d8bdc8eed104040be)

- [Generic 3rd Party AppSec
  Collector](#UUIDb8831534126060fa0e8c23d64129b34e)

> **Note**
>
> Only onboarded and scanned repositories can be mapped.

####### View ingested data and generated issues

**SAST findings and issues**

- **Code Weaknesses** issues page: View SAST issues on the
  [/document/preview/1126197#UUID-dc07deb4-383f-e487-1a84-786e72d0ce33](/document/preview/1126197#UUID-dc07deb4-383f-e487-1a84-786e72d0ce33)
  page. Select the **Findings** tab for findings

- Asset inventories: The **Code Weaknesses** tab on the
  [Repositories](#UUID929bbcfbc88cc71456d696269fe944cb) and [Business
  Applications](#UUIDa7ca1d8292ceff2480bd59b229e2ac47) side cards

**CVE vulnerabilities findings and issues**

- **Vulnerabilities** issues page. View CVE vulnerabilities on the
  [Software Composition Analysis (SCA) CVE vulnerability
  issues](#UUIDd5b6e8c8c4b7665e8015abd242bfc0bf) page. Select the
  **Findings** tab for findings

- Asset inventories: The **Vulnerabilities** tab on the
  [Repositories](#UUID929bbcfbc88cc71456d696269fe944cb) and [Business
  Applications](#UUIDa7ca1d8292ceff2480bd59b229e2ac47) side cards

**License miscompliance findings and issues**

- **Licenses** issues page. View license miscompliance on the [License
  miscompliance issues](#UUID89645b7b3ae4ffec90c4bde04a122e6a) page.
  Select the **Findings** tab for findings

- Asset inventories: The **Package Integrity** tab on the
  [Repositories](#UUID929bbcfbc88cc71456d696269fe944cb) and [Business
  Applications](#UUIDa7ca1d8292ceff2480bd59b229e2ac47) side cards

####### Ingest Veracode SAST data

You can ingest SAST findings directly from Veracode into Application
Security. This allows you to use Application Security\'s analysis and
visualization tools to identify critical vulnerabilities, prioritize
remediation efforts, and improve your application code security.

Veracode supports `CycloneDX`, `json` and table output formats.

######## How to connect Veracode with Application Security

> **Prerequisite**

- > Permissions: The following user permissions are required:

  - > Cortex Cloud: Instance Admin, AppSec Admin or GRBAC permissions.
    > For more information on AppSec Admin permissions, refer to [Code
    > Security user roles and
    > permissions](#UUID9dde913be1821e03e231f10b92025043)

  - > Veracode: At minimum, Reviewer permissions are required

- > Ensure that you have a connected version control system (VCS) system
  > and repositories

- > Generate and copy a Veracode access key. The access key includes a
  > key ID and secret

- > Create an egress path to establish the designated route for outbound
  > data transmission from Cortex XSIAM to third party services. For
  > more information about configuring egress paths, refer to
  > [/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2](/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2)

1.  Select Settings \> Data Sources (under Data Collections) \> + Data
    Source.

2.  Input Veracode in the search bar \> Hover over the Veracode card \>
    Connect.

- > **Note**

  > Select **Connect Another Instance** if an instance has already been
  > configured.

3.  On the **Configure Integration** step of the integration wizard:

    a.  Fill in the provided fields:

        - Enter the Veracode key ID and secret (generated as part of the
          prerequisites above) into their respective fields

        - Select your Veracode region from the **Region** dropdown

    b.  Click **Authorize**.

    - The integration**Select Applications** step of the integration
      wizard is displayed, including a list of Veracode applications
      automatically mapped to Application Security repositories.

4.  Map Veracode applications to Cortex XSIAM repositories.

    a.  Review the application-repository mappings displayed in the
        list. You can select a different repository and branch if
        required.

    b.  Map unmapped Veracode projects by associating them with a Cortex
        XSIAM repository and branch.

    c.  Select **Automatically map future Veracode applications** to
        automatically map future Veracode applications to Cortex XSIAM
        repositories. This is recommended to ensure maximum security
        coverage.

    d.  Select Save.

- > **Note**

  - > Mapping establishes relationships between Veracode projects and
    > Application Security code repositories, simplifying access
    > management and enabling risk analysis at the repository level,
    > including displaying findings on the tenant

  - > Only mapped applications are ingested

5.  Verify that the **Instance Successfully Created** message is
    displayed on the **Status** step of the wizard, and click Close.

- An automatic ingestion of data from integrated Veracode applications
  is initiated.

6.  Verify integration and confirm that the your integrated Veracode
    instance has a status of **Connected**.

    a.  Navigate to Settings \> Data Sources \> search for Veracode in
        the search bar.

    b.  Hover over the resulting entry and click View Details.

    c.  Ensure that the status of your Veracode instance is
        **Connected**.

    d.  Select the Veracode instance.

    e.  Verify the Veracode application - Cortex XSIAM repository
        mapping.

######## Limitations

- Currently, Veracode SAST ingestion supports Veracode periodic and CLI
  scans. Pull Request scans and other types are not supported

- History, deduplication and DevEx features such as PR comments, IDE,
  CLI and enforcement are not supported

######## View SAST code weaknesses generated from ingested Veracode findings

You can view SAST code weaknesses generated from ingested Veracode
findings:

- On the **Code Weaknesses** page under Application Security **Issues**

- Under the **Code Weaknesses** tab of the **Repositories** assets page

For more information on SAST code weaknesses, refer to
[/document/preview/1126197#UUID-dc07deb4-383f-e487-1a84-786e72d0ce33_section-idm234736924479834](/document/preview/1126197#UUID-dc07deb4-383f-e487-1a84-786e72d0ce33_section-idm234736924479834).

######## Manage connections

To manage Veracode connections, refer to
[/document/preview/1235713#UUID-6fb604f2-1bce-b37a-1f4e-44a7337d1400](/document/preview/1235713#UUID-6fb604f2-1bce-b37a-1f4e-44a7337d1400).

####### Ingest SonarQube SAST data

You can ingest SAST findings directly from SonarQube into Application
Security. This allows you to use Application Security\'s analysis and
visualization tools to identify critical vulnerabilities, prioritize
remediation efforts, and improve your application code security.

SonarQube supports json output format.

######## How to connect SonarQube with Application Security

> **Prerequisite**

- > Permissions: Ensure you have System Admin, AppSec Admin or GRBAC
  > permissions. For more information on AppSec Admin permissions, refer
  > to [Code Security user roles and
  > permissions](#UUID9dde913be1821e03e231f10b92025043)

- > Ensure that you have a connected version control system (VCS) and
  > repositories

- > Generate and copy a SonarQube API token. Ensure to assign
  > **Web API** scope to the API token. Refer to the [SonarQube
  > documentation](https://docs.sonarsource.com/sonarqube-server/latest/user-guide/managing-tokens/#generating-a-token)
  > for more information

- > Create an egress path to establish the designated route for outbound
  > data transmission from Cortex XSIAM to third party services. For
  > more information about configuring egress paths, refer to
  > [/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2](/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2)

<!-- -->

- > **Note**

  > The egress path is required for onboarding a self-hosted instance of
  > SonarQube.

1.  Select Settings \> Data Sources (under Data Collections) \> + Data
    Source.

2.  Enter SonarQube in the search bar \> Hover over the displayed search
    result \> Connect.

- > **Note**

  >  

  > Select **Connect Another Instance** if an instance has already been
  > configured.

3.  On the **Configure Integration** step of the integration wizard:

    a.  Fill in the provided fields:

        - **API Token**: Paste the generated SonarQube API token

        - **URL and Port**: Provide the URL of your SonarQube instance.
          Port is optional

        - **Organization**: The SonarQube organization to be associated
          with the data ingestion. Required for SonarQube Cloud

    b.  Click Accept.

4.  On the **Select Applications** step of the integration wizard:

    a.  Select an option:

        - Accept the displayed mapping as detected by Application
          Security. This does not require any action on your part

        - Manually configure mapping if Application Security could not
          match a project to a repository: Select **Set** in the
          Application Security Repository column, and select a
          repository from the list that is displayed

        - Automatically map future SonarQube projects

        - Manually modify mapping: Click **Replace** next to the
          existing mapped Application Security repository. This will
          open an option to select a different repository from the
          displayed list, allowing you to update the mapping

    - > **Note**

      - > Mapping establishes relationships between SonarQube
        > Applications and Application Security code repositories,
        > simplifying access management and enabling risk analysis at
        > the repository level, including displaying findings on the
        > tenant

      - > Only mapped projects will be ingested

    b.  Click Save.

5.  Select **Close** on the **Status** step of the wizard to complete
    the integration, initiating an automatic ingestion of data from the
    integrated SonarQube projects.

- > **Note**

  > Verify that the **Connector Created Successfully** message is
  > displayed on the page.

6.  Verify integration and confirm that the your integrated SonarQube
    instance has a status of **Connected**.

    a.  On **Data Sources**, search for SonarQube in the search bar.

    b.  Hover over the resulting entry and click View More.

    c.  Verify that the status of your SonarQube instance is
        **Connected**.

######## View SAST code weaknesses generated from ingested SonarQube findings

You can view SAST code weaknesses generated from ingested SonarQube
findings:

- On the **Code Weaknesses** page under Application Security **Issues**

- Under the **Code Weaknesses** tab of the **Repositories** assets page

For more information on SAST code weaknesses, refer to
[/document/preview/1126197#UUID-dc07deb4-383f-e487-1a84-786e72d0ce33_section-idm234736924479834](/document/preview/1126197#UUID-dc07deb4-383f-e487-1a84-786e72d0ce33_section-idm234736924479834).

######## Manage SonarQube connections

To manage SonarQube connections, refer to
[/document/preview/1235713#UUID-6fb604f2-1bce-b37a-1f4e-44a7337d1400](/document/preview/1235713#UUID-6fb604f2-1bce-b37a-1f4e-44a7337d1400).

####### Ingest Semgrep data

You can ingest both SAST and SCA findings directly from Semgrep into
Application Security. This allows you to use Cortex XSIAM analysis and
visualization tools to identify critical vulnerabilities, prioritize
remediation efforts, and improve your application code security.

Semgrep supports json, text and SARIF output formats.

######## How to connect Semgrep with Application Security

> **Prerequisite**

- > Permissions: Ensure you have System Admin, AppSec Admin or GRBAC
  > permissions. For more information on AppSec Admin permissions, refer
  > to [Code Security user roles and
  > permissions](#UUID9dde913be1821e03e231f10b92025043)

- > Ensure that you have a connected version control system (VCS) and
  > repositories

- > Create a Semgrep API token

<!-- -->

- > **Note**

  > To create a Semgrep API token, in Semgrep, navigate to Settings \>
  > Tokens \> API tokens.

<!-- -->

- > Create an egress path to establish the designated route for outbound
  > data transmission from Cortex XSIAM to third party services. For
  > more information about configuring egress paths, refer to
  > [/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2](/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2)

1.  Select Settings \> Data Sources (under Data Collections) \> + Data
    Source.

2.  Enter Semgrep in the search bar \> Hover over the displayed search
    result \> Connect.

- > **Note**

  > Select **Connect Another Instance** if an instance has already been
  > configured.

3.  On the **Configure Integration** step of the integration wizard:
    Provide your Semgrep API Secrets value and click **Next**.

4.  On the **Select Issues Types** step of the integration wizard,
    select the type of data findings to be ingested. Options: **SAST**,
    **SCA**, or both.

5.  Map Semgrep projects to Cortex XSIAM repositories on the
    **Select Projects** step of the integration wizard.

    a.  Options:

        - Accept the displayed mapping as detected by Cortex XSIAM. This
          does not require any action on your part

        - Manually configure mapping if Cortex XSIAM cannot match a
          project to a repository: Select **Set** in the Cortex XSIAM
          **Repository** column, and select a repository from the list
          that is displayed

        - Automatically map future Semgrep projects

        - Manually modify mapping: Click **Replace** next to the
          existing mapped Cortex XSIAM repository. This will open an
          option to select a different repository from the displayed
          list, allowing you to update the mapping

    - > **Note**

      - > Mapping establishes relationships between Semgrep Projects
        > Applications and Cortex XSIAM code repositories, simplifying
        > access management and enabling risk analysis at the repository
        > level, including displaying findings on the tenant

      - > Only mapped projects will be ingested

    b.  Click Save.

6.  Verify integration and confirm that the your integrated Semgrep
    instance has a status of **Connected**.

    a.  On **Data Sources**, search for Semgrep in the search bar.

    b.  Hover over the resulting entry and click View More.

    c.  Verify that the status of your Semgrep instance is
        **Connected**.

######## Manage SAST code weaknesses generated from ingested Semgrep findings

You can view SAST code weaknesses generated from ingested Semgrep
findings:

- On the **Code Weaknesses** page under Application Security **Issues**

- Under the **Code Weaknesses** tab of the **Repositories** assets page

For more information on SAST code weaknesses, refer to
[/document/preview/1126197#UUID-dc07deb4-383f-e487-1a84-786e72d0ce33_section-idm234736924479834](/document/preview/1126197#UUID-dc07deb4-383f-e487-1a84-786e72d0ce33_section-idm234736924479834).

######## Manage SCA issues generated from ingested Semgrep findings

You can view SCA vulnerabilities generated from ingested Semgrep
findings.

- **CVE vulnerabilities**:

  - On the **Vulnerabilities** page under Application Security
    **Issues**

  - Under the **Vulnerabilities** tab of the **Software Packages**
    assets page

- **License miscompliance issues**:

  - On the **Licenses** page under under Application Security **Issues**

  - Under the **Package Integrity** tab of the **Software Packages**
    assets page

For more information on SCA issues, refer to
[#UUIDba218b3f28080b0a69865f24bf36748c](#UUIDba218b3f28080b0a69865f24bf36748c).

######## Manage Semgrep connections

To manage Semgrep connections, refer to
[/document/preview/1235713#UUID-6fb604f2-1bce-b37a-1f4e-44a7337d1400](/document/preview/1235713#UUID-6fb604f2-1bce-b37a-1f4e-44a7337d1400).

####### Generic 3rd Party AppSec Collector

The **3rd Party AppSec Collector** automatically uploads Static
Application Security Testing (SAST) data from third-party tools that
support SARIF (Static Analysis Results Interchange Format) output. This
allows you to view your SAST data directly within Cortex XSIAM. Once
SARIF files are uploaded, they are parsed to create code findings. These
findings can then be elevated to issues, either manually or
automatically, depending on your configured policies.

> **Important**
>
> File uploads are limited to a maximum size of 10 MB.

After onboarding the **3rd Party AppSec Collector**, you can view SAST
code weaknesses generated from ingested SARIF findings in these
locations:

- On the **Code Weaknesses** page under Application Security **Issues**

<!-- -->

- For more information about SAST issues under **Code Weaknesses**
  issues, refer to
  [#UUIDb22133d4c86db07a113993dd1e83e55c](#UUIDb22133d4c86db07a113993dd1e83e55c)

<!-- -->

- Under dedicated **Code Weaknesses** tabs on the **Repositories** or
  **Business Applications** assets pages, where relevant SAST issues
  have been identified for that asset.

  - For more information about SAST issues on the **Code Weaknesses**
    tab under **Repositories** assets, refer to [In-depth repository
    asset information](#UUID929bbcfbc88cc71456d696269fe944cb)

  - For more information about SAST issues on the **Code Weaknesses**
    tab under **Business Applications** assets, refer to [Business
    application expanded asset
    details](#UUIDa7ca1d8292ceff2480bd59b229e2ac47)

######## Onboard the 3rd Party AppSec Collector

Before you begin, fulfill these prerequisites.

> **Prerequisites**

- > **Permissions**: The following Cortex XSIAM user roles or RBAC
  > permissions are required:

  - > **User roles**: CortexCortex XSIAM Cloud **Instance Admin**,
    > **AppSec Admin**

  - > **RBAC**: **View/Edit** permissions for **Data Sources**
    > configurations are required when not using a dedicated user role

<!-- -->

- > For more information about user permissions and groups, refer to
  > [Assign user roles and
  > groups](#UUIDc0966cb32b3c88e214d33131de93fa8a).

<!-- -->

- > Onboard the repository into the system before SARIF findings for
  > that repository can be uploaded

- > **SARIF specifications**: Uploaded findings must follow the standard
  > SARIF specification. These fields are mandatory:

  - > Tool.driver.version

  - > results\[\].message.text OR message.id

  - > tool.driver.rules

  - > rule.id

  - > result.ruleId

  - > result.level  (if missing set the default)

  - > Result.locations

  - > fullDescription

- > Only upload findings relevant to the repository, excluding unrelated
  > data such as CVEs

- > Create an egress path to establish the designated route for outbound
  > data transmission from Cortex XSIAM to third party services. For
  > more information about configuring egress paths, refer to
  > [/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2](/document/preview/1201179#UUID-92a164f9-0193-4a89-1194-4807bab04bc2)

1.  Select Settings \> Data Sources (under Data Collection) \> + Data
    Source \> enter 3rd Party AppSec Collector in the search bar.

2.  On the **Configure Collector** step of the integration wizard.

    a.  Fill in the provided fields:

        - **Detection Method**: Currently **SAST** is the supported
          detection method

        - **File Type**: Currently **SAST** is the supported file type

        - **Finding Source**: **3rd party SAST**: This field is
          automatically populated after selecting the SAST file type

        - **Collector Name** (required): This is a free-text field. You
          can input any descriptive name.

        <!-- -->

        - > **Note**

          > We recommend using the `tool.driver.name` from the SARIF
          > file

    b.  Click Generate API Key to obtain the collector instance API key
        ID and key secret.

3.  On the **API Key** step of the integration wizard.

    a.  Copy and save the generated API key ID and API secret.

    - > **Warning**

      > The API key ID and API secret cannot be retrieved once the
      > wizard is closed.

    b.  Copy the API URL.

    - > **Note**

      > This is the newly created generic collector API URL endpoint.

    c.  Select Next.

4.  (Optional): Validate the file format on the **Test** step of the
    wizard to ensure it meets all ingestion requirements.

- > **Note**

  > Only the validity of the format is tested. No findings will be
  > generated from the test file.

  a.  Browse and upload the required file.

  - After upload, you\'ll see one of the following validation outcomes:

    - Validation completed successfully

    - Validation finished with warnings: One or more of the properties
      of at least one of the **results** of the SARIF format failed
      validation

    - Validation failed: one of the mandatory fields is missing/wrong
      value. See SARIF mandatory fields in the prerequisites above

  b.  Select Done.

5.  Setup the data extraction to programmatically send the SARIF SAST
    results to the Cortex XSIAM **3rd Party AppSec Collector** instance
    via API.

- You need to add the following values to the API request:

  - The Cortex XSIAM API key ID and secret generated in **step 2** above

  - The Cortex XSIAM URL copied in **step 3** above

  - Your Cortex XSIAM repository ID. To retrieve the repository ID,
    under **Inventory**, navigate to All Assets \> Repositories (under
    Code) \> select a repository \> copy the Asset ID value from the
    Properties section of the side card

  - (Optional) Branch: Default unless specified

  Example Setups
  - `cURL`

  <!-- -->

  - curl -X POST {API_URL_FROM_RESPONSE}?repository_id={repository_asset_id}&branch={branch_name} -H 'x-crtx-auth-id: {token_id}' -H 'Authorization: {api_token}' -H 'Content-Type: application/json' -d '{"example": "value"}' 

  <!-- -->

  - Full `cURL` example

  <!-- -->

  - curl --location '{base-URL}' \
          --header 'Authorization:{API_KEY}' \
          --header 'x-crtx-auth-id: {API_KEY_ID}' \
          --header 'Content-Type: application/json' \
          --data '{
            "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
            "version": "2.1.0",
            "runs": [
              {
                "tool": {
                  "driver": {
                    "name": "Veracode Static Analysis Policy Scan",
                    "rules": [
                      {
                        "id": "78",
                        "name": "Improper Neutralization of Special Elements used in an OS Command ('\\''OS Command Injection'\\'')",
                        "shortDescription": {
                          "text": "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('\\''OS Command Injection'\\'')"
                        },
                        "helpUri": "https://cwe.mitre.org/data/definitions/78.html",
                        "properties": {
                          "category": "STATIC",
                          "tags": [
                            "STATIC"
                          ]
                        },
                        "defaultConfiguration": {
                          "level": "error"
                        }
                      },
                      {
                        "id": "89",
                        "name": "Improper Neutralization of Special Elements used in an SQL Command ('\\''SQL Injection'\\'')",
                        "shortDescription": {
                          "text": "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('\\''SQL Injection'\\'')"
                        },
                        "helpUri": "https://cwe.mitre.org/data/definitions/89.html",
                        "properties": {
                          "category": "STATIC",
                          "tags": [
                            "STATIC"
                          ]
                        },
                        "defaultConfiguration": {
                          "level": "error"
                        }
                      }
                    ],
                    "version": "1.0"
                  }
                },
                "results": [
                  {
                    "level": "error",
                    "rank": 5,
                    "message": {
                      "text": "<span>This call to java.lang.ProcessBuilder.start() contains a command injection flaw.  The argument to the function is constructed using untrusted input.  If an attacker is allowed to specify all or part of the command, it may be possible to execute commands on the server with the privileges of the executing process.  The level of exposure depends on the effectiveness of input validation routines, if any. start() was called on the processBuilder object, which contains tainted data. The tainted data originated from an earlier call to AnnotationVirtualController.vc_annotation_entry.</span> <span>Validate all untrusted input to ensure that it conforms to the expected format, using centralized data validation routines when possible.  When using blocklists, be sure that the sanitizing routine performs a sufficient number of iterations to remove all instances of disallowed characters.  Most APIs that execute system commands also have a \\\"safe\\\" version of the method that takes an array of strings as input rather than a single string, which protects against some forms of command injection.</span> <span>References: <a href=\\\"https://cwe.mitre.org/data/definitions/78.html\\\">CWE</a> <a href=\\\"https://owasp.org/www-community/attacks/Command_Injection\\\">OWASP</a></span>"
                    },
                    "locations": [
                      {
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "com/scalesec/vulnado/Cowsay.java"
                          },
                          "region": {
                            "startLine": 16
                          }
                        },
                        "logicalLocations": [
                          {
                            "name": "Cowsay.java",
                            "fullyQualifiedName": "com.scalesec.vulnado.Cowsay.run",
                            "kind": "function"
                          },
                          {
                            "fullyQualifiedName": "java.lang.ProcessBuilder.start",
                            "kind": "member",
                            "parentIndex": 0
                          }
                        ]
                      }
                    ],
                    "ruleId": "78",
                    "partialFingerprints": {
                      "context_guid": "",
                      "file_path": "",
                      "procedure": ""
                    }
                  },
                  {
                    "level": "error",
                    "rank": 4,
                    "message": {
                      "text": "<span>This database query contains a SQL injection flaw.  The call to java.sql.Statement.executeQuery() constructs a dynamic SQL query using a variable derived from untrusted input.  An attacker could exploit this flaw to execute arbitrary SQL queries against the database. The first argument to executeQuery() contains tainted data from the variable query. The tainted data originated from an earlier call to AnnotationVirtualController.vc_annotation_entry.</span> <span>Avoid dynamically constructing SQL queries.  Instead, use parameterized prepared statements to prevent the database from interpreting the contents of bind variables as part of the query.  Always validate untrusted input to ensure that it conforms to the expected format, using centralized data validation routines when possible.</span> <span>References: <a href=\\\"https://cwe.mitre.org/data/definitions/89.html\\\">CWE</a> <a href=\\\"https://owasp.org/www-community/attacks/SQL_Injection\\\">OWASP</a></span>"
                    },
                    "locations": [
                      {
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "com/scalesec/vulnado/User.java"
                          },
                          "region": {
                            "startLine": 49
                          }
                        },
                        "logicalLocations": [
                          {
                            "name": "User.java",
                            "fullyQualifiedName": "com.scalesec.vulnado.User.fetch",
                            "kind": "function"
                          },
                          {
                            "fullyQualifiedName": "java.sql.Statement.executeQuery",
                            "kind": "member",
                            "parentIndex": 0
                          }
                        ]
                      }
                    ],
                    "ruleId": "89",
                    "partialFingerprints": {
                      "context_guid": "",
                      "file_path": "",
                      "procedure": ""
                    }
                  }
                ]
              }
            ]
          }'

  <!-- -->

  - `Python 3`

  <!-- -->

  - import requests
        import json

        def generic_collector(token_id, api_token):
            headers = {
                "Authorization": {token_id},
                "x-crtx-auth-id": {api_token},
                "Content-Type": "application/json"
            }

            body = json.dumps({"example": "value"})
            res = requests.post(url="{API_URL_FROM_RESPONSE}?repository_id={repository_asset_id}&branch={branch_name}",
                                headers=headers,
                                data=body)
            return res

6.  Validate the connector status.

    a.  Select Settings \> Data Sources \> locate 3rd Party AppSec
        Collector in the search bar.

    b.  Select **View Details**.

    c.  Check that your instance is displayed on the
        **Collector Instances** page, and that the status of your
        instance is **Connected**.

######### Manage **3rd Party AppSec Collector** instances

1.  Select Settings \> Data Sources \> locate 3rd Party AppSec Collector
    in the search bar.

2.  Select **View Details**.

3.  Right-click on your instance \> Edit instance.

- You are redirected to the **Generic 3rd Party AppSec Collector**
  onboarding wizard to modify required content.

###### Manage data source integrations

Manage integrations to align with evolving requirements and ensure they
remain current.

1.  Select Settings \> Data Sources \> use the search bar to locate the
    required data source.

2.  Hover over a data source and click View Details.

- A list of instances for the selected data source is displayed.

3.  Right-click on an instance and select an option:

    - Edit instance: Redirects to the **Select Repositories** step of
      the integration wizard, where you can modify configurations for
      the selected instance. For more details, refer to the relevant
      integration guide

    - Delete instance: When confirmed, deletes the instance, including
      data from previous scans

##### Transporter over Broker VM

The Transporter over Broker VM enables secure communication between your
self-hosted Version Control Systems (VCS) and Cortex XSIAM. This
solution addresses the need for secure code scanning without exposing
your internal network to the cloud.

The Transporter over Broker VM solution includes the following key
components:

- **Transporter applet** This component runs within your internal
  network, specifically on a Broker VM. The applet requires access to
  your self-hosted version control providers (VCS) such as GitHub
  Server. The Transporter:

  - Establishes and maintains secure, long-lived connections to both the
    Cortex XSIAM tenant and your VCS providers

  - Operates based on events from the VCS provider or triggers initiated
    from Cortex XSIAM

- **Broker VM**: In the Application Security environment, the Broker VM
  is a secured virtual machine (VM) designed to host the Transporter
  applet within your network. The Transporter applet is installed as an
  application or connector directly onto the Broker VM.

<!-- -->

- > **Note**

  - > The broker enables multiple connections, allowing a single
    > Transporter applet to connect to various VCS instances

  - > Multiple Transporter applets cannot be created on a single Broker
    > VM. Each Broker VM is limited to a single Transporter applet
    > instance

<!-- -->

- **Cortex XSIAM tenant:** Serves as the central cloud platform with
  several key functions in the Transporter system:

  - Acts as the cloud endpoint for the secure, long-lived WebSocket
    tunnel established by the Transporter applet running on your Broker
    VM

  - Links the Transporter applet to your self-managed VCS data sources,
    utilizing the secure tunnel for all communication.

  - Receives the data uploaded by the Transporter from your environment

  - Server as the scanner execution environment and results

  - Provides the interface for configuring and managing the Transporter
    system, as well as reviewing and managing the scan results

  - Monitors the status and health of your Transporter applets,
    providing visibility into their operation

The order for setting up the Transporter solution is as follows:

> **Prerequisites**

- > Ensure you have the necessary permissions and have already set up
  > your Broker VM

- > Confirm that your Broker is v 28 or above

- > Whitelist IP addresses to enable access to Cortex XSIAM resources.
  > The IP addresses for the Transporter are in the Broker VM Resources
  > section of the [Enable access to required PANW
  > resources](#UUID24cb15454f44c259b484435238bb6a33) document

- > Open port `4052` (inbound), which is required for the Transporter\'s
  > IP address communication

- > Open Port `443` (outbound), which is required for the Broker VM to
  > pull data from the your version control system (VCS)

1.  [Set up the Transporter applet on your Broker
    VM](#UUID8450e7114b7ffd71220ece7f0a763dd6).

2.  [Onboard the Transporter on your
    VCS](#UUID556ddcc5b44b5994ed4bab2b840d8a28).

###### License

To gain access to the Transporter applet, your Cortex XSIAM license must
be **C1** (Posture management) or above.

> **Warning**
>
> The Transporter applet is not supported for FedRAMP customers.

###### Use cases

- **Enhanced security**: Establish a secure network tunnel for your
  self-hosted VCS, eliminating the need to open direct IP access to the
  cloud for scanning

- **Seamless Integration**: Leverage the existing Cortex XSIAM Broker VM
  infrastructure to deploy and manage the Transporter applet

- **Simplified management**: Configure and manage the Transporter applet
  directly through the Cortex XSIAM console

- **Automated updates**: The Broker VM automatically receives updates
  and enhancements, providing new capabilities to the Transporter
  without manual intervention

###### Setup a Transporter applet on Broker VM

This section describes how to set up and configure a Transporter applet
on a Broker VM.

> **Prerequisite**
>
> **Permissions**: To configure and manage Transporter applet settings,
> you must have permissions to manage **Broker Service** configurations
> (such as an **Instance Administrator**)

1.  Setup a Broker VM.

- Refer to [Set up and configure Broker
  VM](#UUIDa2b1b832d74850d81f427e175514c501).

2.  Select Settings \> Configurations \> Broker VMs (under Data Broker).

3.  Select the Brokers tab \> locate your Broker VM \> hover and click +
    Add under the Apps column \> AppSec Transporter.

- A connector for AppSec Transporter is opened.

  > **Note**

  > You cannot add a Transporter applet through **Clusters**.

4.  Configure the Transporter connection in the provided fields:

    - **Transporter Name** (required). Requires a unique name as you can
      integrate multiple applets for different integrations

    - **Provider Self Signed CA Certificate Path**: Specify the file
      path for a custom Certificate Authority (CA) certificate used by
      the Transporter to securely communicate with services

5.  Click Save.

6.  Verify integration and connectivity: Locate your
    **AppSec Transporter** applet under the **Apps** column. Click it to
    confirm it displays a **Connected** status.

- Proceed to configure the Transporter applet on your self-managed VCS
  data sources instance.

####### Add Connections

The broker enables multiple connections, allowing a single Transporter
applet to connect to various VCS instances (such as GitHub and GitLab).

1.  Select your AppSec Transporter under the App column \> Configure \>
    Add Connection (on the redirected AppSec Transporter setup page).

2.  Repeat **steps 4-6** of [Setup a Transporter applet on Broker
    VM](#UUID8450e7114b7ffd71220ece7f0a763dd6) above.

####### Manage Transporter applets

To manage Transporter applet configurations, disable connections, or
deactivate an applet, navigate to the Broker VMs page. From there,
select your **Appsec Transporter** under the App column.

- **Edit applet configurations**: Select the Appsec Transporter under
  the App column \> Configure. You are redirected to the Transporter
  applet settings to manage its configurations

- **Disable applet connection for a single integration**:

  1.  Select the Appsec Transporter under the App column \> Configure.

  2.  On the Transporter applet configurations page, click on the
      specific Transporter applet \> Disable.

  - This disables the specific integration, but it can be re-enabled.

- **Deactivate an applet** (all connections): Select the Appsec
  Transporter under the App column \> Deactivate \> Confirm when
  prompted

<!-- -->

- All existing connections are deleted but their configurations are
  saved in the database. When adding a new connection, you\'ll be
  prompted if you want to reuse previous configurations.

###### Setup a Transporter on your VCS

You configure a Transporter when onboarding your on-premises version
control system (VCS). This setup is performed on the
**Configure Domain** step of the onboarding wizard. GitHub Server,
GitLab self-managed and Bitbucket Data Center version control systems
support the Transporter integration, where it functions as a network
tunnel.

> **Prerequisites**

- > Ensure you have user permissions to onboard data sources

<!-- -->

- > **Note**

  > The dedicated **AppSec Admin** role includes the required
  > permissions.

<!-- -->

- > Before you begin you must setup a Transporter applet on your Broker
  > VM. Refer to [Setup a Transporter applet on Broker
  > VM](#UUID8450e7114b7ffd71220ece7f0a763dd6) for more information

1.  Onboard your VCS on-premises data source: Navigate to Settings \>
    Data Sources \> + Add Data Source \> select your VCS on-premises
    data source.

2.  Configure the Transporter on the **Configure Domain** step of the
    wizard:

    a.  Select your **Broker VM** from the provided menu.

    b.  Select the Transporter applet associated with the selected
        Broker VM from the **Transporter Connection** menu.

3.  Complete the steps required to onboard the VCS data source: Refer to
    [Onboard version control
    systems](#UUID1f02af66fecaa451e412b0be7cefe18b) for more information
    about onboarding VCS data sources.

> **Note**
>
> **GitLab Enterprise webhook internal IP restriction**: GitLab
> Enterprise\'s security policies prevent webhook subscriptions to
> internal IP addresses (such as broker addresses). These subscriptions
> can only be enabled through specific instance configuration. For more
> information, refer to <https://docs.gitlab.com/security/webhooks/>.

##### Manage 3rd party findings and generated issues

Cortex XSIAM Cloud platform provides a centralized view for managing
security findings from both native scanners and third-party tools. It
ingests code weakness findings (CWEs) from third-party sources. Software
Composition Analysis (SCA) CVE vulnerabilities are ingested from
third-party tools and are also detected by the platform\'s native
scanners (In addition, native scanners also detect Infrastructure as
Code (IaC) misconfigurations and exposed Secrets). By unifying all of
this data, Cortex produces actionable issues that streamline remediation
and give you a single, clear view of your application security posture.

For more information on SCA CVE issues, refer to [SCA CVE
vulnerabilities inventory](#UUID570dcefcef1fa9dd3a14aeaf0857ccd6).

##### Manage code weaknesses

You can ingest Static Application Security Testing (SAST) findings from
third-party vendors. These findings are raw security observations from
your external scanners that Cortex Cloud then uses to generate
actionable issues. These issues are prioritized by Application Security,
enabling you to remediate specific code weaknesses.

Application Security default policies enrich and categorize ingested
Critical and High SAST findings detected in your organization\'s
environment as issues (also known as Code Weaknesses). Issues represent
the smallest unit for remediating SAST-identified CWEs.

> **Note**
>
> You can customize policies to define which findings are categorized as
> issues.

###### How to access code weakness issues

To access SAST code violation issues, under **Modules**, select
Application Security \> Issues \> Code Weaknesses.

> **Tip**
>
> You can also view SAST CWE issues in dedicated tabs under other
> sections when available:

- > In code **Asset** inventories, navigate to Inventory \> All Assets
  > \> Code:

  - > On the **Code Weaknesses** tab under the **Repositories** asset
    > inventory. Refer to [In-depth repository asset
    > information](#UUID929bbcfbc88cc71456d696269fe944cb) for more
    > information

  - > Under the **All Code** asset inventory: Select an asset from the
    > table \> Code Weaknesses

- > In the **Application** asset inventory: navigate to Inventory \> All
  > Assets \> Applications \> select an option from the Applications
  > menu \> select an application from the inventory \> Code Weaknesses
  > tab

- > In **Cases and Issues**; perform a query. Select Issues \> AppSec
  > Issues (under the All Domains menu) \> SAST Scanner (as the
  > Detection Method value)

###### Code weaknesses issue inventory

The SAST code weakness issues inventory includes the following fields.

  -------------------------------------------------------------------------------------
  Property                            Description
  ----------------------------------- -------------------------------------------------
  Severity                            Severity level of the code weakness issue (such
                                      as Critical, High, Medium, Low)

  Name                                Short, descriptive name of the code weakness
                                      issue (such as \"SQL Injection,\" \"Cross-Site
                                      Scripting\")

  CWE(s)                              Common weakness enumeration (CWE) identifiers
                                      associated with the issue

  OWASP Categories                    Top 10 OWASP categories

  Asset Name                          Name of the repository affected by the CWE issue
                                      (such as library name, file name)

  Language                            Programming language in which the CWE issue was
                                      detected (such as Java, Python, JavaScript)

  Branch                              The specific branch or version of the code where
                                      the CWE issue was detected

  File Path                           Path to the file or location within the code
                                      where the CWE issue was detected

  Data Source                         The 3rd party data source for the code weakness
                                      such as GitLab or GitHub

  Risk Factors                        Classifies the issue based on industry-standard
                                      categories, such as OWASP Top 10, CWE Top 25,
                                      providing a standardized understanding of its
                                      type and prevalence

  Status                              The issue status. Values: **New**,
                                      **In Progress**, **Resolved**. You can set the
                                      status as required

  Backlog Status                      **Backlog Status:** Indicates if the issue is
                                      categorized as **Backlog** (pre-existing
                                      technical debt) or **New** (a recently introduced
                                      vulnerability). To understand how issues are
                                      categorized as backlog/new, refer to
                                      [Issue/Finding classification by
                                      scanner](#UUIDb20d66eb5d51a4edd80d1d205cbbdab0)

  Created                             When the issue was created

  Assignee                            The entity assigned to mitigate the issue
  -------------------------------------------------------------------------------------

###### Expanded code weaknesses issue information

Click on an issue in the table to open a detailed side-card, which
provides additional, more in-depth information about the issue. A
concise summary of the issue is displayed at the top of the page. The
information is organized into tabs, including an **Overview** tab
(default display) which provides highlights and a general summary, while
contextual tabs focus on particular details of the issue.

> **Note**
>
> Different issue types include different properties; therefore, not all
> properties are available for every issue.

####### Summary

A summary of the code weakness including the severity level, the CWE
identity, and the type of engine that detected the weakness.

####### Overview

The **Overview** tab provides general details of the code weakness.

- **Description**: Provides a summary of the CWE and its potential
  impact

- **Impact**: The impact that the issue could potentially have on your
  SDLC

- **Status**: Displays the current state of the issue. Values: **New**,
  **In Progress**, **Resolved**. You can set the status as required

- **Timestamps**: Provides the date the issue was created and last
  updated

- **Assignee**: The entity assigned to mitigate the issue. You can
  assign the issue from the menu in the field

- **Affected Assets**: Identifies the version control system and
  repository containing the CWE

- **Evidence**:

  - **Issue source**

    - **Data Source:** The system or integration from which the issue
      data was originally pulled (such as GitLab). Click the icon next
      to the data source to navigate to the data source itself

    - **AppSec Policy**: The violated security standard that led to the
      creation of the issue. Includes a link to the policy

  - **Code location**

    - **File Path:** The exact location of the issue within the
      repository file structure (e.g., python/flask.py (10))

    - **Commit Hash**: The commit hash of the most recent commit that
      modified the code where the issue was detected (e.g., empty-value)

  - **Issue classification**

    - **Risk Factors**: Classification of the issue based on
      industry-standard vulnerability inventories (such as CWE Top 25,
      OWASP Top 10).

    - **CWEs**: Specific Common Weakness Enumeration IDs associated with
      the issue. Includes a link to navigate to the site providing
      additional details about the CWE

    - **OWASP**: Relevant OWASP Top 10 categories associated with the
      issue (e.g., A01:2017 - Injection, A03:2021 - Injection).

  - **Data Flow**

    - This section provides insights into how information moves through
      the relevant code and where the CWE\'s impact on that flow is
      identified

- **Remediation**: Suggested steps to address the code weakness,
  including the file and code line in which the CWE was detected.

####### Action

The **Action** tab provides suggested remediation for the CWE issue,
including best practices.

####### War Room

The **War Room** provides an audit trail of all automatic or manual
actions taken on an issue, serving as a dedicated space to review and
interact with your issue. Each issue has a unique War Room. With machine
learning insights, the Cortex XSIAM Cloud platform suggests the most
effective analysts and command sets to help you address issues
efficiently.

###### SAST code weakness findings

SAST CWE findings are based on ingested third party vendor (such as
Semgrep) data. Findings are potential security vulnerabilities
identified within your source code based on common weakness enumerations
(CWEs). These insights help assess and analyze the security posture of
your applications by identifying weaknesses in your codebase.

> **Note**
>
> Findings on the Cortex XSIAM platform are not intended for direct
> action; but rather represent data collected by the platform. They must
> be promoted to issues to enable mitigation efforts to secure your
> codebase.

The following table displays selected code weakness findings properties.

  -----------------------------------------------------------------------
  Property                            Description
  ----------------------------------- -----------------------------------
  Name                                Short, descriptive name of the CWE
                                      finding (such as SQL Injection or
                                      Cross-Site Scripting)

  CWE(s)                              CWE identifier(s) associated with
                                      the finding (such as CWE-79,
                                      CWE-119)

  OWASP Categories                    Relevant Top 10 OWASP categories
                                      associated with the finding (but
                                      can be from different years)

  Asset Name                          Name of the repository affected by
                                      the CWE finding

  Language                            Programming language in which the
                                      CWE finding was detected (such as
                                      Java, Python, JavaScript)

  Branch                              The specific branch or version of
                                      the code where the CWE finding was
                                      detected

  File Path                           Path to the file or location to the
                                      code wherein the CWE finding was
                                      detected

  Git User                            Username of the Git user who last
                                      modified the file containing the
                                      finding

  Data Source                         Source of the CWE finding
                                      information

  Created                             Timestamp of when the CWE finding
                                      was first detected.

  Finding ID                          Unique identifier assigned to a
                                      specific finding

  Risk Factors                        Maps them to known code weakness
                                      categories and industry standards,
                                      such as the OWASP Top 10 or other
                                      prevalent security enumerations, to
                                      assess their general impact and
                                      likelihood
  -----------------------------------------------------------------------

####### Expanded Findings details

Click on an issue in the table to open a detailed side-card, which
provides additional, more in-depth information about the finding,
including a description, impact, metadata and more:

- **Finding summary**: Found at the top of the card. Includes the
  finding name, ID and type (**Code** for CWE findings)

- **Description**: A description of the finding including its location

- **Timestamp**: When the finding was last updated

- **Asset details**: Includes **Asset** (The impacted asset. Clicking on
  the asset opens the asset side card without needing to navigate away
  to the asset section) and **Asset Type** (The specific asset type in
  which the IaC resource was identified)

- **Evidence**: Provides evidence and contextual details within your
  SDLC containing the IaC misconfiguration finding:

  - **Finding source**

    - **Data Source:** The system or integration from which the finding
      data was originally pulled (such as GitHub or a CI/CD pipeline).
      Click the icon next to the data source to navigate to the data
      source itself

    - **Rule ID**: The unique identifier of the specific rule that
      identified the finding

  - **Code context**

    - **Repository:** The name of the version control repository where
      the finding was located

    - **Branch:** The specific branch within the repository containing
      the finding

    - **File Path:** The exact location of the finding within the
      repository file structure

    - **First Hash:** The commit hash of the first commit where this
      specific finding was introduced or detected

    - **First Commit Date**: The date and time of the first commit where
      this specific finding was introduced or detected.

  - **Scan metadata**

    - **Run ID:** The unique identifier of the specific scan execution
      during which this finding was detected

  - **Code weakness classification**

    - **OWASP Categories**: The relevant OWASP Top 10 categories
      associated with the finding

    - **CWE Categories**: The Common Weakness Enumeration (CWE)
      categories that describe the type of weakness identified by the
      finding

    - **Prioritization Labels**: Labels (such as OWASP Top 10) assigned
      to the finding to aid in its prioritization and classification

#### CI/CD Security

CI/CD security scans for code and configuration violations in the
pipeline safeguard software components and processes throughout the
automated CI/CD pipeline. These scans address the security of the
initial code commit and the automated build processes by identifying
code vulnerabilities and misconfigurations within your codebase and
pipeline configurations. By catching these violations early, they
contribute to maintaining the integrity, confidentiality, and
availability of modern software systems and fostering trust within the
pipeline\'s operations.

##### CI/CD Security use cases

- **CI/CD onboarding**: Integrate your CI/CD pipelines and related
  systems with the CI/CD module to gain centralized visibility and
  consolidate code risks, enabling security insights and pipeline
  hardening

- **CI/CD assets**: Identify and manage all critical CI/CD assets,
  including collaborators, CI/CD instances, CI/CD pipelines and version
  control system (VCS) organizations, to gain a comprehensive view of
  your attack surface

- **Supply Chain security**: Secure your SDLC by gaining visibility into
  and controlling third-party dependencies, open-source components,
  build artifacts, and CI/CD pipeline configurations and activities.
  Identify and mitigate risks introduced throughout the build and
  deployment processes, ensuring a secure software delivery

- **CI/CD risks**: Understand and mitigate common CI/CD risks, including
  [OWASP Top 10 CI/CD security
  risks](https://owasp.org/www-project-top-10-ci-cd-security-risks/), by
  gaining visibility into pipeline security posture, visualizing breach
  pathways, and identifying exposed credentials

- **CI/CD rules**: Define and enforce granular security rules within
  your CI/CD pipelines to block insecure code from reaching production
  and apply consistent security policies across repositories,
  registries, and runtime environments

- **CI/CD policies**: Create and apply comprehensive security policies
  across your entire software supply chain, enforcing them throughout
  the SDLC to harden delivery pipelines and ensure only vetted code
  reaches production

- **CI/CD Compliance**: Scan CI/CD rules against selected compliance
  standards such CIS GitHub to generate comprehensive and recurring
  compliance reports. This ensures continuous, verifiable adherence for
  auditing

##### CI/CD Security user roles and permissions

Cortex XSIAM offers dedicated user roles for CI/CD Security:
**AppSec Admin** and **DevSecOps**, each with specific areas of
responsibilities. When assigning roles to users, it\'s recommended to
align them with the user\'s required responsibilities within the
application security framework.

The **AppSec Admin** has full permissions for all Application
Security-related activities. They can create and modify detection rules
within the Code/Build domain, track progress, and adjust enforcements as
needed. Additionally, they can triage and investigate findings, issues,
and cases spanning from code to cloud. The role also includes complete
visibility into all cloud assets.

The **DevSecOps** role is specifically designed as an intermediary,
possessing more permissions than a Developer but fewer than an AppSec
Admin. This role actively manages security processes and tools to embed
security directly into development and operations workflows.
Responsibilities include managing and resolving security issues,
performing scan management, and improving the overall application
security posture by integrating security practices throughout the
development and operations lifecycle.

Permissions assigned to predefined roles cannot be modified. However,
you can save a predefined role as a new custom role. This custom role
can then be edited to meet specific organizational needs, offering a
balance between standardized roles and customizable access control.

Dedicated CI/CD Security roles include permissions that extend beyond
CI/CD Security itself. In addition to these dedicated users, other roles
within your tenant are also granted specific permissions to CI/CD
Security. You can view all permissions granted to user roles in your
tenant by navigating to Settings \> Configurations \> Roles \> select a
role.

##### CI/CD Assets

CI/CD assets are the fundamental components that enable your automated
software delivery pipeline. These include your collaborators, version
control system (VCS) organizations (the top-level structures within VCS
platforms that contain your repositories, code, and configurations),
CI/CD instances (the tools that execute your pipeline) and CI/CD
pipelines (the automated workflows that build, test, and deploy your
software).

**VCS Repositories** are part of both ASPM and CI/CD asset modules.
Refer to [Repositories as assets](#UUID590316e33f5ce2e0c9ab8f0f4ccf4b31)
for more information about repository assets.

Visibility into these assets allows you to understand your CI/CD
environment. In addition, the assets display associated risks identified
through CI/CD security scans, allowing you to remediate CI/CD issues
directly from the dedicated asset inventories.

###### CI/CD Instances as assets

The CI/CD Instances inventory provides a centralized view of all CI/CD
pipeline tool instances (such as GitHub Actions and Jenkins) across your
environment, enabling efficient tracking and management of your CI/CD
instances. You can access and analyze instance details and properties,
as well as review CI instance configurations and identify configuration
issues.

####### Explore CI/CD Instance assets

To access CI/CD pipeline instances, under **Inventory**, select All
Assets \> Code \> Category \> CI/CD Instances.

The **CI/CD Instances** assets page includes a dashboard and an
inventory. The dashboard includes a **Provider** widget, displaying the
types of CI/CD providers configured (for example, GitHub Actions) and
the number of instances for each provider. You can filter the inventory
by selecting a provider type.

######## CI/CD instance inventory

The following table describes selected CI/CD instance properties
displayed in the inventory table.

  -----------------------------------------------------------------------
  Property                            Description
  ----------------------------------- -----------------------------------
  Name                                The name of the CI/CD pipeline
                                      instance, often including a
                                      descriptor that indicates its
                                      environment or purpose, such as
                                      \"Jenkins-prod\" for a Jenkins
                                      instance in a production
                                      environment

  Provider                            The provider or system of the CI/CD
                                      pipeline instance, such as Jenkins

  URL                                 The web address where the CI/CD
                                      pipeline instance can be accessed

  Last Observed                       The date when the last scan was
                                      conducted on the CI/CD pipelines in
                                      the instance. Use the column filter
                                      to choose a specific date range
                                      (custom, 7 days, 30 days) instead
                                      of the default 24 hours

  Pipeline Count                      The amount of CI/CD pipelines
                                      associated with the instance.
                                      Clicking on the value opens the
                                      **Pipelines** tab of the
                                      description card for additional
                                      information about the associated
                                      pipelines
  -----------------------------------------------------------------------

####### In-depth CI/CD pipeline instance asset information

Click an asset in the inventory table to open its side card, providing
in-depth information organized into several tabs. The **Overview** tab
(default display) offers highlights and a general summary. Additional
contextual tabs provide specific details, including a **Code to Cloud**
tab (providing context on the asset\'s path to production), an
**Applications** tab (displaying the applications in which the asset is
detected), and tabs such as **Configurations** and **Code** (focusing on
specific issue types detected within the asset).

######## CI/CD pipeline instance summary

The CI/CD pipeline instance summary, displayed at the top of the card,
provides concise details about the CI/CD instance, such as its name, the
provider (for example GitHub Actions), and specific pipeline
configurations.

######## Overview

The **Overview** tab summarizes the CI/CD pipeline instance highlights
and properties.

**Highlights**:

- **Critical/High** issues: An aggregation of critical and high issues
  associated with the CI/CD pipeline instance

- **Deployed**: Indicates whether the CI/CD pipeline instance has been
  deployed and is currently active within your cloud environment or
  infrastructure

- **Risk summary**: The amount of issues and findings associated with
  the pipeline instance and their severity level. Selecting an issue or
  finding redirects to the issues or findings page, filtered by the
  selected issue or finding

- **Visibility timeline**: When the CI/CD pipeline instance was first
  and last detected

**Properties**:

- Asset details, including **Asset Id**, **Asset Category** (fixed
  value: CI/CD Instance), **Provider** (CI tool such as Jenkins and
  GitHub Actions) and **Asset Groups** associated with the CI/CD
  pipeline instance

- **Instance URL**: Link to the specific CI/CD instance

The **Highlights** section and other asset properties only display
attributes when their corresponding indicators are present. For example,
if an asset is not deployed, its deployment-related attributes will not
show up; similarly, if there are no detected issues, those highlights or
properties will not appear.

######## Configurations

The **Configurations** tab provides a table of CI/CD instance
configuration issues. The following table provides selected CI/CD
configuration instance issue properties.

  -----------------------------------------------------------------------
  Property                            Description
  ----------------------------------- -----------------------------------
  Severity (icon)                     The severity level of the issue

  Issue Name                          The issue identifier

  Asset Name                          The asset in which the issue was
                                      detected

  Assigned To                         The person or entity assigned to
                                      remediate the issue

  Creation Date                       When the issue was initially
                                      detected

  Issue Status                        The status of the issue
  -----------------------------------------------------------------------

######## Pipelines

The **Pipelines** tab displays a list of CI/CD pipelines associated with
the CI/CD instance.

  -----------------------------------------------------------------------
  Property                            Description
  ----------------------------------- -----------------------------------
  Pipeline Name                       The name of the CI/CD pipeline.

  Pipeline File Path                  The location of the configuration
                                      file that defines the CI/CD
                                      pipeline within the associated
                                      repository

  Related Repositories                A list of repositories that are
                                      associated with the CI/CD pipeline

  Last Observed                       The timestamp indicating the most
                                      recent time this specific CI/CD
                                      pipeline was detected

  Application IDs                     Unique identifiers assigned to the
                                      application(s) that this CI/CD
                                      pipeline builds, tests, or deploys
  -----------------------------------------------------------------------

####### Manage CI/CD pipeline instances

You can perform the following actions CI/CD instances.

######## Asset actions

- Right-click on an asset in an inventory table to access the
  **Actions** menu, where you can perform the following actions:

  - **Open in new tab**: Opens the description tab of the asset for
    detailed analysis of the issue

  - **View asset data**: Opens a new pop-up window displaying the data
    retrieved for the asset during the most recent scan in either JSON
    (default) or tree view. This raw data provides a comprehensive and
    unformatted view of the asset\'s properties and attributes as they
    were initially ingested

  - **Copy text to clipboard**: Copies the selected text to the
    clipboard

  - **Copy entire row**: Copies the entire selected row data

  - **Show/hide rows**: Stand on data in a row and filter the entire
    inventory to show or hide assets based on the selected attribute

  - **Open in Copilot**: Opens the repository in Copilot, an AI-driven
    extended security intelligence and automation management that
    centralizes capabilities like XDR, SOAR, ASM, and SIEM into a
    single, converged platform, leveraging AI and automation to simplify
    operations, stop threats at scale, and significantly accelerate
    security outcomes by consolidating data and tools

- **Export asset data**: Click the download icon (showing
  **Export to file** when hovering over the icon) in the top right of
  any asset page to export the asset data

- View Dashboard: Redirects to the [Application
  Security](/document/preview/1096488#UUID-bf585ea8-f9c4-5a40-6e58-0a93168b8d71)
  dashboard

###### CI/CD Pipelines as assets

The CI/CD Pipelines assets provide a centralized view of all CI/CD
pipeline assets across your environments, enabling efficient tracking
and management. You can access and analyze CI/CD pipeline details,
properties and insights including deployment status, whether deployed,
active or new and a summary of findings and issues associated with
pipelines. This allows you to assess the security and operational status
of your pipelines.

####### Explore CI/CD Pipeline assets

To access CI/CD pipelines assets, under **Inventory**, select All Assets
\> Code \> CI/CD Pipelines.

The **CI/CD pipelines** assets page includes a dashboard and an
inventory.

######## CI/CD Pipeline assets dashboard

The dashboard includes a widget detailing the CI pipeline providers. You
can filter by provider.

######## CI/CD Pipeline assets inventory

The following table describes selected CI/CD Pipeline asset properties
displayed in the inventory table.

  -----------------------------------------------------------------------
  Property                            Description
  ----------------------------------- -----------------------------------
  **Name**                            The unique identifier assigned to
                                      the pipeline

  **Provider**                        The tool or service that supplied
                                      the pipeline, such as GitHub
                                      Actions or Jenkins

  **Repository**                      The code repository which stores
                                      the source code, pipeline
                                      configurations, and related assets
                                      used for the CI/CD process

  **CI File Path**                    The specific location or directory
                                      path where the CI configuration
                                      file is stored

  **CI Instance**                     The individual occurrence of the CI
                                      associated with the pipeline
  -----------------------------------------------------------------------

####### In-depth CI/CD pipeline asset information

Click an asset in the inventory table to open its side card, providing
in-depth information organized into several tabs. The **Overview** tab
(default display) offers highlights and a general summary. Additional
contextual tabs provide specific details, including a **Code to Cloud**
tab (providing context on the asset\'s path to production), an
**Applications** tab (displaying the applications in which the asset is
detected), and tabs such as **Configurations** and **Code** (focusing on
specific issue types detected within the asset).

######## CI/CD Pipeline asset summary

The CI/CD Pipeline asset summary, displayed at the top of the card,
provides concise details about the CI/CD pipeline assets, such as its
name, the platform used (for example GitHub Actions) and specific
pipeline configurations.

######## Overview

The **Overview** tab summarizes CI/CD pipeline asset highlights and
properties.

**Highlights**:

- **Critical/High** issues: An aggregation of critical and high issues
  associated with the CI/CD pipeline asset

- **Deployed**: Indicates whether the CI/CD pipeline asset has been
  deployed and is currently active within your cloud environment or
  infrastructure

- **New**: Indicates whether the CI/CD pipeline asset was created during
  the past 30 days

- **Active**: Indicates whether the CI/CD pipeline asset is active and
  processing tasks

- **Risk summary**: Displays the total amount of risks associated with
  the pipeline asset grouped by category (cases, issues and findings )
  and their severity level. Selecting a risk category will redirect you
  to more information

- **Visibility timeline**: When the CI/CD pipeline assets were first and
  last detected

**Properties**:

- Asset details, including **Asset Id**, **Asset Types** and
  **Asset Groups** associated with the CI/CD pipelines asset

- **Applications**: Lists the applications that include this pipeline
  assets as part of their defined assets or configuration

- **CI/CD configuration**:

  - **Provider**: The platform or service that hosts and manages the
    CI/CD pipeline, such as Jenkins and GitHub Actions

  - **CI File Repository**: The location or repository where the
    configuration files for the CI/CD pipeline are stored

  - **CI Instance**: The specific instance or environment where the
    CI/CD pipeline is executed

- **Last Job Execution**: The most recent execution of a job within the
  CI/CD pipeline

- **Contributors**: The individuals or entities who have made
  contributions to the CI/CD pipeline. This information allows
  collaboration within the CI/CD pipeline\'s development process

> **Note**
>
> The **Highlights** section and other asset properties only display
> attributes when their corresponding indicators are present. For
> example, if an asset is not deployed, its deployment-related
> attributes will not show up; similarly, if there are no detected
> issues, those highlights or properties will not appear.

######## Code to Cloud

The **Code to Cloud** tab describes the integrated flow of a selected
CI/CD pipeline, showing its journey from code commit to deployment. The
graph visualizes the path to production, showcasing the pipeline\'s
central role in orchestrating the flow from the repository, through its
build and test stages, to the image it creates, and finally to the
traced runtime resource it deploys.

######## Applications

The **Applications** tab provides an overview of the applications
associated with this CI/CD pipeline, including the application risk
score, business criticality, business owners and path to production. The
path to production provides a graphical representation the application
software development lifecycle, including the CI/CD pipeline role within
the workflow.

######## Instances

The **Instances** tab displays a list of CI instances associated with
the pipeline. The following table displays CI instance properties.

  -----------------------------------------------------------------------
  Property                            Description
  ----------------------------------- -----------------------------------
  Instance Name                       The name of the specific CI/CD
                                      instance

  Instance ID                         The identifier for the specific
                                      CI/CD instance

  Instance Provider                   The name of the CI/CD tool or
                                      platform that manages the instance
                                      (such as Jenkins, GitHub Actions

  Instance URL                        An address that allows you to
                                      access the user interface or
                                      details page of the specific CI/CD
                                      instance within its native platform

  Last Observed                       The timestamp indicating the most
                                      recent time this specific CI/CD
                                      instance was detected
  -----------------------------------------------------------------------

####### Manage CI/CD pipeline assets

You can perform the following actions on CI/CD pipeline assets.

######## Asset actions

- Right-click on an asset in an inventory table to access the
  **Actions** menu, where you can perform the following actions:

  - **Open in new tab**: Opens the description tab of the asset for
    detailed analysis of the issue

  - **View asset data**: Opens a new pop-up window displaying the data
    retrieved for the asset during the most recent scan in either JSON
    (default) or tree view. This raw data provides a comprehensive and
    unformatted view of the asset\'s properties and attributes as they
    were initially ingested

  - **Copy text to clipboard**: Copies the selected text to the
    clipboard

  - **Copy entire row**: Copies the entire selected row data

  - **Show/hide rows**: Stand on data in a row and filter the entire
    inventory to show or hide assets based on the selected attribute

  - **Open in Copilot**: Opens the repository in Copilot, an AI-driven
    extended security intelligence and automation management that
    centralizes capabilities like XDR, SOAR, ASM, and SIEM into a
    single, converged platform, leveraging AI and automation to simplify
    operations, stop threats at scale, and significantly accelerate
    security outcomes by consolidating data and tools

- **Export asset data**: Click the download icon (showing
  **Export to file** when hovering over the icon) in the top right of
  any asset page to export the asset data

- View Dashboard: Redirects to the [Application
  Security](/document/preview/1096488#UUID-bf585ea8-f9c4-5a40-6e58-0a93168b8d71)
  dashboard

###### Version Control System (VCS) Organizations as assets

The **VCS Organizations** asset inventory provides a centralized view of
all VCS Organizations that are integrated with Cortex XSIAM, including
their repositories and properties. The platform enables efficient
discovery and management of these VCS organization assets, providing
insights and analysis to contextualize their importance within your
ecosystem and assess their risk posture. You can directly access related
issues and findings within the VCS Organizations asset inventory,
allowing you to prioritize and remediate them without navigating to a
separate remediation section.

####### Explore VCS Organization assets

To access VCS Organization assets, under **Inventory**, select All
Assets \> Code \> VCS Organizations.

The **VCS Organization** assets page includes a dashboard and an
inventory.

######## VCS Organization asset dashboard

The **Providers** widget is displayed by default on the dashboard,
showing the distribution of VCS organizations across integrated version
control systems. Selecting a VCS within the widget sorts the inventory
table accordingly.

######## VCS Organization asset inventory

The asset inventory table includes exposed properties as well as
selected key properties that are available but not displayed by default.

  -----------------------------------------------------------------------
  Property/attribute                  Description
  ----------------------------------- -----------------------------------
  VCS Organization Name               The VCS organization name

  VCS Organization Provider           The version control system (such as
                                      GitHub) that the organization is
                                      associated with

  VCS Organization URL                The web address (URL) of the VCS
                                      organization\'s main page on the
                                      respective version control system
                                      provider (such as the main GitHub
                                      organization page)

  First Observed                      The date of the scan that initially
                                      detected the VCS organization

  Observation Time                    The date that the VCS organization
                                      data was last updated

  VCS Organization Connected Apps     A list of applications created
                                      within Cortex XSIAM that have a
                                      connection or association with this
                                      specific VCS organization entity

  Application IDs                     A list of the unique identifiers
                                      (IDs) assigned to the applications
                                      that are connected to or associated
                                      with this specific VCS organization
                                      entity
  -----------------------------------------------------------------------

####### In-depth VCS Organization asset information

Click an asset in the inventory table to open its side card, providing
in-depth information organized into several tabs. The **Overview** tab
(default display) offers highlights and a general summary. Additional
contextual tabs provide specific details, including **Configurations**
(displaying an inventory of configurations for all associated VCS
organization assets) and **Identity** (providing a view of users within
the VCS Organization).

######## VCS Organization asset summary

The VCS Organization asset summary, displayed at the top of the card,
provides concise details about the VCS Organization, such as its name
and associated VCS.

######## Overview

The **Overview** tab summarizes VCS Organization highlights, properties,
repositories and members.

**Highlights**:

- **Critical/High issues**: An aggregation of critical and high issues
  associated with the VCS Organization

- **Deployed**: Indicates whether the VCS Organization has been deployed
  and is currently active within your cloud environment or
  infrastructure

- **Public Repository**: Indicates whether the VCS Organization is a
  public repository, indicating its visibility to the public

- **Risk summary**: The amount of risks associated with the VCS
  Organization grouped by category (cases, issues and findings) and
  their severity level

- **Visibility timeline**: When the collaborator was first and last
  detected

**Properties**:

- Asset (VCS organization) details, including **Asset Id**,
  **Asset Category** and **Asset Groups** associated with the VCS
  Organization

- **Provider**: the VCS associated with the VCS Organization

- **Organization Owners**: Users with full administrative control over
  the version control organization, including members, repositories, and
  settings

**Repositories**: A table of repositories associated with the VCS
Organization. Enables you to quickly identify specific repositories of
interest and gain a comprehensive understanding of the organization\'s
overall repository structure. The table repository properties such as
name, scanned branch, visibility, last commit and associated
technologies. Selecting a repository opens its asset card directly
within VCS Organization assets, allowing quick access to repository
details without having to redirect to the dedicated
[Repository](#UUID929bbcfbc88cc71456d696269fe944cb) assets page.

> **Note**
>
> The **Highlights** section and other asset properties only display
> attributes when their corresponding indicators are present. For
> example, if an asset is not deployed, its deployment-related
> attributes will not show up; similarly, if there are no detected
> issues, those highlights or properties will not appear.

######## Configurations

The **Configurations** tab displays an inventory of configurations for
all associated VCS organization assets, and an inventory of top
configurations issues (VCS & CI/CD Risks) related to the organization.

The table includes the following properties:

- **Severity** level (icon): Indicates the level of severity of the
  configuration issue

- **Asset Name**: The name of the resource in which the misconfiguration
  was detected

- **Assigned To**: The person or team responsible for addressing the
  vulnerability

- **Creation Date**: The date when the vulnerability was detected

######## Identity

The **Identity** tab provides a view of users within the VCS
Organization, outlining their access levels and the repositories they
are collaborators on, along with the timestamp of the latest commit for
each repository

####### Manage VCS organization assets

You can perform the following actions on VCS organization assets.

######## Asset actions

- Right-click on an asset in an inventory table to access the
  **Actions** menu, where you can perform the following actions:

  - **Open in new tab**: Opens the description tab of the asset for
    detailed analysis of the issue

  - **View asset data**: Opens a new pop-up window displaying the data
    retrieved for the asset during the most recent scan in either JSON
    (default) or tree view. This raw data provides a comprehensive and
    unformatted view of the asset\'s properties and attributes as they
    were initially ingested

  - **Copy text to clipboard**: Copies the selected text to the
    clipboard

  - **Copy entire row**: Copies the entire selected row data

  - **Show/hide rows**: Stand on data in a row and filter the entire
    inventory to show or hide assets based on the selected attribute

  - **Open in Copilot**: Opens the repository in Copilot, an AI-driven
    extended security intelligence and automation management that
    centralizes capabilities like XDR, SOAR, ASM, and SIEM into a
    single, converged platform, leveraging AI and automation to simplify
    operations, stop threats at scale, and significantly accelerate
    security outcomes by consolidating data and tools

- **Export asset data**: Click the download icon (showing
  **Export to file** when hovering over the icon) in the top right of
  any asset page to export the asset data

- View Dashboard: Redirects to the [Application
  Security](/document/preview/1096488#UUID-bf585ea8-f9c4-5a40-6e58-0a93168b8d71)
  dashboard

###### VCS Collaborators-as-assets

The **VCS Collaborator** (collaborators) asset inventory provides a
centralized view of all collaborators (users) who interact with VCS
repositories, CI/CD pipelines, and related assets. The platform enables
efficient discovery and management of these assets, providing insights
and analysis to contextualize their importance within your ecosystem and
assess their risk posture. You can directly access related issues and
findings within the Collaborator asset inventory, allowing you to
prioritize and remediate them without navigating to a separate
remediation section.

####### How to access Collaborator assets

- To access Collaborator assets, under **Identity**, select Human
  Identities \> select VCS Collaborator from the Type filter.

####### In-depth Collaborator asset information

Click an asset in the inventory table to open its side card, providing
in-depth information organized into several tabs.

######## Collaborator asset summary

The Collaborator asset summary, displayed at the top of the card,
provides concise details about the collaborator, such as their name and
the version control system that the collaborator is associated with.

######## Overview

The **Overview** tab summarizes the collaborator highlights and
properties.

**Highlights** include:

- **Critical/High issues**: An aggregation of critical and high issues
  associated with the collaborator

- **New**: Whether the collaborator was recently added to the VCS
  organization

- **Inactive**: Indicates whether the collaborator has had no commits
  within the last time period

**Properties** include:

- **Risk Summary**: The amount of risks associated with the collaborator
  grouped by category (cases, issues and findings) and their severity
  level

- Asset details, including **Asset Id**, **Asset Types** and
  **Asset Groups** associated with the collaborator

- **Visibility timeline**: When the collaborator was first and last
  detected

- ** Identity and Affiliation**:

  - **Username**: the alias associated with the collaborator

  - **User Type**: The classification of the collaborator\'s account
    (such as individual user, service account, bot), indicating the
    nature of their access and activity

  - **VCS Organization**: The specific version control system
    organization to which the collaborator belongs or has access

  - **Emails**: \"The email addresses associated with the
    collaborator\'s account, used for communication and notifications

- **Access and Activity**:

  - **Team Membership**: The teams or groups within the VCS Organization
    to which the collaborator belongs, defining their access permissions
    and collaborative roles

  - **Last Commit**: The timestamp of the collaborator\'s most recent
    commit to a repository within the associated VCS Organization,
    indicating their recent activity

The **Highlights** section and other asset properties only display
attributes when their corresponding indicators are present. For example,
if an asset is not deployed, its deployment-related attributes will not
show up; similarly, if there are no detected issues, those highlights or
properties will not appear.

######## Access

The **Access** tab provides a list of assets that a VCS Collaborator has
access to within your environment. It details the specific assets they
can interact with, the level of permission granted, and the timestamp of
their most recent code commit to that asset.

####### Manage Collaborator assets

You can perform the following actions collaborator assets.

######## Asset actions

- Right-click on an asset in an inventory table to access the
  **Actions** menu, where you can perform the following actions:

  - **Open in new tab**: Opens the description tab of the asset for
    detailed analysis of the issue

  - **View asset data**: Opens a new pop-up window displaying the data
    retrieved for the asset during the most recent scan in either JSON
    (default) or tree view. This raw data provides a comprehensive and
    unformatted view of the asset\'s properties and attributes as they
    were initially ingested

  - **Copy text to clipboard**: Copies the selected text to the
    clipboard

  - **Copy entire row**: Copies the entire selected row data

  - **Show/hide rows**: Stand on data in a row and filter the entire
    inventory to show or hide assets based on the selected attribute

  - **Open in Copilot**: Opens the repository in Copilot, an AI-driven
    extended security intelligence and automation management that
    centralizes capabilities like XDR, SOAR, ASM, and SIEM into a
    single, converged platform, leveraging AI and automation to simplify
    operations, stop threats at scale, and significantly accelerate
    security outcomes by consolidating data and tools

- **Export asset data**: Click the download icon (showing
  **Export to file** when hovering over the icon) in the top right of
  any asset page to export the asset data

- View Dashboard: Redirects to the [Application
  Security](/document/preview/1096488#UUID-bf585ea8-f9c4-5a40-6e58-0a93168b8d71)
  dashboard

##### Supply Chain tools

The Supply Chain inventory provides detailed information about
individual tools, including deployments, areas of non-use, and
functionality detected in your SDLC. This data allows you to assess tool
usage, coverage, and potential security risks.

Cortex XSIAM supports these Supply Chain tool execution environments:

- **Third party pipelines**: **GitHub Actions** and **Jenkins plugins**.
  Third-party plugins integrated with Cortex XSIAM, providing visibility
  into installations, locations, and CVE vulnerabilities within your
  pipeline environment. This allows for prioritized remediation,
  effectively reducing your attack surface by identifying and removing
  unused or vulnerable plugins.

<!-- -->

- Additionally, these pipelines often incorporate third-party
  executables into their workflows. Cortex XSIAM offers enhanced
  visibility into these third-party services, transforming unreadable
  data into actionable insights for improved security posture

<!-- -->

- **VCS third parties**: **VCS Apps**. Third-party applications and
  webhooks in your version control system. This enables removal of
  unused assets, management of permissions, and adherence to the
  principle of least privilege

- **Executables**: Standalone programs or scripts executed within your
  CI/CD pipelines. These may include custom scripts, third-party
  command-line tools, or other executable files. The inventory provides
  insights into their usage, deployment locations, and potential
  security risks

- **Webhooks**: Automated, event-driven communications that trigger
  actions across your CI/CD pipeline and integrated services. Cortex
  XSIAM provides an inventory of these webhooks, enabling you to assess
  their usage, coverage, and potential security risks

Tools are categorized by status: **Approved**, **Pending Review**, or
**Rejected** (but still in use). When initially detected, tools are
assigned a **Pending Review** status by default, requiring further
action to change the status to **Approved** or **Rejected**.

> **Note**

- > **Rejected** does not mean the tool is not in use. It allows
  > application security practitioners to search for and remove these
  > tools as needed

- > For information about changing the tool status, refer to
  > [Overview](#X7fdb91da025d42d7465c1b757a18dacd4627710)

###### Supply Chain use cases

- **Tool visibility:** Gain visibility into all tools used across CI/CD
  pipelines and VCSs

- **Third-Party tools:** Discover and monitor all external tools
  (webhooks, executables, apps, plugins) integrated into your CI/CD
  pipelines and VCSs

- **Detailed Tool insights:** Access detailed information on each tool
  (creator, risk factors such as deprecation or low usage, usage
  evidence, first seen date, category) to evaluate approval status and
  assess risk

- **Rejected Tool Monitoring:** Manage tool approval status by approving
  or rejecting tools found in pipelines/VCSs, identifying non-compliant
  usage

- **Usage:** View tool usage indicators by category across
  pipelines/VCSs for management reporting internal as well as external
  usage

####### How to access Supply Chain tools

To access Supply Chain Tools, select Modules \> Application Security \>
Supply Chain Tools (under 3rd Party Tools).

###### Explore Supply Chain tools

The Supply Chain tools inventory table provides a detailed list of your
organization\'s CI/CD pipeline tools and VCS Apps, allowing you to view
and manage your organization\'s supply chain tools from a single,
centralized location. You can review tool usage, third-party
integrations, and risk assessments, including creator information, usage
evidence, and category details. Additionally, you can filter tools by
status (approved, rejected, uncategorized) and category, search for
specific tools, and identify top risks to ensure policy adherence and
prioritize remediation.

The Supply Chain tool page includes a dashboard and an inventory table.

####### Supply Chain tool dashboard

The dashboard includes three widgets:

- **Tools in use**: Displays the total number of Supply Chain tools
  detected in your environment, including the percentage and count of
  approved tools, and a breakdown of tool execution context and the
  number of tools by context

- **Pending review**: The amount of tools flagged as pending review

- **Rejected (in use)**: The number of unapproved or non-compliant tools
  that are still in use

####### Supply Chain tool inventory

The inventory table describes the Supply Chain tool properties.

  -----------------------------------------------------------------------
  Property/ Attribute                 Description
  ----------------------------------- -----------------------------------
  Name                                The name of the Supply Chain tool

  Status                              The tool status. Values: Approved,
                                      Pending, Rejected

  Usage                               The amount of CI/CD pipelines in
                                      which the tool was used

  Type                                The type of tool

  Category                            The category associated with the
                                      tool, such as Version Control
                                      System (VCS), Continuous
                                      Integration (CI) Servers and Build
                                      Automation Tools
  -----------------------------------------------------------------------

###### Expanded Supply Chain tool information

When you click a tool\'s entry in the inventory table, a side card will
open to display detailed information. The information is organized into
three tabs: the **Overview** tab, which provides a summary of the
tool\'s key details and is the default view; the **Vulnerabilities**
tab, which lists any associated security vulnerabilities (CVEs); and the
**Actions** tab, which outlines available mitigation options for the
tool.

####### Overview

The **Overview** tab includes these details:

- **Name**: The name of the tool

- **Description**: A description of the tool usage and a link to its
  third-party origin, such as a public repository, documentation portal,
  or the vendor\'s official website

- **Timestamp**: When the tool was initially detected

- **Category**: The tool type, such as code scanning and analytics

- **Usage**: The amount of assets using this tool

- **Status**: The current status of the tool. Values include
  **Approved**, **Pending Review**, **Rejected**. You can manually
  override the system-assigned status

- **Approve** / **Reject**: Approve or reject the tool.

<!-- -->

- > **Note**

  > **AppSec Admin** user permissions are required to perform these
  > actions.

<!-- -->

- **Execution environments**: A list of execution environments
  associated with the tool. Details include: name, the number of assets
  using the tool and the scan type

####### Usage

The **Usage** tab provides a list of the execution environments
associated with the tool. Details include

- The asset name in which the tool runs (such as a pipeline). Selecting
  the name opens the asset in a side-car without having to navigate to
  the dedicated **Assets** page

- The type of asset, such as CI/CD pipeline, CI/CD instance, or
  Organization (for VCS Apps)

- Evidence of the tool in the environment - the location of the file
  containing the tool

- When the tool was initially detected.

####### Vulnerabilities

The **Vulnerabilities** tab is displayed whenever one or more tools have
a risk factor that is a result of a Common Vulnerability and Exposure
(CVE). This tab provides a consolidated list of all CVEs impacting the
tools. The table includes these properties:

- **Name**. The unique identifier for the CVE entry. For example,
  CVE-2023-25764. This name is a clickable link that directs you to a
  detailed report on the vulnerability from a public database

- **CVSS Score**. The numerical score assigned to the vulnerability
  based on the Common Vulnerability Scoring System (CVSS). This score
  indicates the severity of the vulnerability, with a higher number
  representing a greater risk

- **Asset**: The specific asset affected by the CVE

##### CI/CD Risks

CI/CD pipeline risks are a set of predefined rules that identify
pipeline vulnerabilities. Scans analyze both code and configurations of
integrated VCS and CI/CD systems and pipelines, as well as their
inter-connectivity, to detect these risks. The risks are classified
based on security categories including attack vectors,
misconfigurations, and bad practices found throughout your CI/CD
pipelines.

CI/CD pipeline risk findings, detected during scans, are displayed in a
dedicated table for analysis and investigation. Application Security
then applies context and prioritizes these findings to create CI/CD
pipeline risk issues. These issues represent the smallest unit of risk
that can be remediated, and are displayed in their own dedicated
inventory. You can remediate CI/CD pipeline risk issues manually by
applying suggested fixes.

> **Note**
>
> Application Security CI/CD pipeline scans create a comprehensive
> inventory of all CI/CD pipelines in your environment. For more
> information refer to [CI/CD Pipelines as
> assets](#UUIDf5623dab6987d389a116921c276daca7).

###### CI/CD pipeline issues

All Medium, High and Critical CI/CD pipeline findings detected in an
organization\'s environment are categorized by Cortex XSIAM as CI/CD
risk issues. This approach allows for targeted remediation efforts. Only
manual fixes are available for CI/CD pipeline risk issues.

The **CI/CD Risks** Issues table is a filtered instance of the broader
**Issues** table found under **Cases & Issues**, meaning it exclusively
displays issues categorized as CI/CD risks. However, the **CI/CD Risks**
Issues table only displays issues generated from findings detected
during periodic scans. In contrast, the comprehensive **Issues** table
includes all CI/CD risks issues, regardless of their detection source,
such as periodic, pull request (PR), and continuous integration (CI)
scans.

####### How to access CI/CD pipeline risk issues

To access CI/CD pipeline risks issues, under **Modules**, select
Application Security \> Issues \> CI/CD Risks.

####### CI/CD pipeline risk issue inventory

Below are selected properties of the CI/CD pipeline risks issues
inventories.

  -------------------------------------------------------------------------------------
  Property                            Description
  ----------------------------------- -------------------------------------------------
  Severity                            The CI/CD pipeline risk severity level. Values:
                                      Critical, High, Medium, Low, Informational,
                                      unknown

  Issue Name                          The name assigned to the CI/CD pipeline risk
                                      issue. Corresponds to the CI/CD rule that
                                      detected the risk

  Category                            The type of issue. Values: Code, Configuration

  Description                         A description of the issue

  Finding ID                          The identifier of the finding on which the issue
                                      is based

  Provider                            The version control system (such as GitHub) or CI
                                      tool (such as GitHub Actions) hosting the CI/CD
                                      pipeline in which the issue was detected

  Asset Name                          The name of the asset in which the issue was
                                      detected

  Asset ID                            The identifier of the asset in which the issue
                                      was detected

  Asset Category                      The category of the asset (such as a repository,
                                      CI/CD Pipeline) in which the issue was detected

  Status                              The status of the issue. Values: New, Resolved,
                                      Under Investigation

  Domain                              Fixed value: Posture

  Last Updated                        The most recent scan that detected the finding
                                      which generated the issue

  Backlog Status                      **Backlog Status:** Indicates if the issue is
                                      categorized as **Backlog** (pre-existing
                                      technical debt) or **New** (a recently introduced
                                      vulnerability). To understand how issues are
                                      categorized as backlog/new, refer to
                                      [Issue/Finding classification by
                                      scanner](#UUIDb20d66eb5d51a4edd80d1d205cbbdab0)
  -------------------------------------------------------------------------------------

###### Expanded CI/CD risks issue information

Click on an issue in the table to open a detailed side-card, which
provides additional, more in-depth information about the issue. A
concise summary of the issue is displayed at the top of the page. The
information is organized into tabs, including an **Overview** tab
(default display) which provides highlights and a general summary, while
contextual tabs focus on particular details of the issue.

####### Overview

- **Timestamp**: When the issue was created and last updated

- **Status**: The issue status. Values: **New**, **In Progress**,
  **Resolved**. You can set the status as required

- **Assignee**: The entity assigned to mitigate the issue. You can
  assign the issue from the menu in the field

- **Description**: A description of the risk and the impact that the
  issue could potentially have on your SDLC

- **Asset details**: Includes **Asset** (The impacted asset. Clicking on
  the asset opens the asset side card without needing to navigate away
  to the asset section) and **Asset Type** (The specific asset type in
  which the IaC resource was identified)

- **Evidence**: Provides evidence and contextual details within your
  SDLC containing the IaC misconfiguration issue:

  - **Issue source**

    - **Data Source:** The system or integration from which the issue
      data was originally pulled (such as GitHub or a CI/CD pipeline).
      Click the icon next to the data source to navigate to the data
      source itself

    - **Category**: The scanner category. **Configuration** is the
      immutable value

    - **AppSec Rule**: The security rule that detected this issue.
      Includes a link to the rule

    - **AppSec Policy**: The violated security standard that lead to the
      creation of the issue. Includes a link to the policy

    - **Collaborator**: The individual or team responsible for
      contributing to the code or configuration where the issue was
      identified

  - **Code context**

    - **Scanner Type**: **AppSec CI/CD Risk Scanner** is the immutable
      scanner type

    - **Scanner Source**: **Cortex AppSec** is the immutable scanner
      source

    - **Repository Name:** The name of the version control repository
      where the issue was located

    - **Branch:** The specific branch within the repository containing
      the issue

    - **Framework**: The infrastructure as code (IaC) framework used
      (such as CloudFormation, Terraform)

    - **File Path:** The exact location of the issue within the
      repository file structure

    - **First Hash:** The commit hash of the first commit where this
      specific issue was introduced or detected

    - **Commit Hash**: The commit hash of the most recent commit that
      modified the code where the issue was detected

    - **Commit Time**: The timestamp of the most recent commit that
      modified the code where the issue was detected

  - **Remediation**: Suggested steps to remediate the issue

> **Note**
>
> Different issue types include different properties; therefore, not all
> properties are available for every issue.

####### Actions

Provides suggested solutions. No automated solutions are available for
CI/CD risk issues.

####### War Room

The **War Room** provides an audit trail of all automatic or manual
actions taken on an issue, serving as a dedicated space to review and
interact with your issue. Each issue has a unique War Room. With machine
learning insights, the Cortex XSIAM Cloud platform suggests the most
effective analysts and command sets to help you address issues
efficiently.

###### VCS and CI/CD pipeline risk findings

VCS and CI/CD pipeline scans produce findings, which are potential
security risks in your VCS repositories and CI/CD pipeline
configurations. These insights help assess and analyze the security
posture of your VCS\'s and CI/CD pipelines.

The **CI/CD risks** **Findings** table is a filtered instance of the
broader **Findings** table found under **Cases & Issues**, meaning it
exclusively displays findings categorized as CI/CD pipeline risk
findings. However, CI/CD pipeline risk **Findings** only displays
findings detected during periodic scans. In contrast, the comprehensive
**Findings** table includes all CI/CD pipeline risk findings regardless
of their detection source, such as periodic, pull request (PR), and
continuous integration (CI) scans.

The following table describes selected properties of the Findings table.

+-----------------------------------+-----------------------------------+
| Property                          | Description                       |
+===================================+===================================+
| Name                              | The name of the finding           |
+-----------------------------------+-----------------------------------+
| Created                           | When the finding was initially    |
|                                   | detected                          |
+-----------------------------------+-----------------------------------+
| Last Updated                      | The last detection date of the    |
|                                   | finding                           |
+-----------------------------------+-----------------------------------+
| Provider                          | The VCS including the CI/cD       |
|                                   | pipeline                          |
+-----------------------------------+-----------------------------------+
| Sub Category                      | The CI/CD category that the       |
|                                   | findings belongs to. Values       |
|                                   | include:                          |
|                                   |                                   |
|                                   | - 3rd Party Services              |
|                                   |                                   |
|                                   | - Artifact Integrity Validation   |
|                                   |                                   |
|                                   | - Credential Hygiene              |
|                                   |                                   |
|                                   | - Data Protection                 |
|                                   |                                   |
|                                   | - Dependency Chains               |
|                                   |                                   |
|                                   | - Identity & Access Management    |
|                                   |                                   |
|                                   | - Input Validation                |
|                                   |                                   |
|                                   | - Flow Control Mechanisms         |
|                                   |                                   |
|                                   | - Pipeline-Based Access Controls  |
|                                   |   (PBAC)                          |
|                                   |                                   |
|                                   | - Poisoned Pipeline Execution     |
|                                   |   (PPE)                           |
|                                   |                                   |
|                                   | - System Configuration            |
+-----------------------------------+-----------------------------------+
| Detection Method                  | The engine used to detect VCS and |
|                                   | CI/CD findings. Default value:    |
|                                   | CI/CD Security                    |
+-----------------------------------+-----------------------------------+
| Finding ID                        | The unique identifier assigned to |
|                                   | the finding                       |
+-----------------------------------+-----------------------------------+

####### Expanded Findings details

Click on a finding in the inventory table to open the **Findings** side
card, which provides additional details about the finding.

- **Finding summary**: Found at the top of the card. Includes the
  finding name, ID and type (**Configuration** for CI/CD risk findings)

- **Description**: A description of the finding including its location

- **Timestamp**: When the finding was last updated

- **Asset details**: Includes **Asset** (The impacted asset. Clicking on
  the asset opens the asset side card without needing to navigate away
  to the asset section) and **Asset Type** (The specific asset type in
  which the CI/CD risk was identified)

- **Evidence**: Provides evidence and contextual details within your
  SDLC containing the CI/CD risk finding:

  - **Finding source**

    - **Data Source:** The system or integration from which the finding
      data was originally pulled (such as GitHub or a CI/CD pipeline).
      Click the icon next to the data source to navigate to the data
      source itself

    - **Run ID**: The unique identifier of the specific scan execution
      during which this finding was detected

    - **Collaborator**: The individual or team responsible for
      contributing to the code or configuration where the finding was
      identified

  - **Code context**

    - **Repository:** The name of the version control repository where
      the finding was located

    - **Branch:** The specific branch within the repository containing
      the finding

    - **File Path:** The exact location of the finding within the
      repository file structure

    - **First Hash:** The commit hash of the first commit where this
      specific finding was introduced or detected

  - **Scan metadata**

    - **Run ID:** The unique identifier of the specific scan execution
      during which this finding was detected

- **Code**: The file and code including the CI/CD risk in which the
  finding was detected

##### CI/CD Rules

CI/CD rules are designed to detect security threats within your
application security environment, which includes the various components,
configurations, and interactions within your application that can
potentially introduce vulnerabilities or pose risks to its security.
CI/CD rules identify and flag issues based on predefined criteria,
ensuring that potential threats are proactively detected and addressed
to enhance the overall security posture of your application.

CI/CD rules cover a wide range of security best practices, inspired by
compliance frameworks such as OWASP top 10 CI/CD Risks, as well as
additional best practices beyond regulatory requirements.

> **Note**

- > Out-of-the-box rules cannot be modified

- > Custom CI/CD rules are not supported

###### CI/CD rules roles and permissions

These user roles and permissions are required for CI/CD rules:

- Roles with **Rules Read** permission can view detection rules

- Roles with **Rules View/Edit** permissions can create and modify
  detection rules

- Dedicated **AppSec Admins** and **DevSecOps** user roles only have
  **View** permissions

###### CI/CD rules inventory

The CI/CD rules inventory includes both out-of-the-box and custom rules.

To access the inventory:

1.  Under **Modules**, select Application Security \> AppSec Rules
    (under Policy Management).

2.  In the Filter panel, select Category \> Scanner \> CI/CD Security.

The following list describes selected table properties.

  -----------------------------------------------------------------------
  Field/Property                      Description
  ----------------------------------- -----------------------------------
  Rule Name                           The rule name

  Rule Description                    A description of the rule

  Severity                            The priority level assigned to
                                      findings identified by the rule

  Scanner                             CI/CD Security. This value is
                                      immutable

  Policies                            The policies that include the rule

  Last modified                       The date and time when the rule was
                                      most recently updated

  Labels                              Labels assigned to the rule

  Framework                           The framework or language that the
                                      detection rule applies to (for
                                      example, GitHub, Terraform,
                                      JavaScript)

  Issues                              The amount of issues detected by
                                      the rule
  -----------------------------------------------------------------------

###### Create custom CI/CD rules

Create custom CI/CD rules you to tailor your security measures to
address specific and unique threats to your pipelines that are not
covered by default rules. Custom rules run across branch periodic, PR,
and CI scans.

Use the custom rule builder to create CI/CD rules from scratch or clone
and customize existing rules, enabling you to tailor them to meet your
specific requirements effectively.

You can create custom rules for:

- **Secrets** scans

- **IaC** scans. Supported frameworks include Terraform, TFPlan (with
  automatic application of Terraform custom rules), CloudFormation,
  Kubernetes, Bicep, Helm, Kustomize, Helm and ARM. These scans also
  apply to serverless deployments

To create custom rules:

1.  Under **Modules** select Application Security \> AppSec Rules (under
    Policy Management) \> Add Rule.

2.  On the **New Rule** dialog box:

    a.  Provide these details:

        - **Name**: The name of the rule

        - **Impact**: Describes the potential impact of a detected
          violation. This description is displayed in the Issues page as
          well as PR Comments

        - **Severity**(required): Determines the priority level assigned
          to findings identified by the rule

        - **Scanner** (required): The type of scanner to be used to
          detect issues based on the rule

        - **Category** (required): Refines the scope of the rule. Values
          include General, IAM, Monitoring, Networking, Public, Storage,
          Compute, Kubernetes, Logging, and AI/Machine Learning

        - **Subcategory** (required): Further refines the scope of the
          rule by specifying particular attributes within the selected
          category

        <!-- -->

        - After selecting the category and sub-category, a description
          of the rule finding that will be based on these selections is
          displayed.

          Example
          If **IAM** is the category, and **Overly Permissive** is the
          sub-category, the finding type description is: \"Based on the
          categorization, finding type will be \"Overly permissive IAM
          policies configuration found in infrastructure as code\"\".

        <!-- -->

        - **Framework**: The framework or language that the rule is
          designed to apply to, such as Terraform, CloudFormation and
          ARM

        - **Labels:** Assign tags to rules to help categorize, filter,
          and organize them for easier identification and management

        - **Mapped Runtime Rule**: Select a runtime rule from the menu
          to map to your custom build time rule. This enhances your
          code-to-cloud visibility, allowing you to prioritize findings
          which are detected in both build and deployed environments

    b.  Click Next.

3.  On the **Rule Configuration** screen.

    a.  Provide your rule definition as YAML.

    - > **Note**

      > See [Configure YAML file
      > properties](#UUIDea47201b2a92ce9f3f0ad71e6d7abbd4) below for
      > more details.

    b.  Validate the code: Click Validate Code.

    c.  Provide suggested remediation in AsciiDoc format.

    d.  Click Done.

    - The rule is displayed in the rules inventory table.

- > **Note**

  > Scanning/testing behavior is not supported.

###### Manage CI/CD rules

You can manage CI/CD rules to customize and optimize your pipeline
security configurations according to your specific needs and
preferences: On the **AppSec Rules** inventory, right-click on a rule or
click to open the side panel \> select an option:

- Edit: Opens the **Edit Rule** wizard, allowing you to manage existing
  rules

- Duplication: Opens the selected rule in a New Rule dialog box,
  allowing you to save a copy of the rule. This allows you to customize
  default rules according to your requirements

##### CI/CD Policies

CI/CD policies define how a system should respond to threats in
pipelines. It includes conditions that trigger the policy, the scope of
its application, and the actions to be taken when these conditions are
met. When a policy detects a threat, it generates an issue for
remediation.

Cortex XSIAM provides out-of-the-box CI/CD policies. In addition, you
can create custom policies to tailor it to your specific business or
infrastructure requirements. Out-of-the-box policies cannot be modified
directly. However, you can create a custom policy by cloning the
existing one. This allows you to make changes to the original policy
according to your requirements. Refer to [Manage CI/CD
policies](#UUIDb099305c4a2601e1a697564a966fe2af) for more information.

###### CI/CD policies user roles and permissions

These user roles and permissions are required for CI/CD policies:

- - Roles with **Policies View/Edit** permissions can create and modify
    detection policies

  - Roles with **Policies Read** permissions can view detection policies

  - An **AppSec Admins** user role has **View/Edit **permissions

  - A **DevSecOps** user role only has **View** permissions

###### CI/CD policies inventory

The CI/CD policies inventory includes both out-of-the-box and custom
policies.

To access the inventory:

1.  Under **Modules**, select Application Security \> AppSec Policies
    (under Policy Management).

2.  In the filter panel, select Scan Type \> CI/CD Risk.

The following list describes the policy fields/properties displayed in
the inventory table. Details are provided for properties that require
explanation.

  -----------------------------------------------------------------------
  Field/attribute                     Description
  ----------------------------------- -----------------------------------
  Policy Name                         The name of the CI/CD policy

  Policy Description                  A description of the CI/CD policy

  Scan Type                           **CI/CD Risks** is the immutable
                                      value

  Conditions                          The specific criteria that trigger
                                      the policy

  Actions                             Actions to take when the policy
                                      detects its target risk

  Scope                               The type of assets to be evaluated
                                      by the policy. See for more
                                      information about policy scope

  Trigger                             Trigger types that define when the
                                      condition will be evaluated.
                                      Options include Periodic scan, Pull
                                      Request scan and CI scan

  Last Triggered                      The last time that the policy was
                                      triggered

  Created By                          The user or entity that created the
                                      policy

  Modified by                         The user or entity that modified
                                      the policy

  Modification Time                   The timestamp of the most recent
                                      change to the policy

  Open Issues                         The amount of issues detected by
                                      the policy that remain unresolved
  -----------------------------------------------------------------------

Selecting a policy opens a side panel where you can review the policy
name, description, configuration (scan type, trigger, conditions, and
actions), creator and modifier details, and the last modification time.
In addition you can see open issues created by the policy.

###### Create custom CI/CD policies

Create custom CI/CD policies to enable tailored security checks across
your pipelines.

1.  Under **Modules**, select Application Security \> AppSec Policies
    (under Policy Management).

2.  Click Add Policy on the **Policies** page.

3.  Provide a policy name (required) and description on the **General**
    step of the wizard that is displayed, and click Next.

4.  Define the policy conditions on the **Define Conditions** step of
    the wizard.

    a.  Define the criteria for your policy to evaluate.

        - **Trigger** (Required): For CI/CD policies, the only supported
          trigger type is **Periodic scan**.

        <!-- -->

        - > **Note**

          > **PR Scan** and **CI Scan** triggers are automatically
          > disabled and unchecked. They can only be enabled if other
          > scan types (that is non-CI/CD risk scans such as Secrets)
          > are also selected, and will only run on non-CI/CD risks
          > types of scans

        <!-- -->

        - **Conditions** (Required). Configure conditions for CI/CD
          risks by selecting **CI/CD Risks** as the **Finding Type**:
          Select Add Filter \> Finding Type \> CI/CD Risks.

        <!-- -->

        - > **Note**

          > You can combine multiple conditions to create complex rules
          > for when the policy should apply.

          EXAMPLE
          > Create conditions that apply to a CI/CD policy which detects
          > high severity CI/CD risks on GitHub: Select Add Filter \>
          > Finding Type \> CI/CD Risks \> AND \> Provider \>
          > \[VCS/CI/CD system\] \> AND \> Severity: \> High.

          For more information about CI/CD Risks as the finding type,
          refer to [Finding Type attribute for CI/CD
          Risks](#X7169be171b1d3034f1f0893ee2e1c28a2ce02b1) below.

        <!-- -->

        - **Developer Suppressions**: A developer suppression is an
          inline comment added during code development to exclude
          specific findings from being evaluated by a policy. You can
          choose to either apply or skip these suppressions

          - **Apply**: When you select this option, a new condition is
            automatically added to each existing condition group,
            ensuring the policy respects developer suppressions

          - **Skip**: This option causes the policy to evaluate all
            findings, even those suppressed by a developer

    b.  Click Next.

5.  Define the policy scope on the **Define Scope** step of the wizard.

    a.  Define the scope of the assets to be evaluated by the policy
        using one of these methods. Options include **Asset Groups** and
        **Matching Criteria**.

        - **Asset Groups**: Select the asset groups on which this policy
          and its chosen detection rules will be evaluated. You can only
          select asset groups that are assigned to you as part of your
          scope

        <!-- -->

        - For more information about Application Security
          **Asset Groups**, refer to
          [/document/preview/1395993#UUID-d0e46e4f-af92-f632-cf24-31897d19112b](/document/preview/1395993#UUID-d0e46e4f-af92-f632-cf24-31897d19112b)

        <!-- -->

        - **Matching Criteria**: When selected, displays a list of
          assets. You can define the policy\'s scope by using
          **Matching Criteria**, which allows you to build filters using
          the query builder. Only those assets that satisfy these
          criteria will be included in the policy\'s scope

        <!-- -->

        - > **Note**

          - > SBAC scope limitations do not apply to
            > **Matching Criteria**

          - > For CI/CD policies, you can filter **Matching Criteria**
            > by **VCS Organization Name**,
            > **CI/CD Pipeline \[Name/ID\]**,
            > **CI/CD Instance \[Name/ID\]** or **Collaborator**
            > \[**Name/Email/MFA Enabled/Last Observed**\]

    b.  Click Next.

6.  **Periodic Scan** trigger: This trigger is automatically enabled and
    locked (checked and disabled from being unchecked), as CI/CD Risks
    scans only run on Periodic scans

- Define **actions** to be taken when a policy is triggered on the
  **Define Action** step of the wizard.

  a.  Specify which actions to take when the policy detects its target
      risk:

      - **Create a new issue**: Create an issue if policy conditions
        within the selected scope are met. This is the only available
        action for CI/CD Risks policies

      - **Block**:

        - Block a CI run if the policy conditions within the selected
          scope are met. Available when **CI scan** is selected as the
          evaluation method

        - Block a build pull request (PR) if the policy conditions
          within the selected scope are met. Available when **CI scan**
          is selected as the evaluation method

      - **Report**:

        - Enable reporting via CLI if policy conditions within the
          selected scope are met. Available when **CI scan** is selected
          as the evaluation method

        - Enable reporting of a pull request (PR) comment if policy
          conditions within the selected scope are met. Available when
          **PR scan** is selected as the evaluation method

  b.  Click Create.

  - The policy is created. You are redirected to the **Policies** page,
    which displays the newly created policy.

####### Finding Type attribute for CI/CD Risks

When **CI/CD Risks** is selected as the finding type, the following
apply:

- **Periodic Scan** trigger: This trigger is automatically enabled and
  locked (checked and disabled from being unchecked), as CI/CD Risks
  scans only run on Periodic scans

- **PR Scan** and **CI Scan** triggers: These triggers are automatically
  disabled and unchecked. They can only be enabled if other scan types
  (that is non-CI/CD risk scans such as Secrets) are also selected, and
  will only run on non-CI/CD risks types of scans

- CI/CD risks attributes include **Severity**, **AppSec Rule**,
  **AppSec Rule Label**, **Backlog Status**, **Subcategory**,
  **Provider** (such as GitHub) and **Finding Type** (which enables you
  to enlarge the policy scope to include additional scanner types)

<!-- -->

- For more information about **Backlog Status**, refer to [Backlog
  baseline](#UUID1f924d14a08800ecc94f508836894770).

###### Manage CI/CD policies

Manage your custom CI/CD policies to maintain an effective application
security posture and adapt your security rules to evolving threats and
requirements.

To manage policies, right-click on a policy in the table or select a
policy and then select the menu in the side panel. The following actions
are available:

- **Edit policy**: Redirects to the policy wizard, allowing you to
  modify the policy

<!-- -->

- > **Note**

  > You cannot edit out-of-the-box (OOTB) policies.

<!-- -->

- **Duplicate policy**: Clone OOTB policies as templates for creating
  custom policies. When this option is selected, the policy wizard is
  displayed with the original policy configurations, allowing you to
  modify them as required

<!-- -->

- > **Note**

  > The duplicated policy will include the word \"clone\" in its name
  > and must be renamed.

<!-- -->

- **Disable policy**: Deactivate the policy without deleting it. Future
  scans will not trigger the policy, but existing issues detected by the
  policy will persist. Bulk actions are supported, allowing you to
  disable multiple policies simultaneously

- **Delete policy**: Permanently remove the policy from your
  environment. Issues detected by the policy will persist. Bulk
  deletions are supported

##### CI/CD Compliance

Cortex XSIAM enhances your CI/CD compliance posture by assessing
pipeline asset adherence to industry standards and your organization\'s
best practices. Cortex XSIAM supports compliance checks against the
**CIS GitLab Benchmark** v1.0.1, **CIS GitHub Benchmark** v1.0.0, and
the **OWASP Top 10 CI/CD Risks** v2025.

To access Compliance, select Posture Management \> Compliance \> Reports
or Assessment.

###### Create CI/CD compliance reports

The following steps describe the workflow for creating CI/CD compliance
reports.

  -----------------------------------------------------------------------------------------
  Step                                Description
  ----------------------------------- -----------------------------------------------------
  Step 1. Create an **Asset Group**.  [Create an Asset
                                      Group](#Xf7e9870f7056ea7b3d399c9aab5372d74899c9c)

  Step 2. Create an                   [Create an Assessment
  **Assessment Profile**.             Profile](#X76d2974f6238ac5151c351580033a136aad35cf)

  Step 3. View reports.               [View and access
                                      reports](#Xe48b30e99010bcf7b6aa5321eba1b43ea316e3b)
  -----------------------------------------------------------------------------------------

####### Create an Asset Group

Create an asset group to define a logical collection of your CI/CD
assets (such as specific repositories or pipelines within a provider
like GitHub). This step scopes your security assessments, ensuring that
subsequent compliance checks and scans performed by an assessment
profile are applied to the relevant resources.

1.  Navigate to Inventory \> Groups \> + Add Group.

2.  On the **Create New Assets Group** screen:

    a.  Provide a group name (required)and description.

    b.  Select Provider \> \[Type of provider\].

    - > **Note**

      > The CI/CD module supports GitHub and GitLab providers.

    c.  Select Create Dynamic Group, or select assets from the list that
        is displayed, and click Create Static Group.

- > **Note**

  > For more information about about **Asset Groups**, refer to [Asset
  > Groups](#UUIDa299007a63312a26ae182d415c512454).

####### Create an Assessment Profile

Create an assessment profile, which configures the specific security
standards and initiates the scans against the assets defined in your
asset group.

1.  Navigate to Posture Management \> Compliance \> Assessment Profiles
    \> Create New Assessment.

2.  On the **General** step of the wizard.

    a.  Provide a profile name (required) and description, and select
        **Generate a scheduled report**.

    b.  Specify the email recipients for the report.

    c.  Set the **Evaluation frequency** (required).

    d.  Click Next.

3.  On the **Standards and Asset Group** step of the wizard.

    a.  Select a standard.

    - > **Note**

      > **CIS GitLab Benchmark**, **CIS GitHub Benchmark**, and the
      > **OWASP Top 10 CI/CD Risks** standards are supported.

    b.  Select your asset group from the list and click Next.

4.  Review the details on the **Summary** step of the wizard and click
    Create.

> **Note**
>
> For more information about assessment profiles, refer to
> [/document/preview/1253090#UUID-a4783244-e6aa-a914-f8ed-6be5882609f0](/document/preview/1253090#UUID-a4783244-e6aa-a914-f8ed-6be5882609f0).

####### View and access reports

The email recipients defined in the assessment profile will receive the
compliance report.

To view the compliance scan results:

1.  Navigate to Posture Management \> Compliance \> Assessment or
    Reports.

2.  Right-click on a report

For more information about compliance assessment reports, refer to
[/document/preview/1253036#UUID-6cfa00ee-425f-f73b-ab24-bdc4e737c1a6](/document/preview/1253036#UUID-6cfa00ee-425f-f73b-ab24-bdc4e737c1a6).

#### Code Security

Code Security provides automated, native scanning tools designed to
enhance the security posture of your applications and infrastructure.
Integrating these scanners into your development workflow facilitates a
shift-left approach to security, enabling the proactive identification
and remediation of security issues early in your software development
lifecycle (SDLC), preventing them from reaching production environments.

Findings generated by native scanners are evaluated and elevated to
actionable issues based on policies defined within Cortex XSIAM. Code
Security issues are displayed in dedicated issue tables, organized by
the native Code Security scanner type (Secrets, SCA and IaC
misconfigurations), providing security teams with focused, manageable
views, in specialized issue tables.

These tables are filtered instances of the centralized **Issues** table
located under **Cases & Issues**. These specialized Code Security issue
tables only display issues generated from findings detected during
periodic scans. In contrast, the comprehensive Issues table includes all
issues, regardless of their detection source, such as periodic, pull
request (PR), and continuous integration (CI) scans.

##### Code Security use cases

- **Prevent production incidents**: By integrating security scans into
  CI/CD pipelines, organizations can block insecure code from being
  merged into production, preventing critical vulnerabilities from
  reaching live environments

- **Ensure compliance and reduce risk**: Automated scanning for known
  vulnerabilities (CVEs) and open-source license risks helps
  organizations adhere to regulatory requirements and minimize legal and
  compliance exposure

- **Improve developer efficiency and productivity**: Providing immediate
  feedback on security issues directly within the IDE allows developers
  to fix problems as they code, reducing rework and accelerating secure
  development

- **Gain comprehensive visibility into software assets**: Building a
  complete inventory of open-source packages and assessing your
  operational risk to help understand your software supply chain and
  proactively manage potential threats from outdated or abandoned
  components

- **Streamline security operations**: Centralized scan management,
  customizable policies, and API integrations enable security teams to
  automate workflows, enforce security standards, and gain a holistic
  view of your Application Security posture

- **Enhance traceability and remediation**: Mapping security rules from
  code to cloud environments allows for end-to-end traceability of
  issues, accelerating the identification of root causes and
  prioritization of remediation efforts

###### Code Security key features

- Comprehensive code scanning:

  - **Software Composition Analysis (SCA)**:

    - **Vulnerability scanning**: Identifies known vulnerabilities
      (CVEs) in open-source dependencies

    - **License scanning**: Manages open-source license obligations and
      identifies compliance risks

    - **Package Operational Risk scanning**: Assesses the popularity,
      maintenance status, and potential long-term risks of open-source
      packages (such as deprecation, maintainer activity)

  - **Secrets scanning**: Detects hardcoded credentials, API keys, and
    other sensitive information within source code

  - **Infrastructure as Code (IaC) scanning**: Identifies
    misconfigurations and security flaws in IaC templates (such as
    Terraform, CloudFormation)

- Seamless integration and shift-left capabilities:

  - **Version control system (VCS) and CI tool onboarding**: Integrates
    with popular VCS (such as GitHub, GitLab, Bitbucket) and CI tools
    (such as Jenkins or GitHub Actions) for automated scanning

  - **CLI scans**

    - **Integration with CI tools**: Allows for easy implementation in
      CI pipelines by adding a snippet, enabling blocking of pipelines
      based on security policies

    - **Dedicated Application Security CLI module** (as part of Cortex
      XSIAM unified CLI (which includes Image, API, and code scanning)),
      enabling local scans or pipeline steps to detect IaC, secrets,
      vulnerabilities, license, and package integrity findings

    - **IDE support** (JetBrains, VS Code): Plugins for popular
      Integrated Development Environments (IDEs) to enable shift-left
      security, allowing developers to detect and fix issues (IaC,
      Secrets, CVE, License, Package Integrity (Operational Risk))
      directly as they write code, including local fixes and suppression
      options

- Centralized scan management:

  - **Review of all scan types**: Provides a unified view for periodic,
    Pull Request (PR), and Continuous Integration (CI) scans

  - **Detailed scan insights**: Overview tabs for scan details and
    health, along with dedicated tabs for each finding type
    (Vulnerabilities, Configurations, Secrets, Package Integrity)

  - **Issue/Finding card access**: Allows you to drill down into
    individual issues from the scan management page

  - **Reporting and blocking**: Configurable policies to report findings
    or block pipelines based on predefined Application Security policies

- Out-of-the-box and customizable rules and policies:

  - **Out-of-the-box rules and policies**, as well as the ability for
    custom creation

  - **Customization** of conditions and scope for pipeline blocking

  - **Custom code to cloud rules mapping**: Provides the ability to map
    custom Application Security IaC rules to custom runtime CSPM (Cloud
    Security Posture Management) rules, improving issue traceability and
    accelerating remediation by linking code-level issues to cloud
    runtime anomalies

- Secure communication and APIs:

  - **Transporter**: A secure communication channel between your SDLC
    environment and Cortex XSIAM

  - **Application Security APIs**: Public APIs for scan management,
    policies, and applications, enabling enhanced automation,
    integration capabilities, and granular control with enforced user
    permissions

##### Code Security user roles and permissions

Cortex XSIAM offers dedicated predefined user roles for Code Security:
**AppSec Admin**, **DevSecOps** and **Developer**, each with specific
areas of responsibilities. When assigning roles to users, it\'s
recommended to align them with the user\'s required responsibilities
within the application security framework.

The **AppSec Admin** has full permissions for all Application
Security-related activities. They can create and modify detection rules
within the Code/Build domain, track progress, and adjust enforcements as
needed. Additionally, they can triage and investigate findings, issues,
and cases spanning from code to cloud. The role also includes complete
visibility into all cloud assets.

The **DevSecOps** role is specifically designed as an intermediary,
possessing more permissions than a Developer but fewer than an AppSec
Admin. This role actively manages security processes and tools to embed
security directly into development and operations workflows.
Responsibilities include managing and resolving security issues,
performing scan management, and improving the overall application
security posture by integrating security practices throughout the
development and operations lifecycle.

**Developers** within the Code Security environment have limited
permissions primarily focused on viewing and monitoring security
information. They can access and analyze scan results, track progress,
and collaborate with security teams. However, they typically do not have
the authority to modify detection rules, enforcements, or directly
address security issues.

Permissions defined in the predefined roles cannot be changed. However,
you can save a predefined role as a new custom role. This custom role
can then be edited to meet specific organizational needs, offering a
balance between standardized roles and customizable access control.

Dedicated Code Security roles include permissions that extend beyond
Code Security itself. In addition to these dedicated users, other roles
within your tenant are also granted specific permissions to Code
Security. You can view all permissions granted to user roles in your
tenant by navigating to Settings \> Configurations \> Roles \> select a
role.

##### Code Security assets

**Code Security** provides a comprehensive view of Code Security assets
detected by native **Infrastructure-as-Code (IaC)** and
**Software Composition Analysis (SCA)** scanners. These assets are
displayed in dedicated **IaC Resources** and **Software Package**
inventories. Both are specialized, filtered views within the broader
**All Assets** inventory. This focused approach allows you to manage and
analyze your **Code Security** assets separately from other types in
your environment.

Code Security assets are a part of the broader Application Security
asset suite, including:

- **ASPM** assets, which include **Repositories**. For more information
  about **Repositories**, refer to [Repositories as
  assets](#UUID590316e33f5ce2e0c9ab8f0f4ccf4b31).

- **CI/CD Security** assets, which include **VCS Organizations**,
  **CI/CD Instances** and **CI/CD Pipelines**. For more information
  about **CI/CD Security** assets, refer to
  [/document/preview/1403562#UUID-2888c76f-10dc-1400-4f15-10d97fc07eaa](/document/preview/1403562#UUID-2888c76f-10dc-1400-4f15-10d97fc07eaa).

- **Identity** assets, which include **Collaborators**. For more
  information about **Collaborators** as assets, refer to [VCS
  Collaborators-as-assets](#UUID1f8553431801a2f53c454ed39d8fe635).

###### Code Security asset use cases

- **Visibility and context**

  - **Asset inventory**: Maintain a comprehensive inventory of all
    detected assets, including their metadata and relationships to other
    assets. This provides a centralized view of all components within
    the environment

  - **Code to cloud mapping**: A graphical representation of the SDLC,
    highlighting the asset\'s location within. This visualization allows
    for a clear understanding of the asset\'s journey and its
    relationship to other components

  - **Application path to production**: Trace the asset\'s path through
    the application lifecycle, from its origin in code repositories to
    its deployment. This includes identifying all intermediate stages
    and dependencies

- **Security risks**

  - **Infrastructure as Code** (IaC) misconfigurations: Identify
    misconfigurations associated with the IaC asset configuration, and
    provide details such as severity, location, when created and the
    assignee

  - **SCA CVE vulnerabilities**: Identify known vulnerabilities in
    open-source packages associated with an asset, including details
    such as severity, the CVE issue, CVSS score, when discovered and the
    assignee

  - **License miscompliance**: Identify and detail license miscompliance
    issues within packages associated with an asset, including severity,
    license category (such as strong copyleft), location, when
    discovered, and the assignee

  - **Package Integrity**: Identify and detail any package operational
    issues in packages associated with the asset, including severity,
    location, when created and the assignee

##### Software packages as assets

The **Software Packages** asset inventory provides a centralized view of
all open source software packages and their details across your
environments. The platform enables efficient tracking and management of
your software package assets, ensuring compliance with security and
governance standards. You can directly access package vulnerabilities,
operational risks and license misconfiguration cases, issues, and
findings within the **Software Packages** asset inventory, allowing you
to prioritize and remediate them without having to navigate to a
separate remediation section.

###### In-depth software package asset information

Click an asset in the inventory table to open its side card, providing
in-depth information organized into several tabs. The **Overview** tab
(default display) offers highlights and a general summary. Additional
contextual tabs provide specific details, including a **Code to Cloud**
tab (providing context on the asset\'s path to production), an
**Applications** tab (displaying the applications in which the asset is
detected), and tabs such as **Configurations** and **Code** (focusing on
specific issue types detected within the asset).

####### Software package summary

The software package asset summary, displayed at the top of the card,
provides concise details about the asset\'s key attributes, including
the package name and originating package manager.

####### Overview

The **Overview** tab summarizes software package package highlights and
properties.

Highlights include:

- **Critical/High issues**: An aggregation of critical and high
  vulnerability issues associated with the package

- **New**: Indicates whether the package was first detected in your
  environment during the past 30 days

- **Root**: Indicates whether this package is the top-level package
  within its dependency tree, meaning it is not a dependency of any
  other package within the project

- **Deprecated**: Whether the package was officially deprecated by its
  maintainers. This indicates that it is no longer recommended for use
  and could potentially include security risks

- **Risk summary**: The amount of vulnerabilities associated with the
  package grouped by category (cases, issues and findings) and their
  severity. For more information about OSS package vulnerabilities,
  refer to
  [/document/preview/1100737#UUID-d68e42ab-22ca-e7f1-7e6d-6b920d311f35](/document/preview/1100737#UUID-d68e42ab-22ca-e7f1-7e6d-6b920d311f35)

- **Visibility timeline**: When the package vulnerabilities were first
  and last detected

**Properties**:

- Asset details, including **Asset Id**, **Asset Types** and
  **Asset Groups** associated with the package

- **Applications**: Lists the applications that include this package as
  part of their defined assets or configurations. See **Application**
  below for more details

- **Package source**: Includes details about the package origin,
  including its provider (such as PyPI, npm), the repository and branch
  hosting the package source code, the path to its primary file, the
  license under which it\'s distributed, its dependency type (direct or
  transitive), and a list of contributors

- **Scan information**: A list of Software Composition Analysis (SCA)
  scans conducted on the package. Scan details include the name of the
  scanner used, the specific branch of the package that was scanned, the
  timestamp of the last scan, and the overall status of the scan (such
  as completed or failed).

<!-- -->

- For more information about scan management, refer to [How to access
  Application Security scan
  management](#UUIDb4dc61490e2b122efebc142ac1d9e635).

The **Highlights** section and other asset properties only display
attributes when their corresponding indicators are present. For example,
if an asset is not deployed, its deployment-related attributes will not
show up; similarly, if there are no detected issues, those highlights or
properties will not appear.

####### Code

The **Code** tab identifies the package\'s location within your codebase
by providing the repository, file path, and specific line number.
Additionally, it presents the package\'s dependency tree, viewable as
either a graph or a hierarchical list, presenting its relationships with
other components.

####### Code to Cloud

The **Code to Cloud** tab visually represents the software development
lifecycle (SDLC), focusing on the package\'s role in the path to
production. The graph describes the links between the repository node
hosting the package, the pipeline, image, and cluster.

Example SLDC workflow:

- Developers write code and commit changes to a version control system
  like Git, storing it in a central code repository

- When code changes are pushed to the repository, an automated pipeline
  is triggered, handling build, automated testing, and packaging code
  into a deployable artifact

- The built and tested application is packaged into a container image,
  which is then pushed to a container registry like Docker Hub or a
  cloud-specific registry

- The container image is pulled from the registry and deployed to a
  container orchestration platform like Kubernetes, managing running
  application instances (containers) for scalability, availability, and
  resource management

- The container orchestration platform runs on top of your chosen cloud
  infrastructure, such as AWS, Azure, or GCP

####### Applications

The **Applications** tab provides an overview of the application
associated with this package, including a graphical representation of
its path to production, which incorporates the package\'s role within
the workflow.

For more information about applications, refer to
[/document/preview/1417708#UUID-a80d1f52-9270-6a2c-78af-754f5d3cff0c](/document/preview/1417708#UUID-a80d1f52-9270-6a2c-78af-754f5d3cff0c).

####### Vulnerabilities

The **Vulnerabilities** tab provides a list of vulnerabilities
identified within the package in your environment. Each vulnerability
includes details regarding its severity level, associated CVE
identifier, CVSS score, initial detection date, and assigned team member
or group responsible for remediation.

The table includes the following properties:

- **Severity** level (icon): Indicates the level of severity of the
  vulnerability

- **Issue Name**: The CVE identifier

- **CVSS Score**: The Common Vulnerability Scoring System score that
  quantifies the severity of the vulnerability

- **Assigned To**: The person or team responsible for addressing the
  vulnerability

- **Creation Date**: The date when the vulnerability was detected

For more information about SCA vulnerabilities, [Software Composition
Analysis (SCA) CVE vulnerability
issues](#UUIDd5b6e8c8c4b7665e8015abd242bfc0bf)

####### Package Integrity

The **Package Inventory** tab provides details about the popularity and
maintenance of packages identified within your SDLC. It also includes an
inventory of package operational risk issues and package license issues,
offering a comprehensive view of the package\'s overall health and
compliance.

The table includes the following properties:

- **Severity** level (icon): Indicates the level of severity of the
  package license miscompliance

- **Issue Name**: The package license miscompliance identifier

- **License Name**: The name of the license associated with the package.
  This indicates the specific license agreement that is potentially
  being violated

- **Asset Name**: The name of the asset that uses the package with the
  license miscompliance. This identifies where the license issue occurs

- **Branch**: The branch of the codebase where the asset with the
  license issue is located

The **Operational Risk Issues** table includes the following properties:

- **Severity**: Indicates the level of severity of the package
  operational risk

- **Issue Name**: The package operational risk identifier

- **Asset Name**: The name of the asset that uses the package with the
  package operational risk

- **Branch**: The branch of the codebase where the asset with the
  package operational risk is located

- **Assigned To**: The person or team responsible for addressing the
  package operational risk

- **Creation Date**: The date when the package operational risk was
  initially detected

For more information on Package Operational Risks, refer to [Package
Integrity](#UUID9d71749cd3dd94fb240492b0cdaddaeb).

##### Infrastructure-as-Code (IaC) resources as assets

The **IaC resource** asset inventory provides a centralized view of all
infrastructure-as-code (IaC) resources and their details across your
environments. The platform enables efficient tracking and management of
your IaC resources, ensuring compliance with security and governance
standards. You can directly access IaC misconfiguration issues and
findings within the IaC assets inventory, allowing you to prioritize and
remediate them without having to navigate to a separate remediation
section.

###### Explore IaC assets

To access IaC assets, under **Inventory**, select All Assets \> Code \>
IaC Resources.

The **IaC Resources** assets page includes a dashboard and an inventory.

####### IaC resources dashboard

The dashboard includes two widgets:

- **Cloud Providers**: Displays connected cloud providers (such as AWS
  and GCP) and the number of IaC resources found in each provider

- **Frameworks**: Displays connected frameworks (such as Terraform and
  Kubernetes) and the number of IaC resources found in each framework

Selecting an item in either widget filters the table accordingly.

####### IaC resource asset inventory

The following table describes selected IaC resource properties of the
inventory.

  -----------------------------------------------------------------------
  Property                            Description
  ----------------------------------- -----------------------------------
  Asset ID                            The identifier assigned to the IaC
                                      resource

  Provider                            The version control system
                                      containing the IaC resource

  Name                                The unique identifier for the IaC
                                      resource within the system

  Resource Type                       The type of configurations or
                                      artifacts represented in the
                                      Infrastructure as Code (IaC)
                                      assets, such as Dockerfile, AWS
                                      Internet Gateway and AWS EKS Addon

  Type                                The classification of artifacts or
                                      resources within IaC assets, such
                                      as Dockerfile resource and
                                      Terraform resource

  Cloud Provider                      The cloud provider where this IaC
                                      resource is deployed, such as AWS,
                                      Azure, or GCP

  Repository                          The version control system
                                      repository where the IaC code for
                                      this resource is stored

  File Path                           The relative path to the IaC
                                      provider file within the repository
                                      that defines this resource

  End Line                            The line number indicating the
                                      conclusion or endpoint of the
                                      configuration code for a particular
                                      IaC resource within the specified
                                      file. Example: for
                                      `/vpc.tf (62-66)`, the end line
                                      refers to line 66, marking the
                                      conclusion of the configuration
                                      related to the IaC resource defined
                                      in the \'vpc.tf\' Terraform file

  Framework                           The IaC framework used to define
                                      and manage this resource, such as
                                      Terraform or CloudFormation

  Branch                              The specific branch of the
                                      repository where the IaC asset is
                                      located

  First Observed                      The date and time when this IaC
                                      resource was first discovered by
                                      the system.

  Type Category                       Fixed value: IaC Resource
  -----------------------------------------------------------------------

###### In-depth IaC resource asset information

Click an asset in the inventory table to open its side card, providing
in-depth information organized into several tabs. The **Overview** tab
(default display) offers highlights and a general summary. Additional
contextual tabs provide specific details, including a **Code to Cloud**
tab (providing context on the asset\'s path to production), an
**Applications** tab (displaying the applications in which the asset is
detected), and tabs such as **Configurations** and **Code** (focusing on
specific issue types detected within the asset).

####### IaC resource summary

The IaC resource asset summary, displayed at the top of the card,
provides concise details about the IaC resource, such as its name (such
as aws_s3_bucket.website), type (such as S3 bucket), and the associated
framework (such as Terraform).

####### Overview

The **Overview** tab summarizes IaC resource highlights and properties.

**Highlights** provide key security and operational insights related to
the asset:

- **Critical/High issues**: An aggregation of critical and high issues
  associated with the IaC resource

- **Internet Exposed Runtime Asset**: Indicates whether the IaC
  resource, when deployed, results in a runtime asset (such as a
  container), that is directly accessible from the public internet

- **Deployed**: Indicates whether the IaC resource has been deployed and
  is currently active within your cloud environment or infrastructure

- **New**: Indicates whether the IaC resource was created during the
  past 30 days

- **Sensitive Data in Runtime**: Indicates whether the IaC resource,
  when deployed, handles or stores sensitive data within its runtime
  environment

- **Risk summary**: The amount of cases, issues and findings associated
  with the IaC resource. Each of these types includes two clickable
  values. The first value redirects to the corresponding type table
  sorted by the entry, while the second value opens the description card
  of the specific type within the IaC resource asset inventory without
  requiring redirection

- **Visibility timeline**: When the IaC resource was first and last
  detected

**Properties**:

- Asset details, including **Asset Id**, **Asset Category** and
  **Account ID** associated with the IaC resource

- **Source Control Information**: Displays the origin and location of
  the IaC resource\'s code. It includes the cloud provider (such as
  AWS), the provider hosting the code (such as GitHub, GitLab), the
  linked repository and branch in which the code is hosted, associated
  tags, and the exact file path to the resource\'s definition

- **Version History and Metadata**: Provides insights into the
  resource\'s development history, authorship, and associated metadata.
  It lists collaborators who have modified the IaC code, and details
  about the initial commit hash and time related to this IaC asset

- **Scan information**: A list of scans conducted on the IaC resource.
  Scan details include the name of the scanner used, the specific branch
  of the package that was scanned, the timestamp of the last scan, and
  the overall status of the scan (such as completed or failed)

<!-- -->

- For more information about scan management, refer to [How to access
  Application Security scan
  management](#UUIDb4dc61490e2b122efebc142ac1d9e635).

The **Highlights** section and other asset properties only display
attributes when their corresponding indicators are present. For example,
if an asset is not deployed, its deployment-related attributes will not
show up; similarly, if there are no detected issues, those highlights or
properties will not appear.

####### Code

The **Code** tab describes the directory path and file name where the
asset\'s resource code resides within your IaC repository. In addition,
the code defining the resource block is displayed.

####### Code to Cloud

The **Code to Cloud** tab describes the integrated flow of a selected
Infrastructure as Code (IaC) asset, from development to its deployed
state. The graph visualizes the path to production, showing the IaC
resource\'s journey from the repository node where it\'s hosted, through
the CI/CD system, and finally to the traced runtime resource it
provisions.

####### Applications

The **Applications** tab provides an overview of the application
associated with this IaC asset, including a graphical representation of
its path to production, which incorporates the IaC assets role within
the workflow.

For more information about applications, refer to
[/document/preview/1417708#UUID-a80d1f52-9270-6a2c-78af-754f5d3cff0c](/document/preview/1417708#UUID-a80d1f52-9270-6a2c-78af-754f5d3cff0c).

####### Configurations

The **Configurations** tab displays an inventory of IaC misconfiguration
detected in the asset.

The table includes the following exposed properties:

- **Severity** level (icon): Indicates the level of severity of the IaC
  misconfiguration

- **Issue Name**: The IaC misconfiguration identifier

- **Asset Name**: The name of the IaC resource in which the
  misconfiguration occurred

- **Assigned To**: The person or team responsible for addressing the
  vulnerability

- **Creation Date**: The date when the vulnerability was detected

For more information about IaC misconfiguration, refer to
[#UUIDea3a4b5c9edd63f1e81f2658f83b1d38](#UUIDea3a4b5c9edd63f1e81f2658f83b1d38).

####### Secrets

The **Secrets** tab displays an inventory of exposed Secrets in the IaC
asset.

The table includes the following exposed properties:

- **Severity** level (icon): Indicates the level of severity of the
  exposed Secrets

- **Issue Name**: The Secrets identifier

- **Assigned To**: The person or team responsible for addressing the
  Secrets

- **Creation Date**: The date when the Secrets were initially detected

For more information about Secrets, refer to
[#UUID7d638c37097525bfcd4f357fe65e4d0e](#UUID7d638c37097525bfcd4f357fe65e4d0e).

##### Code Security scanners

The Code Security module provides automated, native scanning tools
designed to enhance the security posture of your applications and
infrastructure. Integrating these scanners into your development
workflow facilitates a \"shift-left\" approach to security, enabling the
proactive identification and remediation of vulnerabilities early in
your software development lifecycle (SDLC).

The module includes both native scanners and the capability to ingest
data from third-party scanners, giving you comprehensive visibility into
your security posture.

Code Security scanners include:

- **Software Composition Analysis** (SCA) scanners: Modern applications
  frequently incorporate numerous open-source and third-party packages.
  Code Security SCA scanners automate the inspection of these
  dependencies. They identify known vulnerabilities (tracked as CVEs),
  assess license compliance to mitigate legal risks, and detect package
  operational risks such as outdated or unmaintained components. This
  provides critical insight into your software\'s complete composition,
  enabling informed decisions about external code. For more information
  refer to
  [#UUIDba218b3f28080b0a69865f24bf36748c](#UUIDba218b3f28080b0a69865f24bf36748c)

- **Secrets** scanner: The accidental exposure of sensitive
  credentials---including API keys, passwords, or tokens---within source
  code or configuration files represents a significant security risk.
  The Code Security module secrets scanner detects hardcoded secrets
  across your repositories and code. Early identification of these
  exposures prevents unauthorized access and potential data breaches.
  For more information refer to
  [#UUID7d638c37097525bfcd4f357fe65e4d0e](#UUID7d638c37097525bfcd4f357fe65e4d0e)

- **Infrastructure as Code** (IaC) scanners: Analyze your infrastructure
  configuration files prior to deployment to detect misconfigurations,
  insecure defaults, and compliance violations, thereby preventing the
  introduction of vulnerabilities into your operational environments.
  For more information refer to
  [#UUIDea3a4b5c9edd63f1e81f2658f83b1d38](#UUIDea3a4b5c9edd63f1e81f2658f83b1d38)

In addition to the native code security scanners, Cortex XSIAM Cloud
ingests data from third-party scanners. This allows you to consolidate
your security findings and manage them all within a single platform for
a holistic view of your security posture. For more information about
third party scanners, refer to [Ingest third-party
data](#UUID555b56a837f1c33b635d61223f135577)

##### Software Composition Analysis (SCA ) scanners

Application Security SCA scanners inspect and manage the security and
compliance of your application\'s open-source and third-party
dependencies. They are part of the Cortex Cloud shift-left security
strategy, enabling organizations to proactively identify and mitigate
risks associated with external code components early in the development
lifecycle.

Currently, support for SCA is limited to static analysis, meaning that
only direct dependencies are scanned. However, if lock files are
present, support is extended to include the analysis of transitive
dependencies as well.

###### SCA use cases

SCA provides a comprehensive approach to securing your software supply
chain by enabling you to achieve these objectives:

- **Gain comprehensive visibility into Software Composition**: SCA tools
  build a complete inventory of all open-source packages and their
  dependencies, providing critical insight into your software\'s entire
  composition. This unified view helps you understand and manage your
  overall software supply chain. Refer to [Software packages as
  assets](#UUIDfbb2f80aede650f0b1f7ec1f9eb42a17) for more information

- **Improve application code security and prioritizing remediation**:
  SCA scans identify critical vulnerabilities and prioritize remediation
  efforts based on a data-driven risk assessment that combines
  code-level vulnerabilities and potential business impact

- **Enable informed decisions about external code**: By providing
  detailed insights into vulnerabilities, licenses, and operational
  risks, SCA empowers development and security teams to make informed
  decisions about the use, update, or replacement of external code
  components

SCA achieves these objectives by performing the following core
functions:

- **Identify known vulnerabilities (CVEs)**: Automatically detect and
  flag known security vulnerabilities (tracked as Common Vulnerabilities
  and Exposures or CVEs) present in your open-source and third-party
  dependencies. This provides crucial insights into potential weaknesses
  that could be exploited

- **Assess license compliance**: Manage open-source license obligations
  and identify potential compliance risks introduced by your
  application\'s components. This helps you adhere to regulatory
  requirements and minimize legal and compliance exposure

- **Detect Package Operational Risks**: Evaluate the operational health
  and potential long-term risks of open-source packages, such as
  assessing their popularity, maintenance status (such as outdated or
  unmaintained components), and deprecation status. This allows you to
  proactively manage threats from abandoned or insecure components

###### Supported Software Composition Analysis (SCA) frameworks and languages

The following table provides the SCA languages supported by Cortex
XSIAM.

  -----------------------------------------------------------------------------------
  Language     Vulnerabilities   Operational   License     Transitive     Root Fix
                                 Risk          Detection   Dependencies   Detection
  ------------ ----------------- ------------- ----------- -------------- -----------
  JavaScript   Yes               Yes           Yes         Yes            Yes

  Python       Yes               Yes           Yes         Yes            Yes

  Go           Yes               Yes           Yes         Yes            Yes

  Java         Yes               Yes           Yes         Yes            Yes

  Kotlin       Yes               Yes           Yes         Yes            Yes

  Ruby         Yes               No            No          Yes            No

  .NET (C#)    Yes               Yes           Yes         Yes            Yes
  -----------------------------------------------------------------------------------

####### SCA support matrix by language

The following table provides a high-level overview of Cortex XSIAM
SCA\'s language support. Clicking on any listed language will navigate
to a dedicated section with more in-depth details about the language.

+-----------------------+-----------------------+-----------------------+
| Language              | Package Managers      | Manifest Files        |
+=======================+=======================+=======================+
| JavaScript            | npm                   | package.json          |
|                       |                       |                       |
|                       |                       | package-lock.json     |
+-----------------------+-----------------------+-----------------------+
| yarn                  | package.json          |                       |
|                       |                       |                       |
|                       | yarn.lock             |                       |
+-----------------------+-----------------------+-----------------------+
| Python                | pip                   | requirements.txt      |
|                       |                       |                       |
|                       |                       | Pipfile               |
|                       |                       |                       |
|                       |                       | Pipfile.lock          |
+-----------------------+-----------------------+-----------------------+
| GO                    | Go                    | go.mod                |
|                       |                       |                       |
|                       |                       | go.sum                |
|                       |                       |                       |
|                       |                       | Gopkg.lock            |
+-----------------------+-----------------------+-----------------------+
| Java                  | Maven                 | pom.xml               |
+-----------------------+-----------------------+-----------------------+
| Gradle                | build.gradle          |                       |
|                       |                       |                       |
|                       | settings.gradle       |                       |
+-----------------------+-----------------------+-----------------------+
| Kotlin                | Maven                 | pom.xml               |
+-----------------------+-----------------------+-----------------------+
| Gradle                | build.gradle.kts      |                       |
|                       |                       |                       |
|                       | settings.gradle.kts   |                       |
+-----------------------+-----------------------+-----------------------+
| Ruby                  | ---                   | Gemfile               |
|                       |                       |                       |
|                       |                       | Gemfile.lock          |
|                       |                       |                       |
|                       |                       | gemspec               |
+-----------------------+-----------------------+-----------------------+
| ,NET                  | ---                   | .csproj               |
|                       |                       |                       |
|                       |                       | packages.config       |
|                       |                       |                       |
|                       |                       | project.assets.json   |
|                       |                       |                       |
|                       |                       | packages.lock.json    |
|                       |                       |                       |
|                       |                       | paket.lock            |
+-----------------------+-----------------------+-----------------------+

###### Software Composition Analysis (SCA) CVE vulnerability issues

All Critical and High SCA CVE vulnerability findings in software
packages within an organization\'s environment are categorized as SCA
issues, which represent the smallest unit for remediating SCA issues. To
address the most critical exposures, you can further prioritize these
secret issues based on their urgency level. Where applicable, both
manual and automated fixes are provided to resolve these issues.

The **Vulnerabilities** issues and findings tables are filtered views of
the main issues and findings tables under **Cases & Issues**, dedicated
solely to issues and findings categorized as CVE vulnerabilities,
detected during periodic scans.

####### How to access CVE vulnerability issues

To access CVE vulnerability issues, under **Modules**, select
Application Security \> Issues \> Vulnerabilities.

> **Tip**
>
> You can also view SCA vulnerabilities in dedicated tabs under other
> sections when available:

- > In **Asset** inventories, navigate to Inventory \> All Assets \>
  > Code:

  - > On the **Vulnerabilities** tab under **Repositories**. Refer to
    > [In-depth repository asset
    > information](#UUID929bbcfbc88cc71456d696269fe944cb) for more
    > information

  <!-- -->

  - > Under the **All Code** inventory: Select an asset from the table
    > \> Vulnerabilities

- > On the **Applications** inventory: Navigate to Inventory \> All
  > Assets \> Applications \> select an option from the Applications
  > menu \> select an application from the inventory \> Vulnerabilities

- > In **Cases and Issues**; perform a query. Select Issues \> AppSec
  > Issues (under the All Domains menu) \> AppSec CVE Scanner (as the
  > Detection Method value)

####### SCA CVE vulnerabilities inventory

The SCA CVE vulnerabilities inventory includes the following exposed
fields. Use the menu to view additional fields.

  --------------------------------------------------------------------------------------
  Field/attribute                     Description
  ----------------------------------- --------------------------------------------------
  Severity                            The severity level of the issue

  Name                                The unique identifier assigned to the CVE

  CVSS Score                          Common Vulnerability Scoring System (CVSS) score
                                      representing the severity of the vulnerability

  EPSS Score                          The Exploit Prediction Scoring System (EPSS)
                                      provides a data-driven probability score (from 0
                                      to 1, or 0% to 100%) that indicates the likelihood
                                      of a given CVE being exploited in the wild within
                                      the next 30 days

  CVE Risk Factors                    Attributes (such as Severity, Attack Vector,
                                      Attack Complexity, Exploit Exists) indicating the
                                      potential severity and likelihood of exploitation
                                      for a given CVE

  Status                              The current state of the issue (New, In Progress,
                                      Resolved)

  Backlog Status                      Indicates whether the issue is classified as
                                      pre-existing technical debt (Backlog) or a newly
                                      introduced vulnerability (New). For more
                                      information about Backlog Status, refer to
                                      [Backlog
                                      baseline](#UUID1f924d14a08800ecc94f508836894770)

  Automatic Fix Available             Whether automatic fixes are available to remediate
                                      the issue

  Manual Fix Available                Whether manual fixes are available to remediate
                                      the issue

  Asset Name                          Name of the asset affected by the issue

  Repository                          Name of the repository where the affected package
                                      is hosted

  Branch                              The specific branch or version of the code where
                                      the vulnerability was detected

  File Path                           Path to the file or location within the code where
                                      the vulnerability was detected

  Data Source                         The system or integration from which the data was
                                      originally pulled (such as GitHub, GitLab)

  Created                             Timestamp of when the issue was first detected.

  Assignee                            The individual responsible for addressing and
                                      resolving the issue
  --------------------------------------------------------------------------------------

####### Expanded CVE vulnerabilities issue information

When you click an issue in the table, a detailed side card opens,
providing a concise summary at the top. This summary includes the issue
name, severity level, ID, category (e.g., Configuration, Vulnerability,
Data), the detecting scanner type, and the age of the issue. The
**Overview** tab then provides in-depth information about the issue.

######## Overview

- **Timestamp**: When the issue was created and last updated

- **Status**: Displays the current state of the issue. Values: **New**,
  **In Progress**, **Resolved**. You can set the status as required

- **Assignee**: The entity assigned to mitigate the issue. You can
  assign the issue to a person responsible for resolving this issue

- **Description**: Provides details about the issue, including where it
  was detected and the specific CVE that the package is vulnerable to

- **Impact**: The impact that the issue could potentially have on your
  SDLC

- **Affected Asset**: The asset that the issue has impacted

- **Evidence**

  - **Issue Source**

    - **Data Source:** The system or integration from which the issue
      data was originally pulled (such as GitHub or a CI/CD pipeline).
      Click the icon next to the data source to navigate to the data
      source itself

    - **Category**: **Vulnerability** is the immutable value

    - **AppSec Policy**: The violated security standard that led to the
      creation of the issue. Includes a link to the policy

  - **Scanning Context**

    - **Scanner Type**: AppSec Vulnerability Scanner. The value is
      immutable

    - **Scanner Source**: Cortex AppSec. The value is immutable

    - **Language**: The programming language of the codebase where the
      vulnerability was detected

    - **Package Manager**: The package manager (such as PIP, npm, Maven)
      in which the vulnerability was detected

  - **Code Location**

    - **Repository Name**: The name of the version control repository
      where the issue was located

    - **Branch**: The specific branch within the repository containing
      the issue

    - **File Path**: The exact location of the issue within the
      repository file structure

    - **Code block**: The code lines including the resource in which the
      issue was detected

    - **Commit Hash**: The commit hash of the most recent commit that
      modified the code where the issue was detected

  - Vulnerability Details

    - **CVSS Score**: The Common Vulnerability Scoring System (CVSS)
      score, providing a standardized measure of the vulnerability\'s
      severity

    - **Fixed Version**: The version of the vulnerable component or
      dependency where the issue has been resolved

  - **Remediation**: Suggested steps to fix the issue

> **Note**
>
> Different issue types include different properties; therefore, not all
> properties are available for every issue.

######## Code to Cloud

The **Code to Cloud** tab provides a trace from the vulnerability issue
to its impact on your runtime environment, displaying a list of traced
runtime findings and traced runtime issues:

- The **Traced Runtime Issues** table includes these exposed properties

  - **Severity**: The level of risk associated with the issue.

  - **Issue Name**: The name of the specific issue detected.

  - **Assigned to**: Indicates the individual responsible for
    remediating the issue.

  - **Asset Name**: The name of the runtime asset where the issue was
    detected.

  - **Detection Method**: The method used to identify the issue, such as
    a specific scanner or security tool.

  - **Observation Time**: The time and date when the issue was first
    observed in the runtime environment.

- The **Traced Runtime Findings** table includes these exposed
  properties

  - **Finding Name**: The specific name of the finding detected on the
    asset.

  - **Asset Name**: The name of the runtime asset where the finding was
    detected.

  - **Detection Method**: The method used to identify the finding.

  - **Observation Time**: The time and date when the finding was first
    observed.

######## Actions

This tab includes suggested steps to fix the issue. When an automatic
fix is available, you can apply it directly by selecting Open Fix Pull
Request. Otherwise, manual steps are provided to guide you through
remediation.

######## War Room

The **War Room** provides an audit trail of all automatic or manual
actions taken on an issue, serving as a dedicated space to review and
interact with your issue. Each issue has a unique War Room. With machine
learning insights, the Cortex XSIAM Cloud platform suggests the most
effective analysts and command sets to help you address issues
efficiently.

####### CVE vulnerabilities findings

CVE vulnerabilities findings are specific, known security threats
identified in your assets based on the CVE system, providing insights
into potential risks.

The **Vulnerabilities** **Findings** table is a filtered instance of the
broader **All Findings** table found under **Cases & Issues**, meaning
it exclusively displays findings categorized as CVE vulnerabilities
findings. However, the **All Findings** table only displays findings
detected during periodic scans. In contrast, the comprehensive
**Findings** table includes all CVE vulnerabilities findings regardless
of their detection source, such as periodic, pull request (PR), and
continuous integration (CI) scans.

> **Note**
>
> Findings are informational and, as such, are not directly mitigable.
> Remediation is performed on issues derived from findings.

To access CVE findings, under **Modules**, select Application Security
\> Issues \> Vulnerabilities \> click the Findings tab.

The following table displays selected selected CVE vulnerabilities
findings inventory properties.

  -------------------------------------------------------------------------------------
  Field/attribute                     Description
  ----------------------------------- -------------------------------------------------
  CVSS Severity                       The Common Vulnerability Scoring System (CVSS)
                                      severity level assigned to the finding

  CVE                                 Common Vulnerabilities and Exposures identifier
                                      associated with the finding

  CVSS Score                          The Common Vulnerability Scoring System severity
                                      score representing the severity of the
                                      vulnerability

  EPSS Score                          Exploit Prediction Scoring System: The
                                      probability (0-1) that estimates the likelihood
                                      of the vulnerability being exploited in the wild
                                      within the next 30 days

  Name                                The CVE identifier

  Asset Name                          Name of the asset affected by the finding, such
                                      as application name, library name

  Risk Factors                        Quantifiable attributes of an issue (such as
                                      whether a fix is available, attack complexity,
                                      severity) allowing you to analyze and assess the
                                      risk

  Package Manager                     The package management system used (such as npm,
                                      Maven, pip)

  Dependency Type                     Type of dependency (direct, transitive)

  Repository                          Name of the repository where the affected package
                                      is hosted

  Branch                              The specific branch or version of the code where
                                      the vulnerability was detected

  File Path                           Path to the file or location within the code
                                      where the vulnerability was detected

  Data Source                         Source of the finding information (the version
                                      control system)

  Backlog Status                      **Backlog Status:** Indicates if the issue is
                                      categorized as **Backlog** (pre-existing
                                      technical debt) or **New** (a recently introduced
                                      vulnerability). To understand how issues are
                                      categorized as backlog/new, refer to
                                      [Issue/Finding classification by
                                      scanner](#UUIDb20d66eb5d51a4edd80d1d205cbbdab0)

  Created                             Timestamp of when the finding was first detected
  -------------------------------------------------------------------------------------

######## Expanded Findings details

Clicking on a finding in the inventory table opens the **Findings** side
card which provides additional details about the finding.

- **Finding summary**: Found at the top of the card. Includes the
  finding name, ID and type (**Vulnerability** for CVE vulnerability
  findings)

- **Description**: A description of the finding including its location

- **Timestamp**: When the finding was last updated

- **Asset details**: Includes **Asset** (The impacted asset. Clicking on
  the asset opens the asset side card without needing to navigate away
  to the asset section) and **Asset Type** (The specific asset type in
  which the CVE vulnerability was identified)

- **Evidence**: Provides evidence and contextual details within your
  SDLC containing the CVE vulnerability finding:

  - **Finding source**

    - **Data Source:** The system or integration from which the finding
      data was originally pulled (such as GitHub or a CI/CD pipeline).
      Click the icon next to the data source to navigate to the data
      source itself

    - **Run ID**: The unique identifier of the specific scan execution
      during which this finding was detected

  - **Code context**

    - **Repository:** The name of the version control repository where
      the finding was located

    - **Package Manager**: The dependency management system (such as
      npm, Maven) used to include or declare the software component
      where the finding was detected

    - **Branch:** The specific branch within the repository containing
      the finding

    - **File Path:** The exact location of the finding within the
      repository file structure

    - **First Hash:** The commit hash of the first commit where this
      specific finding was introduced or detected

    - **First Commit Date**: The date of the commit that introduced the
      problematic code or dependency into the repository. This helps
      understand how long an issue has existed and for prioritizing
      remediation efforts based on its age

  - **CVE Information**

    - **CVE ID**: A unique identifier assigned to publicly known
      cybersecurity vulnerabilities, allowing for standardized tracking
      and referencing.

    - **CVE Description**: A concise summary detailing the nature of the
      vulnerability, including its affected products, impacts, and
      potential exploitation methods.

    - **CVSS Severity**: A qualitative ranking (e.g., Low, Medium, High,
      Critical) derived from the CVSS score, indicating the overall
      severity of the vulnerability.

    - **CVSS Score**: A numerical score (0-10) representing the Common
      Vulnerability Scoring System assessment of the vulnerability\'s
      characteristics and severity.

    - **EPSS Score**: The Exploit Prediction Scoring System score, a
      probability (0-1) estimating the likelihood of a vulnerability
      being exploited in the wild within the next 30 days.

    - **Fix Version**: The specific software or component version in
      which the vulnerability has been patched or resolved by the
      vendor.

    - **Vendor Link**: A direct URL to the official advisory, patch, or
      documentation provided by the vendor regarding the vulnerability.

    - **Risk Factors**: Specific attributes or conditions that
      contribute to an issue\'s likelihood or the severity of its
      impact, such as a lack of validation, hardcoded secrets, or
      unpatched vulnerabilities.

####### Manage SCA CVE vulnerability issues

Right-click on a row in the inventory table to access the following
actions

- **Change Status**. Modify the status of the issue. Values: New, In
  Progress, Resolved

- **Change Severity**: Modify the severity level of the issue. Values:
  Critical, High, Medium, Low

- **Change Assignee**: Change the user or identity assigned to address
  the issue

- **Copy text to clipboard**: Duplicate selected text for easy pasting
  elsewhere

- **Copy entire row**: Duplicate the entire row of data for easy pasting
  elsewhere

- **Copy issue URL**: Duplicate the URL associated with the issue, to
  share or reference the issue

- S**how/hide rows with the \[severity level\]**: Show/hide rows
  matching the \[severity level\] of the selected row

###### License miscompliance issues

All license miscompliance findings detected in software packages within
an organization\'s environment are defined as issues, which represent
the smallest unit for remediating these violations. Manual fix
suggestions are provided to help resolve these issues.

The **Licenses** issues and findings tables are filtered views of the
main issues and findings tables under **Cases & Issues**, dedicated
solely to license issues and findings detected during periodic scans.

Open source software licenses define the terms under which open source
software can be used, modified, and distributed. Cortex XSIAM offers
three types of default license categories out of the box, providing
comprehensive coverage for managing license compliance within your
environment: Non Permissive Licenses, Strong Copyleft Licenses, and Weak
Copyleft Licenses. For more information refer to [Open-source software
license categories](#UUID995bbc594f13df09422778c41aca577a).

####### How to access license miscompliance issues

To access license miscompliance issues, under **Modules**, select
Application Security \> Issues \> Licenses.

> **Tip**
>
> You can also view license miscompliance issues in dedicated tabs under
> other sections when available:

- > In Application asset inventories: navigate to Inventory \> All
  > Assets \> Application \> select an option from the Application menu
  > \> select an item from the inventory \> Package Integrity

- > In **Asset** inventories, navigate to Inventory \> All Assets \>
  > Code:

  - > On the **Licenses** tab under **Repositories**. Refer to [In-depth
    > repository asset
    > information](#UUID929bbcfbc88cc71456d696269fe944cb) for more
    > information

  - > Under the **All Code** inventory: Select an asset from the table
    > \> Package Integrity

- > In **Cases and Issues**; perform a query. Select Issues \> AppSec
  > Issues (under the All Domains menu) \> CAS License Scanner (as the
  > Detection Method value)

####### License miscompliance issues inventory

This table includes selected fields of the license miscompliance issues
issues inventory.

  -----------------------------------------------------------------------
  Field/attribute                     Definition
  ----------------------------------- -----------------------------------
  Severity                            The severity level assigned to a
                                      detected license compliance issue
                                      (such as high, medium, low).

  Name                                The full name or text of the
                                      software license

  License                             The identifier or short name of the
                                      associated license (such as
                                      MPL-2.0).

  Asset Name                          The name of the asset such as
                                      application, service) that uses
                                      this license. Selecting the asset
                                      opens its side panel, allowing you
                                      to view asset details directly
                                      without leaving the issue

  Package Manager                     The package manager used to install
                                      or manage the software package
                                      including the license (such as,
                                      npm, pip, maven)

  License Category                    A categorization of the license
                                      based on its type (such as strong
                                      copyleft )

  Scan Source                         The type of scan that detected the
                                      issue, such as periodic or pull
                                      request

  Assignee                            The individual or team responsible
                                      for addressing the license
                                      compliance issue

  Created                             The date and time when the license
                                      compliance issue was first detected
                                      or recorded
  -----------------------------------------------------------------------

####### Expanded License miscompliance issues information

When you click an issue in the table, a detailed side card opens,
providing a concise summary at the top. This summary includes the issue
name, severity level, ID, category (e.g., Configuration, Vulnerability,
Data), the detecting scanner type, and the age of the issue. The
**Overview** tab then provides in-depth information about the issue.

The issue summary displayed at the top of the card provides concise
details including the package manager and the name and type of package
in which the license miscompliance issue was detected.

######## Overview

The **Overview** tab provides general details of the license
miscompliance:

- **Description**: Provides a summary of the license miscompliance

- **Impact**: The potential impact the license miscompliance issue could
  have on your SDLC

- **Status**: The status of the issue. Values: **New**, **In Progress**,
  **Resolved**. You can modify the status of the issue from the menu in
  the field

- **Assignee**: The entity assigned to resolve the issue. By default the
  value is **Unassigned**. Select an assignee from the menu in the field

- **Timestamps**: Provides the date the issue was created and last
  updated

- **Affected Assets**: Identifies the asset impacted by the issue.
  Selecting the asset opens its side panel, allowing you to view asset
  details directly without leaving the issue or navigating to the
  dedicated **Assets** section under **Inventory**

- **Linked Cases**: The cases that the issue is linked to, including the
  amount of cases, their description and severity. Selecting a case
  opens its side panel, allowing you to view case details directly
  without leaving the issue or navigating to the dedicated **Cases**
  section under **Cases & Issues**

- **Evidence**: Details and location in the codebase of the package
  containing the license miscompliance issue

  - **Issue source and classification**

    - **Scanner Type:** The type of security analysis tool that
      identified the license miscompliance (The default is
      **AppSec Package License Scanner**)

    - **Scanner Source:** The specific platform or vendor providing the
      scanner. **Cortex AppSec** is the default source

    - **AppSec Policy:** The Application Security policy that was
      triggered, leading to the creation of this issue. Select the icon
      next to the policy name to navigate to the policy on the
      **AppSec Policies** page

    - **Backlog Status:** Indicates if the issue is categorized as
      **Backlog** (pre-existing technical debt) or **New** (a recently
      introduced license miscompliance issue). To understand how issues
      are categorized  as backlog/new, refer to [Issue/Finding
      classification by scanner](#UUIDb20d66eb5d51a4edd80d1d205cbbdab0)

  - **Code context**

    - **Package Manager**: The system (such as npm, pip) managing
      application dependencies that contains the non-compliant license
      issue

    - **Repository Name:** The name of the version control repository
      where the license issue was found

    - **Branch:** The specific development branch within the repository
      containing the license issue

    - **File Path:** The exact location of the license issue within the
      repository\'s file structure

    - **Commit Hash:** The unique identifier of the code change (commit)
      that is associated with the license issue

  - **Metadata**

    - **Data Source:** The system or integration from which the issue
      was originally detected (such as GitHub or CI/CD pipeline). Select
      the icon next to the data source redirects to the data source

- **Remediation**: Suggested remediation steps to address the issue. See
  [Actions](#Xf14e67ac16f756bb54d4fc93d964d8127dfa64a) below for
  detailed information

######## Code to Cloud

The **Code to Cloud** tab provides a trace from the IaC misconfiguration
issue to its impact on your runtime environment, displaying a list of
traced runtime findings and traced runtime issues:

- The **Traced Runtime Issues** table includes these exposed properties

  - **Severity**: The level of risk associated with the issue.

  - **Issue Name**: The name of the specific issue detected.

  - **Assigned to**: Indicates the individual responsible for
    remediating the issue.

  - **Asset Name**: The name of the runtime asset where the issue was
    detected.

  - **Detection Method**: The method used to identify the issue, such as
    a specific scanner or security tool.

  - **Observation Time**: The time and date when the issue was first
    observed in the runtime environment.

- The **Traced Runtime Findings** table includes these exposed
  properties

  - **Finding Name**: The specific name of the finding detected on the
    asset.

  - **Asset Name**: The name of the runtime asset where the finding was
    detected.

  - **Detection Method**: The method used to identify the finding.

  - **Observation Time**: The time and date when the finding was first
    observed.

######## Actions

The **Actions** tab displays suggestions to fix the license
miscompliance, including contacting your legal team for further
investigation.

######## War Room

The **War Room** provides an audit trail of all automatic or manual
actions taken on an issue, serving as a dedicated space to review and
interact with your issue. Each issue has a unique War Room. With machine
learning insights, the Cortex XSIAM Cloud platform suggests the most
effective analysts and command sets to help you address issues
efficiently.

####### License miscompliance findings

License miscompliance findings are potential licensing vulnerabilities
in your open-source software packages. These findings allow you to
assess and analyze your package license compliance. Promoting these
findings to issues allows you to address license non-compliance. This
ensures compliance with licensing requirements and maintain the
integrity of your software supply chain.

The **Licenses** **Findings** table is a filtered instance of the
broader **Findings** table found under **Cases & Issues**, meaning it
exclusively displays findings categorized as license miscompliance
findings. However, the Licenses Findings table only displays findings
detected during periodic scans. In contrast, the comprehensive
**Findings** table includes all license miscompliance findings
regardless of their detection source, such as periodic, pull request
(PR), and continuous integration (CI) scans.

######## How to access license miscompliance findings

To access license miscompliance findings, under **Modules**, select
Application Security \> Issues \> Licenses \> click the Findings tab.

######## License miscompliance findings inventory

The license findings inventory includes the following properties.

  -------------------------------------------------------------------------------------
  Field/attribute                     Definition
  ----------------------------------- -------------------------------------------------
  Name                                The finding name including the category assigned,
                                      such as Weak copyleft

  License                             The specific license under which the software
                                      package is distributed (such as MIT, GPL, Apache
                                      2.0).

  Asset Name                          The name of the asset such as application,
                                      service) that uses this license

  Package Manager                     The package manager used to install or manage the
                                      software package including the license (such as,
                                      npm, pip, maven)

  Dependency Type                     Indicates whether the dependency is direct or
                                      transitive

  Repository                          The repository hosting the code in which the
                                      license miscompliance was detected

  Branch                              The branch containing the repository with the
                                      license miscompliance

  License Category                    A categorization of the license based on its type
                                      (such as strong copyleft )

  Data Source                         The version control system hosting the repository
                                      with the license miscompliance

  Created                             The date and time when the license compliance
                                      issue was first detected or recorded

  Finding ID                          The unique identifier assigned to the license
                                      finding

  Backlog Status                      **Backlog Status:** Indicates if the issue is
                                      categorized as **Backlog** (pre-existing
                                      technical debt) or **New** (a recently introduced
                                      vulnerability). To understand how issues are
                                      categorized as backlog/new, refer to
                                      [Issue/Finding classification by
                                      scanner](#UUIDb20d66eb5d51a4edd80d1d205cbbdab0)
  -------------------------------------------------------------------------------------

######## Expanded Findings details

Clicking on a finding in the inventory table opens the **Findings** side
card, which provides additional details about the finding.

- **Finding summary**: Found at the top of the card. Includes the
  finding name, ID and type (**Code** for license miscompliance
  findings)

- **Description**: A description of the finding including its location

- **Timestamp**: When the finding was last updated

- **Asset details**: Includes **Asset** (The impacted asset. Clicking on
  the asset opens the asset side card without needing to navigate away
  to the asset section) and **Asset Type** (The specific asset type in
  which the license miscompliance was identified)

- **Evidence**: Provides evidence and contextual details within your
  SDLC containing the license miscompliance finding:

  - **Finding source**

    - **Data Source:** The system or integration from which the finding
      data was originally pulled (such as GitHub or a CI/CD pipeline).
      Click the icon next to the data source to navigate to the data
      source itself

    - **Collaborator**: The individual or team responsible for
      contributing to the code or configuration where the finding was
      identified

  - **License information **

    - **License**. The license (MPL-2.0) including the miscompliance

    - **License Category**. The category assigned to the license. Refer
      to [Open-source software license
      categories](#UUID995bbc594f13df09422778c41aca577a) for more
      information about license categories

    - **OSI Approved**. Whether the license is OSI approved or not

  - **Code context**

    - **Repository:** The name of the version control repository where
      the finding was located

    - **Package Manager**: The tool (such as PIP) that manages the
      dependency in which the license miscompliance was detected

    - **Branch:** The specific branch within the repository containing
      the finding

    - **File Path:** The exact location of the finding within the
      repository file structure

    - **First Hash:** The commit hash of the first commit where this
      specific finding was introduced or detected

  - **Scan metadata**

    - **Run ID:** The unique identifier of the specific scan execution
      during which this finding was detected

####### Open-source software license categories

Open-source software licenses define the terms under which open-source
software can be used, modified, and distributed. In Application
Security, licenses are scanned as part of the SCA vulnerability scan for
open-source packages. All  Critical, High and Medium license
miscompliance detected in open-source software packages within an
organization\'s environment are defined as issues. This enables
structured vulnerability management and focused remediation. Where
applicable, manual and automated fixes are provided.

Application Security offers three types of default license categories
out of the box, providing comprehensive coverage for managing license
compliance within your environment:

- Non-Permissive Licenses  (High severity)

- Strong Copyleft Licenses  (High severity)

- Weak Copyleft Licenses  (Medium severity)

Within each license type, SPDX identifiers are organized and sorted
based on their characteristics and attributes. SPDX Identifiers are
unique codes assigned to software licenses by the Software Package Data
Exchange (SPDX) project. These identifiers are used to categorize and
accurately identify software packages distributed under various types of
licenses, including strong copyleft, weak copyleft, and non-permissive
licenses. By associating each software package with a specific SPDX
Identifier, it becomes easier to track and manage license compliance
across different licensing policies, ensuring that the correct license
type is identified and adhered to.

######## Non-permissive licenses

Non Permissive licenses policies identify software packages distributed
under non-permissive or restrictive licenses. These licenses restrict
how you can use, modify, and distribute the software. They may limit
your ability to integrate the software into certain projects or require
you to purchase a commercial license for specific uses.

######### Non-permissive SPDX identifiers

The following list displays supported SPDX identifiers for
non-permissive licenses.

- BUSL-1.1

- C-UDA-1.0

- CC-BY-NC-3.0-DE

- CC-BY-NC-ND-3.0-DE

- CC-BY-NC-ND-3.0-IGO

- CC-BY-NC-SA-2.0-DE

- CC-BY-NC-SA-2.0-FR

- CC-BY-NC-SA-2.0-UK

- CC-BY-NC-SA-3.0-DE

- CC-BY-NC-SA-3.0-IGO

- CC-BY-ND-3.0-DE

- Hippocratic-2.1

- JPL-image

- MS-LPL

- NCGL-UK-2.0

- PolyForm-Noncommercial-1.0.0

######## Strong copyleft licenses

Strong Copyleft licenses policies identify software packages distributed
under strong copyleft licenses, such as the GNU General Public License
(GPL). These licenses require derivative works to be distributed under
the same copyleft license terms as the original work. This ensures
broader access and modification rights.

######### Strong copyleft SDPX identifiers

The following list displays supported SPDX identifiers for strong
copyleft licenses.

- AGPL-1.0

- AGPL-1.0-only

- AGPL-1.0-or-later

- AGPL-2.0

- AGPL-3.0

- AGPL-3.0-only

- AGPL-3.0-or-later

- Arphic-1999

- CERN-OHL-S-2.0

- copyleft-next-0.3.0

- copyleft-next-0.3.1

- GPL-2.0

- GPL-3.0

- Linux-man-pages-copyleft

- OpenPBS-2.3

######## Weak copyleft licenses

Weak Copyleft Licenses policies identify software packages distributed
under weak copyleft licenses. These licenses permit combining code with
other licenses, including proprietary licenses, without mandating the
entire derivative work to be released under the same copyleft license.

######### Weak copyleft SPDX identifiers

The following list displays supported SPDX identifiers for weak copyleft
licenses.

- Artistic-1.0

- Artistic-2.0

- APSL

- CAL-1.0-Combined-Work-Exception

- CC-BY-SA-2.0-UK

- CC-BY-SA-2.1-JP

- CC-BY-SA-3.0-AT

- CC-BY-SA-3.0-DE

- CC-BY-SA-4.0

- CDDL-1.0

- CDLA-Sharing-1.0

- CERN-OHL-W-2.0

- CPOL-1.02

- EPL-1.0

- EPL-2.0

- eCos-2.0

- EUPL-3.0

- FDK-AAC

- LGPL-2.0

- LGPL-2.1

- LGPL-3.0

- MPL-1.1

- MPL-2.0

- MS-RL

- OSL-3.0

- QPL-1.0-INRIA-2004

- Sendmail-8.23

- SimPL-2.0

- TAPR-OHL-1.0

- TPL-1.0

####### Manage license miscompliance issues

Right-click on a row in the inventory table to access the following
actions

- **Change Status**. Modify the status of the issue. Values: New, In
  Progress, Resolved

- **Change Severity**: Modify the severity level of the issue. Values:
  Critical, High, Medium, Low

- **Change Assignee**: Change the user or identity assigned to address
  the issue

- **Copy text to clipboard**: Duplicate selected text for easy pasting
  elsewhere

- **Copy entire row**: Duplicate the entire row of data for easy pasting
  elsewhere

- **Copy issue URL**: Duplicate the URL associated with the issue, to
  share or reference the issue

- S**how/hide rows with the \[severity level\]**: Show/hide rows
  matching the \[severity level\] of the selected row

###### Package Integrity

**Package Integrity** (also referred to as **Package Operational Risk**)
assesses the operational risk and potential impact of each package in
your codebase by examining package maintainer and popularity factors,
and other relevant metrics. This analysis results in open-source package
operational risk severity levels being categorized into High, Medium and
Low. By prioritizing risks based on these categories, you can
effectively focus remediation efforts on the most critical issues.

The **Package Integrity** issues and findings tables are filtered views
of the main issues and findings tables under **Cases & Issues**,
dedicated solely to issues and findings categorized as package
operational risks and detected during periodic scans.

The following table defines the operational risk metrics used to assess
open-source packages.

  -----------------------------------------------------------------------
  Metric                              Property
  ----------------------------------- -----------------------------------
  Maintainer                          Level: Indicates the level of
                                      maintenance based on various
                                      computed factors

  ---                                 Versions

  ---                                 Last release

  ---                                 Last commit

  ---                                 Created

  ---                                 Open issues

  ---                                 Open pull requests

  Popularity                          Level: Indicates the level of
                                      popularity based on various
                                      computed factors

  ---                                 Weekly downloads

  ---                                 Number of stars

  ---                                 Number of forks

  ---                                 Contributors
  -----------------------------------------------------------------------

####### Limitation

Package Operational Risk relies on metadata from the package's
associated GitHub repository (such as activity, popularity, deprecation
status). If the package manager entry does not include a valid GitHub
repository URL, operational risk data may be unavailable for that
package. 

####### Package Operational Risk policy enforcement

You can create policies to automatically detect and prevent the
introduction of operational risks. These policies ensure that all
third-party dependencies align with your organization\'s security
standards and risk tolerance, helping you maintain a secure software
supply chain. For more information about creating policies, refer to
[Create Application Security
policies](#UUIDb040a2f4a6d104a6f1e043379392c825).

####### Package Integrity inventory

The following table describes selected fields in the Package Integrity
issues inventory table.

  --------------------------------------------------------------------------------------
  Property                            Description
  ----------------------------------- --------------------------------------------------
  Severity                            Severity level of the package integrity issue
                                      (such as Critical, High, Medium, Low)

  Name                                Name of the package integrity issue

  Asset Name                          Name of the asset affected by the package
                                      integrity issue

  Package Manager                     The package management system used (such as npm,
                                      Maven, pip), in which the package with the issue
                                      was detected

  Repository                          Name of the repository where the package was
                                      obtained

  Branch                              The specific branch of the code where the package
                                      was used

  File Path                           The exact path to the file within the
                                      repository\'s structure where the issue is located

  Data Source                         The sources from which the issue was generated or
                                      collected

  Dependency Type                     Type of dependency (direct, transitive)

  Created                             Timestamp of when the package integrity issue was
                                      first detected

  Status                              The current state of the issue (New, In Progress,
                                      Resolved)

  Backlog Status                      Indicates whether the issue is classified as
                                      pre-existing technical debt (Backlog) or a newly
                                      introduced risk (New). For more on Backlog status,
                                      refer to [Backlog
                                      baseline](#UUID1f924d14a08800ecc94f508836894770)

  Assignee                            The individual or identity responsible for
                                      addressing the package integrity issue
  --------------------------------------------------------------------------------------

Click on an issue in the table to open a detailed side-card, which
provides additional, more in-depth information about the issue. A
concise summary of the issue is displayed at the top of the page. The
information is organized into tabs, including an **Overview** tab
(default display) which provides highlights and a general summary, while
contextual tabs focus on particular details of the issue.

Issue summary

The issue summary, displayed at the top of the card, provides concise
details about the issue, including its name, severity, type (such as
configuration or data), the number of days the issue has been open, and
the type of scanner that detected the issue (such as IaC scanner).

> **Note**
>
> You can modify the severity level from the severity field menu.

######## Overview

The **Overview** tab provides general details of the package integrity
issue:

- **Description**: Provides a summary of the issue

- **Impact**: The potential impact the issue could have on your SDLC

- **Status**: The status of the issue. Values: **New**, **In Progress**,
  **Resolved**. You can modify the status of the issue from the menu in
  the field

- **Assignee**: The entity assigned to resolve the issue. By default the
  value is **Unassigned**. Select an assignee from the menu in the field

- **Timestamps**: Provides the date the issue was created and last
  updated

- **Affected Assets**: Identifies the asset impacted by the issue.
  Selecting the asset opens its side panel, allowing you to view asset
  details directly without leaving the issue or navigating to the
  dedicated **Assets** section under **Inventory**

- **Linked Cases**: The cases that the issue is linked to, including the
  amount of cases, their description and severity. Selecting a case
  opens its side panel, allowing you to view case details directly
  without leaving the issue or navigating to the dedicated **Cases**
  section under **Cases & Issues**

- **AppSec Policy**: The policy (with its defined rules and conditions)
  that was triggered, leading to the creation of this issue. Includes a
  link to the policy in the general Application Security policy
  inventory

- **Evidence**: Details and location in the codebase of the package
  containing the package operational risk issue

  - **Issue source and classification**

    - **Scanner Type:** The type of security analysis tool that
      identified the package integrity issue

    - **Scanner Source:** The specific platform or vendor providing the
      scanner. Cortex AppSec is the default source. This field is not
      selectable

    - **Package Manager:** The software package management system used
      (such as npm, pip, Maven, NuGet)

    - **Package Registry URL:** The URL of the repository or registry
      from which the package was sourced. Select the icon next to the
      policy name to navigate to the package registry

    - **Backlog Status**: Indicates if the finding is categorized as
      **Backlog** (pre-existing technical debt) or **New** (a recently
      introduced package integrity issue)

    - **AppSec Policy:** The Application Security policy that was
      triggered, leading to the creation of this issue. Select the icon
      next to the policy name to navigate to the policy in the the
      **AppSec Policies** page. To understand how issues are categorized
       as backlog/new, refer to [Issue/Finding classification by
      scanner](#UUIDb20d66eb5d51a4edd80d1d205cbbdab0)

  - **Code context**

    - **Branch:** The specific development branch within the repository
      containing the package integrity issue

    - **File Path:** The exact location of the relevant file (such as
      package.json, pom.xml) within the repository\'s file structure

    - **Commit Hash:** The unique identifier of the code change (commit)
      that is associated with the package integrity issue

    - **Collaborator:** The user that authored the relevant code commit

    - **Commit Time:** The date and time when the associated code commit
      was made

  - **Metadata**

    - **Data Source:** The system or integration from which the finding
      data was originally pulled (such as GitHub or a CI/CD pipeline).
      Select the icon next to navigate to the data source

    - **Risk Factors:** Specific attributes or conditions that
      contribute to the severity or exploitability of the package
      integrity issue

- **Remediation**: Suggested manual remediation steps to address the
  operational risk. See
  [Actions](#Xcf37b1291330f1ea9d26642816d8990293a3b04) for more detailed
  information

######## Actions

The **Actions** tab provides suggested steps to address package
operational risk issues.

####### Expanded Package Inventory issue information

When you click an issue in the table, a detailed side card opens,
providing a concise summary at the top. This summary includes the issue
name, severity level, ID, category (e.g., Configuration, Vulnerability,
Data), the detecting scanner type, and the age of the issue. The
**Overview** tab then provides in-depth information about the issue.

######## Overview

- **Timestamp**: When the issue was created and last updated

- **Status**: The issue status. Values: **New**, **In Progress**,
  **Resolved**. You can set the status as required

- **Assignee**: The entity assigned to mitigate the issue. You can
  assign the issue

- **Description**: Provides details about the package integrity issue,
  including the location where the package was detected (such as
  specific repository, file path, and line number) and the operational
  risks identified

- **Impact**: The impact that the issue could potentially have on your
  SDLC

- **Asset details**: Includes **Asset** (The impacted asset. Clicking on
  the asset opens the asset side card without needing to navigate away
  to the asset section) and **Asset Type** (The specific asset type in
  which the IaC resource was identified)

- **Evidence**: Provides evidence and contextual details within your
  SDLC containing the package operational risk:

  - **Issue source**

    - **Data Source:** The system or integration from which the issue
      data was originally pulled (such as GitHub or a CI/CD pipeline).
      Click the icon next to the data source to navigate to the data
      source itself

    - **Category**: **Package Operational Risk** is the immutable value

    - **AppSec Policy**: The violated security standard that led to the
      creation of the issue. Includes a link to the policy

  - **Scanning context**

    - **Scanner Type**: Code. The value is immutable

    - **Scanner Source**: Cortex AppSec. The value is immutable

    - **Package Manager**: The package manager (such as PIP, npm, Maven)
      in which the vulnerability was detected

    - **Package Registry URL**: The URL of the package registry (e.g.,
      npm, PyPI, Maven Central) from which the vulnerable package was
      obtained

  - **Code location**

    - **Repository Name**: The name of the version control repository
      where the issue was located

    - **Branch**: The specific branch within the repository containing
      the issue

    - **File Path**: The exact location of the issue within the
      repository file structure

    - **Commit Hash**: The commit hash of the most recent commit that
      modified the code where the issue was detected

    - **Commit Time**: The timestamp of the most recent commit that
      modified the code where the issue was detected

  - **Risk analysis**

    - **Risk Factors**: Specific attributes or conditions that
      contribute to an issue\'s likelihood or the severity of its impact

- **Remediation**: Suggested mitigation for the package operational
  risk.

> **Note**
>
> Different issue types include different properties; therefore, not all
> properties are available for every issue.

######## Actions

This tab includes suggested steps to fix the issue. No automatic fixes
are available for Package Operational Risks.

######## War Room

The **War Room** provides an audit trail of all automatic or manual
actions taken on an issue, serving as a dedicated space to review and
interact with your issue. Each issue has a unique War Room. With machine
learning insights, the Cortex XSIAM Cloud platform suggests the most
effective analysts and command sets to help you address issues
efficiently.

####### Package Integrity findings

Package Integrity scans produce findings, which are potential package
operational risks within your software packages. These insights help
assess and analyze the security posture of your software supply chain.

The **Package Integrity** **Findings** table is a filtered instance of
the broader **Findings** table found under **Cases & Issues**, meaning
it exclusively displays findings categorized as **Package Integrity**
findings.

> **Note**
>
> Findings cannot be mitigated. They must be promoted to issues to
> enable remediation efforts to secure your software packages.

To access package integrity findings, navigate to Package Integrity
issues (see
[/document/preview/1143473#UUID-5fc2ec31-3a01-432b-0341-c52144dbb6ee](/document/preview/1143473#UUID-5fc2ec31-3a01-432b-0341-c52144dbb6ee)),
and click the **Findings** tab.

The following table describes selected fields in the
**Package Integrity Findings** inventory table.

  --------------------------------------------------------------------------------------
  Property                            Description
  ----------------------------------- --------------------------------------------------
  Name                                The name of the package operational risk

  Asset Name                          The asset in which the finding was detected

  Finding ID                          A unique identifier assigned to the finding

  Data Source                         The version control system hosting the repository
                                      which includes the package in which the finding
                                      was detected

  Package Manager                     The package manager hosting the package in which
                                      the finding was detected

  Repository                          The repository hosting the package in which the
                                      finding was detected

  Branch                              The branch in which the finding was detected

  File Path                           The exact path to the file within the
                                      repository\'s structure where the issue is located

  Dependency Type                     Whether the package is direct or transitive

  Created                             When the finding was first detected

  Backlog Status                      Indicates whether the issue is classified as
                                      pre-existing technical debt (Backlog) or a newly
                                      introduced misconfiguration (New). For more on
                                      Backlog status, refer to [Backlog
                                      baseline](#UUID1f924d14a08800ecc94f508836894770)
  --------------------------------------------------------------------------------------

######## Expanded Findings details

Click on a finding in the inventory table to open the **Findings** side
card, which provides additional details about the finding.

- **Summary**: A summary of the finding at the top of the card including
  name, id and the type of scanner (**Code** is the immutable value for
  Package Integrity issues) that detected the finding

- **Description**: Provides a summary of the finding

- **Impact**: The potential impact the issue could have on your SDLC

- **Timestamps**: Provides the date the issue was last updated

- **Affected Assets**: Identifies the asset impacted by the finding.
  Selecting the asset opens its side panel, allowing you to view asset
  details directly without leaving the finding or navigating to the
  dedicated **Assets** section under **Inventory**

- **Evidence**: Details and location in the codebase of the package
  containing the package operational risk finding:

  - **Issue source and classification**

    - **Package Manager:** The dependency management system (such as
      npm, Maven) used to include or declare the software component
      where the finding was detected

    - **Dependency Type**: Indicates whether the vulnerability
      originates from a direct dependency (explicitly declared in your
      project) or an indirect/transitive dependency (pulled in by one of
      your direct dependencies)

    - **Data Source:** The system or integration from which the finding
      data was originally pulled (such as GitHub or a CI/CD pipeline).
      Select the icon next to navigate to the data source

  - **Code context**

    - **Repository**: The name of the version control repository where
      the finding was located

    - **Branch:** The specific development branch within the repository
      containing the package integrity finding

    - **First Hash:** The commit hash of the earliest code change where
      this finding was identified

    - **First Commit Date:** The date of the commit that introduced the
      problematic code or dependency into the repository. This helps
      understand how long an issue has existed and for prioritizing
      remediation efforts based on its age

    - **Collaborator:** The user that authored the relevant code commit

  - **Code**: The file and code including the license miscompliance in
    which the finding was detected

  - **Scan Metadata**

    - **Run ID:** The unique identifier of the specific scan execution
      during which this finding was detected

####### Manage Package Integrity issues

Right-click on a row in the inventory table to access the following
actions

- **Change Status**. Modify the status of the issue. Values: New, In
  Progress, Resolved

- **Change Severity**: Modify the severity level of the issue. Values:
  Critical, High, Medium, Low

- **Change Assignee**: Change the user or identity assigned to address
  the issue

- **Copy text to clipboard**: Duplicate selected text for easy pasting
  elsewhere

- **Copy entire row**: Duplicate the entire row of data for easy pasting
  elsewhere

- **Copy issue URL**: Duplicate the URL associated with the issue, to
  share or reference the issue

- S**how/hide rows with the \[severity level\]**: Show/hide rows
  matching the \[severity level\] of the selected row

##### Secrets scanners

Application Security Secrets scans identify sensitive data embedded in
your codebase. This proactive scanning approach ensures that sensitive
information is detected and addressed early in the Software Development
Lifecycle, significantly reducing the risk of such issues reaching
production environments.

**Secrets use cases**

- **Detect exposed sensitive data**: Identify hardcoded credentials, API
  keys, passwords, tokens, encryption keys, certificates, and
  pass-phrases found directly within your source code or configuration
  files

- **Prevent unauthorized access and data breaches**: By enabling the
  early identification of these exposures, secrets scans help prevent
  unauthorized access and potential data breaches that could compromise
  your infrastructure and applications

**Supported file types**: Application Security scans any plaintext files
that are not encrypted, not compressed (for example, not .zip files) and
not compiled (for example, not .jar files), for secrets. Additionally,
entropy findings look for keywords to lower the noise, and those
keywords must be in line with the high entropy string to be flagged.

**Entropy Analysis**: Application Security provides signatures that
analyze the randomness of strings within the file. Highly random
strings, often referred to as high entropy, can be indicative of a
potential secret. To reduce false positives, Application Security
considers specific keywords that might be associated with secrets
alongside the randomness of the data for better accuracy.

You can create policies to automatically detect and prevent the
introduction of vulnerable open-source components into your codebase.
These policies ensure that all third-party dependencies align with your
organization\'s security standards and risk tolerance, helping you
maintain a secure software supply chain. For more information about
creating secrets policies, refer to [Create Application Security
policies](#UUIDb040a2f4a6d104a6f1e043379392c825).

###### Secrets issues

Valid secrets exposed during scans, and classified as Critical or High
by Application Security policies, are categorized as issues, which
represent the smallest unit for remediating these exposed Secrets. To
address the most critical exposures, you can further prioritize these
secret issues based on their urgency level. Manual fix suggestions are
provided to resolve these issues.

The **Secrets** issues and filters tables are filtered views of the main
Issues and Findings tables under **Cases & Issues**, dedicated solely to
exposed secrets issues and findings detected by periodic Secrets scans.

####### How to access Secrets issues

Under **Modules**, select Application Security \> Issues \> Secrets.

> **Tip**
>
> You can also view **Secrets** issues in dedicated tabs under other
> sections when available:

- > In **Code** asset inventories: navigate to Inventory \> All Assets
  > \> Code:

  - > On the **Secrets** tab under **Repositories**. Refer to [In-depth
    > repository asset
    > information](#UUID929bbcfbc88cc71456d696269fe944cb)for more
    > information

  - > Under the **All Code** inventory: Select an asset from the table
    > \> Secrets

- > In **Application** asset inventories: navigate to Inventory \> All
  > Assets \> Application \> select an option from the Application menu
  > \> select an item from the inventory \> Secrets

- > In **Cases and Issues**; perform a query. Select Issues \> AppSec
  > Issues (under the All Domains menu) \> Secrets (as the Detection
  > Method value)

###### Secrets issues inventory

The Secrets issues inventory includes the following properties.

  --------------------------------------------------------------------------------------
  Property                            Description
  ----------------------------------- --------------------------------------------------
  Severity                            Severity level of the secret exposure (such as
                                      Critical, High, Medium, Low)

  Name                                Name or description of the secret exposure type

  Asset Name                          Name of the resource or asset where the secret was
                                      exposed

  Organization                        The organization within the VCS in which the issue
                                      was detected

  Branch                              The specific branch or version of the code where
                                      the secret exposure was detected

  Repository                          The version control repository where secret
                                      resides

  File Path                           Path to the file or location within the code where
                                      the secret was exposed

  Data Source                         The system or integration from which the issue
                                      data was originally pulled (such as GitHub,
                                      GitLab)

  Risk Factors                        Specific conditions that increase the exposure or
                                      exploitability of a secret, such as a lack of
                                      validation or hardcoding in source code

  Status                              The current state of the issue (New, In Progress,
                                      Resolved)

  Backlog Status                      Indicates whether the issue is classified as
                                      pre-existing technical debt (Backlog) or a newly
                                      introduced vulnerability (New). For more on
                                      Backlog status, refer to [Backlog
                                      baseline](#UUID1f924d14a08800ecc94f508836894770)

  Assignee                            The individual responsible for addressing and
                                      resolving the issue

  Created                             Timestamp of when the secret exposure was first
                                      detected
  --------------------------------------------------------------------------------------

####### Secret validation options

You can filter secrets based on their validation status. Options
include:

- Valid: The secret has been verified as active and functional

- Invalid: The secret has been verified as no longer active or
  functional

- Privileged: The secret is valid and provides access to sensitive
  resources or functions

- Irrelevant: The secret is not considered a security risk in its
  current context

###### Expanded Secrets issue information

When you click an issue in the table, a detailed side card opens,
providing a concise summary at the top. This summary includes the issue
name, severity level, ID, category (e.g., Configuration, Vulnerability,
Data), the detecting scanner type, and the age of the issue. The
**Overview** tab then provides in-depth information about the issue.

####### Overview

- **Timestamp**: When the issue was created and last updated

- **Status**: The issue status. Values: **New**, **In Progress**,
  **Resolved**. You can set the status as required

- **Assignee**: The entity assigned to mitigate the issue. You can
  assign the issue from the menu in the field

- **Description**: A description of the issue

- **Impact**: The impact that the issue could potentially have on your
  SDLC

- **Asset details**: Includes **Asset** (The impacted asset. Clicking on
  the asset opens the asset side card without needing to navigate away
  to the asset section) and **Asset Type** (The specific asset type in
  which the IaC resource was identified)

- **Evidence**: Provides evidence and contextual details within your
  SDLC containing the IaC misconfiguration issue:

  - **Issue source**

    - **Data Source:** The system or integration from which the issue
      data was originally pulled (such as GitHub or a CI/CD pipeline).
      Click the icon next to the data source to navigate to the data
      source itself

    - **Category**: **Configuration** is the immutable value

    - **AppSec Rule**: The security rule that detected this issue.
      Includes a link to the rule

    - **AppSec Policy**. The violated security standard that lead to the
      creation of the issue. Includes a link to the policy

    - **Collaborator**: The individual or team responsible for
      contributing to the code or configuration where the issue was
      identified

  - **Code context**

    - **Scanner Type**: **AppSec IaC Scanner** is the immutable value

    - **Scanner Source**: **Cortex AppSec** is the immutable value

    - **Repository Name:** The name of the version control repository
      where the issue was located

    - **Branch:** The specific branch within the repository containing
      the issue

    - **Framework**: The infrastructure as code (IaC) framework used
      (such as CloudFormation, Terraform)

    - **File Path:** The exact location of the issue within the
      repository file structure

    - **First Hash:** The commit hash of the first commit where this
      specific issue was introduced or detected

    - **Commit Hash**: The commit hash of the most recent commit that
      modified the code where the issue was detected

    - **Commit Time**: The timestamp of the most recent commit that
      modified the code where the issue was detected

  - **Classification**

    - **Backlog Status:** Indicates if the issue is categorized as
      **Backlog** (pre-existing technical debt) or **New** (a recently
      introduced vulnerability). To understand how issues are
      categorized as backlog/new, refer to [Issue/Finding classification
      by scanner](#UUIDb20d66eb5d51a4edd80d1d205cbbdab0)

- **Code**: The file and code including the exposed secret

> **Note**
>
> Different issue types include different properties; therefore, not all
> properties are available for every issue.

####### Actions

Suggested steps to mitigate the issue. Automated fixes are not available
for secrets.

####### War Room

The **War Room** provides an audit trail of all automatic or manual
actions taken on an issue, serving as a dedicated space to review and
interact with your issue. Each issue has a unique War Room. With machine
learning insights, the Cortex XSIAM Cloud platform suggests the most
effective analysts and command sets to help you address issues
efficiently.

###### Secrets findings

Secrets findings uncover sensitive information, like credentials or API
keys, that may be exposed within your assets. These insights help assess
and analyze the potential exposure of secrets in your environment.

The **Secrets** **Findings** table is a filtered instance of the broader
**Findings** table found under **Cases & Issues**, meaning it
exclusively displays findings categorized as exposed secrets findings.

> **Note**
>
> Findings are informational and, as such, are not directly mitigable.
> Remediation is performed on issues derived from findings.

To access Secrets findings, select Application Security \> Issues \>
Secrets \> click the Findings tab.

####### Findings inventory

The **Findings** inventory includes the following exposed properties.

  -------------------------------------------------------------------------------------
  Property                            Description
  ----------------------------------- -------------------------------------------------
  Name                                The name or title of the finding.

  Asset Name                          The name of the asset or resource associated with
                                      the finding

  Risk Factors                        Secret validation status such as Valid, Invalid,
                                      No Validation

  Data Source                         The sources from which the finding was generated
                                      or collected

  Branch                              The branch of code or version control branch
                                      where the finding was detected

  File Path                           The file path or location within the repository
                                      where the finding is located

  Risk Factors                        The specific conditions that contribute to a
                                      finding\'s likelihood, such as a lack of
                                      validation or hardcoded secrets

  Backlog Status                      **Backlog Status:** Indicates if the issue is
                                      categorized as **Backlog** (pre-existing
                                      technical debt) or **New** (a recently introduced
                                      vulnerability). To understand how issues are
                                      categorized as backlog/new, refer to
                                      [Issue/Finding classification by
                                      scanner](#UUIDb20d66eb5d51a4edd80d1d205cbbdab0)
  -------------------------------------------------------------------------------------

######## Expanded Findings details

Clicking on a finding in the inventory table opens the **Findings** side
card which provides additional details about the finding.

- **Finding summary**: Found at the top of the card. Includes the
  finding name, ID and type (**Data** for Secrets findings)

- **Description**: A description of the finding including its location

- **Timestamp**: When the finding was last updated

- **Asset details**: Includes **Asset** (The impacted asset. Clicking on
  the asset opens the asset side card without needing to navigate away
  to the asset section) and **Asset Type** (The specific asset type in
  which the secrets was identified)

- **Evidence**: Provides evidence and contextual details within your
  SDLC containing the finding:

  - **Finding source**

    - **Data Source:** The system or integration from which the finding
      data was originally pulled (such as GitHub or a CI/CD pipeline).
      Click the icon next to the data source to navigate to the data
      source itself

  - **Code context**

    - **Branch:** The specific branch within the repository containing
      the finding

    - **File Path:** The exact location of the finding within the
      repository file structure

    - **First Hash:** The commit hash of the first commit where this
      specific finding was introduced or detected

    - **First Commit Date**: The date of the commit that introduced the
      problematic code or dependency into the repository. This helps
      understand how long an issue has existed and for prioritizing
      remediation efforts based on its age

  - **Scan metadata**

    - **Run ID:** The unique identifier of the specific scan execution
      during which this finding was detected

    - **Rule ID**: The ID of the rule that triggered the finding

    - **Prioritization Labels**: Labels assigned to a finding (such as
      no validation), which allow you to prioritize findings for further
      analysis or mitigation

###### Manage Secrets issues

You can take the following actions to address and manage Secrets
exposure issues:

Right-click on a row in the inventory table to access the following
actions

- **Change Status**. Modify the status of the issue. Values: New, In
  Progress, Resolved

- **Change Severity**: Modify the severity level of the issue. Values:
  Critical, High, Medium, Low

- **Change Assignee**: Change the user or identity assigned to address
  the issue

- **Copy text to clipboard**: Duplicate selected text for easy pasting
  elsewhere

- **Copy entire row**: Duplicate the entire row of data for easy pasting
  elsewhere

- **Copy issue URL**: Duplicate the URL associated with the issue, to
  share or reference the issue

- S**how/hide rows with the \[severity level\]**: Show/hide rows
  matching the \[severity level\] of the selected row

##### Infrastructure as Code (IaC) scanners

IaC scanners safeguard your cloud infrastructure by identifying security
risks in your infrastructure configurations before they are deployed.

By analyzing your infrastructure configuration files prior to
deployment, IaC scanners help prevent the introduction of
vulnerabilities into your operational environments.

###### IaC use cases

- **Proactive detection**: IaC scans identify and flag critical issues
  such as misconfigurations, insecure defaults, and compliance
  violations directly within your IaC templates. This includes detecting
  potential risks in files for various frameworks (see [Supported
  frameworks and languages](#UUID257cfa48c8dc73c385b6c2d00a82956c) for
  supported frameworks)

- **Issue remediation**: All Critical and High IaC misconfiguration
  findings are categorized as actionable issues. The platform provides
  both manual and automated fixes to resolve these issues, streamlining
  remediation efforts. Automated fixes for IaC misconfigurations can
  modify the configuration directly

- **Integration and developer efficiency**: IaC scanning integrates
  seamlessly into development workflows. Findings can be detected
  locally using the Cortex CLI or directly within supported
  [IDEs](#UUID85da3f598a259e11b5b1d3f093a190d9) (Visual Studio Code,
  JetBrains) via plugins, providing real-time security feedback to
  developers as they write code. This helps developers fix problems
  early, reducing rework and accelerating secure development

- **Policy enforcement**: You can create and apply custom policies and
  rules that define how the system responds to IaC threats, allowing for
  tailored security checks and automated actions such as blocking CI
  runs or pull requests based on detected misconfigurations

###### Supported frameworks and languages

Application Security supports the following infrastructure-as-code (IaC)
frameworks.

  ----------------------- ----------------------- -----------------------
  Ansible                 Dockerfile              OpenAI

  ARM                     Helm                    OpenTofu

  Bicep                   Kubernetes              Terraform

  CloudFormation          Kustomize               Terraform Plan
  ----------------------- ----------------------- -----------------------

###### IaC misconfiguration issues

All Critical and High IaC misconfiguration findings detected in an
organization\'s environment are categorized as issues, which represent
the smallest unit for remediating IaC resource misconfigurations. Where
applicable, both manual and automated fixes are provided to resolve
these issues.

The **IaC Misconfigurations** issues and findings tables are a filtered
view of the main Issues table under **Cases & Issues**, dedicated solely
to IaC misconfigurations issues and findings detected by periodic scans.

####### How to access IaC misconfiguration issues

To access IaC misconfiguration issues, under **Modules**, select
Application Security \> Issues \> IaC misconfiguration.

> **Tip**
>
> You can also view IaC misconfiguration issues in dedicated tabs under
> other sections when available:

- > In code **Asset** inventories, navigate to Inventory \> All Assets
  > \> Code:

  - > On the **Configuration** tab under *Repository assets*. Refer to
    > [In-depth repository asset
    > information](#UUID929bbcfbc88cc71456d696269fe944cb) for more
    > information

  - > Under the **All Code** asset inventory: Select an asset from the
    > table \> click the Configuration tab

- > In **Application** asset inventories, when an application includes
  > an IaC asset that includes a detected misconfiguration: navigate to
  > Inventory \> All Assets \> Applications \> select an option from the
  > Applications menu \> select an application from the inventory \>
  > Configurations

- > Under **Cases and Issues**; perform a query. Select Issues \> AppSec
  > Issues (under the All Domains menu) \> IaC Scanner (as the Detection
  > Method value)

###### IaC misconfiguration issues inventory

The IaC misconfiguration issues inventory includes the following
properties. Use the menu to view additional fields.

  --------------------------------------------------------------------------------------
  Property                            Description
  ----------------------------------- --------------------------------------------------
  Severity                            The level of risk or impact associated with the
                                      finding, typically categorized (such as Critical,
                                      High, Medium, Low).

  Name                                The specific name or title of the finding, clearly
                                      identifying the detected issue

  Asset Name                          The name of the asset (such as a repository) where
                                      the issue was identified

  Framework                           The Infrastructure as Code (IaC) framework or
                                      language used for the asset (such as
                                      CloudFormation, Terraform, Azure Resource Manager,
                                      Kubernetes)

  Repository                          The version control repository where the
                                      problematic code or configuration resides

  Data Source                         The system or integration from which the data was
                                      originally pulled (such as GitHub, GitLab)

  Branch                              The specific branch within the repository where
                                      the issue was detected

  File Path                           The exact path to the file within the
                                      repository\'s structure where the issue is located

  Status                              The current state of the issue (New, In Progress,
                                      Resolved)

  Assignee                            The individual responsible for addressing and
                                      resolving the issue

  Backlog Status                      Indicates whether the issue is classified as
                                      pre-existing technical debt (Backlog) or a newly
                                      introduced misconfiguration (New). For more on
                                      Backlog status, refer to [Backlog
                                      baseline](#UUID1f924d14a08800ecc94f508836894770)
  --------------------------------------------------------------------------------------

###### Expanded IaC misconfiguration issue information

When you click an issue in the table, a detailed side card opens,
providing a concise summary at the top. This summary includes the issue
name, severity level, ID, category (e.g., Configuration, Vulnerability,
Data), the detecting scanner type, and the age of the issue. The
**Overview** tab then provides in-depth information about the issue.

####### Overview

- **Timestamp**: When the issue was created and last updated

- **Status**: Displays the current state of the issue. Values: **New**,
  **In Progress**, **Resolved**. You can set the status as required

- **Assignee**: The entity assigned to mitigate the issue. You can
  assign the issue to a person responsible for resolving this issue

- **Description**: A description of the issue

- **Impact**: The impact that the issue could potentially have on your
  SDLC

- **Asset details**: Includes **Asset** (The impacted asset. Clicking on
  the asset opens the asset side card without needing to navigate away
  to the asset section) and **Asset Type** (The specific asset type in
  which the IaC resource was identified)

- **Evidence**: Provides evidence and contextual details within your
  SDLC containing the IaC misconfiguration issue:

  - **Issue source**

    - **Data Source:** The system or integration from which the issue
      data was originally pulled (such as GitHub or a CI/CD pipeline).
      Click the icon next to the data source to navigate to the data
      source itself

    - **Category**: **Configuration** is the immutable value

    - **AppSec Rule**: The security rule that detected this issue.
      Includes a link to the rule

    - **AppSec Policy**: The violated security standard that led to the
      detection and creation of the issue

    - **Collaborator**: The individual or team responsible for
      contributing to the code or configuration where the issue was
      identified

  - **Code context**

    - **Scanner Type**: **AppSec IaC Scanner** is the immutable value

    - **Scanner Source**: **Cortex AppSec** is the immutable value

    - **Repository Name:** The name of the version control repository
      where the issue was located

    - **Branch:** The specific branch within the repository containing
      the issue

    - **Framework**: The infrastructure as code (IaC) framework used
      (such as CloudFormation, Terraform)

    - **File Path:** The exact location of the issue within the
      repository file structure

    - **Resource code block**: The specific section of code that hosts
      the IaC resource where the misconfiguration finding was detected

    - **First Hash:** The commit hash of the first commit where this
      specific issue was introduced or detected

    - **Commit Hash**: The commit hash of the most recent commit that
      modified the code where the issue was detected

    - **Commit Time**: The timestamp of the most recent commit that
      modified the code where the issue was detected

  - **Scan metadata**

    - **Run ID:** The unique identifier of the specific scan execution
      during which this issue was detected

  - **Classification**

    - Indicates if the issue is categorized as **Backlog** (pre-existing
      technical debt) or **New** (a recently introduced vulnerability).
      To understand how issues are categorized as backlog/new, refer to
      [Issue/Finding classification by
      scanner](#UUIDb20d66eb5d51a4edd80d1d205cbbdab0)

- **Code**: The file and code including the IaC resource in which the
  issue was detected

> **Note**
>
> Different issue types include different properties; therefore, not all
> properties are available for every issue.

####### Code to Cloud

The **Code to Cloud** tab provides a trace from the IaC misconfiguration
issue to its impact on your runtime environment, displaying a list of
traced runtime findings and traced runtime issues:

- The **Traced Runtime Issues** table includes these exposed properties

  - **Severity**: The level of risk associated with the issue.

  - **Issue Name**: The name of the specific issue detected.

  - **Assigned to**: Indicates the individual responsible for
    remediating the issue.

  - **Asset Name**: The name of the runtime asset where the issue was
    detected.

  - **Detection Method**: The method used to identify the issue, such as
    a specific scanner or security tool.

  - **Observation Time**: The time and date when the issue was first
    observed in the runtime environment.

- The **Traced Runtime Findings** table includes these exposed
  properties

  - **Finding Name**: The specific name of the finding detected on the
    asset.

  - **Asset Name**: The name of the runtime asset where the finding was
    detected.

  - **Detection Method**: The method used to identify the finding.

  - **Observation Time**: The time and date when the finding was first
    observed.

####### Actions

This tab includes suggested steps to fix the issue. When an automatic
fix is available, you can apply it directly by selecting Open Fix Pull
Request. Otherwise, manual steps are provided to guide you through
remediation.

####### War Room

The **War Room** provides an audit trail of all automatic or manual
actions taken on an issue, serving as a dedicated space to review and
interact with your issue. Each issue has a unique War Room. With machine
learning insights, the Cortex XSIAM Cloud platform suggests the most
effective analysts and command sets to help you address issues
efficiently.

###### IaC misconfiguration findings

IaC misconfiguration scans produce findings, which are potential
security risks in your Infrastructure-as-Code (IaC) definitions. These
insights help assess and analyze the security posture of your IaC
assets.

The IaC misconfiguration Findings table is a filtered instance of the
broader **Findings** table found under **Cases & Issues**, meaning it
exclusively displays findings categorized as IaC misconfiguration
findings.

> **Note**
>
> Findings are informational and, as such, are not directly mitigable.
> Remediation is performed on issues derived from findings.

To access IaC misconfiguration findings, under **Modules**, select
Application Security \> Issues \> IaC Misconfigurations \> click the
Findings tab.

####### Findings inventory

The **Findings** inventory includes the following exposed properties.

  -----------------------------------------------------------------------
  Property                            Description
  ----------------------------------- -----------------------------------
  Name                                The specific name or title of the
                                      finding (follows the name of the
                                      rule)

  Asset Name                          The name of the asset (such as a
                                      repository) where the finding was
                                      identified

  Repository                          The version control repository
                                      where the problematic code or
                                      configuration resides

  Data Source                         The system or integration from
                                      which the finding data was
                                      originally pulled (such as GitHub,
                                      GitLab)

  Branch                              The specific branch within the
                                      repository where the finding was
                                      detected

  File Path                           The exact path to the file within
                                      the repository\'s structure where
                                      the finding is located
  -----------------------------------------------------------------------

####### Expanded Findings details

Clicking on a finding in the inventory table opens the **Findings** side
card which provides additional details about the finding.

- **Finding summary**: Found at the top of the card. Includes the
  finding name, ID and type (**Configuration** for IaC findings)

- **Description**: A description of the finding including its location

- **Timestamp**: When the finding was last updated

- **Asset details**: Includes **Asset** (The impacted asset. Clicking on
  the asset opens the asset side card without needing to navigate away
  to the asset section) and **Asset Type** (The specific asset type in
  which the IaC resource was identified)

- **Evidence**: Provides evidence and contextual details within your
  SDLC containing the IaC misconfiguration finding:

  - **Finding source**

    - **Data Source:** The system or integration from which the finding
      data was originally pulled (such as GitHub or a CI/CD pipeline).
      Click the icon next to the data source to navigate to the data
      source itself

    - **Run ID**: The unique identifier of the specific scan execution
      during which this finding was detected

    - **Collaborator**: The individual or team responsible for
      contributing to the code or configuration where the finding was
      identified

  - **Code context**

    - **Repository:** The name of the version control repository where
      the finding was located

    - **Branch:** The specific branch within the repository containing
      the finding

    - **File Path:** The exact location of the finding within the
      repository file structure

    - **First Hash:** The commit hash of the first commit where this
      specific finding was introduced or detected

    - **First Commit Date**: The date of the commit that introduced the
      problematic code or dependency into the repository. This helps
      understand how long an issue has existed and for prioritizing
      remediation efforts based on its age

  - **Scan metadata**

    - **Run ID:** The unique identifier of the specific scan execution
      during which this finding was detected

###### Manage IaC misconfiguration issues

You can take the following actions to address and manage IaC
misconfiguration issues:

Right-click on a row in the inventory table to access the following
actions

- **Change Status**. Modify the status of the issue. Values: New, In
  Progress, Resolved

- **Change Severity**: Modify the severity level of the issue. Values:
  Critical, High, Medium, Low

- **Change Assignee**: Change the user or identity assigned to address
  the issue

- **Copy text to clipboard**: Duplicate selected text for easy pasting
  elsewhere

- **Copy entire row**: Duplicate the entire row of data for easy pasting
  elsewhere

- **Copy issue URL**: Duplicate the URL associated with the issue, to
  share or reference the issue

- S**how/hide rows with the \[severity level\]**: Show/hide rows
  matching the \[severity level\] of the selected row

<!-- -->

- **Open Fix PR**: Create a Pull Request (PR) with a suggested fix to
  remediate the issue

##### Application Security scans management

You can manage Application Security scans through dedicated periodic
branch and pull request (PR) scans inventories, which provide a central
view of scan health, status, scope, and detected issues. This enables
efficient tracking, analysis, and management of scans for vulnerability
insights

In addition, you can configure native scanners, optimize settings, and
monitor scan health to streamline your scan management process and
enhance your security posture.

###### How to access Application Security scan management

1.  Under **Modules**, select **Application Security**.

2.  Under **Scans**, select a scan type:

    - **Branch Periodic Scanning**: Scans code branches on a schedule to
      identify vulnerabilities early in development. For more
      information about branch periodic scans, refer to [Branch periodic
      scans](#UUID0505eca92c92b3cc8d8b312780b5f1f4)

    - **Pull Request Scans**: Scans code changes within pull requests to
      prevent the introduction of new vulnerabilities. For more
      information about pull request scans, refer to [Pull Request
      scans](#UUIDa307c455fe90e5096d4fa650771da319)

####### Scan data presentation

Periodic and pull request scan details are presented on the Cortex XSIAM
console across three levels of granularity: an inventory table providing
a list of scans, a side panel providing general scan details including a
high-level breakdown of the findings and issues detected during the
scan, and an expanded description card, providing detailed information
about the issues generated from these scans.

> **Note**
>
> While scans provide a comprehensive inventory of all issues detected
> during a scan, dedicated inventories are also maintained for specific
> scan types for more granular management. For more information, refer
> to
> [#UUIDea3a4b5c9edd63f1e81f2658f83b1d38](#UUIDea3a4b5c9edd63f1e81f2658f83b1d38),
> [#UUID7d638c37097525bfcd4f357fe65e4d0e](#UUID7d638c37097525bfcd4f357fe65e4d0e)
> and
> [#UUIDba218b3f28080b0a69865f24bf36748c](#UUIDba218b3f28080b0a69865f24bf36748c).

###### Branch periodic scans

Branch periodic scans are automated checks that assess the security
posture of applications and infrastructure. These scans run at regular
intervals using supported Application Security scanners to identify
vulnerabilities and weaknesses. You can analyze the scans directly from
a dedicated inventory table, which displays branch periodic scan
details, including code context, scan date, health, detected findings,
and generated issues.

####### How to access branch periodic scans

Under **Modules** select Application Security \> Branch Periodic
Scanning (under Scans).

####### Branch periodic scan inventory

The branch periodic scan inventory displays the following details:

The following fields are displayed in the scan inventory table.

- **Repository**: Identifies the scanned repositories

- **Organization**: Specifies the organization owning the repository

- **Scanned Branch**: Indicates the branch analyzed during the scan

- **Scan Date**: Records the timestamp of the last scan execution

- **Scan Health**: Displays the health of the scan. Values include:

  - Error

  - Partially: Indicates that the scan execution resulted in a partial
    completion, with some scan modules (for example IaC) succeeding and
    others (such as Secrets) failing

  - Completed

> **Note**
>
> The inventory table displays scan issues for visibility only;
> remediation is not available here. To resolve issues, navigate to the
> dedicated issue type inventory, where you can manage and remediate
> them.

####### Expanded periodic scan details

Selecting a scan from the inventory opens its side car, which displays a
general overview of the scan\'s details and provides access to details
of issues and findings via dedicated scan type tabs.

####### Overview

The overview tab displays these scan details.

- **General scan information**

  - **Organization**: The specific business entity or organizational
    unit associated with the periodic scan

  - **Scan Date**: The date and time when the periodic scan was
    performed

  - **Scan Health**: The overall health status of the periodic scan,
    indicating its success, failure, or other relevant states

- **Code context**

  - **Repository**: The version control repository that was scanned

  - **Scanned Branch**: The specific branch within the repository that
    was subjected to the periodic scan

- **Scan results summary**

  - **Issues**: A breakdown by severity and count of actionable security
    issues identified from the scan\'s findings

  - **Issues by Type**: A categorization and count of identified issues
    based on their specific vulnerability types (such as IaC, Secrets)

  - **Findings**: A breakdown by severity and count of findings
    discovered by the scan before being converted into actionable issues

  - **Findings by Type**: A categorization and count of raw findings
    based on their specific detection types.

######## Vulnerabilities

When selecting the **Vulnerabilities** tab, the **Issues** tab is
displayed by default. Selecting an issue in the table that is presented
then opens its side card directly within Scans Management, eliminating
the need to navigate to the dedicated **Vulnerabilities** issues page.

For detailed information about vulnerabilities issues, refer to
[Software Composition Analysis (SCA) CVE vulnerability
issues](#UUIDd5b6e8c8c4b7665e8015abd242bfc0bf).

Select the Findings tab to open a list of findings associated with the
issue, including the name of the finding, the asset in which the finding
was detected, and the repository hosting the asset.

Click on a finding for additional details, including a description of
the finding the asset type and group associated with the finding, when
last updated, and evidence for the finding.

Select the Findings tab to open a list of findings associated with the
issue, including the name of the finding, the asset in which the finding
was detected, and the repository hosting the asset.

Click on a finding for additional details, including a description of
the finding the asset type and group associated with the finding, when
last updated, and evidence for the finding.

######## Configurations

When selecting the **Configurations** tab, the **Issues** tab is
displayed by default. Selecting an issue in the table that is presented
then opens its side card directly within Scans Management, eliminating
the need to navigate to the dedicated **IaC misconfigurations** issues
page.

For detailed information about IaC misconfiguration issues, refer to
[/document/preview/1100728#UUID-99b50c01-6076-74ad-b770-a67362a7b709](/document/preview/1100728#UUID-99b50c01-6076-74ad-b770-a67362a7b709).

Select the Findings tab to open a list of findings associated with the
issue, including the name of the finding, the asset in which the finding
was detected, and the repository hosting the asset.

Click on a finding for additional details, including a description of
the finding the asset type and group associated with the finding, when
last updated, and evidence for the finding.

######## Secrets

When selecting the **Secrets** tab, the **Issues** tab is displayed by
default. Selecting an issue in the table that is presented then opens
its side card directly within Scans Management, eliminating the need to
navigate to the dedicated **Secrets** issues page.

For detailed information about Secrets issues, refer to [Secrets
issues](#UUID534c4c85c2d2ed6b7951c5aa54775dd0).

Select the Findings tab to open a list of findings associated with the
issue, including the name of the finding, the asset in which the finding
was detected, and the repository hosting the asset.

Click on a finding for additional details, including a description of
the finding the asset type and group associated with the finding, when
last updated, and evidence for the finding.

######## Package Integrity

When selecting the **Package Integrity** tab, the **Issues** tab is
displayed by default, displaying a list of package operational risk and
license issues, with detailed properties for each entry. Selecting an
entry then opens its side card directly within Scans Management,
eliminating the need to navigate to the dedicated **Package Integrity**
issues page.

For detailed information about **Package Integrity** issues, refer to
[Package Integrity](#UUID9d71749cd3dd94fb240492b0cdaddaeb).

Select the Findings tab to open a list of findings associated with the
issue, including the name of the finding, the asset in which the finding
was detected, and the repository hosting the asset.

Click on a finding for additional details, including a description of
the finding the asset type and group associated with the finding, when
last updated, and evidence for the finding.

###### Pull Request scans

Pull Request (PR) scans are initiated by events triggered by version
control systems such as GitHub, GitLab, Bitbucket and Azure Repos, or
via webhooks. These scans are run on default or non-default branches
containing open PRs or Merge Requests (MR) from your integrated
repositories. The scan results are based on
default enforcement thresholds. You can analyze PR scans directly from a
dedicated inventory table, which displays PR scan details, including
code context, scan date, health, status, detected findings, and
generated issues.

####### How to access Pull Request scans

Under **Modules** select Application Security \> Pull Request Scans
(under Scans).

####### Pull Request scan inventory

The pull request scan inventory displays the following details:

- **Repository**: Identifies the scanned repositories

- **Organization**: Specifies the organization owning the repository

- **Scanned Branch**: Indicates the branch analyzed during the scan

- **Scan Date**: Records the timestamp of the last scan execution

- **Pull Request ID**: The unique identifier of the PR

- **Commit**: The commit included in the PR

- **Scan Health**: Displays the health of the scan. Values include:

  - Error

  - Partially: Indicates that the scan execution resulted in a partial
    completion, with some scan modules (for example IaC) succeeding and
    others (such as Secrets) failing

  - Completed

- **PR Status**: Status of the PR scan. Values: \"Passed\', \'Blocked\',
  \'In Progress\'

> **Note**
>
> The inventory table displays scan issues for visibility only;
> remediation is not available here. To resolve issues, navigate to the
> dedicated issue type inventory, where you can manage and remediate
> them.

####### Expanded Pull Request scan details

Selecting a scan from the inventory opens its side car, which displays a
general overview of the scan\'s details and provides access to details
of issues and findings via dedicated scan type tabs.

####### Overview

The overview tab displays these scan details.

- **General scan information**

  - **Organization**: The specific business entity or organizational
    unit associated with the periodic scan

  - **Scan Date**: The date and time when the periodic scan was
    performed

  - **Scan Health**: The overall health status of the periodic scan,
    indicating its success, failure, or other relevant states

- **Code context**

  - **Repository**: The version control repository that was scanned

  - **Scanned Branch**: The specific branch within the repository that
    was subjected to the periodic scan

- **Scan results summary**

  - **Issues**: A breakdown by severity and count of actionable security
    issues identified from the scan\'s findings

  - **Issues by Type**: A categorization and count of identified issues
    based on their specific vulnerability types (such as IaC, Secrets)

  - **Findings**: A breakdown by severity and count of findings
    discovered by the scan before being converted into actionable issues

  - **Findings by Type**: A categorization and count of raw findings
    based on their specific detection types.

######## Vulnerabilities

Selecting the **Vulnerabilities** tab, the **Issues** tab is displayed
by default. Selecting an entry then opens its side card (which includes
remediation options) directly within Scans Management, eliminating the
need to navigate to the dedicated **Vulnerabilities** issues page.

For detailed information about vulnerabilities issues, refer to
[Software Composition Analysis (SCA) CVE vulnerability
issues](#UUIDd5b6e8c8c4b7665e8015abd242bfc0bf).

Select the Findings tab to open a list of findings associated with the
issue, including the name of the finding, the asset in which the finding
was detected, and the repository hosting the asset.

Click on a finding for additional details, including a description of
the finding the asset type and group associated with the finding, when
last updated, and evidence for the finding.

######## Configurations

When selecting the **Configurations** tab, the **Issues** tab is
displayed by default. Selecting an issue in the table that is presented
then opens its side card directly within Scans Management, eliminating
the need to navigate to the dedicated **IaC misconfigurations** issues
page.

For detailed information about IaC misconfiguration issues, refer to
[/document/preview/1100728#UUID-99b50c01-6076-74ad-b770-a67362a7b709](/document/preview/1100728#UUID-99b50c01-6076-74ad-b770-a67362a7b709).

Select the Findings tab to open a list of findings associated with the
issue, including the name of the finding, the asset in which the finding
was detected, and the repository hosting the asset.

Click on a finding for additional details, including a description of
the finding the asset type and group associated with the finding, when
last updated, and evidence for the finding.

######## Secrets

When selecting the **Secrets** tab, the **Issues** tab is displayed by
default. Selecting an issue in the table that is presented then opens
its side card directly within Scans Management, eliminating the need to
navigate to the dedicated **Secrets** issues page.

For detailed information about Secrets issues, refer to [Secrets
issues](#UUID534c4c85c2d2ed6b7951c5aa54775dd0).

Select the Findings tab to open a list of findings associated with the
issue, including the name of the finding, the asset in which the finding
was detected, and the repository hosting the asset.

Click on a finding for additional details, including a description of
the finding the asset type and group associated with the finding, when
last updated, and evidence for the finding.

######## Package Integrity

When selecting the **Package Integrity** tab, the **Issues** tab is
displayed by default, displaying a list of package operational risk and
license issues, with detailed properties for each entry. Selecting an
entry then opens its side card directly within Scans Management,
eliminating the need to navigate to the dedicated **Package Integrity**
issues page.

For detailed information about **Package Integrity** issues, refer to
[Package Integrity](#UUID9d71749cd3dd94fb240492b0cdaddaeb).

Select the Findings tab to open a list of findings associated with the
issue, including the name of the finding, the asset in which the finding
was detected, and the repository hosting the asset.

Click on a finding for additional details, including a description of
the finding the asset type and group associated with the finding, when
last updated, and evidence for the finding.

###### CI scans

CI scans detect exposed secrets, misconfigurations in your
infrastructure-as-code (IaC) files, vulnerabilities in your software
composition analysis (SCA) packages, and license non-compliance in your
CI pipelines. Scan results, including details of the scan, scan scan
status and health, are displayed in a dedicated table. For deeper
analysis, click on a scan in the table to open a side panel containing
general scan details and a breakdown of CI findings and issues.

####### How to access CI scans

Under **Modules** select Application Security \> CI Scans (under Scans).

####### CI scan inventory table

The CI scan inventory table displays the following details:

+-----------------------------------+-----------------------------------+
| Property                          | Description                       |
+===================================+===================================+
| Repository                        | The scanned repository            |
+-----------------------------------+-----------------------------------+
| Organization                      | The organization owning the       |
|                                   | repository                        |
+-----------------------------------+-----------------------------------+
| Scanned Branch                    | Indicates the branch analyzed     |
|                                   | during the scan                   |
+-----------------------------------+-----------------------------------+
| Scan Date                         | Records the timestamp of the last |
|                                   | scan execution                    |
+-----------------------------------+-----------------------------------+
| Scan Health                       | Displays the health of the scan.  |
|                                   | Values include:                   |
|                                   |                                   |
|                                   | - Completed                       |
|                                   |                                   |
|                                   | - Partially: Indicates that the   |
|                                   |   scan execution resulted in a    |
|                                   |   partial completion, with some   |
|                                   |   scan modules (for example IaC)  |
|                                   |   succeeding and others (such as  |
|                                   |   Secrets) failing                |
|                                   |                                   |
|                                   | - Error                           |
+-----------------------------------+-----------------------------------+
| CI Status                         | Displays the health status of the |
|                                   | scan. Values: Passed, Blocked, In |
|                                   | Progress                          |
+-----------------------------------+-----------------------------------+

> **Note**
>
> The inventory table displays scan issues for visibility only;
> remediation is not available in scan management. To resolve issues,
> navigate to the dedicated issue type inventory, where you can manage
> and remediate them.

######## Expanded CI scan details

Selecting a scan from the inventory opens its side car, which displays a
general overview of the scan\'s details and provides access to details
of issues and findings via dedicated scan type tabs.

######### Overview

The overview tab displays these scan details.

- **General scan information**

  - **Organization**: The specific business entity or organizational
    unit associated with the periodic scan

  - **Scan Date**: The date and time when the periodic scan was
    performed

  - **Scan Health**: The overall health status of the periodic scan,
    indicating its success, failure, or other relevant states

- **Code context**

  - **Repository**: The version control repository that was scanned

  - **Scanned Branch**: The specific branch within the repository that
    was subjected to the periodic scan

- **Scan results summary**

  - **Issues**: A breakdown by severity and count of actionable security
    issues identified from the scan\'s findings

  - **Issues by Type**: A categorization and count of identified issues
    based on their specific vulnerability types (such as IaC, Secrets)

  - **Findings**: A breakdown by severity and count of findings
    discovered by the scan before being converted into actionable issues

  - **Findings by Type**: A categorization and count of raw findings
    based on their specific detection types.

Vulnerabilities

When selecting the **Vulnerabilities** tab, the **Issues** tab is
displayed by default. Selecting an issue in the table that is presented
then opens its side card directly within Scans Management, eliminating
the need to navigate to the dedicated **Vulnerabilities** issues page.

For detailed information about vulnerabilities issues, refer to
[Software Composition Analysis (SCA) CVE vulnerability
issues](#UUIDd5b6e8c8c4b7665e8015abd242bfc0bf).

Select the Findings tab to open a list of findings associated with the
issue, including the name of the finding, the asset in which the finding
was detected, and the repository hosting the asset.

Click on a finding for additional details, including a description of
the finding the asset type and group associated with the finding, when
last updated, and evidence for the finding.

Configurations

When selecting the **Configurations** tab, the **Issues** tab is
displayed by default. Selecting an issue in the table that is presented
then opens its side card directly within Scans Management, eliminating
the need to navigate to the dedicated **IaC misconfigurations** issues
page.

For detailed information about IaC misconfiguration issues, refer to
[/document/preview/1100728#UUID-99b50c01-6076-74ad-b770-a67362a7b709](/document/preview/1100728#UUID-99b50c01-6076-74ad-b770-a67362a7b709).

Select the Findings tab to open a list of findings associated with the
issue, including the name of the finding, the asset in which the finding
was detected, and the repository hosting the asset.

Click on a finding for additional details, including a description of
the finding the asset type and group associated with the finding, when
last updated, and evidence for the finding.

Secrets

When selecting the **Secrets** tab, the **Issues** tab is displayed by
default. Selecting an issue in the table that is presented then opens
its side card directly within Scans Management, eliminating the need to
navigate to the dedicated **Secrets** issues page.

For detailed information about Secrets issues, refer to [Secrets
issues](#UUID534c4c85c2d2ed6b7951c5aa54775dd0).

Select the Findings tab to open a list of findings associated with the
issue, including the name of the finding, the asset in which the finding
was detected, and the repository hosting the asset.

Click on a finding for additional details, including a description of
the finding the asset type and group associated with the finding, when
last updated, and evidence for the finding.

Package Integrity

When selecting the **Package Integrity** tab, the **Issues** tab is
displayed by default, displaying a list of package operational risk and
license issues, with detailed properties for each entry. Selecting an
entry then opens its side card directly within Scans Management,
eliminating the need to navigate to the dedicated **Package Integrity**
issues page.

For detailed information about **Package Integrity** issues, refer to
[Package Integrity](#UUID9d71749cd3dd94fb240492b0cdaddaeb).

Select the Findings tab to open a list of findings associated with the
issue, including the name of the finding, the asset in which the finding
was detected, and the repository hosting the asset.

Click on a finding for additional details, including a description of
the finding the asset type and group associated with the finding, when
last updated, and evidence for the finding.

###### Manage repository scan configurations

You can achieve granular control over repository security through scan
configurations. Tailor scans by managing branches, enabling/disabling
scanners, customizing PR behavior, excluding paths, and managing
repository deletion.

To access repository scan configurations:

1.  Select Settings \> Data Sources \> hover over a connected data
    source from the catalog \> click View Details.

2.  Select an instance.

3.  Right-click on a selected repository(ies) \> Scan Configuration.

4.  Configure scan settings:

    - **Configure scanners**:

      - **Enable or disable Code Security scanners** (IaC, SCA, Secrets)

      - **Enable or disable Git history scans** to automatically detect
        secrets still present in a repository's past commits. By
        identifying these exposed credentials, you can proactively
        address risks and prevent potential data breaches

      - **Enable/disable secrets validation** to check a detected
        secret's activity status via public APIs. This allows you to
        prioritize and address only active, exposed secrets.

    - **PR scans**:

      - **Scan PR**: Enable security scans to automatically trigger on a
        pull request (PR) to identify potential security risks or
        misconfigurations before the code is merged

      - **Fail PR on scan error**: Enable pull requests (PRs) to
        automatically fail on a scan error. This prevents security risks
        and misconfigurations from being merged

    - **Tagging Bot**

    - **Exclude paths**: Specify the files and directories to exclude
      from scanning.

      - **Exclude directories**: Enter folder names to exclude all files
        inside, such as `node_modules/`, `tests/`, `dist/`

      - **Exclude files by pattern**: Use wildcards: `*` for any number
        of characters, `?` for a single character

        - `.*.log`: Excludes all log files

        - `*.min.js` Excludes all minified JavaScript files

      - **Use a Comma-Separated List**: Separate multiple exclusions
        with commas. For example, `node_modules/`, `dist/, docs/`)

      - **Avoid leading slashes**: Use `dist/`, `not /dist/`

5.  Click Save.

####### Configure active scanners

Enable or disable specific scanners. Options: **IaC**, **Secrets**.

> **Note**
>
> For Secrets scans you configure these additional settings:

- > **Git history scan**: scans Git history to detect secrets deleted
  > from files but still present in past commits, notifying you of these
  > exposures. This helps mitigate the risk of compromised credentials
  > that may be found in the repository\'s history

- > **Secret validation**: validates detected secrets against public
  > APIs to verify their active status, enabling you to prioritize and
  > promptly address exposures. Secrets validation scanning is available
  > through the Cortex XSIAM tenant and IDE extensions

####### Configure pull request (PR) scanning

Control your pull request security by enabling scans and configuring
error handling. You can perform the following actions:

- **Scan PR**: When enabled, security scans are performed on pull
  requests (PRs) before merging

- **Fail PR on scan error**: When enabled, any scanner error during a
  pull request (PR) check will result in the PR failing and being
  blocked from merging

####### Configure excluded paths

By default, Application Security scans all paths in all repositories.
You can define rules to exclude paths and apply them to selected
repositories. This improves scan performance and helps focus on critical
areas by ignoring irrelevant or temporary files.

To exclude paths from scans, list a path or multiple paths or files
separated by commas (,) and then select the repositories where these
exclusions should apply.

###### Monitor data source instances health

You can monitor the health and status of your integrated data source
instances and their repositories. Tracking and analyzing this data
allows you to understand and troubleshoot errors, mitigate detected
vulnerabilities, and ensure the reliability of your data sources.

####### How to view scans health

1.  Navigate to Settings \> Data Sources (under Data Collection).

2.  Search for data instance such as GitHub (Code Scanning), in the
    search bar.

- The data source is displayed, including the number of connected
  instances and the instance status. Status options include Connected,
  Error, Warning.

3.  Hover over the data source and select **View Details** to display
    the list of data source instances.

4.  Select a data source instance.

- The health status page opens, displaying:

  - The status of the instance, connected repositories and instance
    type, such as cloud are displayed on the top card

  - A list of repositories connected to the instance, including scan
    details such as status, scan coverage (connected scanners such as
    SCA, Secrets and IaC and the scan status), location (scanned branch,
    organization, repository) and timestamp

######## Understanding errors and warnings

- An error status is displayed if:

  - More than 50% of the repositories associated with the instance have
    errors

  - There is a token error for a repository

  - There are missing permissions (categorized as an error based on
    severity)

  - Webhook subscription errors (categorized as an error based on
    severity)

  - At least one repository includes a warning

- A warning status is displayed if:

  - Less than 50% of the repositories associated with the instance have
    errors

  - Missing permissions (categorized as a warning based on severity)

  - Webhook subscription errors (categorized as a warning based on
    severity)

######## Troubleshoot scan health

You can troubleshoot both instance and repository issues.

1.  Select an instance containing an error or warning status.

2.  Review instance issues: click Review Health in the top bar.

- A list of errors by repository and related to the instance are
  displayed. The list includes these unique properties:

  - **Classification**: Options: **Warning** or **Error**

  - **Error Type**: The type of instance error. Options: Permission,
    Clone, Connection, Webhook subscription, Token

  - **Repository**: the repository containing the issue

  - **Scope**: the scope of the issue

3.  Review repository issues: select a repository in the table with a
    status of **Error** or **Warning**.

- A list of repository-related warnings and errors is displayed,
  including details such as description, type, location, and timestamp.

##### Application Security Policies

A Application Security policy defines how a system should respond to
application security threats. It includes conditions that trigger the
policy, the scope of its application, and the actions to be taken when
these conditions are met. When a policy detects a threat, it generates
an issue for remediation.

Application Security provides out-of-the-box policies. In addition, you
can create custom policies to tailor it to your specific business or
infrastructure requirements. Out-of-the-box policies cannot be modified
directly. However, you can create a custom policy by cloning the
existing one. This allows you to make changes to the original policy
according to your requirements. Refer to [Manage Application Security
policies](#UUIDa2027ad2463f8474afc9729baf063e4d) for more information.

###### User roles and permissions

These user roles and permissions are required for AppSec policies:

- - Roles with **Policies View/Edit** permissions can create and modify
    detection policies

  - Roles with **Policies Read** permissions can view detection policies

  - An **AppSec Admins** user role has **View/Edit **permissions

  - A **DevSecOps** user role only has **View** permissions

###### Create Application Security policies

Create custom Application Security policies to enable tailored security
checks across your engineering environments and workflows.

1.  Under **Modules**, select Application Security \> AppSec Policies
    (under Policy Management).

2.  Click Add Policy.

3.  On the **General** step of the policy creation wizard.

    a.  Provide a policy name (required) and description.

    b.  Select a policy type:

        - **Code Scanners** (default): This policy type scans your code
          for security issues across the development lifecycle,
          enforcing actions on secrets, Software Composition Analysis
          (SCA) risks (vulnerabilities, licenses, and package
          operational risks), IaC misconfigurations, and code weaknesses

        - **CI/CD Configuration Scanners**: This policy type scans your
          CI/CD and Version Control System (VCS) environments to detect
          misconfigurations and risky settings in pipelines, workflows,
          and repositories

    c.  Select Next.

4.  On the **Conditions** step of the wizard.

    a.  Select a finding type.

        - If **Code Scanners** is the selected policy type, the
          following finding types are available: **Select All**,
          **Vulnerability**, **Secrets**, **IaC Misconfiguration**,
          **License**, **Operational Risk**, **Code Weakness**. You can
          combine multiple finding types to create complex rules for
          when the policy should be applied.

        - If **CI/CD Configuration Scanners** is the selected policy
          type, select **CI/CD Risk**, which is the only valid and
          applicable value

    - > **Note**

      - > Add additional condition attributes for a single finding type
        > by using the **OR** operator

      - > When selecting multiple finding types, only filters common to
        > all types are available

    b.  Click **Select filter** to select the finding type attributes.

    - Refer to [Application Security policy condition
      attributes](#UUID653093930ff8be1ab9184da44fe43db5) for more
      information about condition attributes.

    c.  Click Next.

5.  On the **Scope** step of the wizard.

    a.  Define the scope of the assets to be evaluated by the policy
        using one of these methods:

        - **Asset Types**: Select assets from the list. These assets are
          based on the selected asset type. Use the following filters to
          narrow the scope:

          - **For code scanners**

            - **Category**. Values: Application, Repository

            - **Business Owner**

            - **Business Criticality**

            - **Application Name**

            - **Repository Name**

            - **Repository ID**

            - **Is Public Repository**

            - **Provider**

          <!-- -->

          - > **Note**

            - > If you select the **Applications** asset type, the
              > policy evaluates all repositories for matching
              > applications

            - > SBAC scope limitations do not apply to **Asset Types**

          <!-- -->

          - **For the CI/CD Configuration scanner**:

            - **Category**. Values: CI/CD Instance, CI/CD Pipeline, VCS
              Collaborator, VCS Organization

            - **Business Owner**

            - **Business Criticality**

            - **Application Name**

            - **CI/CD Pipiline**

            - **CI/CD Instance ID**

            - **CI/CD Pipeline Name**

            - **CI/CD Pipeline ID**

            - **VCS Collaborator Name**

            - **VCS Collaborator ID**

            - **VCS Collaborator Email**

            - ** VCS Collaborator MFA Enabled**

            - **VCS Collaborator Last Observed**

            - **VCS Organization Name**

            - **Provider**

        - **Asset Groups**: Select the asset groups on which this policy
          and its chosen detection rules will be evaluated. You can only
          select asset groups that are assigned to you as part of your
          scope.

        <!-- -->

        - For more information about Application Security
          **Asset Groups**, refer to
          [/document/preview/1395993#UUID-d0e46e4f-af92-f632-cf24-31897d19112b](/document/preview/1395993#UUID-d0e46e4f-af92-f632-cf24-31897d19112b)

    b.  Click Next.

6.  On the **Triggers & Action** step of the wizard.

    a.  Select one or more trigger types that define when the condition
        will be evaluated:

        - **Code scanners**

          - **Periodic Scan**: Automated security scans that run every
            12 hours

          - **PR (Pull Request)Scan**: Security scans triggered
            automatically by events in your version control system when
            a Pull Request (PR) or Merge Request (MR) is created or
            updated

          - **CI Scan**: Security scans that run as part of your build
            pipeline, including checks on your code and configurations.

        - **CI/CD Configuration scanner**: Only **Periodic Scan** is
          supported

    b.  Specify which actions to take when the policy detects its target
        risk.

        - **Code scanners**

+-----------------------+-----------------------+-----------------------+
| Periodic scan         | PR scan               | CI scan               |
+=======================+=======================+=======================+
| Create an issue       | Block PR              | Block CI              |
|                       |                       |                       |
| Override Severity     | PR Comment            | CLI Report            |
|                       |                       |                       |
|                       | Create an issue       | Create an issue       |
|                       |                       |                       |
|                       | Override Severity     | Override Severity     |
+-----------------------+-----------------------+-----------------------+

- **Table Legend**

  - **Create an issue**: Create an issue if policy conditions within the
    selected scope are met

  - **Block**:Block a run if the policy conditions within the selected
    scope are met

  - **CLI Report**: Enable reporting via CLI if policy conditions within
    the selected scope are met. Available when CI scan is selected as
    the evaluation method

  - **Override Severity**: Manually override the default severity that
    the system has configured for this policy

<!-- -->

- **CI/CD Configuration scanner**: **Create an Issue** and
  **Override Severity** are the supported actions

c.  Click Next.

<!-- -->

7.  On the **Summary** step of the wizard: Review the policy settings
    and click Apply.

- You can view the custom policy in the policies table.

####### Application Security policy condition attributes

Application Security policy **Condition** attributes define the criteria
evaluated by the policy to determine if the data within the selected
scope triggers a rule.

Condition attributes include: **Severity**, **AppSec Rule**,
**AppSec Rule Label**, **Backlog Status** and **Finding Type**.

> **Note**

- > The **Severity**, **AppSec Rule**, **AppSec Rule Label** and
  > **Backlog Status** attributes are not dependent on the
  > **Finding Type** attribute

- > For more information about **Backlog Status**, refer to [Backlog
  > baseline](#UUID1f924d14a08800ecc94f508836894770)

######## Finding Type attribute

The **Finding Type** attribute allows you to select the scan types that
the policy will apply to. Multiple selection is supported.
**Finding Type**includes: **Select All**, **Secrets**,
**IaC Misconfigurations**, **Vulnerabilities**, **Licenses**,
**Operational Risk**, **Weaknesses** and **CI/CD Risks**.

> **Note**
>
> For CI/CD Risks as the finding type, refer to [CI/CD policies user
> roles and permissions](#UUID515c7865477b07be67fec6335f60c770).

After selecting **Finding Type** as the attribute and selecting the
`AND` operator, additional attributes relating to the selected finding
type are displayed.

Example

When **License** is selected as the finding type, the following package
attributes become available for filtering: **License Type**,
**Package Deprecated**, **Package Maintained**,
**Package Operational Risk** and **Package Popularity**. If you select
**License Type**, a list of selectable licenses (such as
**Artistic 2.0**, **APSL**) are displayed.

######### Selectable Finding Types

The following table describes the **Finding Type** attributes.

+-----------------------------------+--------------------------------------------------+
| Attribute                         | Description                                      |
+===================================+==================================================+
| **Secrets**                       | - Severity:                                      |
|                                   |                                                  |
|                                   |   - Comparison: equal to, greater than, less     |
|                                   |     than                                         |
|                                   |                                                  |
|                                   |   - Severity level: Critical, High, Medium, Low  |
|                                   |                                                  |
|                                   | - Detection rules                                |
|                                   |                                                  |
|                                   |   - Logic: Is, Is not                            |
|                                   |                                                  |
|                                   |   - Rules: Multi-selection list of available     |
|                                   |     detection rules or type-in field             |
|                                   |                                                  |
|                                   | - Secret validity: Privileged, Valid, Invalid,   |
|                                   |   Unknown                                        |
|                                   |                                                  |
|                                   | - Detection rule labels                          |
|                                   |                                                  |
|                                   |   - Logic: Is, Is not                            |
|                                   |                                                  |
|                                   |   - Labels: Multi-selection list of available    |
|                                   |     labels                                       |
+-----------------------------------+--------------------------------------------------+
| **IaC**                           | - Severity:                                      |
|                                   |                                                  |
|                                   |   - Comparison: equal to, greater than, less     |
|                                   |     than                                         |
|                                   |                                                  |
|                                   |   - Severity level: Critical, High, Medium, Low  |
|                                   |                                                  |
|                                   | - Has fix: Value: True, False                    |
|                                   |                                                  |
|                                   | - Detection rules                                |
|                                   |                                                  |
|                                   |   - Logic: Is, Is not                            |
|                                   |                                                  |
|                                   |   - Rules: Multi-selection list of available     |
|                                   |     detection rules                              |
|                                   |                                                  |
|                                   | - IaC tag                                        |
|                                   |                                                  |
|                                   |   - Logic: Is, Is not                            |
|                                   |                                                  |
|                                   |   - Tags: \[One or more tags, separated by       |
|                                   |     commas or spaces\]                           |
|                                   |                                                  |
|                                   | - Detection rule labels                          |
|                                   |                                                  |
|                                   |   - Logic: Is, Is not                            |
|                                   |                                                  |
|                                   |   - Labels: \[Multi-selection list of available  |
|                                   |     labels or type-in field\]                    |
+-----------------------------------+--------------------------------------------------+
| **Vulnerability**                 | - Severity                                       |
|                                   |                                                  |
|                                   |   - Comparison: equal to, greater than, less     |
|                                   |     than                                         |
|                                   |                                                  |
|                                   |   - Severity level: Critical, High, Medium, Low  |
|                                   |                                                  |
|                                   | - Risk factors                                   |
|                                   |                                                  |
|                                   |   - Logic: Is, Is not                            |
|                                   |                                                  |
|                                   |   - Risk Factors: \[Multi-selection list of      |
|                                   |     available risk factor values\]               |
|                                   |                                                  |
|                                   | - CVE ID                                         |
|                                   |                                                  |
|                                   |   - Logic: Is, Is not                            |
|                                   |                                                  |
|                                   |   - CVE IDs: \[Multiple CVE IDs can be entered,  |
|                                   |     separated by commas or spaces\]              |
|                                   |                                                  |
|                                   | - CWE                                            |
|                                   |                                                  |
|                                   |   - Logic: Is, Is not                            |
|                                   |                                                  |
|                                   |   - CWEs: \[Multiple CWE IDs can be entered,     |
|                                   |     separated by commas or spaces\]              |
|                                   |                                                  |
|                                   | - CVSS score                                     |
|                                   |                                                  |
|                                   |   - Comparison: equal to, greater than, less     |
|                                   |     than                                         |
|                                   |                                                  |
|                                   |   - Score: \[Number between 0-10\]               |
|                                   |                                                  |
|                                   | - EPSS                                           |
|                                   |                                                  |
|                                   |   - Comparison: equal to, greater than, less     |
|                                   |     than                                         |
|                                   |                                                  |
|                                   |   - Percentage: \[Percentage value\]             |
|                                   |                                                  |
|                                   | - Has fix: Value: True, False                    |
|                                   |                                                  |
|                                   | - Is KEV: Value: True, False                     |
|                                   |                                                  |
|                                   | - Package name                                   |
|                                   |                                                  |
|                                   |   - Logic: Is, Is not, Contains, Does not        |
|                                   |     contain                                      |
|                                   |                                                  |
|                                   |   - Package Name: \[Package name string\]        |
|                                   |                                                  |
|                                   | - Package version                                |
|                                   |                                                  |
|                                   |   - Comparison: equal to, not equal to, greater  |
|                                   |     than, less than                              |
|                                   |                                                  |
|                                   |   - Version: \[Package version string\]          |
|                                   |                                                  |
|                                   | Refer to [Vulnerabilities and Licenses as the    |
|                                   | Finding                                          |
|                                   | Type](#X466246049df53559e0d958bcfded6a5cee043b4) |
|                                   | below for more information about Vulnerabilities |
|                                   | attributes.                                      |
+-----------------------------------+--------------------------------------------------+
| **License**                       | - Severity                                       |
|                                   |                                                  |
|                                   |   - Comparison: equal to, greater than, less     |
|                                   |     than                                         |
|                                   |                                                  |
|                                   |   - Severity level: Critical, High, Medium, Low  |
|                                   |                                                  |
|                                   | - Detection rules                                |
|                                   |                                                  |
|                                   |   - Logic: Is, Is not                            |
|                                   |                                                  |
|                                   |   - Rules: Multi-selection list of available     |
|                                   |     detection rules                              |
|                                   |                                                  |
|                                   | - License type                                   |
|                                   |                                                  |
|                                   |   - Logic: Is, Is not                            |
|                                   |                                                  |
|                                   |   - Licenses: Multi-selection list of available  |
|                                   |     license types                                |
|                                   |                                                  |
|                                   | Refer to [Vulnerabilities and Licenses as the    |
|                                   | Finding                                          |
|                                   | Type](#X466246049df53559e0d958bcfded6a5cee043b4) |
|                                   | below for more information about License         |
|                                   | attributes.                                      |
+-----------------------------------+--------------------------------------------------+
| **Operational risk**              | - Popularity                                     |
|                                   |                                                  |
|                                   |   - Comparison: equal to, greater than, less     |
|                                   |     than                                         |
|                                   |                                                  |
|                                   |   - Level: Low, Medium, High, Critical           |
|                                   |                                                  |
|                                   | - Maintained                                     |
|                                   |                                                  |
|                                   |   - Frequency: Is, Is not                        |
|                                   |                                                  |
|                                   |   - Maintenance Level: Infrequently, Moderately, |
|                                   |     Frequently                                   |
|                                   |                                                  |
|                                   | - Deprecated Package: Value: True, False         |
|                                   |                                                  |
|                                   | - Package Name                                   |
|                                   |                                                  |
|                                   |   - Logic: Is, Is not, Contains, Does not        |
|                                   |     contain                                      |
|                                   |                                                  |
|                                   |   - Package Name: \[Package name string\]        |
|                                   |                                                  |
|                                   | - Package Version                                |
|                                   |                                                  |
|                                   |   - Comparison: equal to, not equal to, greater  |
|                                   |     than, less than                              |
|                                   |                                                  |
|                                   |   - Version: \[Package version string\]          |
+-----------------------------------+--------------------------------------------------+
| **Weaknesses**                    | Severity, CWE, OWASP category, source, language  |
+-----------------------------------+--------------------------------------------------+

######## Vulnerabilities and Licenses as the Finding Type

When the Finding Type is related to **Vulnerabilities** or **Licenses**,
the following package-specific attributes and their values are available
as filters:

- Package Maintenance: LOW / MEDIUM / HIGH

- Package Popularity: LOW / MEDIUM / HIGH

- Package is Deprecated: True / False

- Package Operational Risk: LOW / MEDIUM / HIGH

Example

`Finding Type = Vulnerabilities AND CVSS > 9 AND package operational Risk = HIGH`

######## CI/CD Risks as the Finding Type

When **CI/CD Risks** is selected as the Finding Type, the following
apply:

- **Periodic Scan** trigger: This trigger is automatically enabled and
  locked (checked and disabled from being unchecked), as CI/CD Risks
  scans only run on Periodic scans

- **PR Scan** and **CI Scan** triggers: These triggers are automatically
  disabled and unchecked. They can only be enabled if other scan types
  (that is non-CI/CD risk scans such as Secrets) are also selected, and
  will only run on non-CI/CD risks types of scans

######## Developer Suppressions

A developer suppression is an inline comment added during code
development to exclude specific findings from being evaluated by a
policy. You can choose to either apply or skip these suppressions.

- **Skip**: This option causes the policy to evaluate all findings, even
  those suppressed by a developer.

- **Apply**: When you select this option, a new condition is
  automatically added to each existing condition group, ensuring the
  policy respects developer suppressions

Precedence rule: If both a global suppression setting and a
condition-level filter for Developer Suppression are present, the
condition-level filter will always take precedence during policy
evaluation.

######## Query building with Finding Types

You can select the **Finding Type** attribute at the beginning of a new
query and also after each `OR` operator. When an **AND** operator
follows a selected Finding Type, the available attributes for filtering
will be limited to those relevant to that specific Finding Type. The
**OR** operator, however, provides access to all available attribute
options.

Example

`finding type = Vulnerabilities AND CVSS>9 AND has a fix = true) OR (finding type = Operational Risk AND maintenance = LOW) OR (finding type = IaC misconfiguration AND IaC tag = kuku`

###### Manage Application Security policies

Manage your custom Application Security policies to maintain an
effective application security posture and adapt your security rules to
evolving threats and requirements.

To manage policies, right-click on a policy in the table or select a
policy and then select the menu in the side panel. The following actions
are available:

- **Edit policy**: Redirects to the policy wizard, allowing you to
  modify the policy

<!-- -->

- > **Note**

  > You cannot edit out-of-the-box (OOTB) policies.

<!-- -->

- **Duplicate policy**: Clone OOTB policies as templates for creating
  custom policies. When this option is selected, the policy wizard is
  displayed with the original policy configurations, allowing you to
  modify them as required

<!-- -->

- > **Note**

  > The duplicated policy will include the word \"clone\" in its name
  > and must be renamed.

<!-- -->

- **Disable policy**: Deactivate the policy without deleting it. Future
  scans will not trigger the policy, but existing issues detected by the
  policy will persist. Bulk actions are supported, allowing you to
  disable multiple policies simultaneously

- **Delete policy**: Permanently remove the policy from your
  environment. Issues detected by the policy will persist. Bulk
  deletions are supported

##### Application Security Rules

Application Security rules are designed to detect security threats
within your application security environment, which includes the various
components, configurations, and interactions within your application
that can potentially introduce vulnerabilities or pose risks to its
security. Application Security rules identify and flag issues based on
predefined criteria, ensuring that potential threats are proactively
detected and addressed to enhance the overall security posture of your
application.

Application Security rules cover a wide range of security best
practices, inspired by compliance frameworks such as PCI, GDPR, ISO
27001:2013, and NIST, as well as additional best practices beyond
regulatory requirements.

In addition to default rules, you can create custom rules to tailor to
your specific security requirements.

> **Note**
>
> Out-of-the-box rules cannot be modified directly. However, you can
> create a custom rule by cloning the existing one. This allows you to
> make changes to the original rule according to your requirements.
> Refer to [Manage Application Security custom
> rules](#UUID9315c326a5b37ca51961390884781421) for more information.

###### Roles and permissions

These user roles and permissions are required for AppSec rules:

- Users with **Rules Read** permission can view detection rules

- Users with rules **Rules View/Edit** permissions can create and modify
  detection rules

- Both **AppSec Admins** and **DevSecOps** roles only have **view**
  permissions

###### Rules inventory

To access Application Security rules, under **Modules** select
Application Security \> AppSec Rules (under Policy Management).

The Application Security rules inventory includes both out-of-the-box
and custom rules. The following list describes rules fields/properties
displayed in the inventory table. By default, rules are displayed
according to severity and then alphabetically. Details are provided for
properties that require explanation. You can enable or disable rules by
checking the box next to the rule name in the table.

  -----------------------------------------------------------------------
  Property                            Description
  ----------------------------------- -----------------------------------
  Rule Name                           The rule name

  Rule Description                    A description of the rule

  Severity                            The priority level assigned to
                                      findings identified by the rule

  Scanner                             The type of security scanner used
                                      to detect violations of this rule

  Policies                            The policies that include the rule

  Last modified                       The date and time when the rule was
                                      most recently updated

  Labels                              Labels assigned to the rule

  Framework                           The framework or language that the
                                      detection rule applies to (for
                                      example, GitHub, Terraform,
                                      JavaScript)
  -----------------------------------------------------------------------

####### How to search for Application Security rules

Use filters to find specific rules or categories.

Examples

- To filter rules relating to Secrets, select filter icon \> Scanner
  (from the Select field) \> Secrets (from the Value field).

- To view custom rules only, select **Mode** from the **Select field**,
  **not equals** as the operator, and **Out-of -the-box** as the value

- Sort rules according to their attributes, such as issue severity, to
  prioritize remediation efforts

###### Create custom Application Security rules

Creating custom Application Security rules rules allows you to tailor
your security measures to address specific and unique threats to your
organization that are not covered by default rules. Custom rules run
across branch periodic, PR, and CI scans.

Use the custom rule builder to create rules from scratch or clone and
customize existing rules, enabling you to tailor them to meet your
specific requirements effectively.

You can create custom rules for:

- **Secrets** scans

- **IaC** scans. Supported frameworks include Terraform, TFPlan (with
  automatic application of Terraform custom rules), CloudFormation,
  Kubernetes, Bicep, Helm, Kustomize, Helm and ARM. These scans also
  apply to serverless deployments

To create custom rules:

1.  Under **Modules** select Application Security \> AppSec Rules (under
    Policy Management) \> Add Rule.

2.  On the **New Rule** dialog box:

    a.  Provide these details:

        - **Name**: The name of the rule

        - **Impact**: Describes the potential impact of a detected
          violation. This description is displayed in Issues and PR
          Comments

        - **Severity**(required): Determines the priority level assigned
          to findings identified by the rule

        - **Scanner** (required): The type of scanner to be used to
          detect issues based on the rule

        - **Subcategory** (required): Refines the scope of the rule.
          Values include General, IAM, Monitoring, Networking, Public,
          Storage, Compute, Kubernetes, Logging, and AI/Machine Learning

        - **Framework**: The framework or language that the rule is
          designed to apply to, such as Terraform, CloudFormation and
          ARM

        - **Labels:** Assign tags to rules to help categorize, filter,
          and organize them for easier identification and management

    b.  Click Next.

3.  On the **Rule Configuration** screen.

    a.  Provide your rule definition as YAML.

    - > **Note**

      > See [Configure YAML file
      > properties](#UUIDea47201b2a92ce9f3f0ad71e6d7abbd4) below for
      > more details.

    b.  Validate the code: Click Validate Code.

    c.  Provide suggested remediation in AsciiDoc format.

    d.  Click Done.

    - The rule is displayed in the rules inventory table.

- > **Note**

  > Scanning/testing behavior is not supported.

###### Manage Application Security custom rules

You can manage Application Security detection rules to customize and
optimize your security configurations according to your specific needs
and preferences: On the **AppSec Rules** inventory, right-click on a
rule or click to open the side panel \> select an option:

- Edit: Opens the **Edit Rule** wizard, allowing you to manage existing
  rules

- Duplication: Opens the selected rule in a New Rule dialog box,
  allowing you to save a copy of the rule. This allows you to customize
  default rules according to your requirements

###### Configure YAML file properties

You can leverage YAML templates to create complex rules tailored to
specific compliance or security requirements. Application Security rules
support attribute-based and connection-state rules.

####### Rule attributes properties (YAML)

The following YAML attributes are used to define the properties of the
rules.

- **provider**: Specifies the cloud provider or source for the resources

- **definition**: Contains the logic and conditions for the rule,
  including attributes, operators, and resource connections

- **resource_type**: Defines the type of the specific cloud resource

- **cond_type**: Represents the condition type for applying the rule.
  Options: **attributes**, **connection**, **filter**, **resource**

- **attribute**: Refers to the specific attribute or property of the
  cloud resource being evaluated

- **value**: Represents the value that the attribute of the cloud
  resource should meet for the rule condition

####### Attribute-based rules

Attributes define resource property configurations. The YAML syntax for
attribute configurations aligns with the framework targeted by the rule,
such as Terraform, to define the desired resource state. Application
Security IaC rules identify and flag any resource that deviates from
this defined state as a violation.

Each resource must include one of the following conditions:

- **Contain the specified attribute values**. For example, if a rule
  states that the `region` attribute must be `us-west-2`, then a
  resource will only pass this part of the rule if it includes the
  `region` attribute, and the value of that attribute is `us-west-2`

- **Match the attribute\'s presence**. For example, if a rule states
  \"the `encryptionEnabled` attribute must be present,\" then a resource
  will only pass if it includes the `encryptionEnabled` attribute,
  regardless of its value

- **Match the attribute\'s absence**: For example, if a rule says \"the
  `publicAccessAllowed` attribute must be absent,\" then a resource will
  only pass if it does not include the `publicAccessAllowed` attribute

EXAMPLE

In this example, the attribute check flags any `aws_redshift_cluster`
resource where the `automated_snapshot_retention_period` is not `0`.

    definition:
         cond_type: "attribute"
         resource_types:
         - "aws_redshift_cluster"
         attribute: "automated_snapshot_retention_period"
         operator: "not_equals"
         value: "0"

**Supported Operators**: Attribute operators apply differently based on
the scan type:

- For `IaC` scans: All attribute operators are supported

- For `Secrets` scans: You must implicitly use the `regex` operator.
  Even if `regex` is not explicitly defined, pattern matching is applied
  automatically. For example, in the following secret rule, regex is
  implicitly applied:

<!-- -->

- cond_type: "secrets"
       value:
         - "[A-Za-z0-9]{8,20}"
         - "my-super-secret-password-regex"

The table below explains how to use attributes with matching keys and
values.

  -----------------------------------------------------------------------
  Operators                           Values
  ----------------------------------- -----------------------------------
  `Equals`                            `equals`

  `Not Equals`                        `not_equals`

  `Regex Match`                       `regex_match`

  `Not Regex Match`                   `not_regex_match`

  `Exists`                            `exists`

  `Not Exists`                        `not_exists`

  `One Exists`                        `one_exists`

  `Any`                               `any`

  `Contains`                          `contains`

  `Not Contains`                      `not_contains`

  `Within`                            `within`

  `Starts With`                       `starting_with`

  `Not Starts With`                   `not_starting_with`

  `Ends With`                         `ending_with`

  `Not Ends With`                     `not_ending_with`

  `Greater Than`                      `greater_than`

  `Greater Than Or Equal`             `greater_than_or_equal`

  `Less Than`                         `less_than`

  `Less Than Or Equal`                `less_than_or_equal`

  `Subset`                            `subset`

  `Not Subset`                        `not_subset`

  `Intersects`                        `intersects`

  `Not Intersects`                    `not_intersects`
  -----------------------------------------------------------------------

######## Limitation of nesting in `NOT` blocks

Nesting connection condition types within a `NOT` block is not currently
supported. The following example displays an unsupported \'NOT\' block
for connection condition types.

    definition:
      not:
        cond_type: "connection"
        resource_types:
          - "aws_elb"
        connected_resource_types:
          - "aws_security_group"
        operator: "exists"

######## Using JSONPath with operators

Operators within this system support advanced attribute targeting
through *JSONPath* expressions. To apply an operator to a JSONPath
result, prefix the operator with `jsonpath_`. This allows for flexible
and precise data extraction and comparison. For example:
`jsonpath_length_equals` or `jsonpath_length_exists` .

####### Connection-based rules

Connection state in a rule defines whether resources of different types
are connected or disconnected. This helps enforce security controls and
architectural constraints by specifying allowed or prohibited
relationships between resources.

EXAMPLE

In this example, `aws_lb` and `aws_elb` must be connected to
`aws_security_group` or `aws_default_security_group` to be compliant.

    definition:
           cond_type: "connection"
           resource_types:
               - "aws_elb"
               - "aws_lb"
           connected_resource_types:
             - "aws_security_group"
             - "aws_default_security_group"
           operator: "exists"

The table below explains how to use Connection State types with matching
keys and values.

  ---------------------------------------------------------------------------------
  Key                          Type                    Value
  ---------------------------- ----------------------- ----------------------------
  `cond_type`                  string                  A connection must exist
                                                       between the specified
                                                       resources

  `resource_type`              collection of strings   Use
                                                       either `all` or \[included
                                                       resource type from list\]

  `connected_resource_types`   collection of strings   Use
                                                       either `all` or \[included
                                                       resource type from list\]

  `operator`                   string                  `exists`/`not exists`
  ---------------------------------------------------------------------------------

The table below explains how to use Connection State operators:

  -----------------------------------------------------------------------
  Connection State Operators          Value
  ----------------------------------- -----------------------------------
  Exists                              exists

  Not Exists                          not_exists
  -----------------------------------------------------------------------

####### Logical operators (AND/OR)

A rule can include layers of defined attributes, connection state, or
both. To define the relationship between them, use `AND`/`OR` logical
operators. You can customize the attributes, connection state, or both
across multiple layers.

 

In this example, the attribute property is evaluated using `OR` logic to
enforce compliance checks for ensuring all AWS databases have a backup
policy.

    metadata:
     name: "Ensure all AWS databases have Backup Policy"
     guidelines: "In case of non-compliant resource - add a backup policy configuration for the resource"
     category: "storage"
     severity: "medium"
    scope:
      provider: "aws"
    definition:
     or:
       - cond_type: "attribute"
         resource_types:
         - "aws_rds_cluster"
         - "aws_db_instance"
         attribute: "backup_retention_period"
         operator: "not_exists"
       - cond_type: "attribute"
         resource_types:
         - "aws_rds_cluster"
         - "aws_db_instance"
         attribute: "backup_retention_period"
         operator: "not_equals"
         value: "0"
       - cond_type: "attribute"
         resource_types:
         - "aws_redshift_cluster"
         attribute: "automated_snapshot_retention_period"
         operator: "not_equals"
         value: "0"
       - cond_type: "attribute"
         resource_types:
         - "aws_dynamodb_table"
         attribute: "point_in_time_recovery"
         operator: "not_equals"
         value: "false"
       - cond_type: "attribute"
         resource_types:
         - "aws_dynamodb_table"
         attribute: "point_in_time_recovery"
         operator: "exists"

 

In this example, both `AND`/`OR` logical operators are utilized to
evaluate both attribute and connection state properties in order to
enforce compliance checks for ensuring that all Application Load
Balancers (ALBs) are only connected to HTTPS listeners.

    metadata:
      name: "Ensure all ALBs are connected only to HTTPS listeners"
      guidelines: "In case of non-compliant resource - change the definition of the listener/listener_rul protocol value into HTTPS"
      category: "networking"
      severity: "high"
    scope:
      provider: "aws"
    definition:
      and:
      - cond_type: "filter"
        value:
        - "aws_lb"
        attribute: "resource_type"
        operator: "within"
      - cond_type: "attribute"
        resource_types:
        - "aws_lb"
        attribute: "load_balancer_type"
        operator: "equals"
        value: "application"
      - or:
        - cond_type: "connection"
          resource_types:
          - "aws_lb"
          connected_resource_types:
          - "aws_lb_listener"
          operator: "not_exists"
        - and:
          - cond_type: "connection"
            resource_types:
            - "aws_lb"
            connected_resource_types:
            - "aws_lb_listener"
            operator: "exists"
          - cond_type: "attribute"
            resource_types:
            - "aws_lb_listener"
            attribute: "certificate_arn"
            operator: "exists"
          - cond_type: "attribute"
            resource_types:
            - "aws_lb_listener"
            attribute: "ssl_policy"
            operator: "exists"
          - cond_type: "attribute"
            resource_types:
            - "aws_lb_listener"
            attribute: "protocol"
            operator: "equals"
            value: "HTTPS"
          - or:
            - cond_type: "attribute"
              resource_types:
              - "aws_lb_listener"
              attribute: "default_action.redirect.protocol"
              operator: "equals"
              value: "HTTPS"
            - cond_type: "attribute"
              resource_types:
              - "aws_lb_listener"
              attribute: "default_action.redirect.protocol"
              operator: "not_exists"
          - or:
            - cond_type: "connection"
              resource_types:
              - "aws_lb_listener_rule"
              connected_resource_types:
              - "aws_lb_listener"
              operator: "not_exists"
            - and:
              - cond_type: "connection"
                resource_types:
                - "aws_lb_listener_rule"
                connected_resource_types:
                - "aws_lb_listener"
                operator: "exists"
              - or:
                - cond_type: "attribute"
                  resource_types:
                  - "aws_lb_listener_rule"
                  attribute: "default_action.redirect.protocol"
                  operator: "equals"
                  value: "HTTPS"
                - cond_type: "attribute"
                  resource_types:
                  - "aws_lb_listener_rule"
                  attribute: "default_action.redirect.protocol"
                  operator: "not_exists"

 

In this example, `OR` logic is applied to custom secrets defined as part
of a policy aiming to enforce security measures by restricting the
addition of certain types of secrets.

    metadata:
      name: "My Secret"
      guidelines: "Don't add secrets"
      category: "secrets"
      severity: "high"
    definition:
      cond_type: "secrets"
      value:
        - "[A-Za-z0-9]{8,}"
        - "my-super-secret-password-regex"

##### AppSec CLI

###### Cortex CLI for Code Security

The Code Security CLI, part of the Cortex CLI, allows developers and
security teams to integrate security checks directly into their
application development workflows.

> **Note**
>
> For detailed information about the Cortex XSIAM unified CLI, refer to
> [/document/preview/1401404#UUID-7187f72b-074b-0a94-3ae9-d4d167b54060](/document/preview/1401404#UUID-7187f72b-074b-0a94-3ae9-d4d167b54060).

The Code Security CLI supports the following scan types:

- **Secrets**: Identifies exposed sensitive secrets within your codebase

- **Infrastructure-as-Code** (IaC): Analyzes infrastructure
  configuration files to detect potential security misconfigurations

- **Software Composition Analysis** (SCA): Performs vulnerability
  detection in third-party dependencies, assesses their license
  compliance and their package operational risk

In addition, the Code Security CLI serves as the integration mechanism
for security scanning within supported CI tools such as Jenkins, GitHub
Actions, and others. This is achieved by adding a code snippet
containing the CLI command into the configuration files of your CI tool
when integrating the CI tool with Cortex XSIAM. It acts as a wrapper,
enabling security scanning within your pipelines, and direct upload of
results to the platform.

The CLI supports the following outputs:

- json

- spdx

- cli

- junitxml

- sarif

- cyclonedx

- cyclonedx_json

####### Code Security CLI scan behavior and output

- Scans generate assets (see
  [/document/preview/1077363#UUID-d258a70e-528b-b6b5-824b-e1c929edcff0](/document/preview/1077363#UUID-d258a70e-528b-b6b5-824b-e1c929edcff0),
  [/document/preview/1084997#UUID-17221af4-a8c2-16bb-e335-a452c13c5bfc](/document/preview/1084997#UUID-17221af4-a8c2-16bb-e335-a452c13c5bfc)
  and
  [/document/preview/1091335#UUID-bf9b91dc-8c27-f541-69b0-bfa663f463db](/document/preview/1091335#UUID-bf9b91dc-8c27-f541-69b0-bfa663f463db)

- If one scanner (such as Secrets) fails, the other scanners will
  continue to run and produce results

- Scan failures trigger an error message indicating the scanner that
  failed

- The Code Security CLI provides these output modes for flexible
  management and viewing of scan results:

  - **Upload to platform**: `--upload-mode = true` (default). Uploads
    scan results directly to the platform for centralized analysis and
    management

  - **Upload findings only**. `--upload-mode = false` (default). Upload
    findings, but without including the actual source code content. This
    prevents raw source code from leaving your local environment or
    being stored on the platform

  - **CLI output only**: `upload = false` (default). View scan results
    directly in your command-line interface without being uploaded to
    the platform

<!-- -->

- For more information about the output flags, refer to [Cortex CLI
  Application Security command line
  reference](#UUID1f7b753f144f4db8dd3f589b8832d66d).

####### Authentication

To authenticate the Code Security CLI, choose one of the following
methods:

- **Using command-line flags**: Provide authentication details directly
  with your commands

<!-- -->

- The following flags are required to authenticate the Code Security
  CLI:

  - `--api-base-url`: \[\$CORTEX_API_BASE_URL\]

  - `--api-key`: \[\$CORTEX_API_KEY\]

  - `--auth-id`. \[\$CORTEX_AUTH_ID\]

  For more information about these flags, refer to [Cortex CLI common
  command line reference guide](#UUID692df6034f88296f74eba572bb9ff237).

<!-- -->

- **Using a **`cortex.env`** file**: Place your authentication details
  in a `cortex.env` file. You can download this file from the UI

- **Using a **`cortex.yaml`** file**: Place your authentication details
  in a `cortex.yaml` file

####### Requirements

> **Prerequisites**

- > **For the Cortex CLI binary**:

  - > Ensure you have `Node.js v22` installed on your host machine
    > before running any scans with the Cortex CLI. This is crucial to
    > prevent runtime errors, as the CLI depends on Node.js for
    > executing JavaScript analysis

  <!-- -->

  - > **Note**

    - > To check your version of `Node.js`, run `node -v`

    - > To download Node.js, refer to the official
      > [Node.js](https://nodejs.org/) site

  <!-- -->

  - > For Linux OS systems, ensure that **GLIBC **(GNU C library)
    > version 3.25 or greater is installed

<!-- -->

- > **Note**

  > This requirement does not apply when using the CLI as a container
  > image.

<!-- -->

- > **Permissions**: Ensure you have the required user permissions.
  > Refer to
  > [/document/preview/1203998#UUID-5f83dcd6-a392-b2c7-a864-65407ab6bfa6_section-idm234735378274209](/document/preview/1203998#UUID-5f83dcd6-a392-b2c7-a864-65407ab6bfa6_section-idm234735378274209)
  > for more information

- > Onboard and install the Cortex CLI. Refer to [Connect Cortex
  > CLI](#UUID24585c529b8f7d01ff2e6718dc8b3fe1) for more information

####### Configure proxy for the Code Security CLI

When operating the Code Security CLI within environments requiring
internet access via a proxy server, you can configure the tool to route
its traffic through your proxy using standard environment variables. For
proxies that perform TLS inspection, you must also specify a CA
certificate

- **Environment variables**: Set `HTTP_PROXY` and `HTTPS_PROXY` (or
  `http_proxy` and `https_proxy`) to your proxy address

- **CA Certificate**: The `--ca-certificate` flag (which can also be
  configured via the \$CORTEX_CODE_CA_CERTIFICATE environment variable)
  must be used to provide the custom CA certificate for proxies that
  perform TLS inspection

###### Connect Cortex CLI

Connect Cortex CLI to scan supported Cortex Cloud modules and gain
insights into your security posture, enabling you to identify, analyze
and address potential risks.

> **Prerequisites**

- > **System requirements**:

  - > **macOS** (Intel Core i7, such as Sequoia): To ensure all
    > functionalities work correctly, you must install the `vectorscan`
    > dependency via **Homebrew**, using this command:
    > `brew install vectorscan`

  - > **Ubuntu 20** requires the `prefetch` utility

  - > **Ubuntu (for linux-amd64)** also requires the `libhyperscan5`
    > library. To install, run `sudo apt install libhyperscan5`

  - > **Linux for AppSec Module**: Support is provided for systems
    > meeting the following specifications:

    - > **RHEL 10**: Kernel: 6.12, glibc: 2.39

    - > **Debian 12**: Kernel: 6.1.27, glibc: 2.36

    - > **Ubuntu**:

      - > Version 18.04 - Kernel: 4.15, glibc: 2.27

      - > Version 20.04 - Kernel: 5.4, glibc: 2.31

      - > Version 22.04 - Kernel: 5.15, Glibc: 2.35

      - > Version 24.04 - Kernel: 6.8, Glibc: 2.39

  - > **Windows**: AMD 64 and ARM 64

- > For cURL-based downloads:

  - > `curl`

  - > `jq`

    - > On **Ubuntu/Debian-based Linux **distributions:
      > `sudo apt-get install jq`

    - > On **RedHat/CentOS/Fedora**: `sudo yum install jq`

    - > **macOS** (using `Homebrew`): `brew install jq`

    - > **Windows**:

      - > Download the executable from [jq GitHub
        > releases](https://github.com/stedolan/jq/releases)

      - > If `Chocolatey` is installed: `choco install jq`

- > **Permissions**: Grant the user installing the CLI required
  > permissions. For more information refer to
  > [#UUID479c01b6c5644b12c22da36a823a69af](#UUID479c01b6c5644b12c22da36a823a69af)

- > Best Practice (required for SCA vulnerability suppression):

  - > Run the CLI within your current working directory
    > (\<current_directory_path\>). It is recommended to use the
    > absolute file path for your current working directory

  - > Ensure that the `--repo-id` parameter includes
    > the `<repo_owner_name>/<repo_name>` structure, with
    > the `<repo_name>` matching the exact name of the directory

  <!-- -->

  - Example
    > The present working directory is `Users/test/<repo_name>`.
    > Therefore, the `--repo-id` parameter must
    > be `--repo-id <repo_owner_name>/<repo_name>`, ensuring
    > that `<repo_name>` precisely matches the directory name within the
    > structure.

  <!-- -->

  - > For terminal actions performed by Cortex XSIAM IDE extensions on
    > Windows, Command Prompt (CMD) is the supported environment.
    > PowerShell is not supported for these actions

1.  Navigate to Settings \> Data Sources (Under Data Collections) \> +
    Data Source \> Show More \> CI/CD.

- > **Tip**

  > You can also locate your CI tool by typing its name (such as
  > Jenkins) into the search bar on the **Add Data Source** page after
  > selecting **+ Data Sources**.

2.  Hover over **Cortex CLI** and click Connect.

- > **Tip**

  > You can enter **CLI** in the search bar to locate the Cortex CLI
  > tool.

3.  In the **Configure** step of the integration wizard.

    a.  Select your operating system from the menu.

    b.  Download the CLI binary: copy (or download) the command provided
        in the wizard and paste into your terminal.

    c.  Click Next.

    - The **Authenticate** step of the wizard is displayed.

4.  On The **Authenticate** step of the wizard.

    a.  Generate an API:

        i.  Select Generate API key.

            - **IMPORTANT**: This option
              **is required for CWP image scans**

            - This option creates a **CLI** role for the API key with
              CLI **View/Edit** options. It is recommended as it grants
              the API key permissions to not only access data, but also
              to upload or send data back

            - If you do not select this option, the generated API key
              creates a **CLI Read Only** role with CLI **View**
              permissions only

            - **Warning**: Using **With upload results** permissions may
              incur additional costs as per your license agreement

        ii. Copy the the generated `API Key ID` and `API key` that are
            displayed in their respective fields.

        iii. Copy and save the the generated API key from the
             **Retrieve your API key** field.

        - A code command is generated and displayed.

        iv. Verify that the generated API key is displayed under the API
            Keys inventory.

    - > **Note**

      > **Using an existing API Key (or verifying existing API Key permissions)**:
      > If you are using an existing API key, verify it has CLI
      > permissions. **CLI View/Edit** permissions correspond to
      > selecting **With upload results** permissions, while
      > **CLI Read Only** or **View** permissions corresponds to not
      > selecting the **With upload results** permissions.

    b.  Download and save the CLI tool to your system:

        i.  Copy or download the provided code.

        - > **Note**

          > On macOS arm 64 architecture you must unpack the downloaded
          > file to retrieve the executable.

        ii. Replace `${API_KEY}` in the code with your API key.

        iii. Retrieve and paste the Cortex Cloud public API URL in the
             code: Navigate to Settings \> API Keys (under
             Configurations) \> click Copy API URL .

    c.  Run the command in your terminal.

    d.  Click Done.

5.  Make the `cortexcli` file executable: run `chmod +x cortexcli`.

> **Note**
>
> To add an additional CLI instance, navigate to Settings \> Data
> Sources \> select the menu for your connected CLI instance \> + New
> Instance, and repeat the onboarding steps.

####### Download and run the Cortex CLI

1.  Download the CLI: Run
    `curl -k -u $CORTEX_API_ID::$CORTEX_API_KEY --output ./cortexcli $CORTEX_FQDN/api/v2/remote-li/{version}/{platform}/artifacts`

2.  Execute the CLI: Run `chmod +x cortexcli`.

3.  Verify installation: Run `cortexcli -v`.

- The CLI version is displayed.

####### Authentication

You can authenticate the Cortex CLI using one of two methods:
command-line flags or an environment configuration file.

- **Using command-line flags**: Provide your API credentials and base
  URL directly in the command using the following flags

  - `--api-base-url`: \[\$CORTEX_API_BASE_URL\]

  - `--api-key`: \[\$CORTEX_API_KEY\]

  - `--api-key-id` \[\$CORTEX_KEY_ID\]

<!-- -->

- For more information about these flags, refer to [Cortex CLI common
  command line reference guide](#UUID692df6034f88296f74eba572bb9ff237).

<!-- -->

- **Using an environment configuration file**: Instead of using flags,
  you can create an environment configuration file named `cortex.env`.
  Save this file in your working directory and add your credentials as
  variables:

  - `CORTEX_API_KEY`: \<api key id\>

  - `CORTEX_API_KEY`: \<secret\>

  - `CORTEX_API_BASE_URL`: \<tenant URL\>, for example
    `https://api-tenantname.paloaltonetworks.com/`

####### Cortex CLI usage

To execute a Cortex CLI scan, run
`cortexcli [global flags] [module name] scan [module flags]`.

**Command breakdown**

- **Global flags**:

  - `--api-base-url <value>`

  - `--api-key <value>`

  - `--api-key-id <value>`

- `cortexcli` acts as the global option, establishing the environment
  for subsequent Cortex CLI commands

- **Module name**: Select the module (environment) to be scanned:

  - `api` for API Security. For more information about API Security
    scans, refer to [Cortex CLI for API
    Security](#UUIDb1ffc59aa0e6d095fb27175615393ebe)

  - `image` for CWP. For more information about CWP scans, refer to
    [Cortex CLI for Cloud Workload
    Protection](#UUID2aaaaa4730b7203d8fe6833d61c99f3d)

  - `code scan` for Application Security. For more informations about
    Application Security refer to [Cortex CLI for Application
    Security](#UUID74b44110560ce8becddb8cd6ed4ba60d)

- **Module flags**: The flags available for the selected command:

  - For flags common to all environments, refer to [Cortex CLI common
    command line reference guide](#UUID692df6034f88296f74eba572bb9ff237)

  - For flags specific to CWP refer to
    [/document/preview/1394340#UUID-0b78b5d4-d82e-f0ac-e375-0b3f5220e19c](/document/preview/1394340#UUID-0b78b5d4-d82e-f0ac-e375-0b3f5220e19c)

  - For flags specific to API Security, refer to [Cortex CLI API
    Security command line reference
    guide](#UUIDb16a2f075a39c3754a6e4b12b0012a59)

  - For flags specific to Application Security, refer to [Cortex CLI
    Application Security command line
    reference](#UUID1f7b753f144f4db8dd3f589b8832d66d)

> **Note**

- > For more information about CLI usage for CWP, refer to [Cortex CLI
  > for Cloud Workload
  > Protection](#UUID2aaaaa4730b7203d8fe6833d61c99f3d)

- > For more information about CLI usage for API Security, refer to
  > [Cortex CLI for API Security](#UUIDb1ffc59aa0e6d095fb27175615393ebe)

- > For more information about CLI usage for Application Security, refer
  > to [Cortex CLI usage for Application
  > Security](#UUIDb8f6c20b0b698af8d1ce68c976f7e227)

###### Cortex CLI usage for Application Security

To scan Application Security, run:

    cortexcli –-api-base-url <API URL> --api-key <API key from the "Authenticate" step in the CLI connector screen> --api-key-id <API Key ID> code scan --directory {{DIRECTORY}} --branch main --repo-id organization/repo-name –output json --output-file-path ./output.json

####### Command line reference

The command structure includes global flags which are used for
authentication, and then specifies the module name and command specific
to Application Security which are followed by dedicated flags unique to
this module as well as flags common to all modules.

- **Global flags**: These flags are part of the initial `cortexcli`
  command and are necessary to authenticate and connect to Cortex XSIAM

  - `--api-base-url`: (Required = true). The public facing API URL.
    Refer to [Connect Cortex CLI](#UUID24585c529b8f7d01ff2e6718dc8b3fe1)
    for more information

  - `--api-key`: (Required = true). The Cortex Cloud API key generated
    when onboarding the CLI as a data source. Refer to [Connect Cortex
    CLI](#UUID24585c529b8f7d01ff2e6718dc8b3fe1) for more information

  - `--api-key-id`: (Required = true). The Cortex Cloud API key ID
    generated when onboarding the CLI as a data source

<!-- -->

- For a comprehensive list of Application Security global flags, refer
  to [Cortex CLI Application Security command line
  reference](#UUID1f7b753f144f4db8dd3f589b8832d66d)

<!-- -->

- **Application Security specifics**: Following the global flags, the
  command specifies the module and the commands required for initiating
  a scan using the Cortex Cloud Application Security module:

  - `code scan`: Required - true. This command instructs the CLI to
    perform an Application Security scan.

  - For the optional flags, refer to the dedicated Application Security
    [command line reference](#UUID1f7b753f144f4db8dd3f589b8832d66d)

####### CLI Usage Examples

- **Send output to a file**: Direct the command\'s output to a specified
  file instead of displaying it in the console

<!-- -->

- ./cortexcli --api-base-url <BASE_URL> --api-key <API_KEY> --api-key-id <API_KEY_ID> code scan --branch <branch name> --repo-id <repo name> --directory <path> --output json --output-file-path <path>

<!-- -->

- **Perform a scan without upload**: Run a scan for local analysis or
  testing without uploading the results to Cortex XSIAM. This command
  runs a code scan and saves all standard output (human-readable format)
  to `scan_results.txt`

<!-- -->

- ./cortexcli --api-base-url <BASE_URL> --api-key <API_KEY> --api-key-id <API_KEY_ID> code scan --upload-mode no-upload --branch <branch name> --repo-id <repo name> --directory <path>

####### Sample outputs

The `cortexcli` provides different options for how scan results are
presented.

- **Standard output** (stdout): When no specific output format flags
  (such as `--output json` or `--output sarif)` are provided, the Cortex
  CLI will produce standard output directly to your terminal or console

- **JSON output**: To obtain the output of a scan command as a JSON
  file, specify the flags
  `--output json --output-file-path ./output.json`. This command will
  save the detailed scan results in JSON format to output.json in the
  current directory.

####### Supported flags

The Application Security CLI supports both common Cortex CLI and
dedicated Application Security flags.

- For dedicated Application Security flags, refer to [Cortex CLI
  Application Security command line
  reference](#UUID1f7b753f144f4db8dd3f589b8832d66d)

- For common flags, refer to [Cortex CLI common command line reference
  guide](#UUID692df6034f88296f74eba572bb9ff237)

###### Cortex CLI Application Security command line reference

This reference guide documents the commands and flags unique to the
Application Security CLI. For CLI commands common to all supported
modules refer to [Cortex CLI common command line reference
guide](#UUID692df6034f88296f74eba572bb9ff237).

> **Important**
>
> The Cortex CLI Application Security only supports single occurrences
> of each flag. If the same flag is passed multiple times, only the last
> provided value will be used. For example, in the following command,
> only TF CloudFormation will be the scanned framework.
>
> ./cortexcli \--api-base-url \<YOUR_API_URL\> \--api-key
> \<YOUR_API_KEY\> \--auth-id \<YOUR_AUTH_ID\> \--framework terraform
> \--framework \"terraform cloudformation\"

+-----------------------------------+---------------------------------------------------------------------------------------------------+
| Command/Variable                  | Description                                                                                       |
+===================================+===================================================================================================+
| \--source                         | The source of execution. Default source: CLI. Examples: Jenkins, GitHub Actions, CLI              |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--repo-id                        | Required for upload mode.                                                                         |
|                                   |                                                                                                   |
|                                   | Identity string of the repository. Format `repo_owner/repo_name`.                                 |
|                                   |                                                                                                   |
|                                   | > **Note**                                                                                        |
|                                   | >                                                                                                 |
|                                   | > The repo-id flag must not end with `.config`, `.log` or `.ini`. `-config` is acceptable.        |
|                                   |                                                                                                   |
|                                   | - > `--repo-id foo.config` will be blocked                                                        |
|                                   |                                                                                                   |
|                                   | - > `--repo-id foo-config` will pass                                                              |
|                                   |                                                                                                   |
|                                   | To retrieve the repository ID, under **Inventory**, navigate to All Assets \> Repositories (under |
|                                   | Code) \> select a repository \> copy the Asset ID value from the Properties section of the side   |
|                                   | card.                                                                                             |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--branch                         | Required for upload mode.                                                                         |
|                                   |                                                                                                   |
|                                   | Selected branch of the persisted repository                                                       |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--directory                      | Required.                                                                                         |
|                                   |                                                                                                   |
|                                   | The directory path to scan. Cannot be used together with `--file`                                 |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--file                           | The file path to scan. Cannot be used together with `--directory`. When using this option, the    |
|                                   | Cortex CLI will filter runners based on the file type provided. For example, if you specify a     |
|                                   | `.tf` file, only the Terraform and secrets frameworks will be included. You can further limit     |
|                                   | this (for example; skip secrets) by using the `--skip-framework` argument                         |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--var-file                       | Variable files to load in addition to the default files. This feature is currently supported for  |
|                                   | both source Terraform (.tfvars files) and Helm chart scans (for providing custom values or        |
|                                   | variable overrides). Refer to                                                                     |
|                                   | <https://www.terraform.io/docs/language/values/variables.html#variable-definitions-tfvars-files>) |
|                                   | for more information                                                                              |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--framework                      | Filter scan to run only on specific frameworks {`arm`, `ansible`, `bicep`, `cloudformation`,      |
|                                   | `docker`, `dockerfile`, `helm`, `kubernetes`, `kustomize`, `openapi`, `sca`, `secrets`,           |
|                                   | `serverless`, `terraform`, `terraform_json`, `terraform_plan`}                                    |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--skip-framework                 | Filter scans to skip specific infrastructure code frameworks. Add multiple frameworks using       |
|                                   | spaces. For example, `--skip-framework terraform sca_package`                                     |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--ca-certificate                 | CA Certificate to use                                                                             |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| -no-cert-verify                   | (default: false)                                                                                  |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--summary-position               | Sets the position for displaying the summary information                                          |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--upload-mode                    | Upload mode determines the method or mode used to upload data, and includes these options:        |
|                                   |                                                                                                   |
|                                   | - `upload` : Uploads scan results to the Cortex XSIAM platform                                    |
|                                   |                                                                                                   |
|                                   | - `no-upload` : Disables uploads of scan results to the platform                                  |
|                                   |                                                                                                   |
|                                   | - `no-code`: Uploads scan findings to the platform, but without including the actual source code  |
|                                   |   content (code blocks in the uploaded data                                                       |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--external-modules-download-path | Specifies the directory to download external modules to. Defaults to `.external_modules`          |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--output                         | Output format for reporting                                                                       |
|                                   |                                                                                                   |
| Supported formats: cli, json,     |                                                                                                   |
| spdx, junitxml, sarif, cyclonedx, |                                                                                                   |
| cyclonedx_json                    |                                                                                                   |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--output-file-path               | Specifies the output path for the scan result file                                                |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--deep-analysis                  | Enables or disables deep analysis of the Terraform plan and related files                         |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--repo-root-for-plan-enrichment  | Enriches Terraform plan findings by mapping them to their original `.tf` files                    |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--skip-path                      | Specifies a path (file or directory) that should be skipped during the scanning process. This     |
|                                   | option is useful for excluding specific files or directories that are not relevant to the         |
|                                   | scanning analysis, increasing the efficiency and accuracy of scan results                         |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--create-repo-if-missing         | Determines whether the system should create a repository if it is missing. This option allows     |
|                                   | users to automate the creation of repositories as needed and ensure that all required             |
|                                   | repositories are available for scanning. For example, when running automated scans or integrating |
|                                   | with version control systems, enabling `--create-repo-if-missing` can help maintain consistency   |
|                                   | and prevent disruptions due to missing repositories                                               |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--compact                        | Do not display code blocks in the output                                                          |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--no-fail-on-crash               | Prevents the application from failing (blocking pipelines) in the event of a scanner or backend   |
|                                   | failure. Instead of returning a `2` exit code, it will return a `0` exit code in such scenarios.  |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--var-file                       | Variable files to load in addition to the default files, Currently only supported for source      |
|                                   | Terraform (.tf file) and Helm chart scans                                                         |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| CORTEX_APPSEC_VALIDATE_SECRETS    | Controls whether secret validation is performed. By default, this feature is disabled. Set        |
|                                   | `CORTEX_APPSEC_VALIDATE_SECRETS = true` to enable it                                              |
+-----------------------------------+---------------------------------------------------------------------------------------------------+
| \--help                           | Help                                                                                              |
+-----------------------------------+---------------------------------------------------------------------------------------------------+

###### Cortex CLI common command line reference guide

This reference guide describes the common command line flags used to
manage the Application Security,Cloud Workload Protection (CWP) ) and
API Security modules through the Cortex CLI, including the structure of
base commands and subcommands.

####### Common Cortex CLI commands and flags

The following table describes CLI commands common to all supported
Cortex CLI modules.

+-----------------------------------+-----------------------------------+
| Command                           | Description                       |
+===================================+===================================+
| \--api-base-url                   | The public facing API URL. To     |
|                                   | retrieve the URL, under           |
|                                   | **Settings**, select              |
|                                   | Configurations \> API Keys \>     |
|                                   | copy API URL. Required: true.     |
|                                   | \[\$CORTEX_API_BASE_URL\]         |
+-----------------------------------+-----------------------------------+
| \--api-key                        | The API key used for              |
|                                   | authorization. Required: true.    |
|                                   | \[\$CORTEX_API_KEY\]              |
+-----------------------------------+-----------------------------------+
| \--api-key-id                     | The API key ID. Required: true.   |
|                                   | \[\$CORTEX_API_KEY_ID\]           |
+-----------------------------------+-----------------------------------+
| \--soft-fail                      | Identifies and reports errors     |
|                                   | identified during a scan but does |
|                                   | not trigger a failing condition.  |
|                                   | Instead, the scan returns a       |
|                                   | successful result with an exit    |
|                                   | code of `0`. Unlike skipped or    |
|                                   | suppressed checks, soft fail      |
|                                   | errors are still reported but do  |
|                                   | not cause the scan to fail.       |
|                                   | Required: false.                  |
|                                   | \[\$CORTEX_SOFT_FAIL\]            |
|                                   |                                   |
|                                   | > **Note**                        |
|                                   | >                                 |
|                                   | > For soft fails, a failed check  |
|                                   | > matches the defined severity    |
|                                   | > threshold. If multiple soft     |
|                                   | > fail severities are specified,  |
|                                   | > the highest severity acts as    |
|                                   | > the threshold for determining a |
|                                   | > soft fail. However, a           |
|                                   | > successful scan will always     |
|                                   | > return an exit code of `0`,     |
|                                   | > even if block-level findings    |
|                                   | > (which might trigger soft fails |
|                                   | > based on severity) are present. |
+-----------------------------------+-----------------------------------+
| \--log-level                      | Set the logging level (INFO,      |
|                                   | WARNING, ERROR) for Stdout output |
+-----------------------------------+-----------------------------------+
| \--http-proxy                     | The HTTP proxy server URL to      |
|                                   | route traffic through             |
|                                   | \[\$HTTP_PROXY\]                  |
+-----------------------------------+-----------------------------------+
| \--help                           | Show help options                 |
+-----------------------------------+-----------------------------------+
| \--version                        | Retrieves the version of the      |
|                                   | Cortex CLI currently in use       |
+-----------------------------------+-----------------------------------+

##### IDE

Integrate the Cortex Cloud security plugin into your workflow with your
IDE to directly scan your infrastructure-as-code (IaC) files for
misconfigurations, detect vulnerabilities in your software composition
analysis (SCA) packages, identify exposed secrets, and uncover license
violations while coding.

This process seamlessly runs in the background without disrupting your
coding experience. Security findings are flagged within your code,
categorized by scan type and severity for identification and resolution
within the IDE itself. Remediation options include fixes (when
available), suppression, or referring to documentation. Supported IDEs
include VS Code and all JetBrains offerings (such as IntelliJ, PyCharm
and so on).

> **Note**
>
> Not all remediation options are available for all findings or all type
> of scan category.

###### System requirements

**License**: Running a supported IDE requires a license for the Cortex
XSIAM add-on.

**Supported architectures**:

- macOS: arm64 and x64 (x86-64 or amd64)

- Windows: x64

**Supported frameworks**: The IDE is compatible with all frameworks
supported by Application Security

**Limitations**:

- Mono-repos are not supported

- Special characters (such as `&`, parentheses) are not supported in
  user names within a file path). For example, the `é` character in
  `c:\Users\JohnSmithé` is not supported

- For terminal actions performed by Cortex XSIAM IDE extensions on
  Windows, only Command Prompt (CMD) is supported. PowerShell is not
  supported

###### Visual Studio (VS) Code

Integrate the Cortex XSIAM code security plugin with your VS Code IDE to
enhance security during development. The plugin scans for security
policy violations using both default and custom policies, allowing you
to identify and resolve issues before committing code, reducing the risk
of pull request failures due to undetected problems.

####### Choose your security level

- **Enhanced security with Cortex AppSec integration** (recommended):
  For comprehensive security analysis, connect the plugin to Cortex
  Cloud using your Cortex XSIAM API Key and API Key ID (see
  prerequisites below for more information about API keys). This option
  provides the full functionality of the platform security features

- **Basic open-source functionality**: If you prefer not to use access
  credentials, you can still benefit from the plugin's basic open-source
  features. These features provide a foundational level of security
  analysis, helping you identify common vulnerabilities. However, you
  will not have access to Cortex XSIAM

####### Supported scan categories

The plugin scans these code security categories:

- **Secrets**: Identifies sensitive data embedded in code, such as API
  keys, encryption keys, OAuth tokens, certificates, PEM files,
  passwords, and pass-phrases

- **IaC misconfigurations** in IaC templates such as Kubernetes and
  Terraform. For a list of supported IaC frameworks see
  [/document/preview/1085685#UUID-bc8c82ba-7366-1262-9e84-5e08d974aa61](/document/preview/1085685#UUID-bc8c82ba-7366-1262-9e84-5e08d974aa61)

- **SCA vulnerabilities**: Includes security issues in both direct and
  transitive open-source dependencies

- **Licenses**: Software license noncompliance

- **Package Integrity**: Assesses the operational risk and potential
  impact of each package in your codebase

####### Prerequisites

> **Prerequisites**
>
> Before you begin:

- > **Permissions**: **CLI Read only** permissions. Refer to
  > [#UUID479c01b6c5644b12c22da36a823a69af](#UUID479c01b6c5644b12c22da36a823a69af)
  > for more information about permissions

- > **Environment setup**

  - > **macOS** and **Windows**:
    > Install [Python](https://www.python.org/downloads/) 3.9.x to
    > 3.12.x

  - > Install `Node.js version 22` and above for SCA scans (such as
    > vulnerabilities scans)

- > On the Cortex XSIAM console.

  - > Retrieve your access key and URL for authentication purposes when
    > setting up the plugin

    - > Generate and copy a Cortex XSIAM access key to enable access to
      > Cortex XSIAM. The access key includes a key ID and secret:

      1.  > Navigate to Settings \> Configurations \> API Keys (under
          > Integrations) \> + New Key.

      2.  > Copy and save the key.

      3.  > Retrieve your API Key ID from the ID column.

    <!-- -->

    - > For more information about API keys, refer to
      > <https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM-REST-API/Cortex-XSIAM-APIs>.

      > **Note**

      > When generating an API key, ensure you select the **Standard**
      > security level.

    <!-- -->

    - > Retrieve your Cortex Cloud API URL: Navigate to Settings \>
      > Configurations \> API Keys (under Integration) \> click Copy API
      > URL

####### Installation

You can install the plugin directly through your IDE extensions panel or
the Visual Studio Marketplace. After completing the installation,
restart your IDE if prompted.

- Install through VS Code IDE: Access the Activity bar \>
  select Extensions \> Prisma Cloud \> Install

- Install from the Visual Studio Marketplace.

  1.  Access the [Prisma Cloud
      extension](https://marketplace.visualstudio.com/items?itemName=PrismaCloud.prisma-cloud) directly
      on the Visual Studio Marketplace.

  2.  Select Install \> Open Visual Studio Code.app.

  - You are redirected to the Cortex Cloud extension on your IDE.

  3.  Click Install.

####### Configure plugin settings

The configuration process depends on whether you're using the
open-source or proprietary version. For the proprietary version, you
will need your Cortex XSIAM API Key, API Key ID and and tenant URL to
establish a secure connection between your environment and Cortex XSIAM.
These details authenticate you to your tenant. The open-source project
does not require these settings.

> **Note**
>
> **Enforcement** rules and **CA certificates** are not applicable to
> the open-source project.

1.  Access the Cortex settings in one of these ways:

    - Select Extensions \> Prisma Cloud \> Navigate to the bottom menu
      bar of your VS Code editor and select the Cortex Cloud tab

    - Select Extensions \> Prisma Cloud \> click the Settings (cogwheel)
      icon \> Settings

2.  Fill in the provided fields:

    - **API Key ID** (required): The Cortex XSIAM access key ID. See
      [Prerequisites](#Xcd2678805eb12ca81f80deedc0dc539d86e0c37)  above

    - **API Key** (required): The Cortex XSIAM secret key. See
      [Prerequisites](#Xcd2678805eb12ca81f80deedc0dc539d86e0c37) above

    - **Platform URL** (required): Your Cortex Cloud URL. See
      [Prerequisites](#Xcd2678805eb12ca81f80deedc0dc539d86e0c37) above

    <!-- -->

    - > **Warning**

      > You must insert your **API key** and **API ID** values into the
      > **Settings** before providing the tenant **URL**.

    <!-- -->

    - **CLI Version**: Leave blank to use the latest CLI version (or
      enter \'latest\'), or specify a version

    - **CLI Path**: Specifies the path to the CLI scanner. Recommended:
      Leave empty to let the extension manage the scanner installation

    - **Disable Error Message Popups**: Hide error message popups. You
      can view errors in the logs via the **Open Cortex Cloud Log**
      command

    - **Certificate**: Add your Cortex XSIAM CA certificate.
      Format: `.pem` file

    <!-- -->

    - Example
      - **macOS/Linux**: /Users/your_username/Documents/cacert.pem or
        \~/Documents/cacert.pem

      - **Windows**: C:\\Users\\your_username\\Documents\\cacert.pem

    <!-- -->

    - **Ignore Gitignore files**: Selected by default. Files that
      belongs to paths included in the `• gitignore` file will not be
      scanned when opened or saved

    - **External Checks Directory**: Provide the path to a folder
      containing custom security checks

    - **Specific Frameworks**: Scan specific frameworks such as `ARM`.
      You can add multiple frameworks using spaces between the values in
      the command. Refer to [Cortex CLI Application Security command
      line reference](#UUID1f7b753f144f4db8dd3f589b8832d66d) for more
      information about framework flags

    - **Environment Variables**: Define specific environment variables
      and their values that will be accessible to the security scanner
      while it performs its analysis

      - To add variables, select Add item \> provide the variable
        key/value pairs \> OK

      - To edit or delete a variable: Select the edit or delete icons
        next to a variable in the table

####### UI layout

To view the extension, select the **Cortex Cloud** tab in the
**Activity** bar. The extension UI layout is as follows:

- **Left pane**: The **Security scan panel**, which includes these
  features:

  - **Full Scan** button: manually initiate a full scan of your project

  - **Scan results**. Features a tree structure displaying detected
    issues by security category (IaC misconfigurations, Secrets,
    Vulnerabilities (SCA), and Licenses). Each category expands to
    reveal folders containing specific issues detected during a scan

  - Control buttons: Provide access to **Settings**,
    **Test Connectivity**, **Full scan** play button, and
    **Extension Monitoring**, which includes scan history and log files

- **Middle pane**: **Code editor**. Review your codebase, and view a
  list of issues related to a file or resource (for IaC
  misconfigurations), along with remediation options

- **Right pane**: **Details panel**. Provides a detailed view of a
  selected issue, including information such as the code difference when
  available, and remediation options

####### How to use the VS Code Cortex Cloud extension

The Cortex Cloud VS Code security extension allows you to conduct
comprehensive scans, manage findings efficiently, and remediate issues
within your coding environment. You can prioritize findings and address
the most critical issues by filtering the scan results based on category
and severity.

To use the extension:

1.  Write your code.

- The plugin provides real-time security feedback and suggestions.

2.  Use the available actions and commands to resolve security issues
    and ensure compliance with best practices.

######## UI layout

To access the plugin, select the Cortex Cloud icon in the extension
panel. The UI is divided into three sections:

- Left pane (**Navigation** panel): Displays a tree structure of issues
  according to security category: (IaC misconfigurations, Secrets,
  Vulnerabilities (SCA), and Licenses). Expand each category to reveal
  folders containing specific issues detected during a scan

- Middle pane (**Code editor**). Allows you to review your codebase,
  view findings related to resources (for IaC misconfigurations) or
  files, and access remediation options

- Right pane (**Problems Tool**). Provides detailed information about a
  selected issue, including code differences (when available),
  and remediation options

######## Scans

You can perform scans on an entire project or specific files:

- **Full scan**: Click the Play button for any security category (for
  example, IaC and Secrets) in the Navigation panel to scan the entire
  project. This action initiates scans across all categories

- **Selected file scan**: Open or save a specific file to trigger a scan
  for that file only

######## Findings

Manage findings through either the **Code editor** or
the **Problems Tool**.

- Findings are grouped by security category in the Navigation panel for
  easy browsing

- Click on a category or folder to view associated findings

- Select an issue to display its details in the Code Editor and Problems
  Tool

- Use the filter icon in the Navigation panel to refine findings by
  severity

######## Manage findings in the Code editor

To manage findings directly in your code editor, the extension
highlights secrets, misconfigurations, vulnerabilities, and license
non-compliance issues with red marks next to affected lines. Hover over
the marks to view the issue\'s details, severity and remediation
options. For multiple issues, scroll to view all detected findings. For
a more detailed view of any issue, click Console to open the
**Problems Tool ** and explore further information about the detected
finding.

######## Manage findings through the Problems Tool

The **Problems Tool** provides a detailed view of selected issues,
including available remediation options. You can access the Problems
Tool by selecting an issue in the navigation bar or through
the **Console** option in the Code editor.

######## Remediation

You can mitigate issues directly through both the Code editor and
the Problems Tool. Options include **Fix**, **Suppress**,
or **Documentation**.

> **Note**
>
> Not all remediation options are available for all issues.

######## Fix issues

When selecting an issue in the Code editor or Problems Tool, a suggested
fix is displayed when available. Fixes are applied automatically upon
selection. Below is a list of the types of fixes available for different
issue categories.

- Secrets issues: Follow the policy guidelines

- IaC misconfiguration: The fix modifies the configuration. The Problems
  Tool displays the code difference to be fixed

- SCA CVE vulnerabilities: You can directly fix the specific
  vulnerability that has been detected during the scan by upgrading the
  package to the version that includes a fix

- License mis-compliance: Follow the policy guidelines

- Package integrity:

######## Suppression

Suppress an issue to temporarily hide or ignore an issue without fixing
it, allowing you to concentrate on more important issues.

> **Note**
>
> The suppression is scoped to the file.

1.  In the IDE, select an issue from the Navigation bar and
    click Suppress in either the Code editor or Problems Tool.

2.  Provide a justification for the suppression and click Enter to
    confirm.

- The justification will be added as a commented annotation to your
  source code.

After suppressing an issue, the file will not be scanned for two
minutes. This is to prevent the issue from being re-triggered. Saving
the file during the hold period will not trigger a scan.

######### Documentation

If automated fixes are not available, policy documentation can provide
guidance on how to address the issue: Select an issue and
click Documentation. You are redirected to the relevant policy
documentation which includes suggested guidelines on how to solve the
issue.

###### JetBrains

Integrate the Cortex AppSec code security plugin with your JetBrains IDE
instance to enhance security during development. The plugin scans for
security policy violations using both default and custom policies,
allowing you to identify and resolve issues before committing code,
reducing the risk of pull request failures due to undetected problems.

> **Note**
>
> The Cortex AppSec code security plugin supports all JetBrains
> products.

####### Supported scan categories

The plugin scans these code security categories:

- **Secrets**: Identifies sensitive data embedded in code, such as API
  keys, encryption keys, OAuth tokens, certificates, PEM files,
  passwords, and pass-phrases

- **IaC misconfigurations** in IaC templates such as Kubernetes and
  Terraform. For a list of supported IaC frameworks see
  [/document/preview/1085685#UUID-bc8c82ba-7366-1262-9e84-5e08d974aa61](/document/preview/1085685#UUID-bc8c82ba-7366-1262-9e84-5e08d974aa61)

- **SCA vulnerabilities**: Includes security issues in both direct and
  transitive open-source dependencies

- **Licenses**: Software license mis-compliance

- **Package Integrity**: Assesses the operational risk and potential
  impact of each package in your codebase

####### Prerequisites

> **Prerequisites**

- > **Permissions**: **CLI Read only** permissions. Refer to
  > [#UUID479c01b6c5644b12c22da36a823a69af](#UUID479c01b6c5644b12c22da36a823a69af)
  > for more information about permissions

- > Environment setup

  - > **macOS** and **Windows**:
    > Install [Python](https://www.python.org/downloads/) 3.9.x to
    > 3.12.x

  - > Install `Node.js version 22` and above for SCA scans (such as
    > vulnerabilities scans)

- > On Cortex XSIAM

  - > Generate and copy a Cortex XSIAM access key to enable access to
    > Cortex XSIAM. The access key includes a key ID and secret:

    1.  > Navigate to Settings \> Configurations \> API Keys (under
        > Integrations) \> + New Key.

    2.  > Copy and save the key.

    3.  > Retrieve your API Key ID from the ID column.

  <!-- -->

  - > For more information about API keys, refer to
    > <https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM-REST-API/Cortex-XSIAM-APIs>.

    > **Note**

    > When generating an API key, ensure you select the **Standard**
    > security level.

- > Retrieve your Cortex Cloud API URL: Navigate to Settings \>
  > Configurations \> API Keys \> select Copy API URL.

####### Installation

You can install the plugin directly through the JetBrains IDE
**Plugins** panel or the JetBrains Marketplace.

- Install through JetBrains IDE: Navigate to Settings \> Plugins \>
  select the Marketplace tab \> search for Prisma Cloud \> Install \> OK

- Install from the JetBrains marketplace:

  1.  [Open the marketplace](https://plugins.jetbrains.com/).

  2.  Select a platform, search for the Prisma Cloud plugin, and click
      Get.

  3.  Select **Download** from the Versions tab and then **Got it** in
      the popup.

######## Configure plugin settings

1.  In your IDE, select Settings \> Tools \> Cortex Cloud.

2.  In the plugin **Settings** screen, fill in these fields:

    - **Access Key**: Your Cortex XSIAM API key ID

    - **Secret Key**: Your Cortex XSIAM API secret key

    - **Cortex XSIAM URL**: Your Cortex XSIAM URL.

    <!-- -->

    - > **Warning**

      > You must insert your **API key** and **API ID** values into the
      > **Settings** before providing the tenant **URL**.

    <!-- -->

    - **CA-Certificate** (optional): Add your CA certificate.
      Format: `.pem` file

    <!-- -->

    - Example
      - **macOS/Linux**: /Users/your_username/Documents/cacert.pem or
        \~/Documents/cacert.pem

      - **Windows**: C:\\Users\\your_username\\Documents\\cacert.pem

    <!-- -->

    - **CLI Version**: Leave blank to use the latest Application
      Security version (or enter \'latest\'), or specify a version

    - **CLI Path**: Specifies the path to the CLI executable.
      Recommended: Leave empty to let the  extension manage the CLI
      installation

    - **Ignore gitignore files**: Selected by default. Files that
      belongs to paths included in the `• gitignore` file will not be
      scanned when opened or saved

    - **External Checks Directory**: Provide the path to a folder
      containing custom security checks

    - **Custom Environment Variables**: Environment variables passed to
      the scanner during scans such as CORTEX_API_BASE_URL:

      - To add variables, provide the key/value pairs in the table under
        the **Custom Environment Variables** field

      - To remove variables, select the (**---**) sign

3.  Click Apply \> OK.

######### Test connection

You can test your connection by selecting the **Test Connection** field
under **Settings**.

######## Manage plugin configurations

Use one of these methods to access plugin configurations and modify
settings:

- Select the **Settings** icon in the **Details panel**

- Select Settings \> Tools \> Cortex Cloud

####### UI layout

- **Left pane**: Displays a tree structure that accurately mirrors the
  files and folders of the project you have opened.

- **Middle pane**: Displays the **Code editor**. When an issue is
  selected in the **Details panel**, the relevant file opens in this
  editor. This allows you to examine your codebase, see the issue in its
  specific context (such as an IaC misconfiguration), and find
  recommended remediation steps

- **Bottom pane**: This is the **Details panel**. Serves as the central
  hub for in-depth analysis and management of your code scan issues. It
  provides comprehensive information on selected issues, remediation
  options scan history, and various controls such as a manual scan
  option.

####### How to use the JetBrains Cortex XSIAM extension

The Cortex XSIAM security extension for JetBrains IDEs integrates
comprehensive scanning, efficient issue management, and remediation
capabilities directly into your coding environment, without disturbing
development.

######## Execute scans

ou can scan your code for security issues using two primary methods:
full project scans and single file scans.

- **Full project scans**: These scans comprehensively analyze your
  entire project. They can be initiated in two ways:

  - **Automatic scan**: Triggered automatically when you open a project

  - **Manual scan**: Initiated by clicking the Play button in the
    **Details panel**

- **Single file scan**: These scans focus on a specific file. They are
  triggered automatically when you open or save that file

######## View scan history

Select **Scan History** in the **Details panel** to view a record of
past scanning activities. For each recorded scan, you can review details
such as the start time and duration of the scan, the path that was
scanned, the scan trigger (such as Manual or File Opened), the total
number of issues detected, and the CLI command used to execute the scan.
Under scan history, you can also run scans locally from the terminal for
support purposes and so on.

Filters are available within the **Scan History** to view **All Scans**,
**Project Scans**, or **File Scans**.

######## View log files

Select the **Log file** icon (next to the **Play** button in the Details
panel) to view log files. These logs provide diagnostic information and
details about the execution of your scans, which can be useful for
troubleshooting.

######## Manage issues in the **Details panel**

The **Detail panel**\'s main display features a series of tabs for
categorizing issues. An **Overview** tab provides a summary of all
detected issues. Alongside it, dedicated tabs exist for specific
security categories: Issues are organized by security category (**IaC**,
**Secrets**, **Vulnerabilities**, **Licenses**, and
**Package Integrity**). The **Overview** tab displays the total count of
all issues, while each category-specific tab displays the total count of
issues associated with its specific type.

You can filter issues:

- By severity level (**L M H C**) to filter issues by severity

- By fix availability (**Fix Available**) to filter for issues with an
  available fix

<!-- -->

- > **Note**

  > After selecting **Fix Available**, the number of issues displayed in
  > the issue categories (such as IaC) reflect the number of fixable
  > issues for that type.

The **Details panel** displays a hierarchical view of folders and files
that contain issues, with this display dynamically updated based on the
selected issue type tab.

1.  Under a scan category, browse through folders/subfolders to locate
    and click on a file containing issues.

2.  (Optional) Use a filter to prioritize issues.

3.  Select an individual issue within the file to display its details in
    the right section of the **Details panel**.

- > **Note**

  > The corresponding file simultaneously opens in the **Code editor**,
  > highlighting the issue within its exact code context. See below for
  > more information.

  The detailed issue view provides information including:

  - The name and description of the issue

  - The code lines (or resource for IaC misconfigurations) in which the
    issue has been detected

  - Contextual remediation options, provided specifically for each issue
    type to guide resolution. For more information about remediation
    options, refer to [Remediation options by issue
    category](#X43165ca76b21c66e5a75c05b90a20f997ec3101) below

######## Manage issues in the **Code editor**

Select an individual issue within the **Details panel** to open the file
containing the issue in the **Code editor**.

Issues are marked by a red **i** icon next to the code line.

- Click the red **i** icon for basic details about an issue: name,
  severity, and remediation options (see below)

- For IaC resources with multiple issues, hovering over the line of code
  marked **i** displays a list of issues at the resource\'s starting
  line. Scroll to view all issues

- Select **Console** to display the issue in the **Details** panel

######## Remediation options by issue category

You can mitigate issues directly through both the **Code editor** or the
**Details panel**. Options include **Fix**, **Suppress**, and
**Documentation**.

> **Note**
>
> Not all types of remediation are available for all issue categories.
> For example, fixes are not available for **License** issues.

######### Fixes

When selecting an issue in either the **Code editor** and
**Details panel**, a suggested fix is displayed when available. Fixes
are automatically applied to the code upon selection. The following list
displays the type of fix available for the different categories of
issues.

- **CVE vulnerabilities**: The fix bumps the package version. You can
  directly fix the specific CVE vulnerability that has been detected
  during the scan by upgrading the package to the version that includes
  a fix

- **IaC misconfigurations**: The fix modifies the configuration. The
  **Details panel** displays the code difference to be fixed

- **Secrets** issues: N/A

- **License** mis-compliance: N/A

- **Package Integrity**: N/A

######### Suppression

Suppress an issue to temporarily hide or ignore an issue without fixing
it, allowing you to concentrate on more important issues. The
suppression is scoped to the file.

1.  Select an issue from the Details panel \> click Suppress in either
    the Code editor or Details panel.

2.  Provide a justification for the suppression \> click OK.

- The justification will be added as a commented annotation to your
  source code.

After suppressing an issue, the file will not be scanned for two
minutes. This is to prevent the issue from being re-triggered. Saving
the file during the hold period will not trigger a scan.

######### Documentation

If automated fixes are not available, policy documentation can provide
guidance on how to address the issue: Select an issue \> click
Documentation in either the Code editor or Details panel. You are
redirected to the relevant documentation which includes suggested
guidelines on how to mitigate the issue.

> **Note**
>
> Secrets and Licenses category issues are typically mitigated by
> following the guidance in the Documentation.

#### API documentation

The Application Security module includes an API for programmatic access
to its features. This enables you to automate security workflows,
integrate security insights into your existing tools, and create custom
solutions. With the API, you can retrieve application security data,
manage configurations, and trigger actions, helping to incorporate
security into your development and operational processes.

**Required license**: Cortex Cloud Runtime Security or Cortex Cloud
Posture Management.

For more information, refer to the [Application
Security](https://cortex-panw.stoplight.io/docs/cortex-cloud/branches/main/du9vcgm60cz6j-aspm-cicd-and-application-security-ap-is)
API documentation.

### Attack Surface Management

#### Get started with Attack Surface Management

Before you get started with Cortex XSIAM Attack Surface Management,
review the topics in this section to better understand what attack
surface management is, what the key use cases are, and how it works.

> **Note**
>
> Requires the ASM add-on.

##### What is Attack Surface Management?

The ASM add-on module for Cortex XSIAM brings industry-leading Attack
Surface Management (ASM) capabilities to the XSIAM platform. ASM helps
you discover and manage your public attack surface, providing visibility
into all of your digital assets, including on-prem and cloud. With
Attack Surface Management, you can identify and remediate
vulnerabilities, enforce compliance policies, and reduce the risk of
cyberattacks.

ASM data and insights are viewable and actionable in several different
places in the Cortex XSIAMinterface.

- **External Surface Assets**---In the **Inventory**, Cortex XSIAM
  provides a searchable, filterable view of all the external
  internet-facing assets that have been attributed to your organization,
  including certificates, domains, services, and websites.

- **Dashboards & Reports**---Cortex XSIAM provides out-of-the-box and
  customizable dashboards and reports on the current and historical
  state of your organization\'s inventory, services, and issues. This
  reporting delivers insight into trends and helps leaders identify key
  topics and business units to focus on to improve the security posture
  of the organization.

- **Cases & Issues**---Cortex XSIAM generates issues based on a flexible
  attack surface rules engine that identifies security and configuration
  risks within your organization\'s assets and services, and provides a
  workflow in which analysts can investigate, prioritize, track efforts
  to remediate outstanding problems, and independently confirm that
  issues have been corrected.

- **Attack Surface Management module**---Cortex XSIAM provides 800+
  attack surface rules and hundreds of attack surface tests to identify
  actionable, risky and vulnerable assets and confirm exploitability. In
  this location you\'ll also find a list of your
  **External IP Address Ranges** with key contextual information about
  each range.

###### Attack Surface Management use cases

Cortex XSIAM Attack Surface Management gives security and IT operations
teams the visibility they need to reduce risk to the business by
focusing remediation efforts on critical exposures and assets out of
compliance with policy. Cortex XSIAM automatically updates your asset
lists and processes, providing a single source of truth about assets
that tie to your organization, including on-prem, through partners, and
in cloud providers.

Use cases include the following:

1.  **Asset discovery and inventory management**: Discover all of your
    internet-facing assets, including cloud instances, web applications,
    and IoT devices, and maintain an up-to-date inventory of those
    assets.

2.  **Vulnerability management**: Identify and remediate vulnerabilities
    in your internet-facing assets, reducing the risk of cyberattacks.

3.  **Compliance**: Enforce compliance policies by identifying and
    tracking changes in your attack surface, ensuring that all assets
    are properly secured and in compliance with industry standards.

4.  **Incident response**: Gain real-time insights into security
    incidents, so you can quickly respond to and mitigate potential
    threats.

5.  **Certificate hygiene**: Manage your SSL/TLS certificates by
    identifying expiring or vulnerable certificates and providing
    automated workflows to renew or replace them.

6.  **DNS hygiene**: Monitor your DNS records and ensure that they are
    properly configured, reducing the risk of DNS-related attacks.

7.  **Mergers and acquisitions**: Assess the security risks and identify
    potential vulnerabilities associated with mergers and acquisitions
    through visibility into the target company\'s internet-facing
    assets.

##### Network mapping

Attack Surface Management (ASM) in Cortex XSIAM discovers and
intelligently attributes assets to organizations, helping you discover
and protect previously unknown internet-connected systems. Through this
network mapping process you will understand your organization\'s true
public-facing network perimeter.

###### Asset discovery and attribution

Cortex XSIAM uses a variety of methods to discover and attribute
internet-facing assets to your organization. These methods include:

- **IP Registration**---An IP range's registry information mentions
  information about your organization. Cortex XSIAM pulls from all
  regional internet registry databases, including ARIN, RIPE, APNIC,
  LACNIC, and AFRINIC. Registry information in your Cortex XSIAM
  instance is updated approximately biweekly.

- **ASN Advertisement**---An autonomous system number (ASN) assigned to
  you advertises your IP range as a BGP prefix.

- **Domain Registration**---Domain registry information mentions
  information about your organization. Cortex XSIAM pulls Whois
  registration information and updates it in your Cortex XSIAM instance
  approximately biweekly.

- **Certificate**---An IP range advertised one of your certificates.

- **DNS**---A DNS record points to an IP in your IP range. Cortex XSIAM
  gets its domains and DNS data from a combination of active and passive
  global collection techniques.

- **Self-Provided**---The asset was on an IP address list provided by
  your organization or was attributed by Cortex XSIAM for a reason other
  than those listed above.

###### Human-in-the-loop

An expert analyst oversees a human-in-the-loop system which leverages
our proprietary AI models to produce network maps of the highest
confidence and completeness.

Your Internet-facing assets are always under attack from targeted and
opportunistic attackers. Without a continuously updated, accurate
inventory of those assets, you leave unknown or unmonitored assets
exposed to threats. Cortex XSIAM discovers and helps remediate any
exposures on those assets.

A primary advantage of Cortex XSIAM is combining leading-edge automated
network mapping analysis with expert insights and validation. Cortex
XSIAM experts understand the intricacies and idiosyncrasies of asset
scanning and attribution. The end-result for Cortex XSIAM customers is
fewer false positives and development of naming schemas and patterns
that lead to broader asset discovery than what you see with fully
automated scanning engines alone.

###### Does Cortex XSIAM include assets for vendors, partners, and subsidiaries?

Standard contracts for the ASM Module for Cortex XSIAM include mapping
and reporting on your core company\'s attack surface as well as named
subsidiaries. Depending on the contract, or an additional statement of
work, we can map and report on additional vendors, partners, or
acquisitions. Contact your customer success manager for more
information.

##### Scanning

Attack Surface Management (ASM) in Cortex XSIAM uses data collected from
global internet scans as well open-source intelligence about the
internet to maintain a complete inventory of all the internet-facing
assets that belong to an organization. The following topics describe the
scans that Cortex XSIAM uses to map and monitor your attack surface.

###### Scanning cadences

Cortex XSIAM scans the internet to discover new services at varying
cadences depending on several factors such as port, protocol, cloud
provider ranges, and customer-attributed assets. All responsive services
are monitored regularly.

Below is a list of our targeted scanning cadences:

- **Discovery Scans**

  - **Global Base**--- twice per week discovery of approximately 250 of
    the most common ports on all IPv4 space.

  - **Global Extended**---low background rate discovery of the remaining
    65k ports, excluding those covered in KAM base and KAM extended.

  - **KAM (Known Assets Monitoring) Base**---daily discovery of
    approximately 300 of the most common ports on customer-attributed
    assets.

  - **KAM Extended**---weekly discovery of approximately 2800 of the
    most common ports on customer-attributed assets. These do not
    overlap with KAM Base.

- **Monitoring Scans**

  - Daily on all responsive services.

- **Attack Surface Testing Scans**

  - Daily on configured services.

###### Known Assets Monitoring

Cortex XSIAM performs global scans twice a week on a limited set of
ports by default. For customers who opt in, Cortex XSIAMperforms
targeted scanning of known assets daily. Known Assets Monitoring (KAM)
brings three significant benefits to the data delivered by Cortex XSIAM:

- Additional ports and protocols

  - Port/protocol pairs not included in global scans, including port
    25/SMTP, 500/UDP

  - SMB version enumeration

- TLS/SSL scanning

  - Determination of supported cipher suites and protocol versions for
    TLS/SSL services

- Frequent scanning and data delivery

  - Faster data delivery for reduced time to notification of new
    exposures

####### Opting in to Known Assets Monitoring

Note the following prerequisites for Known Assets Monitoring (KAM):

- KAM uses more exhaustive payloads than global scans, so we recommend
  validating your network before opting in. KAM will be turned on once
  we have consent from the network owner that all identified ranges have
  been validated.

- We recommend verifying that KAM source IP addresses are not blocked on
  your automated intrusion prevention system (IPS), intrusion detection
  system (IDS), or firewalls and that anti-scanning and DDoS rules do
  not apply to these specific IP ranges.

  - Cortex XSIAM scans your external attack surface only, so we do not
    need any access inside your network.

  - The amount of traffic you receive from our scanners depends on the
    KAM configuration (basic or extended) and the total amount of IP
    space owned by your organization.

- Contact your Customer Success Team to learn more and opt in to KAM.

###### Scanning ports and protocols

Cortex XSIAM detects protocol-validated services on the IPv4 and IPv6
space of the internet through a series of specialized payloads that
target specific port-protocol pairs. Following are examples of some of
the protocols and ports on which Cortex XSIAM checks for active services
throughout a standard global scan.

> **Note**
>
> The following lists are not exhaustive. For current and complete
> lists, contact your customer success team.

- **Sample protocols**: SSL, FTS, SSH, Telnet, HTTP, POP3, RDP, FTP,
  XMPP, Postgres, VNC, UDP, etc

- **Sample Ports**: 0, 20, 21, 22, 23, 25, 53, 67, 68, 80, 81, 82, 83,
  88, 110, 111, 118, 123, 135, 137, 138, 139, 143, 161, 179, 389, 401,
  443, 444, 445, 465, 500, 502, 554, 587, 593, 808, 873, 888, 943, 987,
  990, 993, 995, 1000, 1024, 1025, 1026, 1028, 1112, 1234, 1250, 1433,
  1434, 1443, 1521, 1717, 1723, 1900, 1911, 2001, 2002, 2078, 2080,
  2082, 2083, 2084, 2085, 2086, 2087, 2096, 2121, 2160, 2161, 2222,
  2323, 2443, 2483, 2484, 2525, 3000, 3052, 3306, 3333, 3388, 3389,
  3390, 3443, 3493, 3905, 3909, 3917, 3929, 3975, 3978, 4002, 4100,
  4117, 4172, 4343, 4430, 4433, 4443, 4444, 4500, 4506, 4567, 4786,
  4911, 5000, 5001, 5060, 5061, 5222, 5269, 5351, 5353, 5432, 5443,
  5555, 5632, 5800, 5900, 5901, 5902, 5903, 5904, 5905, 5906, 5907,
  5908, 5909, 5910, 5916, 5984, 5985, 5986, 6001, 6002, 6363, 6379,
  6443, 7001, 7080, 7170, 7443, 7547, 7777, 8000, 8005, 8008, 8009,
  8010, 8015, 8020, 8080, 8081, 8082, 8083, 8085, 8088, 8090, 8094,
  8139, 8140, 8159, 8194, 8195, 8196, 8197, 8198, 8209, 8210, 8211,
  8212, 8213, 8214, 8215, 8216, 8217, 8218, 8219, 8220, 8282, 8290,
  8291, 8292, 8293, 8294, 8333, 8443, 8444, 8530, 8531, 8800, 8880,
  8887, 8888, 8899, 8991, 8999, 9000, 9002, 9042, 9080, 9091, 9092,
  9100, 9200, 9418, 9443, 9444, 9595, 9983, 9997, 10000, 10010, 10443,
  11211, 11495, 11553, 12345, 16010, 17185, 17516, 17778, 18080, 18574,
  20249, 21242, 22460, 25789, 25827, 27017, 28080, 30005, 30006, 30010,
  30083, 30303, 32400, 37443, 37777, 38080, 38520, 40000, 40005, 42713,
  44344, 44818, 47001, 47693, 47808, 49501, 49502, 50001, 50067, 50070,
  50580, 50805, 50995, 50996, 50997, 51005, 51007, 51200, 51401, 52200,
  52311, 52590, 52869, 53300, 53524, 53631, 54041, 54498, 54528, 55918,
  56222, 58000, 58603, 60000, 60243, 60443, 61337, 62078

##### GeoIP data collection

Attack Surface Management (ASM) in Cortex XSIAM geoIP data collection
enables you to confirm that your actual network distribution is
consistent with what you believe your global footprint to be. GeoIP data
is especially important for security organizations to identify
compliance violations, such as data residing in restricted locations,
and to drive efficient remediations where customers leverage geoIP data
to determine infrastructure location, who owns the asset, and where to
route notifications.

#### Attack Surface Management detections

The Attack Surface Management module creates findings and issues based
on the following types of detections:

- [Attack surface rules](#UUID332e3adf9c839714a4e88d918fae3d1a)

- [Attack Surface Testing](#UUID71afff0dab064ee596dc29569345e33c)

- [Externally inferred CVEs](#UUIDac45f274f4d8361b32bcf58eee8f077a)

##### Attack surface rules

An *attack surface rule* is a definition managed by Cortex XSIAM that
identifies risks on a customer\'s attack surface. Attack Surface Rules
match on ASM global scan results to detect exposed or misconfigured
customer-owned assets. When an attack surface rule is enabled, Cortex
XSIAM will generate findings as well as issues for observations that
match that rule.

To view attack surface rules, navigate to Modules \> Attack Surface \>
Policies \> Attack Surface Rules.

The following table describes each field in the Attack Surface Rules
table.

+-----------------------------------+------------------------------------------------------+
| Field                             | Description                                          |
+===================================+======================================================+
| ASM Alert Categories              | A categorization done by the Cortex XSIAM security   |
|                                   | research team often with input from customers or in  |
|                                   | reference to published materials such the the        |
|                                   | BOD-22-01 or BOD-23-02 from CISA.                    |
+-----------------------------------+------------------------------------------------------+
| Description                       | Description of what the attack surface rule is       |
|                                   | looking for.                                         |
+-----------------------------------+------------------------------------------------------+
| Estimated Alert Count             | Estimated number of alerts that Xpanse will create   |
|                                   | if this attack surface rule is enabled.              |
+-----------------------------------+------------------------------------------------------+
| Has Remediation Rule              | Indicates whether a remediation path rule has been   |
|                                   | created for this attack surface rule.                |
|                                   |                                                      |
|                                   | Applies only to systems with the Active Response     |
|                                   | addon module.                                        |
+-----------------------------------+------------------------------------------------------+
| Modified                          | Date of the most recent update to the attack surface |
|                                   | rule.                                                |
+-----------------------------------+------------------------------------------------------+
| Remediation Guidance              | Guidance on how to remediate or mitigate the alerts  |
|                                   | created by this attack surface rule.                 |
+-----------------------------------+------------------------------------------------------+
| Rule ID                           | ID for this attack surface rule.                     |
+-----------------------------------+------------------------------------------------------+
| Rule Name                         | Name of the attack surface rule.                     |
+-----------------------------------+------------------------------------------------------+
| Severity                          | Severity of the risk identified by the attack        |
|                                   | surface rule. Issues are created with the same       |
|                                   | severity as the attack surface rule that triggered   |
|                                   | them. See [Default attack surface rule               |
|                                   | severity](#X04e5e4a699f594c6ee006e6c134515762691962) |
|                                   | for default severity settings.                       |
+-----------------------------------+------------------------------------------------------+
| Status                            | Enabled or Disabled. An enabled attack surface rule  |
|                                   | creates an issue when it detects an instance of that |
|                                   | rule. See [Default attack surface rule enablement    |
|                                   | status](#X0db86d70c3c3be5dc915a267723f4c1ccc0188d)   |
|                                   | for details about the default enablement status.     |
+-----------------------------------+------------------------------------------------------+

###### Manage attack surface rules

On the **Attack Surface Rules** page you can enable or disable rules and
change the severity to align with your organization's specific needs and
priorities.

1.  Navigate to Modules \> Attack Surface \> Policies \> Attack Surface
    Rules.

2.  Select one or more rules and right-click to perform one of the
    following actions:

    - **Enable or Disable** the rule---Some rules are enabled by
      default, but many are designed to be opt-in.

    - Change the default **Severity** of the rule---All attack surface
      rules have a predefined default **Severity** setting of **Low**,
      **Medium**, or **High**. **Critical** is never a predefined
      default, but you can set it as the default.

When you first enable an attack surface rule, you can expect to see new
findings within 24 hours if any instances of that rule are detected on
your attack surface. When you disable an attack surface rule, Cortex
XSIAM will stop creating new issues for that rule, but any existing open
issues will remain open until you change the status.

###### Default attack surface rule severity

The Cortex security research team determines the default severity
setting for an attack surface rule based on a number of details. We may
adjust the default severity when new threat information becomes
available. Changes to the default severity will never override any
changes you make to a rule's severity.

+-----------------------------------+-----------------------------------+
| Default Severity                  | Description                       |
+===================================+===================================+
| **Critical**                      | None of the attack surface rules  |
|                                   | are rated as **Critical **by      |
|                                   | default. This severity is         |
|                                   | reserved for customers to elevate |
|                                   | the attack surface rules or       |
|                                   | individual issues they deem       |
|                                   | critical for their organization.  |
+-----------------------------------+-----------------------------------+
| **High**                          | **High **severity rules identify  |
|                                   | risks that most organizations     |
|                                   | would consider important to       |
|                                   | remediate in a timely manner.     |
|                                   | This primarily includes known     |
|                                   | insecure versions of software     |
|                                   | with published high or critical   |
|                                   | severity CVEs and external        |
|                                   | services that are inherently      |
|                                   | risky to expose directly on the   |
|                                   | internet.                         |
|                                   |                                   |
|                                   | For example:                      |
|                                   |                                   |
|                                   | - A known-insecure version of     |
|                                   |   software with a known           |
|                                   |   high-score CVE. These may       |
|                                   |   include CVEs with weaponized    |
|                                   |   exploits.                       |
|                                   |                                   |
|                                   | - Devices and services that are   |
|                                   |   inherently risky to be exposed  |
|                                   |   to the public internet (RDP,    |
|                                   |   building control systems,       |
|                                   |   databases, etc). These are      |
|                                   |   often targets for opportunistic |
|                                   |   attackers who are scanning the  |
|                                   |   internet and can use brute      |
|                                   |   force or use other tactics to   |
|                                   |   gain access to an               |
|                                   |   organization's systems.         |
+-----------------------------------+-----------------------------------+
| **Medium**                        | **Medium **severity rules         |
|                                   | identify risks that we believe    |
|                                   | some organizations would consider |
|                                   | important to remediate, but may   |
|                                   | not be important to everyone.     |
|                                   |                                   |
|                                   | For example:                      |
|                                   |                                   |
|                                   | - A service type with known       |
|                                   |   vulnerabilities that could      |
|                                   |   reasonably be expected to be    |
|                                   |   publicly visible on the         |
|                                   |   internet but where we cannot    |
|                                   |   infer insecure versions with    |
|                                   |   high confidence.                |
|                                   |                                   |
|                                   | - A service that may or may not   |
|                                   |   be expected to be publicly      |
|                                   |   visible on the internet         |
|                                   |                                   |
|                                   | - Something that an organization  |
|                                   |   may or may not be expected to   |
|                                   |   remediate (e.g. a certificate   |
|                                   |   expiring in 30 days).           |
+-----------------------------------+-----------------------------------+
| **Low**                           | **Low **severity rules are        |
|                                   | unlikely to be consequential to   |
|                                   | most organizations. These include |
|                                   | the following types of risks:     |
|                                   |                                   |
|                                   | - Services that could be expected |
|                                   |   to be exposed to the internet,  |
|                                   |   but where the attack surface    |
|                                   |   rule will not exclusively       |
|                                   |   surface vulnerable instances    |
|                                   |   (in these cases, they may be    |
|                                   |   paired with a higher priority   |
|                                   |   \"insecure\" version of the     |
|                                   |   rule for known vulnerable       |
|                                   |   instances).                     |
|                                   |                                   |
|                                   | - Services that could be of       |
|                                   |   interest but pose minimal       |
|                                   |   attack surface risk. Attack     |
|                                   |   surface rules that capture      |
|                                   |   these services exist primarily  |
|                                   |   for visibility purposes.        |
|                                   |                                   |
|                                   | - Low-signal findings where       |
|                                   |   reliably detecting the service  |
|                                   |   is considered low confidence.   |
|                                   |   Attack surface rules where the  |
|                                   |   impact of exposure is high but  |
|                                   |   the detection signal is low are |
|                                   |   also classified as              |
|                                   |   **Low **severity.               |
+-----------------------------------+-----------------------------------+

###### Default attack surface rule enablement status

Attack surface rules are enabled or disabled by default. You can change
the enablement status for a rule or set of rules at any time.

If a rule is made available to only a select set of customers (typically
due to customer request), we will set the rule to enabled by default,
regardless of the severity.

In general, most attack surface rules are disabled by default. This
approach ensures that customers stay in control of their overall risk
assessment. We encourage you to routinely review the attack surface
rules and **Enable** them so they begin generating issues.

The internal Cortex decision to enable a rule by default weighs the
likelihood of generating numerous issues that may not be relevant to all
customers versus the risk of a customer missing something important to
them.

###### Attack surface rule deprecation

Cortex XSIAM is committed to providing the most accurate attack surface
rules. Our security research team continuously reviews and refines the
attack surface rules to ensure that our rules effectively reflect the
evolving threat landscape and new technologies. When a rule is marked as
\"deprecated\" in Cortex XSIAM, it signifies that the rule is no longer
recommended for active use by customers and is slated for eventual
removal from the platform. A deprecated rule will continue to function
for a transitional period, but deprecation indicates an important update
in our recommended best practices and upcoming rule enhancements.

##### Attack Surface Testing

> **Note**
>
> Requires the ASM add-on.

Cortex XSIAM Attack Surface Testing confirms the presence of
vulnerabilities on your external attack surface, enabling you to quickly
and confidently prioritize risks. With your approval, Cortex XSIAM runs
benign exploits against externally facing assets to confirm the presence
or absence of vulnerabilities. Rather than manually verifying every
inferred CVE, Attack Surface Testing runs daily scans based on your
preferences.

When setting up Attack Surface Testing, you select the targets for the
testing, either all or a subset of your directly discovered services
(which are services that are definitively associated with an asset that
belongs to your organization). After you\'ve selected targets, Cortex
XSIAM runs attack surface scans daily. Attack surface test results are
displayed on the **Services** tab in the inventory, so you can review
the data as part of your existing ASM workflow. All attack surface tests
are enabled by default, but you can view information about the tests and
disable tests if needed from the **Attack Surface Tests** page.

Confirmed vulnerabilities create issues with the **Detection Method** of
**Attack Surface Test**.

###### Attack surface tests

Cortex XSIAM has an extensive set of attack surface tests for CVEs and
other risks that affect externally-facing services and can be confirmed
with benign testing. Our attack surface testing is layered on top of our
existing attack surface management (ASM) global scanning infrastructure,
which distributes requests across a broad time range to minimize the
impact to scanned and tested services.

We perform external scans only, which means we only test
directly-discovered services accessible from the public internet. To
further decrease test load and the possibility of impacting a service,
we map attack surface tests to service classifications, enabling us to
run tests only on the relevant services in your approved set of targets.
For example, we only run Apache attack surface tests against your Apache
services.

Attack Surface Testing does not perform authenticated tests; however, we
do have attack surface tests focused on the detection of applications
that are using manufacturer default credentials. These attack surface
tests attempt to log in to specific business operations systems, IT, and
networking devices with default credentials, but don\'t perform any
operations if login is successful and will never change the state or
configuration of a tested service. You can identify attack surface tests
for default credentials by looking at the test Name field, which
typically includes **Default Credentials** , and the Vulnerability ID
field, which uses the prefix **DEFAULT-CRED-**.

New attack surface tests are added at the discretion of the Cortex XSIAM
Security Research Team when new vulnerabilities are announced.

> **Note**
>
> Attack surface testing scans are typically not CFAA compliant, meaning
> that they may attempt more extensive fuzzing to confirm or deny the
> presence of a CVE.

###### Set up Attack Surface Testing

To set up Attack Surface Testing for the first time, complete the
following tasks:

1.  Verify that you have edit permission for Vulnerability Testing

- To set up Attack Surface Testing, you must have a role that includes
  edit permission for Vulnerability Testing. To check your role-based
  permissions go to Settings \> Configurations \> Access Management \>
  Roles, and select the role. Select the Components tab, and find
  **Vulnerability Testing** under Threat Management \> Detections.

2.  Accept the End-User Licensing Agreement (EULA)

- The EULA gives Cortex XSIAM permission to conduct attack surface
  testing scans. You only need to accept the EULA once. After accepting
  the EULA the Vulnerability Testing Configuration page opens
  automatically so you can select the targets for testing.

  You only need to accept the EULA once, before you enable attack
  surface testing for the first time.

  After accepting the terms of the EULA, the
  **Vulnerability Testing Configuration** page opens and you can select
  the set of services to be tested.

  1.  Navigate to Modules \> Attack Surface \> Policies \> Attack
      Surface Tests.

  2.  On the Welcome to Vulnerability Testing page, click **Next**.

  3.  Read the End-User Licensing Agreement and click **Accept Terms**.

3.  Select targets for attack surface testing

- Attack surface testing targets are directly-discovered services, which
  are definitively associated with an asset that belongs to your
  organization. You can choose to run attack surface tests on all your
  relevant directly-discovered services or you can specify a subset of
  services.

  Specify the directly-discovered services upon which Cortex XSIAM will
  run attack surface tests. After the initial set-up, you can update
  this set of targets anytime.

  1.  Navigate to Settings \> Configurations \> Attack Surface \> Attack
      Surface Testing.

  2.  To select specific targets, in the **Target Testing** section,
      make sure the toggle is set to **Selected Targets**, and click
      **Edit Targets** (or **Add Targets** if this is the first time you
      are selecting targets.)

  - To select all the targets, set the toggle to **All Targets**. This
    overrides your target selection.

  3.  Use the filter to define a set of targets from your list of
      services.

  4.  Click **Save Targets**.

After you complete the initial set-up tasks, Cortex XSIAM begins daily
attack surface testing scans.

You can perform the following post-setup tasks to view attack surface
tests and change your attack surface testing configuration.

Enable new attack surface tests by default

You can configure Cortex XSIAM to automatically enable or disable new
attack surface tests when they are introduced. By default Cortex XSIAM
enables new attack surface tests.

1.  Navigate to Settings \> Configurations \> Attack Surface \> Attack
    Surface Testing.

2.  In the **New Vulnerability Tests section**, select **Opt-in** in the
    toggle to enable new tests by default or **Opt-out** to disable new
    tests by default.

View attack surface tests

View information about the available attack surface tests, and enable or
disable tests on the **Vulnerability Testing** page. By default all
tests are enabled.

1.  Navigate to Modules \> Attack Surface \> Policies \> Attack Surface
    Tests.

2.  Filter and sort the list of tests as needed to identify the tests
    you want to enable or disable.

3.  Select one or more tests using the check boxes, and right click to
    **Enable **or **Disable** them.

- Attack surface test field descriptions

  -----------------------------------------------------------------------
  Field                               Description
  ----------------------------------- -----------------------------------
  Affected Software                   Software names and versions
                                      impacted by this vulnerability.

  CWE IDs                             Common Weakness Enumeration ID as
                                      defined by MITRE.

  Created                             When Cortex XSIAM released this
                                      test.

  EPSS Score Description              The Exploit Prediction Scoring
                                      System (EPSS) score indicates the
                                      likelihood that a vulnerability
                                      will be exploited in the wild.
                                      Possible values are 0 -100%.the
                                      higher the score, the greater the
                                      probability that a vulnerability
                                      will be exploited.

  References                          Research references and supporting
                                      documentation.

  Remediation Guidance                Recommended steps for remediating
                                      or mitigating the vulnerability.

  Severity Score                      The CVE severity score is based on
                                      the NIST Common Vulnerability
                                      Scoring System (CVSS).

  Services Found Vulnerable           The number of directly-discovered
                                      services owned by your organization
                                      that Cortex XSIAM has confirmed
                                      vulnerable with this test.

  Status                              Indicates whether the test is
                                      **Enabled** or **Disabled**.

  Vendor Names                        Name of the vendor whose product is
                                      impacted by the vulnerability.

  Vulnerability IDs                   CVE number or other public
                                      identifier for the vulnerability.
  -----------------------------------------------------------------------

View source IP addresses for Attack Surface Testing scans

To view the IP address range Cortex XSIAM uses for vulnerability tests,
navigate to Settings \> Configurations \> Attack Surface \> Attack
Surface Testing and refer to the **Source IP Addresses** section. We
recommend adding this range to your organization\'s security tooling
allow lists to avoid unnecessary alerting; however, we do not recommend
modifying the configuration of your perimeter security controls to allow
this traffic to pass. The aim of Attack Surface Testing is to confirm
the exploitability of vulnerabilities from an attacker perspective.

##### Externally inferred CVEs

Cortex XSIAM identifies *externally inferred CVEs* by comparing the
product name and version of an active service, if identifiable, with
CVEs for those products in the National Vulnerability Database (NVD). We
categorize externally inferred CVE matches as high or medium confidence
based on the version information that is available on the service and
from NVD.

- **High Confidence Match**---Precise version information is available
  both from the service and from NVD. Cortex XSIAM generates issues for
  high-confidence externally inferred CVEs.

- **Medium Confidence Match**---Part of the version information from the
  service matches the NVD entry for the CVE, but the version information
  from the service or from NVD has additional characters. Cortex XSIAM
  creates findings for medium-confidence externally inferred CVEs but
  will not generate issues.

> **Note**
>
> An externally inferred CVE might impact your service or asset, but
> additional investigation is required to confirm that the CVE is
> actually present.

The following table provides examples of externally inferred CVE
matches.

  ----------------------------------------------------------------------------------------------------------------
  Service           CVE information available from NVD                         Match result      Details
  information                                                                                    
  available from                                                                                 
  ASM scan                                                                                       
  ----------------- ---------------------------------------------------------- ----------------- -----------------
  Apache v 2.4.49   CVE-2021-41773Affects                                      High Confidence   Because the CPE
                    cpe:2.3:a:apache:http_server:2.4.49:\*:\*:\*:\*:\*:\*:\*   Match             information from
                                                                                                 NVD matches the
                                                                                                 version of Apache
                                                                                                 indicated from
                                                                                                 the scan, this is
                                                                                                 a high confidence
                                                                                                 match.

  Apache v 2.4.49c  CVE-2021-41773Affects                                      Medium Confidence Because the
                    cpe:2.3:a:apache:http_server:2.4.49:\*:\*:\*:\*:\*:\*:\*   Match             version numbers
                                                                                                 from the service
                                                                                                 and the NVD
                                                                                                 information
                                                                                                 match, except for
                                                                                                 the additional
                                                                                                 character in the
                                                                                                 version from the
                                                                                                 service, this is
                                                                                                 a medium
                                                                                                 confidence match.

  Apache v 2.4.50   CVE-2021-41773Affects                                      No Match          Because the CPE
                    cpe:2.3:a:apache:http_server:2.4.49:\*:\*:\*:\*:\*:\*:\*                     information from
                                                                                                 NVD indicates a
                                                                                                 version of Apache
                                                                                                 that is different
                                                                                                 than the one we
                                                                                                 saw in the scan,
                                                                                                 this does not
                                                                                                 match.

  Apache v 2.4.50   CVE-2022-22719Affects                                      High Confidence   Because the CPE
  (Running on Red   cpe:2.3:a:apache:http_server:\*:\*:\*:\*:\*:\*:\*:\* (up   Match             information from
  Hat Enterprise    to and including 2.4.52)                                                     NVD matches the
  Linux 6 (RHEL6),                                                                               version of apache
  which is not                                                                                   indicated from
  affected by this                                                                               the scan, this is
  CVE)                                                                                           a high confidence
                                                                                                 match. Cortex
                                                                                                 XSIAM cannot
                                                                                                 determine if
                                                                                                 mitigating
                                                                                                 controls are in
                                                                                                 place or the
                                                                                                 underlying OS, so
                                                                                                 this pairing will
                                                                                                 still generate a
                                                                                                 high confidence
                                                                                                 match.

  Apache (any       CVE-2012-3526Affects                                       No match          Because this CVE
  version number)   cpe:2.3:a:apache:http_server:\*:\*:\*:\*:\*:\*:\*:\*                         does not indicate
                                                                                                 any specific
                                                                                                 version number,
                                                                                                 we do not
                                                                                                 consider it a
                                                                                                 match for any
                                                                                                 version of Apache
                                                                                                 http_server,
                                                                                                 regardless of
                                                                                                 version
                                                                                                 information.
  ----------------------------------------------------------------------------------------------------------------

##### Digital Risk Protection

Organizations face significant challenges in safeguarding their brand
and digital assets from threats such as credential theft and brand
impersonation. Using our comprehensive asset inventory, along with
embedded intelligence and automation, Cortex XSIAM Digital Risk
Protection discovers and helps you mitigate the following risks:

- **Brand risk domains**

<!-- -->

- Brand risk domains pose a threat to organizations because they can be
  used by threat actors to deceive customers, partners, or employees by
  impersonating a legitimate brand or application. These domains can be
  used for phishing attacks, spreading malware, launching social
  engineering campaigns, or conducting other fraudulent activities.
  Additionally, malicious brand risk domains can also be used to steal
  sensitive information such as login credentials, financial data, or
  intellectual property.

<!-- -->

- **Leaked credentials**

<!-- -->

- Leaked Credentials pose a risk to organizations by providing
  unauthorized access to sensitive systems and data, leading to data
  breaches, financial losses, and reputation damage.

  Cortex XSIAM focuses on externally reported credential leaks,
  specifically surfacing those that have occurred within the last six
  months.

**How to enable Digital Risk Protection**

Digital Risk Protection is **disabled** by default. You can enable it by
enabling the Brand Risk Domains and Brand Risk Leaked Credentials attack
surface rules. When enabled, these rules generate issues that include
brand risk domain and leaked credential information on the issue details
panel.

1.  Navigate to Modules \> Attack Surface \> Policies \> Attack Surface
    Rules.

2.  Filter the list of attack surface rules by
    **ASM Issue Categories = Brand Protection**.

- ![](media/rId4037.png){width="2.9166666666666665in"
  height="0.959501312335958in"}

3.  Select either or both rules, right-click and select **Enable**.

> **Note**
>
> Both of these attack surface rules are based on the attributed domain
> assets that appear in the asset inventory. If there are no attributed
> domains in your inventory, Cortex XSIAM will not generate Digital Risk
> Protection findings and issues.

#### Attack surface assets

The internet-facing assets that were discovered in a attack surface
management (ASM) scan and attributed to your organization are available
in the inventory on the Inventory \> Assets \> All Assets \> External
Surface pages. For information about **External Surface** assets,
including domains, certificates, services, and websites, see [External
Surface assets](#UUID0d20cdf5cbf4a6de88a1366c0cd19706).

To view your external IP address ranges in the inventory, navigate to
Inventory \> Assets \> Network Configuration \> IP Address Ranges \>
External IP Address Ranges. For information about external IP address
ranges, see [Configure your network
parameters](#UUIDe3a5b326b0bf13c4d129724741eff275).

##### Upload or remove ASM assets

In Cortex XSIAM you can upload assets or remove assets from your
inventory through the UI. This feature simplifies inventory management
by enabling you to to make ad hoc inventory updates yourself as needed.
To make large-scale scope changes to your inventory (for example, a
merger with a new organization), contact your Customer Success Architect
for assistance.

> **Note**
>
> You must have the Instance Administrator role to upload or remove
> assets.

###### Upload assets

You can add assets to your inventory by submitting an asset upload
request, in the form of a CSV file, through the Cortex XSIAM UI. After
submitting an asset upload request, the requested assets will appear in
the **Asset Uploads/Removal** table with the status **Pending Review**.
Cortex XSIAM will respond to your upload request within five days of
submission. The status of each asset will be updated in the
**Asset Uploads/Removal** table to either **Accepted**, which indicates
that the asset has been added to your inventory, or **Rejected**.
Rejected assets will have an explanation for the rejection.

**Guidelines and restrictions for asset uploads**

Before you submit an asset upload request, familiarize yourself with the
following guidelines and restrictions:

- You can upload domains (paid-level domains and subdomains) and IPv4
  ranges. You can upload a single IPv4 address, but it must be submitted
  as an IPv4 range asset type. Upload of certificates and IPv6 ranges is
  not yet supported.

- An asset upload request can include up to 500 assets.

- The asset upload request must follow the CSV formatting requirements
  described in the [CSV format for upload
  requests](#Xd818302cfe02ee021a3d4682c2a79315aaf7a28) section.

- You cannot upload an asset that was added or rejected in a previous
  upload request. This will cause an error that must be fixed before you
  can submit the upload request.

- You cannot upload an asset that was previously removed in an asset
  removal request. Instead you can undo an asset removal request, which
  will result in the asset being added back to your inventory. See
  [/document/preview/1121324#UUID-70761a40-e00e-0086-90ae-f8ad58e838ca](/document/preview/1121324#UUID-70761a40-e00e-0086-90ae-f8ad58e838ca)
  for details.

> **Note**
>
> If an asset upload request has an invalid CSV or includes one or more
> invalid assets, the entire request will fail, and none of the assets
> will be uploaded. If this happens, Cortex XSIAM will display an error
> message indicating what caused the error, so you can fix the problem
> and resubmit if you choose.

**How to submit an asset upload request**

1.  Create and save a CSV file that lists the assets you want to add to
    your inventory. It is important to format the CSV file correctly, or
    the upload might fail. Refer to [CSV format for upload
    requests](#Xd818302cfe02ee021a3d4682c2a79315aaf7a28) for an example
    and details about upload request CSV file formatting.

2.  Navigate to Settings \> Configurations \> Asset Management \> Asset
    Uploads/Removals.

3.  Click the** Asset Upload/Removal** button and select
    **Add Asset(s)**.

4.  Drag and drop or browse to your CSV file to upload it to Cortex
    XSIAM.

- The assets will be added to the **Asset Uploads/Removals** table with
  the status **Pending**,

5.  Check the status of your asset upload request as needed on
    the** Asset Uploads/Removals** page.

- Within five days of submitting your request, each asset will be
  **Accepted **and added to the inventory or **Rejected**. Assets that
  were rejected will include an explanation in the **Decision Reason**
  field.

####### CSV format for upload requests

An asset upload request is a CSV file that lists the assets you want to
add along with the asset types and business units they will be assigned
to. It is important to format the CSV file to match the following
requirements. Incorrect formatting or typos may cause the upload to
fail.

**Upload request example**

This example shows the correct CSV format for an asset upload request,
including the supported values for asset types and supported IP range
notation. The headers in your CSV must match the headers shown here.

  -----------------------------------------------------------------------
  BusinessUnits           AssetType               Asset
  ----------------------- ----------------------- -----------------------
  BU1, BU2                Domain                  example.com

  BU3                     Domain                  example1.com

  BU1                     IP_Range                192.0.2.0/32

  BU2                     IP_Range                192.0.2.0-192.0.2.0

  BU1, BU3                IP_Range                192.0.2.0-192.0.2.24

  BU2, BU3                IP_Range                192.0.2.0/27
  -----------------------------------------------------------------------

**Upload request CSV details**

The following table provides details about each field that is required
in an asset upload request CSV file.

+-----------------------------------+-----------------------------------+
| Field                             | Details                           |
+===================================+===================================+
| Business Units                    | This is the business unit you     |
|                                   | want to assign to the asset upon  |
|                                   | upload.                           |
|                                   |                                   |
|                                   | The header for this field must be |
|                                   | written as **BusinessUnits**.     |
|                                   |                                   |
|                                   | The business units in your CSV    |
|                                   | must already exist in Cortex      |
|                                   | XSIAM and must use the exact same |
|                                   | spelling and capitalization.      |
|                                   |                                   |
|                                   | If you aren\'t sure which         |
|                                   | business units are available in   |
|                                   | your tenant, follow these steps   |
|                                   | to download the complete list of  |
|                                   | business units:                   |
|                                   |                                   |
|                                   | 1.  Go to Settings \>             |
|                                   |     Configurations \> Asset       |
|                                   |     Management \> Asset           |
|                                   |     Uploads/Removals.             |
|                                   |                                   |
|                                   | 2.  In the upper righthand        |
|                                   |     corner, click                 |
|                                   |     the** Asset Upload/Removal**  |
|                                   |     button and select             |
|                                   |     **Asset Upload**.             |
|                                   |                                   |
|                                   | 3.  In the **Add List of Assets** |
|                                   |     dialog box, click on          |
|                                   |     **Business Unit Directory**   |
|                                   |     to download the list of       |
|                                   |     business units.               |
+-----------------------------------+-----------------------------------+
| Asset Type                        | The header for this field must be |
|                                   | written as **AssetType**.         |
|                                   |                                   |
|                                   | Supported values are **Domain**   |
|                                   | and **IP_Range**.                 |
+-----------------------------------+-----------------------------------+
| Asset                             | This is the specific domain or    |
|                                   | IPv4 range you want to add to     |
|                                   | your inventory.                   |
|                                   |                                   |
|                                   | The header for this field must be |
|                                   | written as **Asset**.             |
|                                   |                                   |
|                                   | IP ranges can be specified using  |
|                                   | the following types of notation:  |
|                                   |                                   |
|                                   | - CIDR notation                   |
|                                   |                                   |
|                                   | - \<First IP address\>-\<Last IP  |
|                                   |   address\>                       |
|                                   |                                   |
|                                   | Individual IP addresses can be    |
|                                   | specified using the following     |
|                                   | notation:                         |
|                                   |                                   |
|                                   | - 192.0.2.0/32                    |
|                                   |                                   |
|                                   | - 192.0.2.0-192.0.2.0             |
+-----------------------------------+-----------------------------------+

####### Rejection reasons for upload requests

After submitting an upload request, Cortex XSIAM will accept or reject
each individual asset. Rejected assets will indicate the reason for the
rejection in the **Decision Reason** column of the
**Asset Uploads/Removal** table. Rejection reasons include the
following:

- The asset you uploaded shows registration information that is
  attributable to an unrelated organization.

- The asset you uploaded is currently for sale.

- The asset you uploaded is a cloud IP address or the asset you uploaded
  is a cloud or reserved internal IANA IP address. We do not add these
  asset types to customer maps.

- The asset you uploaded contains your customer's content. Cortex XSIAM
  focuses on corporate infrastructure for our telecommunications, ISPs,
  and other customer leasing organizations.

###### Remove assets

You can remove assets from your inventory by submitting an asset removal
request, in the form of a CSV file, through the Cortex XSIAM UI. After
you\'ve submitted an asset removal request, the requested assets appear
in the **Asset Uploads/Removal** table with the status **Removed**.
Within 24 hours of submitting the request, Cortex XSIAM will remove the
assets from the inventory and remove associated alerts, incidents, and
services,

**Guidelines and restrictions for asset removals**

Before you submit an asset removal request, familiarize yourself with
the following guidelines and restrictions:

- You can remove domains (paid-level domains and subdomains),
  certificates, and IPv4 ranges. Removal of IPv6 ranges is not
  supported.

- The asset removal request CSV file must be less than 2 MB.

- You cannot remove an asset that was uploaded in a previous upload
  request. This will cause an error that must be fixed before you can
  submit the upload request.

- When you remove a paid-level domain, related subdomains are also
  removed.

- When you remove an IPv4 range, the individual IPv4 addresses in that
  range are also removed.

- You can undo a removal request, which will result in the asset being
  added back to your inventory. See
  [/document/preview/1142208#UUID-6cf66e56-fb19-91b7-5f4d-ee234432f381](/document/preview/1142208#UUID-6cf66e56-fb19-91b7-5f4d-ee234432f381)
  for more information.

- Removing assets will not result in a reduction to your contract price.
  Contract pricing will be reevaluated at the time of contract renewal.

> **Note**
>
> If an asset removal request has an incorrectly formatted CSV or
> includes one or more invalid assets, the entire request will fail, and
> none of the assets will be removed. If this happens, Cortex XSIAM will
> display an error message indicating what caused the error, so you can
> fix the problem and resubmit if you choose.

**How to submit an asset removal request**

An asset removal request is a CSV file that lists all the assets you
want to remove from your inventory. It is important that the data and
formatting of the CSV file are correct, or the entire request might be
rejected.

1.  Create and save a CSV file that lists the assets you want to remove
    from your inventory. Be sure to provide the correct asset
    information and follow the formatting requirements described in [CSV
    format for removal
    requests](#X901fc9aec408cc6c871119605e0adce628a2469).

2.  Navigate to Settings \> Configurations \> Asset Management \> Asset
    Uploads/Removals.

3.  Click on the** Asset Upload/Removal** button and select
    **Remove Asset(s)**.

4.  Drag and drop or browse to your CSV file to upload it to Cortex
    XSIAM.

- As soon as the file has been successfully uploaded, the assets will
  appear in the ** Asset Uploads/Removals** table with the status
  **Removed**. Within 24 hours, the assets will be removed from the
  inventory and related incidents, alerts, and services will also be
  removed.

####### CSV format for asset removal requests

An asset removal request is a CSV file that lists the assets you want to
remove from the inventory. It is important to format the CSV file to
match the following requirements. Incorrect formatting or typos may
cause the upload to fail.

**Remove request example**

This example shows the correct CSV format for an asset removal request,
including the supported asset types and IP range notation. The headers
in your CSV must match the headers shown here.

  -----------------------------------------------------------------------
  AssetType                           Asset
  ----------------------------------- -----------------------------------
  Domain                              example.com

  Domain                              example1.com

  IP_Range                            192.0.2.0/32

  IP_Range                            192.0.2.0-192.0.2.0

  IP_Range                            192.0.2.0-192.0.24

  IP_Range                            192.0.2.0/27
  -----------------------------------------------------------------------

**Remove request CSV details**

The following table provides details about each field that is required
in an asset removal request CSV file.

+-----------------------------------+-----------------------------------+
| Field                             | Details                           |
+===================================+===================================+
| Asset Type                        | The header for this field must be |
|                                   | written as **AssetType**.         |
|                                   |                                   |
|                                   | Supported values are **Domain**,  |
|                                   | **IP_Range**, and                 |
|                                   | **Certificate**. Use the          |
|                                   | **IP_Range** asset type to remove |
|                                   | individual IP addresses.          |
+-----------------------------------+-----------------------------------+
| Asset                             | This is the specific domain,      |
|                                   | certificate, or IP range you want |
|                                   | to add to your inventory.         |
|                                   |                                   |
|                                   | IP ranges can be specified using  |
|                                   | the following types of notation:  |
|                                   |                                   |
|                                   | - CIDR notation                   |
|                                   |                                   |
|                                   | - \<First IP address\>-\<Last IP  |
|                                   |   address\>                       |
|                                   |                                   |
|                                   | Individual IP addresses can be    |
|                                   | specified using the following     |
|                                   | notation:                         |
|                                   |                                   |
|                                   | - 192.0.2.0/32                    |
|                                   |                                   |
|                                   | - 192.0.2.0-192.0.2.0             |
+-----------------------------------+-----------------------------------+

####### Undo an asset removal

There may be situations where you want to add an asset back to your
inventory that was previously removed. Cortex XSIAM will not allow you
to upload an asset that was previously removed, but you can undo the
removal to add that asset back to the inventory.

A common use case for undoing a removal is when an IP range has been
removed, but you want to add back an IP address that falls within that
range. In that case you can undo the removal of the range, and then
submit a new removal request for the ranges before and after the IP
address that you want to add back. For example, if you removed IP range
192.0.2.0 -192.0.2.24, but then realized you need to include 192.0.2.10
in your inventory, you would:

1.  Undo the removal for IP range 192.0.2.0 -192.0.2.24.

2.  Submit a new asset removal request that includes IP ranges
    192.0.2.0 - 192.0.2.9 and 192.0.2.11 - 192.0.2.24

**How to undo an asset removal**

1.  Navigate to Settings \> Configurations \> Asset Management \> Asset
    Uploads/Removals.

2.  In the **Asset Uploads/Removals** table, find the asset you want to
    add back to the inventory. An asset must be in the **Removed **state
    to undo the removal (and add it back to the inventory).

3.  Right-click the row and select **Undo Asset Removal**. Click
    **Yes **to confirm the removal.

- After confirming the Undo Asset Removal action, the asset will no
  longer appear in the table.

#### Deploy ASM and Exposure Management enrichment and remediation automation

The Cortex Exposure Management pack enables you to automate attack
surface management (ASM) and vulnerability issue enrichment and
remediation. This content pack includes playbooks that streamline the
remediation process by enriching issues with contextual information
gathered from out-of-the-box integrations with sources like CMDBs, Cloud
Service Providers, and VM solutions, and by automatically remediating
some types of ASM and runtime vulnerability issues.

> **Note**
>
> For details and requirements regarding the enrichment information that
> can be collected and the specific issues that can be remediated
> automatically, review the Exposure Management Content Pack information
> in Marketplace.

Complete the tasks below to enable automated enrichment and remediation
of ASM and vulnerability issues.

##### Task 1. Install the Cortex Exposure Management content pack

Install the Cortex Exposure Management content pack and, optionally, the
related content packs.

1.  Navigate to Marketplace \> Browse and locate the Cortex Exposure
    Management content pack.

2.  Select the content pack and review the contents and other details.

3.  Click **Install** to add the content pack to the **Cart**.

- The **Cart **displays the number of items you are installing,
  including any additional required content packs. It also displays
  relevant optional content packs.

4.  (Optional) Select the related content packs you want to install, for
    example ServiceNow and AWS Enrichment and Remediation.

5.  Click **Install**.

##### Task 2. Add automation rules for ASM and vulnerability issue enrichment and remediation

Add the automation rules for exposure management issue remediation and
enrichment. Automation rules trigger the Cortex Exposure Management
playbooks to run on ASM and vulnerability issues. To learn which issues
will trigger the playbooks, review the automation rules.

1.  Navigate to Investigation & Response \> Automation \> Automation
    Rules.

2.  Click **View Recommendations**.

3.  Select one or more of the Cortex Exposure Management automation
    rules.

4.  Click **Add Selected Rules**.

##### Task 3. Set up integrations

Install and configure relevant 3rd-party integrations, such as
ServiceNow and AWS, to enable the Cortex Exposure Management playbooks
to collect enrichment information and to automatically remediate some
issues.

1.  Navigate to Settings \> Configurations \> Data Collection \>
    Automation & Feed Integrations.

2.  For the integration you want to add, click **Add Instance**.

3.  Add the parameters, as required.

4.  **Save & Exit**.

See the Exposure Management Content Pack for a list of supported
integrations. See [Automation and Feed
Integrations](https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM/Cortex-XSIAM-Premium-Documentation/Automation-and-feed-integrations?tocId=H1gu%7EV_kzEFpGVOhpDgaTQ)
for more detailed information about setting up integrations.

##### Task 4. Configure vulnerability policies

The Cortex Exposure Management playbooks run on specific types of
issues. Review your vulnerability policies to make sure issues are being
created for relevant vulnerability findings. For information about
vulnerability policies and how to configure them, see [Vulnerability
policies](https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM/Cortex-XSIAM-Premium-Documentation/Vulnerability-policies).

> **Note**
>
> Cortex Exposure Management playbooks only run on issues that were
> created after the automation rules have been configured.

#### ASM enrichment of cloud assets

Attack Surface Management (ASM) enrichment of cloud assets brings ASM
capabilities to cloud security posture management, providing visibility
into all the assets in your cloud infrastructure that are exposed to the
internet.

ASM enrichment of cloud assets includes the following capabilities:

- **Discovery of unmanaged cloud services**: Identify internet-exposed
  cloud services that are unmanaged, so you can onboard them into Cortex
  XSIAM for comprehensive cloud security and policy enforcement.

- **Confirmation of internet exposure:** ASM internet scan data is used
  to reinforce CNA detections to provide high-confidence detections of
  inadvertent internet exposure. This joint approach combines inside-out
  and outside-in assessments to reduce false-positives.

- **Monitoring of managed and unmanaged cloud services**: Gain ongoing
  visibility into the risks on cloud services through regular ASM scans
  and issues and findings for cloud-related attack surface detections.

##### What is unmanaged cloud?

**Managed cloud**---Cloud services that were discovered in an ASM scan
and can be correlated with preexisting cloud assets that have been
onboarded into your asset inventory. For example, if an ASM scan finds a
service on AWS that is also in your cloud inventory, the asset is
considered a managed cloud asset.

**Unmanaged cloud**---Cloud services that were discovered by an ASM
scan, were attributed to you based on domain, subdomain, or TLS
certificate, but cannot be correlated to the IPs or FQDNs of any
onboarded cloud assets. For example, if a scan detects a service on an
Azure asset that has not been onboarded into your cloud inventory, it is
considered an unmanaged cloud asset.

If an ASM scan finds a service on HiNet or some other unsupported cloud
provider, it is considered \"not applicable\" because it cannot be
onboarded and converted to a managed asset.

##### Review your unmanaged cloud services

Review your unmanaged cloud services in your **External Surface**
inventory. Unmanaged cloud services are cloud services that were
discovered in an ASM scan and cannot be correlated with cloud assets
that were previously onboarded into your inventory.

1.  Navigate to Inventory \> Assets \> All Assets \> External Surface \>
    Services.

2.  On the **Service Inventory** page, filter the list of services using
    the filter **Partially Onboarded** **=** **Yes**.

##### Review unmanaged cloud issues

The attack surface rule Unmanaged Cloud Service creates findings when
ASM scans detect unmanaged cloud services. This rule is enabled by
default, which means it will also create issues. Perform these steps to
view your unmanaged cloud issues:

1.  Navigate to Cases & Issues \> Issues.

2.  Filter the Issues table using the filter **Attack Surface Rule ID**
    **=** **UnmanagedCloudService**.

3.  Click on an issue to display the issue details, including the
    unmanaged cloud service information.

#### Emerging Vulnerabilities

> **Note**
>
> Requires the ASM add-on

The **Emerging Vulnerabilities** page streamlines your response to
global attack surface threat events and zero-day exploits by aggregating
the most important information about a threat and its impact on your
organization in one place. From **Emerging Vulnerabilities**, you can
accomplish the following:

- **Review a curated list of emergent and global threat events**, and
  quickly identify the events that impact your organization. The list
  displays key information about each threat, such as CVSS and EPSS
  scores, and is sorted by the **Last Policy Update** date.

- **Research a threat event**. Our security research team provides a
  threat summary, potential exploit consequences, previous exploit
  activity, and links to other reputable sources for additional
  information.

- **Assess the impact of a threat event on your organization**. Quickly
  identify services on your external attack surface impacted by emerging
  vulnerabilities. Review a detailed list of the affected software, turn
  on relevant attack surface rules, and access relevant issues, assets,
  and attack surface test results.

- **Build a Remediation Plan**. The **Emerging Vulnerabilities** page
  provides remediation guidance for each event and click-throughs to
  issues to begin remediation.

> **Note**
>
> You must have a role with Attack Surface Rules permission to access
> the **Emerging Vulnerabilities** page. When setting up Roles Based
> Access Control (RBAC), you can find Attack Surface Rules in the
> Detection & Threat Intel component.

**How to view emerging vulnerabilities**

1.  Navigate to Posture Management \> Vulnerability Management \>
    Emerging Vulnerabilities.

2.  Click anywhere in the row of a threat event to open the details
    page.

3.  Review the information on this page to learn about the threat event
    and build a remediation plan for your organization.

##### Which vulnerabilities are included in Emerging Vulnerabilities?

Typically, an emerging vulnerability is a critical or high-risk
vulnerability that allows threat actors direct access to assets, leading
to widespread impact across corporate networks. Devices and applications
impacted by such vulnerabilities are at risk of exploitation remotely
over the public-facing internet. These threats often allow threat actors
to gain remote control of systems. 

Cortex XSIAM considers the following questions when evaluating the level
of risk of a threat event and whether to include it on the Emerging
Vulnerabilities page:

- Is it a vulnerability without a patch?

- Is it a "Known Exploitable Vulnerability" that has been weaponized by
  threat actors?

- Can it be exploited remotely over the internet in an unauthenticated
  manner?

- Is a proof of concept readily available? Has active exploitation in
  the wild been reported?

- How widespread is the impact of the vulnerability? Does it impact many
  organizations or is limited to a certain section of the industry?

- Is the vulnerability in an application or device that is routinely
  targeted by attackers?

- Does it have a vendor severity rating of "Critical" or "High"? Does it
  have a CVSS score of 9 or higher?

- Are there geo-political factors in play? (For example, is an APT
  targeting groups or individuals from specific countries or regions?)

##### How often is the Emerging Vulnerabilities page updated?

Our security research team creates and updates threat events in the
**Emerging Vulnerabilities** page in the following situations:

- When a new threat event occurs and the security research team
  determines the event is critical enough to add to
  **Emerging Vulnerabilities**.

- When new information is discovered for existing threat events. The
  information on an Emerging Vulnerabilities page is updated frequently
  as a threat evolves and exploit details are made public.

#### Global Lookup

Global Lookup enables you to query any IPv4 or IPv6 address or domain
and analyze the last seven days of internet scan data. This data is
enriched with registration information, geolocation, related
certificates, observed services, ASNs, and passive DNS records. Global
Lookup is not limited to your own attack surface, allowing you to
investigate any IP address or domain globally. This provides clarity on
indicator ownership and faster analysis of potentially malicious
indicators.

1.  Navigate to Modules \> Attack Surface \> Global Lookup.

2.  Enter an IP address or domain in the Search box.

### Cloud Workload Policies and Rules

Cloud Workload Policies and Rules help organizations maintain security
compliance, prevent misconfigurations, and reduce risks across cloud
environments.

- **Cloud Workload Policies** define organizational security objectives
  by combining detection logic with preventive actions across selected
  asset scopes. Policies can generate issues and proactively block
  misconfigurations before they reach runtime, ensuring workloads remain
  compliant with security requirements throughout the Software
  Development Life Cycle (SDLC). They leverage identified security risks
  and enforce controls at the right stages of development and
  operations, such as during CI pipelines or in runtime environments.

- **Cloud Workload Rules** define the detection logic for
  misconfigurations and their applicable asset types, specifying the
  criteria and conditions used to identify security risks. These rules
  can be selected and enforced through Misconfiguration Policies within
  the designated policy asset scope.

Together, Policies define which risks must be addressed and what actions
to take, while Rules specify how those risks are detected through
precise logic and conditions.

> **Prerequisite**
>
> Users need **View/Edit** RBAC permissions (under Policies \> Compute
> Policies) or the **Instance Administrator** role to view, edit, and
> modify Cloud Workload Policies.
>
> **Important**
>
> Users with SBAC granular scoping (in addition to the RBAC permissions
> required for Cloud Workload Policies) can only view Cloud Workload
> Policies, when their access is scoped to any of the available options:
> **All assets**, **No assets**, or **Select asset groups**. For more
> information on granular scoping, see [Manage user
> scope](#UUID071cdbb66c6a6afe3a671fa79991a0a8). When no SBAC
> restriction is applied, the user's access is determined solely by
> their RBAC permissions.

#### How policies and rules work together

 

*Cloud Workload Policies *serve as enforcement mechanisms that govern
the responses to the identified findings, whereas *Cloud Workload Rules*
establish the criteria for evaluation but do not initiate any actions
unless incorporated within a policy. 

In the absence of an associated policy, rules exist solely as evaluative
criteria and do not generate alerts or trigger any response actions.
Policies determine how findings from rules are escalated to issues or
preventive measures.

#### Cloud Workload Policies

Cloud Workload Policies help you prevent and manage security violations
in your cloud runtime instances. They enable you to apply detection
logic to specific asset groups at the desired SDLC stage, and define
what action needs to be taken if the conditions are met.

Depending on the nature of the security violation, a Cloud Workload
Policy allows you to

- *Prevent the violation*. For example: Block an S3 bucket deployment
  that is open to the public.

- *Create an issue*. For example: Create an issue when an AWS credential
  file is found on a Linux server.

A Cortex Cloud Workload Policy has the following elements:

- **SDLC Evaluation Stage:** The SDLC stage at which the policy is
  applied and evaluated. Depending on the policy type, one or more of
  the following stages may be available:

  - **CI:** The stage during which a pipeline builds the artifact. After
    building the artifact, the pipeline pushes it to a registry.

  - **Deploy:** The stage when the artifact is pushed to a cloud
    instance for running.

  - **Runtime:** The stage when the artifact is running on a cloud
    instance.

- **Rule(Conditions):** The logical conditions that will trigger the
  evaluation of this policy.

- **Scope:** A filter specifying which assets the rule applies to.

- **Action:** The response triggered when the rule evaluates
  successfully (only when part of a policy). Based on the rules included
  in the policy, it can create an issue or prevent the security
  violation.

- **Severity:** The selected value is included in issues that are
  created for violations of the policy.

##### Types of Cloud Workload Policies

- **Misconfiguration policies:** Enable you to assess different
  workloads for misconfiguration with the relevant security standards
  and with your organizations security guidelines as per your
  requirements. You can include custom and predefined rules in these
  policies and create issues for violations.

- **Malware policies:** Enable you to detect and manage malicious files
  within cloud workloads. These policies analyze files based on
  predefined conditions such as file name, path, size, and detection
  method.

- **Secret policies:** Enable you to identify and protect sensitive
  data, such as API keys and credentials within the workloads.

##### Cloud Workload Policies page

The **Cloud Workload Policies** page allows users to manage policies
that define security and compliance actions for cloud workloads. Users
can create, edit, filter, and manage policies through a structured table
and widget panel.

> **Note**
>
> Keep the following caveats in my mind when working with Policies:

- > Instance Administrators are able to view all facets of Policies
  > without restrictions, even if Scope Based Access Control (SBAC)
  > roles are in effect. Learn more about
  > [SBAC](#UUID071cdbb66c6a6afe3a671fa79991a0a8).

- > If you've been assigned a custom role with View/Edit permissions
  > limited by SBAC, you may not be able to view certain Policies.

- > You can further narrow your search on the Inventory page by using
  > SBAC to limit the scope of the finding, issues, and case counts.

The Cloud Workload Policies page displays all the configured policies
with the following fields.

**Policy table columns**

  ----------------------------------------------------------------------------------------
  **Field**                           **Description**
  ----------------------------------- ----------------------------------------------------
  **Type**                            Defines the policy category:
                                      **Misconfiguration, Secrets, Malware**.

  **Evaluation Stage**                Indicates at which stage in the **SDLC** the policy
                                      is evaluated.

  **Policy Name**                     The user-defined name of the policy.

  **Action**                          Defines the action taken when conditions match:
                                      **Create an Issue** (logs an issue) or
                                      **Prevent and Create an Issue** (prevents the action
                                      and logs an issue).

  **Issue Severity**                  The severity level of the issue created:
                                      **Critical, High, Medium, Low, or Informational**.

  **Conditions**                      Logical statements that determine how the policy
                                      evaluates findings.

  **Asset Groups**                    Predefined groups of assets to which the policy
                                      applies.

  **Open Issues**                     The number of unresolved issues associated with the
                                      policy.

  **Description**                     Additional details about the policy.

  **Created By**                      The user who created the policy.

  **Last Modified**                   The timestamp of the last modification.
  ----------------------------------------------------------------------------------------

###### Widgets panel

The **Cloud Workload Policies** page includes a widget panel that
provides a visual summary of policies:

- **Policies by Type:** Displays policies categorized as
  misconfiguration, secret, or malware.

- **Policies by Evaluation Stage:** Shows the distribution of policies
  based on SDLC evaluation stages: Runtime, Deploy, or CI.

####### Show or hide the widget panel

The widget panel provides a visual summary of policies based on policy
type or evaluation stage.

To hide the widget panel, do the following:

1.  Navigate to **Posture Management** \> **Rules & Policies** \>
    **Policies** \> **Cloud Workload**.

2.  On the **Cloud Workload Policies** page, click the **Widget Panel**
    icon at the top of the page.

3.  The panel toggles between visible and hidden states.

###### Filter page results

See ***Filter page results*** to get information about how to filter the
list of policies.

###### Change the layout of the policies table

1.  Navigate to **Posture Management** \> **Rules & Policies** \>
    **Policies** \> **Cloud Workload**.

2.  In the **Cloud Workload Policies** page, click the **More Options**
    icon (**⋮**).

3.  In the **Layout** tab, do the following:

    - To remove columns, go to the **In View** section and search for a
      specific column. Click **-** next to the column to remove it from
      the table.

    - To reorder columns, go to the **In View** section. Click and drag
      columns up or down to rearrange the columns.

    - To add new columns, go to the **Add Columns** section. Click **+**
      next to the columns to include them in the table.

4.  The table layout updates automatically based on your selections.

###### Policy Details Panel

The policy details panel is displayed when you click a policy in the
policy table. To view details of a cloud workload policy:

1.  Navigate to **Posture Management** \> **Rules & Policies** \>
    **Policies** \> **Cloud Workload**.

2.  In the **Cloud Workload Policies** page, select the policy you want
    to check.

The policy panel displays the following details related to the selected
policy:

- Policy details.

- Related rule settings.

- The number of issues opened as part of the policy. You can click on
  the link to navigate to the **Issues and Cases **section to check the
  issue details.

From the policy detail panel, you can:

- Enable or disable the policy

- Edit the policy

- Save as new

- Delete the policy

##### Enable or disable a Cloud Workload Policy

1.  Navigate to **Posture Management** \> **Rules & Policies** \>
    **Policies** \> **Cloud Workload**.

2.  In the **Cloud Workload Policies** page, click on the policy you
    want to enable or disable.

3.  In the **Details** page, click the toggle button at the top to
    enable or disable the policy.

##### Create a Cloud Workload Policy

You can create policies on the type of threats or compliance
requirements that must be addressed.

To create a cloud workload policy:

1.  Navigate to **Posture Management** \> **Rules & Policies** \>
    **Policies** \> **Cloud Workload**

2.  In the Cloud Workload Policy page, click **+ Create Policy** and
    select the type of policy you want to create:

    a.  Misconfiguration

    b.  Malware

    c.  Secret

3.  On the **General** section,

    a.  Enter a unique name and description.

    b.  Select an **SDLC Evaluation Stage**. Depending on the type of
        policy you are creating, one or more of the following options
        are available.

        - **CI** (Only available for Malware and Secret policies)

        - **Runtime** (available for all policy types)

        - **Deploy** (Only available for Malware and Secret policies)

    c.  Click **Next**.

4.  On the **Define conditions** page, select the conditions that you
    want to track and prevent. Depending on the type of policy, you are
    presented with:

    a.  A list of rules (for Misconfiguration policies), or

    b.  A Query builder (for Secret and Malware policies).

- For a new Misconfiguration policy, select the rules that identify the
  violations that you want to track.

  In the case of Secrets or Malware related violations, predefined
  engines identify the violations and create the necessary findings. You
  can create new Secret or Malware policies to inspect these findings
  and evaluate the relevant attributes of a finding to take the desired
  action.

5.  Click **Next** after adding the desired rules or conditions.

6.  In the **Define Scope** section,

    a.  Use the filter panel to filter the list and select the asset
        groups you want to apply the policy to. Select one or more
        **Asset Groups **where the policy will apply.

    b.  Click **Next**.

7.  In the **Define action** section,

    a.  For** Select an action**, choose the option to
        **Create an issue** to log an issue if the policy is violated.

    b.  Under **Issue Severity**, choose
        **Critical, High, Medium, or Low** to define the issue severity.

    c.  In the **Remediation Guidance** box, enter optional remediation
        instructions. Issues are automatically resolved when the finding
        is no longer applicable to the asset or when the affected asset
        is removed from the inventory.

    d.  Click **Done** to complete the process and create the new Cloud
        Workload Policy.

##### Use an existing policy to create a new Cloud Workload policy

1.  Navigate to **Posture Management** \> **Rules & Policies** \>
    **Policies** \> **Cloud Workload**.

2.  In the **Cloud Workload Policies** page, click the policy you want
    to enable or disable.

3.  In the **Details** page, click the **More Options** icon (**⋮**) and
    then select **Save as new**.

4.  Modify the necessary fields in the
    **Policy Name, Conditions, Scope,** and **Actions** screens.

5.  Click **Done** to create the new custom policy.

##### Edit a Cloud Workload Policy

1.  Navigate to **Posture Management** \> **Rules & Policies** \>
    **Policies** \> **Cloud Workload**.

2.  In the **Cloud Workload Policies** page, click the policy you want
    to enable or disable.

3.  In the **Details** page, click the **Edit** icon.

4.  Make the necessary changes.

5.  Click **Done** to save the changes.

##### Delete a Cloud Workload Policy

1.  Navigate to **Posture Management** \> **Rules & Policies** \>
    **Policies** \> **Cloud Workload**.

2.  In the **Cloud Workload Policies** page, click the policy you want
    to delete.

3.  In the **Details** page, click the **More Options** icon (**⋮**) and
    then select **Delete policy**.

4.  Click **Delete** to confirm.

#### Cloud Workload Rules

**Rules**: Cloud Workload Rules define the criteria for identifying
security violations. This criteria can be applied to assets in your
cloud environment and to findings generated by Cortex Cloud.

Rules only enable the detection of security violations. They must be
included in a policy to trigger a preventive response or generate an
alert in the form of an issue.

##### Default (pre-defined) Rules

Cortex Cloud includes a number of pre-defined rules to secure your cloud
runtimes. These rules are used by default policies to prevent security
violations and create issues.

##### Custom (user-defined) Rules

Custom Rules or Custom Detection Rules allow you to define and implement
tailored security and compliance checks within cloud workloads. These
rules enable organizations to detect specific conditions,
vulnerabilities, or misconfigurations that might not be covered by
built-in system rules.

A custom rule consists of the following components:

- **Scanner:** Defines the mechanism by which the rule inspects the
  cloud assets. You need to select the scanner type that will implement
  the rule. Every time the selected scanner runs, all the rules
  associated with that scanner are also executed. The available scanner
  types are:

  - **Agentless Disk Scan:** Rules that use Agentless Disk Scanner to
    inspect the container images on which the Agentless scanner runs.
    You can specify different rules for containers running different
    OSes. For example, you can create a rule that checks for incorrect
    or malicious entries in the etc\\hosts file on Windows images.

  - [**Kubernetes
    Connector:**](https://docs-cortex.paloaltonetworks.com/r/Cortex-XDR/Cortex-XDR-Cloud-Documentation/What-s-new-in-Kubernetes-Connector)
    Rules that use the Kubernetes Connector scanner to inspect
    Kubernetes environment variables and resources such as Namespaces,
    ReplicaSets, Deployments and more.

  - [**XDR
    Agent:**](https://docs-cortex.paloaltonetworks.com/r/Cortex-XDR/Cortex-XDR-Cloud-Documentation/Install-Cortex-XDR-agents) Rules
    that use XDR Agent Scanner to perform custom compliance checks by
    executing user-defined Python scripts, offering a tailored approach
    to compliance validation.

- **Rule (Condition):** Defines the detection criteria. This is
  specified as Rego or Python statements that evaluate assets, findings,
  and their associated attributes to identify security violations based
  on the selected scanner.

- **Severity:** The selected value is included in issues that are
  created as a result of rule violation.

- **Compliance Controls:** Associates the custom rule with a custom
  compliance control. If the rule detects the security violation, it
  will invoke the corresponding compliance control, thereby including
  the violation in relevant compliance reports.

##### Cloud Workload Rules page

The **Cloud Workload Rules** page allows users to manage rules. Users
can create, edit, filter, and manage rules.

> **Note**
>
> Keep the following caveats in my mind when working with Rules:

- > Instance Administrators are able to view all facets of Rules without
  > restrictions, even if Scope Based Access Control (SBAC) roles are in
  > effect. Learn more about
  > [SBAC](#UUID071cdbb66c6a6afe3a671fa79991a0a8).

- > If you've been assigned a custom role with View/Edit permissions
  > limited by SBAC, you may not be able to view specific Rules.

- > You can further narrow your search in a Rules table by using SBAC to
  > limit the scope of the finding, issues, and case counts.

The Widget section enables the users to get \'at-a-glance\' based on
**Platform**, **Rule type** and **Scanner** type.

The Cloud Workload Rules page displays both the default rules and
user-configured rules, with the following fields.

**Rule table columns**

  -----------------------------------------------------------------------
  Column Name                         Description
  ----------------------------------- -----------------------------------
  **Rule ID**                         A unique identifier assigned to
                                      each rule.

  **Rule Name**                       The name of the rule, typically
                                      defined by the user or system.

  **Description**                     A brief summary of the rule\'s
                                      purpose and functionality.

  **Policies**                        Lists the policies in which the
                                      rule is included.

  **Controls**                        Compliance controls associated with
                                      the rule for regulatory adherence.

  **Platform**                        Specifies the platform or
                                      environment the rule applies to.
                                      For example, Linux or Windows.

  **Scanner**                         The tool or method used to evaluate
                                      findings, such as agentless, or
                                      Kubernetes Connector.

  **Severity**                        Defines the severity of the rule.

  **Data Type**                       The type of data the rule
                                      evaluates. For example, Secrets,
                                      Malware, or Compliance.

  **Compliance Violation**            Indicates whether a rule can
                                      trigger a compliance violation when
                                      conditions are met.

  **Created By**                      The user who created the rule.

  **Last Modified**                   The date and time the rule was last
                                      updated.

  **Rule Type**                       Indicates whether the rule is a
                                      **Built-in** or **Custom** rule.

  **Remediation**                     Defines the remediation steps to
                                      address the detected
                                      misconfiguration.
  -----------------------------------------------------------------------

###### Filter page results

See ***Filter page results*** to get information about how to filter the
list of policies.

###### Change the layout of the rules table

1.  Navigate to **Posture Management \> Rules \> Cloud Workload**.

2.  In the **Cloud Workload Rules** page, click the **More Options**
    icon (**⋮**).

3.  In the **Layout** tab, do the following:

    - To add or remove columns, search for a specific column and:

      - Click **+** to add it to the table.

      - Click **-** to remove it from the table.

    - To reorder columns, go to the **In View** section and
      **click and drag** columns up or down.

    - To add new columns, go to the **Add Columns** section and click
      **+** to include them in the table.

4.  The table layout updates automatically based on your selections.

###### Rule details panel

The rule panel displays the following details related to the selected
rule:

- Details of the rule like scanner details, remediation details and
  more.

- Compliance Controls for the rule.

This panel enables you to:

- Edit the rule

- Save as new

- Delete the rule

##### Create a new Custom Detection Rule

Creating a Custom Detection Rule (CDR) provides increased flexibility
for defining and enforcing security best practices. It enables you to
customize compliance requirements to suit your specific needs, ensuring
alignment with organizational goals and regulatory standards. For
example, you can create a rule to run periodic checks on an asset to
evaluate whether it adheres to a specific requirement.

**Before you begin**

Ensure you have a custom compliance control defined to associate the
Custom Detection Rule to. For more information, see
[/document/preview/1345689#UUID-534080f2-2697-630d-4618-ba39f1d08093](/document/preview/1345689#UUID-534080f2-2697-630d-4618-ba39f1d08093).

**How to create a Custom Detection Rule**

1.  Go to **Posture Management** \> **Rules & Policies** \> **Rules** \>
    **Cloud Workload**.

2.  In the **Cloud Workload Rules** page, click **Create Custom Rule**.

3.  Enter the following settings:

    - **Rule name**: A descriptive name for the custom rule.

    - **Description**: An optional field for adding additional details
      or context about the rule, such as its purpose or intended
      behavior.

4.  Select a **Scanner** to execute the Custom Detection Rule and its
    associated script. The options are:

    - **Agentless Disk Scan**

    - **Kubernetes Connector**

    - **XDR Agent**

5.  Configure settings specific to the scanner you select.

- Agentless Disk Scan settings

+-----------------------------------+-----------------------------------------------------------------------------------+
| Field                             | Description                                                                       |
+===================================+===================================================================================+
| **Operating System**              | The operating system targeted by the rule. The available options are:             |
|                                   |                                                                                   |
|                                   | - Linux                                                                           |
|                                   |                                                                                   |
|                                   | - Windows                                                                         |
+-----------------------------------+-----------------------------------------------------------------------------------+
| **Input file(s) path**            | The full file path for one or more files. For example,                            |
|                                   | `/nfs/an/disks/jj/home/dir/file.txt`                                              |
+-----------------------------------+-----------------------------------------------------------------------------------+
| **Define the Rule (Rego)**        | Use Rego to define the custom detection logic.                                    |
|                                   |                                                                                   |
|                                   | Use the default code in this box as a reference or starting point. Click [read    |
|                                   | here](https://www.openpolicyagent.org/docs/latest/policy-language/#learning-rego) |
|                                   | for more information how to use Rego syntax.                                      |
+-----------------------------------+-----------------------------------------------------------------------------------+

- Kubernetes Connector settings

+-----------------------------------+-----------------------------------------------------------------------------------+
| Field                             | Description                                                                       |
+===================================+===================================================================================+
| **Kubernetes Resources**          | From the drop down, select one or more from the following:                        |
|                                   |                                                                                   |
|                                   | - **Namespaces**: Logical partitions within a Kubernetes cluster that allow       |
|                                   |   resource isolation and organization.                                            |
|                                   |                                                                                   |
|                                   | - **ReplicaSets**: Ensures a specified number of pod replicas are running at all  |
|                                   |   times by automatically scaling up or down.                                      |
|                                   |                                                                                   |
|                                   | - **Deployments**: Manages and control pod replicas by providing declarative      |
|                                   |   updates for ReplicaSets, enabling rolling updates and rollbacks.                |
|                                   |                                                                                   |
|                                   | - **StatefulSets**: Deploys stateful applications that require persistent         |
|                                   |   identity and storage, ensuring stable pod names and ordered scaling.            |
|                                   |                                                                                   |
|                                   | - **DaemonSets**: Ensures that a copy of a specific pod runs on all or selected   |
|                                   |   nodes in the cluster, commonly used for logging and monitoring agents.          |
|                                   |                                                                                   |
|                                   | - **Jobs**: Runs one-time or short-lived workloads that complete execution and    |
|                                   |   then terminate.                                                                 |
|                                   |                                                                                   |
|                                   | - **CronJobs**: Defines scheduled jobs that run at specified times or intervals,  |
|                                   |   similar to Linux cron jobs.                                                     |
|                                   |                                                                                   |
|                                   | - **ClusterRoles**: Defines permissions at the cluster level, granting access to  |
|                                   |   resources across all namespaces.                                                |
|                                   |                                                                                   |
|                                   | - **Roles**: Defines permissions within a specific namespace, restricting access  |
|                                   |   to resources within that namespace.                                             |
|                                   |                                                                                   |
|                                   | - **RoleBindings**: Associates a role with a user, group, or service account      |
|                                   |   within a specific namespace.                                                    |
|                                   |                                                                                   |
|                                   | - **ClusterRoleBindings**: Associates a cluster role with users, groups, or       |
|                                   |   service accounts at the cluster-wide level.                                     |
|                                   |                                                                                   |
|                                   | - **NetworkPolicies**: Defines rules that control the communication between pods  |
|                                   |   and other network entities within the cluster, enforcing security restrictions. |
|                                   |                                                                                   |
|                                   | - **Services**: Exposes a set of pods as a network service, allowing stable       |
|                                   |   communication within and outside the cluster.                                   |
|                                   |                                                                                   |
|                                   | - **ServiceAccounts**: Provides an identity for pods to authenticate against the  |
|                                   |   Kubernetes API, allowing controlled access to resources.                        |
|                                   |                                                                                   |
|                                   | - **Endpoints**: Represents the actual network addresses of the pods backing a    |
|                                   |   service, dynamically updated as pods start or stop.                             |
|                                   |                                                                                   |
|                                   | - **Ingresses**: Manages external access to services, providing HTTP/HTTPS        |
|                                   |   routing, load balancing, and SSL termination.                                   |
|                                   |                                                                                   |
|                                   | - **ConfigMaps**: Stores non-sensitive configuration data in key-value pairs,     |
|                                   |   allowing applications to retrieve configuration without modifying container     |
|                                   |   images.                                                                         |
|                                   |                                                                                   |
|                                   | - **Secrets**: Securely stores and manage sensitive data, such as API keys,       |
|                                   |   passwords, and certificates, in an encrypted format.                            |
|                                   |                                                                                   |
|                                   | - **Nodes**: Defines the physical or virtual machines that run the workloads in a |
|                                   |   Kubernetes cluster.                                                             |
+-----------------------------------+-----------------------------------------------------------------------------------+
| **Define the Rule (Rego)**        | Use Rego to define the custom detection logic.                                    |
|                                   |                                                                                   |
|                                   | Use the default code in this box as a reference or starting point. Click [read    |
|                                   | here](https://www.openpolicyagent.org/docs/latest/policy-language/#learning-rego) |
|                                   | for more information how to use Rego syntax.                                      |
+-----------------------------------+-----------------------------------------------------------------------------------+

- XDR Agent settings

+-----------------------------------+--------------------------------------+
| Field                             | Description                          |
+===================================+======================================+
| **Custom Code Execution**         | Enable this setting for the scanner  |
|                                   | to perform custom compliance checks  |
|                                   | by executing user-defined Python     |
|                                   | scripts.                             |
|                                   |                                      |
|                                   | > **Note**                           |
|                                   | >                                    |
|                                   | > Only users with the following      |
|                                   | > roles can enable or                |
|                                   | > disable **Custom Code Execution**: |
|                                   |                                      |
|                                   | - > Account Admin                    |
|                                   |                                      |
|                                   | - > Instance Administrator           |
|                                   |                                      |
|                                   | - > Deployment Admin                 |
|                                   |                                      |
|                                   | - > Privileged Security Admin        |
|                                   |                                      |
|                                   | Click **Confirm** to accept the      |
|                                   | following terms:                     |
|                                   |                                      |
|                                   | - The Python scripts you provide     |
|                                   |   will be executed in your cloud     |
|                                   |   environment(s).                    |
|                                   |                                      |
|                                   | - This capability is solely for the  |
|                                   |   purpose of enabling you to define  |
|                                   |   the compliance check rules for     |
|                                   |   your cloud environment(s). Any     |
|                                   |   other purposes are expressly       |
|                                   |   prohibited.                        |
|                                   |                                      |
|                                   | - Any actions involving WRITE,       |
|                                   |   MODIFY, or DELETE operations of    |
|                                   |   your cloud environment(s) are      |
|                                   |   strictly prohibited. It is your    |
|                                   |   responsibility to ensure that your |
|                                   |   custom Python scripts only perform |
|                                   |   read-only operations of your cloud |
|                                   |   environment(s) explicitly for      |
|                                   |   compliance check purposes.         |
|                                   |                                      |
|                                   | - You are solely responsible for the |
|                                   |   quality, content, use, and         |
|                                   |   execution results of your Python   |
|                                   |   script. You assume all risks and   |
|                                   |   liabilities arising from executing |
|                                   |   your Python script(s), including   |
|                                   |   any potential errors, damages, or  |
|                                   |   consequences resulting from its    |
|                                   |   use.                               |
|                                   |                                      |
|                                   | After you confirm accepting the      |
|                                   | terms, the rest of the XDR Agent     |
|                                   | settings appear.                     |
+-----------------------------------+--------------------------------------+
| **Operating System**              | The operating system targeted by the |
|                                   | rule. The available options are:     |
|                                   |                                      |
|                                   | - Linux                              |
|                                   |                                      |
|                                   | - Windows                            |
+-----------------------------------+--------------------------------------+
| **Define the Rule (Python)**      | Use Python to define the custom      |
|                                   | detection logic.                     |
|                                   |                                      |
|                                   | This section supports syntax         |
|                                   | highlighting and validation          |
|                                   | (IntelliSense) to help users create  |
|                                   | accurate and efficient rules.        |
|                                   |                                      |
|                                   | Use the default code in this box as  |
|                                   | a reference or starting point.       |
|                                   |                                      |
|                                   | > **Important**                      |
|                                   | >                                    |
|                                   | > The custom Python scripts are      |
|                                   | > intended to be executed            |
|                                   | > exclusively for compliance checks  |
|                                   | > and validations. To ensure the     |
|                                   | > scripts are used properly and no   |
|                                   | > security risks or unintended       |
|                                   | > changes occur, the system          |
|                                   | > implements the following           |
|                                   | > restrictions and safeguards:       |
|                                   |                                      |
|                                   | - > Only a predefined set of Python  |
|                                   |   > libraries and functions required |
|                                   |   > for compliance checks are        |
|                                   |   > available for use. Libraries or  |
|                                   |   > functions that enable writing,   |
|                                   |   > deleting, or creating operations |
|                                   |   > are excluded.                    |
|                                   |                                      |
|                                   | - > Only authorized users with       |
|                                   |   > specific permissions can create  |
|                                   |   > or update custom scripts. This   |
|                                   |   > ensures that only trusted        |
|                                   |   > individuals can define           |
|                                   |   > compliance checks.               |
+-----------------------------------+--------------------------------------+

6.  For **Compliance Violation Severity**, define the severity level of
    the compliance violation to ensure proper categorization and
    prioritization. Possible values are:

    - Critical

    - High

    - Medium

    - Low

    - Informational

7.  For **Compliance Controls**, assign the rule to one or more existing
    compliance controls.

- > **Note**

  > Only Custom Detection Rules (not built-in rules) can be assigned to
  > custom controls.

  a.  Click **Add**.

  b.  Select a custom compliance control from the list.

  c.  Click **Assign**.

8.  For **Remediation**, you can optionally define the remediation steps
    to address any detected misconfiguration.

9.  Click **Create**.

- The new rule appears in the **Rules List**.

  You can now use the rule as a check to either create an issue or
  monitor compliance adherence to a specific requirement.

  **Create an issue**

  Under Posture Management \> Policies \> Cloud Workload, add the Custom
  Detection Rule to a **Policy**. This policy automatically runs the
  rule and creates an issue if the check fails.

  **Monitor compliance adherence**

  Under Posture Management \> Compliance \> Catalogs \> Standards,
  create a custom standard that includes the custom control associated
  with the Custom Detection Rule, and then create an assessment profile
  that runs the custom standard. You can then monitor the compliance
  results in a report. For more information, see [Monitor and track
  compliance
  adherence](/document/preview/1254147#UUID-f481858f-4663-fcde-7e86-f819fa40b6c7).

##### Use an existing rule to create a new Custom Detection Rule

1.  Navigate to **Posture Management** \> **Rules & Policies** \>
    **Rules** \> **Cloud Workload**.

2.  In the **Cloud Workload Rules** page, click the policy you want to
    enable or disable.

3.  In the **Details** page, click the **More Options** icon (**⋮**) and
    then select **Save as new**.

4.  Modify the fields as required.

5.  Click **Create** to create the new custom detection rule.

##### Edit a Custom Detection Rule

1.  Navigate to **Posture Management** \> **Rules & Policies** \>
    **Rules** \> **Cloud Workload**.

2.  In the **Cloud Workload Rules** page, click the rule you want to
    edit.

3.  In the **Details** page, click the **More Options** icon (**⋮**) and
    then click **Edit**.

4.  Make the necessary changes.

5.  Click **Update** to save the changes.

##### Delete a Custom Detection Rule

1.  Navigate to **Posture Management** \> **Rules & Policies** \>
    **Rules** \> **Cloud Workload**.

2.  In the **Cloud Workload Rules** page, click the rule you want to
    delete.

3.  In the **Details** page, click the **More Options** icon (**⋮**) and
    then select **Delete**.

4.  In the confirmation message, click **Delete**.

### Cortex Cloud Data Classification

#### What is Cortex Cloud Data Classification?

To access Data Classification management in Cortex Cloud Security
Command Center, click Settings \> Configurations .

The main screens of Data Classification management are:

- **Data Patterns:** Types of data that are discoverable on a data
  object, such as credit card numbers, social security numbers (SSNs),
  and email addresses. Cortex Cloud Data Classification provides a
  complete list of hundreds of out-of-the-box patterns. Scroll to the
  right to see more information about each pattern (description, region
  and state location, whether enabled). You can disable the data
  patterns that are not relevant for you. For more information, see [How
  to disable and enable data patterns in Data
  Classification](#UUIDb7e4cbbf271aa7dfb74e527f3a3a21a1).

- **Data Profiles:** A data profile defines a data-related business case
  and is applied to a data object such as a file or field. Six major
  data profiles are included out-of-the-box:

  - **Developer Secrets**: Sensitive pieces of information, such as API
    keys, passwords, tokens, and other credentials, that are used to
    authenticate and access various resources, services, and APIs. These
    secrets play a crucial role in securing applications and systems by
    validating the identity and permissions of users or applications.

  - **Financial**: A collection of information and data related to an
    individual or an organization\'s financial status, transactions,
    investments, assets, liabilities, income, expenses, and other
    financial activities. This profile includes details such as bank
    account information, credit card details, investment portfolios,
    income statements, tax returns, and any other financial records that
    provide a comprehensive view of a person or entity\'s financial
    health and behavior.

  - **PCI**: A set of information and data related to Payment Card
    Industry (PCI) compliance requirements and standards. This profile
    includes details such as credit card numbers, expiration dates,
    security codes (CVV/CVC), and any other data associated with
    processing payment transactions securely and in accordance with PCI
    Data Security Standards (PCI DSS).

  - **PHI**: A collection of information and data related to Protected
    Health Information (PHI), which includes sensitive and confidential
    health-related data about individuals. This profile may contain
    details such as health insurance information, patient identifiers,
    HIPAA related identifiers, ICD identifiers, and any other data that
    can be used to identify or link to an individual\'s health
    condition.

  - **PII**: Personally Identifiable Information (PII), which includes
    any data that can be used to identify or distinguish an individual
    uniquely. This profile may contain information such as full names,
    home addresses, email addresses, phone numbers, social security
    numbers, driver\'s license numbers, passport numbers, and other
    personal identifiers that can be linked to a specific person.

  - **Sensitive**: A broad range of information that is considered
    confidential, proprietary, or personally sensitive. This profile may
    include various types of data that we did not use to classify any
    other profile, such as internal IP addresses, internal classless
    inter-domain routing (CIDR), IP addresses, license plate numbers,
    MAC addresses, passwords, political views, religious beliefs, or SIM
    card numbers (ICCID).

- **Global Settings:** By default, both the OCR scan and Collect Masked
  Patterns are relevant for all modules that are using data
  classification. In other words, these two settings are global and
  define the behavior of OCR and sample collection for all modules using
  data classification.

  - **OCR** (Optical Character Recognition): Enabled by default. When
    enabled, OCR extracts text from images. Disabling this option
    reduces scanning time but does not cover image classification.

  - **Collect Masked Patterns**: Collects three samples for each data
    pattern that was classified in each object (file or table) and is
    masked by the Data Classification engine in your environment. Data
    does not leave your environment before it is masked, therefore the
    full data is always protected.

#### How to create and validate a custom data pattern

##### Overview

Custom data patterns allow you to define specific criteria for
identifying sensitive data tailored to your organization\'s unique
requirements. These patterns are applied globally across all modules
that utilize Cortex Cloud Data Classification.

##### Parameters and definitions

To create a new custom data pattern, you will need to use the following
parameters:

+-----------------------------------+-----------------------------------+
| Parameter                         | Definition                        |
+===================================+===================================+
| regex                             | Define your pattern using regular |
|                                   | expressions that are compatible   |
|                                   | with Rust syntax.                 |
+-----------------------------------+-----------------------------------+
| context words                     | Specify keywords that should      |
|                                   | appear in proximity to the regex  |
|                                   | match. These words are included   |
|                                   | in the search. A context word can |
|                                   | be just one word or a phrase of a |
|                                   | few words. Separate the context   |
|                                   | words or phrases with a comma     |
|                                   | (,).                              |
+-----------------------------------+-----------------------------------+
| proximity                         | Define a proximity for each       |
|                                   | custom data pattern. The          |
|                                   | proximity parameter defines the   |
|                                   | maximum number of characters      |
|                                   | allowed between the context words |
|                                   | and a regex match. The proximity  |
|                                   | parameter finds regex values only |
|                                   | after the context word.           |
+-----------------------------------+-----------------------------------+
| masking level                     | Define a specific masking level   |
|                                   | for each custom data pattern you  |
|                                   | create. Any changes to this       |
|                                   | setting only affect future data   |
|                                   | collection.                       |
|                                   |                                   |
|                                   | The possible masking level        |
|                                   | options are:                      |
|                                   |                                   |
|                                   | - **Mask all:** Displays only the |
|                                   |   number of strings with          |
|                                   |   asterisks (\*).                 |
|                                   |                                   |
|                                   | - **Partial: ** Partial masking   |
|                                   |   hides the last 70% of the       |
|                                   |   value. Only alphanumeric        |
|                                   |   characters are masked.          |
+-----------------------------------+-----------------------------------+
| profile association               | You can associate your custom     |
|                                   | data pattern with one or more     |
|                                   | custom data profiles. This allows |
|                                   | the pattern to be included in the |
|                                   | definition of a data profile.     |
+-----------------------------------+-----------------------------------+

##### Create a new custom data pattern

1.  In Cortex XSIAM Security Command Center, in the lower left part of
    the screen, click Settings \> Configurations.

2.  In the **Configurations** column, under **Data Classification**,
    click **Data Patterns**.

3.  On the **Data Patterns** screen, click **+ Add Pattern**.

4.  On the **Create New Data Pattern** screen, do the following (the
    starred fields are mandatory):

    1.  In the **Data Pattern Name** field, enter a data pattern name.
        To add an optional description, click **Add description** and
        enter a description in the text box that opens. If you change
        your mind and want to remove it, click **Remove description**.

    2.  In the **Regular Expression (Regex)** field, enter a regex.

    3.  In the **Context Words** line, enter the context words you want
        to use for your new data pattern.

    4.  In the **Proximity** field, enter an integer that is greater
        than 10 and less than 150. The proximity is the maximum distance
        in characters from the context word to a regex value. If
        a context word is found, the proximity is counted from the end
        of the context word. The entire regex value must be found within
        this proximity window to be considered as found.

5.  You can now test your new data pattern to validate it.

> **Note**
>
> Once a custom data pattern is saved, it runs on all data in the same
> way as any out-of-the-box (OOTB) pattern, becoming globally applicable
> for all modules using Cortex Cloud Data Classification.

##### Validate the data pattern

It is crucial to validate your custom data pattern before saving it to
ensure that it functions as intended and does not negatively impact
system performance.

Validation does the following:

- Helps you understand if your custom classifier is properly defined in
  order to capture the data that you require. If it is not properly
  defined, the validator provides insights into the problem and assists
  with modifications.

- Verifies that the custom pattern does not cause the classification
  engine to get stuck or work slowly, which could affect functionality
  or the user experience.

To validate your data pattern, do the following:

1.  In the **Test Data Pattern** text box, enter your test text and
    click **Test**. Based on your configured regex value, any matches
    that are found appear in the test results box and are highlighted.

2.  You can adjust your regex value and click **Test** again to get
    different results.

##### Validator behavior and results

- **Check regex:**

  - A text that is found by regex appears with highlighting.

  - If the regex text is found within the defined proximity range, it is
    highlighted in green, even if only one text is found within the
    correct proximity of a context word.

  - If the text is found outside of the defined proximity range for all
    context words, it is highlighted in gray.

- **Check context words:**

  - Texts that are found under different context words are underlined.

  - If a text is found within the proximity range, it is highlighted in
    green.

  - If a text is found outside the proximity range, it is highlighted in
    gray.

- **Textual explanation and guidance:** The checker provides messages
  based on the test results.

- **Sanity check (performance):** A critical check runs automatically
  when you click **Save** for your custom pattern, even if you don\'t
  manually run the data pattern check.

  - If a regex fails the sanity check, a notification informs you that
    the regex is too broad and needs to be narrowed.

  - You cannot save a custom classifier until its regex passes this
    performance test.

##### Manage custom data patterns

- **Delete custom data patterns:** You can delete custom data patterns.
  Be aware that deleting a data pattern erases all past data associated
  with it in each module using Cortex Cloud Data Classification. It can
  take up to two days for data deletion process to be completed in all
  places where this custom data pattern exists.

- **Attach Geo tags to patterns:** You can attach Geo tags to each
  pattern, to help filter or view information based on specific
  locations. These tags can be added or removed only from custom
  patterns.

- **Enable or disable a data pattern:** You can enable or disable a data
  pattern. This action is global and applies to all modules using Cortex
  Cloud Data Classification. Enabling or disabling only affects future
  scans; past results are still presented.

> **Note**
>
> For more information, see [How to disable and enable data patterns in
> Data Classification](#UUIDb7e4cbbf271aa7dfb74e527f3a3a21a1).

#### How to disable and enable data patterns in Data Classification

##### Disable data patterns

You can disable data patterns that you do not require. Disabled data
patterns are not searched for in new scans. Existing results on past
scans do not change.

> **Note**
>
> Disabling data patterns can cause changes in your data profile results
> and stop detection of these data patterns.

1.  In Cortex Command Center, click Settings \> Configurations \> Data
    Classification \> Data Patterns.

2.  Right-click the rows of the data patterns you want to disable, and
    in the context menu, select **Disable**.

3.  In the **Disable Data Pattern** screen, click **Yes** to disable the
    data pattern or patterns that you selected, or click **No** to
    cancel. If you click **Yes**, the data pattern will be disabled and
    appear grayed out. You can enable it again if required, as described
    below.

##### Enable data patterns

You can enable data patterns after they have been disabled. Once
enabled, new scans classify these data patterns and the results are then
visible in all relevant modules.

1.  Right-click the rows of the disabled data patterns that you want to
    enable, and in the context menu, click **Enable**.

2.  In the **Enable Data Pattern** screen, click **Yes** to enable the
    data pattern or patterns that you selected, or click **No** to
    cancel.

> **Note**
>
> For more information about data patterns in data classification, see
> [What is Cortex Cloud Data
> Classification?](#UUID774b12bc81879542ebb9d7bf17a73ec9).

#### How to create and validate a custom data profile

##### Overview

A data profile is a label which is applied to a data object such as a
file or table and defines a data-related business case.

Data profiles are a fundamental component of your organization\'s data
security strategy, serving as the vehicle that defines what is
considered sensitive data. Data profiles specifically outline the
sensitive data your organization aims to discover, monitor, or receive
alerts about. Profiles can be applied to and calculated for various data
sources, including files, tables, and text-based information such as API
calls.

You can create data profiles to customize sensitive data definitions
according to your requirements, complementing or extending the
predefined out-of-the-box (OOTB) profiles.

##### Understand custom data profiles

Unlike OOTB profiles, which are fixed lists and cannot be edited or
erased, custom data profiles offer full flexibility: they can be edited,
duplicated, deleted, disabled, or enabled. This means you can either
build a custom profile from scratch, or start by duplicating an existing
OOTB profile and then modifying it. When you duplicate an OOTB profile,
the system initially assigns it a name \"copy of X,\" but you can rename
it as required.

##### Create a new custom data profile

When creating a custom data profile, you need to define various
parameters that specify what constitutes sensitive data.

1.  In Cortex XSIAM Security Command Center, in the lower left part of
    the screen, click Settings \> Configurations.

2.  In the **Configurations** column, under **Data Classification**,
    click **Data Profiles**.

3.  On the **Data Profiles** screen, click **+ Add Profile**.

4.  On the **Create New Data Profile** screen, do the following:

    1.  In the **Data Profile Name** field, specify a data profile name.
        To add an optional description, click **Add description** and
        enter a description in the text box that opens. If you change
        your mind and want to remove it, click **Remove description**.

    2.  Under **Select Data Location**, select the locations that you
        want to assign to your new data profile:

        - **Cloud**: includes a variety of parameters.

        - **Endpoints**: Includes only data patterns.

        - **APIs:** Includes only data patterns.

    3.  Under **Set Conditions**, select the filters you want to set for
        your new data profile.

        - **Cloud**: Includes a variety of filters.

        - **Endpoints**: Includes only data patterns.

        - **APIs**: Includes only data patterns.

- > **Note**

  > If you choose two data locations, only the filters they have in
  > common will be included in the possible filter options.

5.  Click **Create**.

- The new custom data profile now appears in the **Data Profiles** list.

##### Manage custom data profiles

You can manage custom data profiles as follows:

- **Edit:** You can fully edit any custom profile.

- **Duplicate:** All custom profiles can be duplicated using the context
  menu in the **Data Profiles** list.

- **Delete:** Only custom data profiles can be deleted using the context
  menu in the Data Profiles list.

<!-- -->

- > **Important**

  > Deleting a data profile deletes all past data associated with it in
  > all modules using Cortex Cloud Data Classification after a warning
  > notification is displayed.

<!-- -->

- **Enable or Disable:** You can enable or disable any data profile,
  custom or OOOB.

<!-- -->

- > **Important**

  > Enabling and disabling a data profile removes or re-adds the data
  > profile results to the data objects; that is, files and tables.

##### Enable and disable data profiles

> **Note**
>
> For more information, see [How to disable and enable data profiles in
> Cortex Cloud Data
> Classification](#UUID9b87c07474b0463018f9f96949c6afe7).

#### How to disable and enable data profiles in Cortex Cloud Data Classification

##### Understand data profile statuses

Data profiles define what constitutes sensitive data for your
organization and are applicable to both files and tables. You have the
flexibility to enable or disable both out-of-the-box (OOTB) and custom
data profiles.

- **Enabled:** When a data profile is enabled, Cortex Cloud Data
  Classification actively applies its definitions to identify sensitive
  data.

- **Disabled:** When a data profile is disabled, all data profile
  results are removed from the object; that is, file or table.

> **Note**
>
> Existing results on past scans are updated in the Asset and Object
> inventories within two hours after being disabled or enabled.

##### Disable data profiles

You can disable data profiles that you do not require. Disabled data
profiles are not searched for in new scans. Existing results on past
scans are updated in the Asset and Object inventories within two hours
after being disabled or enabled.

1.  In Cortex XSIAM Security Command Center, click Settings \>
    Configurations \> Data Classification \> Data Profiles.

2.  Right-click the rows of the data profiles you want to disable, and
    in the context menu, select **Disable**.

3.  In the **Disable Data Profile** screen, click **Yes** to disable the
    data profile or profiles that you selected, or click **No** to
    cancel. If you click **Yes**, the data profile will be disabled and
    appear grayed out. You can enable it again if required, as described
    below.

##### Enable data profiles

You can enable data profiles after they have been disabled. Once
enabled, within two hours, the profiles are recalculated on the existing
data in the Asset and Object inventories. After the new scans calculate
these data profiles, the results are then visible in all relevant
modules.

1.  Right-click the rows of the disabled data profiles that you want to
    enable, and in the context menu, click **Enable**.

2.  In the **Enable Data Profile** screen, click **Yes** to enable the
    data profile or profiles that you selected, or click **No** to
    cancel.

> **Note**
>
> For more information about data profiles in Cortex Cloud Data
> Classification, see [What is Cortex Cloud Data
> Classification?](#UUID774b12bc81879542ebb9d7bf17a73ec9).

##### Important considerations

- **Global impact of built-in data profiles**: You can only enable or
  disable them.

- **Flexibility for custom profiles:** You can do the following with
  custom data profiles, including those you have duplicated from
  built-in data profiles:

  - Edit

  - Duplicate

  - Delete

  - Disable

  - Enable

### Cortex Cloud Data Security

The Cortex Cloud Data Security solution is an agentless multi-cloud data
security platform that discovers, classifies, protects, and governs
sensitive data.

#### What is Cortex Cloud Data Security?

When you start managing your data assets in the cloud, this requires the
implementation of comprehensive data security capabilities. The mission
of Cortex Cloud Data Security is to provide you with such capabilities,
in order to ensure complete visibility and real-time control over
potential security risks to your data.

The following image shows the Cortex Cloud Data Security dashboard:

![](media/rId4129.png){width="5.833333333333333in"
height="3.0770833333333334in"}

**Capabilities**

As a cloud-native data security solution, Cortex Cloud Data Security
utilizes several technologies to discover, contextualize, monitor, and
protect your cloud data assets in real time. Cortex Cloud Data Security
collects data from a variety of cloud deployments and data servers, both
managed (such as buckets, file storage, databases) and self-hosted (such
as MongoDB and MySQL running on virtual machines). The Cortex Cloud Data
Security platform also discovers data analytic environments (DBaaS) such
as Snowflake, offering you a complete data landscape view. By using
cloud-native APIs and methods, Cortex Cloud Data Security collects the
metadata of the monitored assets and administrative logs such as
CloudTrail, activity logs, and audit logs. Using this information,
Cortex Cloud Data Security can detect and remediate the following issues
or risks:

- **Shadow data**: An example of shadow data is database snapshots and
  backups created by development teams as they make changes to files or
  move them around the cloud. This type of shadow data is not protected
  by existing data governance frameworks, and security teams often do
  not even not know it exists, even though it may contain sensitive
  information.

- **Compliance violations**: The flexibility of cloud infrastructure
  makes it harder for you to stay compliant with security regulations
  such as HIPAA, GDPR, PCI, and so on, therefore making it more
  difficult to be able to prove it to auditors. Cortex Cloud Data
  Security provides your compliance teams with an easy way to classify
  data under these regulations and ensure it is handled properly, and
  intervene when a violation is detected.

- **Data exfiltration or theft**: Cortex Cloud Data Security enables you
  to easily detect exposures in the data element layer and limit access
  to them in a way that prevents cybersecurity attacks and data
  breaches.

- **Ransomware**: The real-time threat detection tools of Cortex Cloud
  Data Security enable you to stop ransomware attacks early in the kill
  chain.

- **Data misuse**: While typically not malicious, data misuse can lead
  to unintentional data compromise. Cortex Cloud Data Security can
  prevent such data misuse by enforcing security policies across
  multi-cloud architectures, which prevents users and developers from
  storing files in inappropriate places.

**Benefits**

Using the data detection and security capabilities of Cortex Cloud Data
Security enables you to:

- Discover and visualize all your data assets across the different cloud
  services, which will help you understand where the sensitive data is,
  how it is used and how it is moving across the organization.

- Reduce the attack surface on your sensitive data by identifying and
  eliminating the data threat vector early in the kill chain.

- Reduce cost due to detection of unused, duplicated, and stale data
  which allows for better data hygiene and operation.

- Protect all of your data in real time.

- Combine different technology sets such as DSPM and DDR capabilities to
  provide the highest level of data protection. See [Cortex Cloud Data
  Security use cases](#UUID9a7575fe08c7af9d2639f9bf14ce1bdb) for further
  elaboration on these capabilities.

- Create a centralized view of all data exposure issues by applying a
  single policy across multiple cloud deployments.

- Reduce cloud costs by identifying orphaned snapshots, shadow backups,
  and stale assets that contribute to unnecessary storage expenses.

#### Supported assets in Cortex Cloud Data Security

The Cortex Cloud Data Security solution helps you discover, classify,
protect, and govern your data across multi-cloud environments. With
Cortex Cloud Data Security, you can reduce data misuse, achieve
compliance, and prevent ransomware attacks and data breaches.

Cortex Cloud Data Security offers data classification for the following
assets and services:

**AWS**

- **Storage:** Simple Storage Service (S3)

- **Databases:** Aurora (provisioned), RDS (MySQL, MariaDB, PostgreSQL),
  DynamoDB, Amazon Redshift

- **Self-Managed Databases:**

  - MongoDB

  - MySQL

  - SQL Server

  - PostgreSQL

  - MariaDB

**Azure (Outpost Scan Only)**

- **Storage:** Blob Storage

- **Databases:** Azure SQL, Azure Cosmos DB, Azure SQL Managed Instance

- **Self-Managed Databases:**

  - MongoDB

  - MySQL

  - SQL Server

  - PostgreSQL

  - MariaDB

**GCP**

- **Storage:** Cloud Storage

- **Databases:** Cloud SQL (MySQL, PostgreSQL, SQL Server), Bigtable

- **Analytics:** BigQuery

- **Self-Managed Databases:**

  - MongoDB

  - MySQL

  - SQL Server

  - PostgreSQL

  - MariaDB

**Snowflake (Posture)**

- Account

- Stage

- Database

**Microsoft Office 365 (Posture)**

- Tenant

- Microsoft SharePoint site

- Drive

- Document library

> **Note**
>
> The list above refers to only data classification; however, Cortex
> Cloud Data Security discovers and monitors all cloud assets and
> services for usage and misconfigurations.
>
> **Note**
>
> For information about configuring data classification asset types, see
> [How to configure the scanning settings for supported
> services](#UUID0314dd70c386329a11f796710202949e).

#### Cortex Cloud Data Security concepts

The following is a list of the basic concepts related to Cortex Cloud
Data Security:

- **Data asset:** Any asset that contains data in a customer
  environment.

- **Storage:** A data asset that contains folders and files.

- **Database:** A data asset that contains structured data in tables and
  columns. It can also contain semi-structured data (non-tabular data).

- **Disk: ** A type of data asset that is a VM disk in cloud
  environments such as EBS for AWS, managed disks in Microsoft Azure,
  and Persistent Disk in Google Cloud Platform (GCP). These can host
  files, folders, and databases.

- **Discovery:** The process of detecting data assets in a customer
  environment.

- **Data classification:** The process of scanning data for sensitive
  records and identifying the class and quantity of sensitive records
  within a data asset.

- **Object:** An instance of either files or columns, in a storage asset
  or database asset respectively.

- **Data pattern:** The basic structure of data that is discovered in an
  object such as email address, IP address, phone number, name, credit
  card number, and bank account number.

- **Data profile:** A group or category of multiple data patterns
  sharing similar attributes. For example, personally identifiable
  information (PII) is a data profile that could include an mail
  address, phone number, or name. Another example of a data profile is
  developer secrets, which might include a token, AWS key, or
  certificate.

- **Sensitive Record:** A sensitive record is defined by having a data
  pattern that is matched with a data object.

- **False positive:** A case where certain data is detected as being a
  specific data pattern but actually matches a different data pattern or
  possibly should not match any data pattern at all.

- **Data security finding:** Findings are security-related insights that
  are generated as part of data scanning but are not necessarily
  actionable. For example, \"shadow backups found" is an example of a
  finding that can be generated by the Cortex Cloud Data Security
  scanner.

- **Data security issues:** Issues reflect actionable security risks
  that are generated by a Data Policy. For example, "sensitive public
  object in private asset" is an issue referencing a scenario where an
  object is publicly accessible while the asset configuration does not
  make it entirely public.

#### Cortex Cloud Data Security use cases

##### Understand your data

- Discover and visualize all your data assets across the different cloud
  service providers, SaaS applications, and on-premise data stores,
  which will help you understand where the sensitive data is, how it is
  used and how it is moving across the organization.

- Classify and identify sensitive information stored in data assets,
  including personally identifiable information (PII), regulated data
  (PHI, PCI, SOX), and corporate secrets defined in structured,
  semi-structured, and unstructured data.

- To understand your data, use the **Data Security Dashboard**, which
  provides visibility into all the data assets. The complete list of
  your data assets can be found under **Data Inventory**, where you can
  investigate each individual asset.

##### Understand access to your data

- Utilizing the Cortex Cloud Identity Security module, understand which
  entities, human and non-human, have access to your sensitive
  information and how it is used within the organization and outside of
  the organization.

##### Understand your risks

- Reduce the attack surface on your sensitive data by identifying and
  eliminating the data threat vector early in the kill chain, such as
  publicly accessible sensitive data, insecure data movement, lack of
  backup or versioning, lack of encryption, and more.

- Create a centralized view of all data exposure issues by applying a
  single policy across multiple cloud deployments.

- Prioritize your security measures by content type.

- Protect all of your data in real time.

- To detect security issues in your data assets, use **Data Issues**.

##### Ensure compliance

- Address your compliance requirements and avoid penalties. for security
  standards such as GDPR, PCI DSS, NIST, HIPAA, and others.

- Ensure data residency and sovereignty.

##### Reduce cloud cost

- Significantly reduce cloud costs by identifying orphaned snapshots,
  shadow backups, and stale assets that contribute to unnecessary
  storage expenses. It automates data retention policy analysis,
  ensuring compliance while preventing excessive data storage costs.

- By managing large asset inventories and prioritizing financial efforts
  on critical resources, you can optimize cloud utilization.
  Additionally, its data freshness analysis helps remove outdated
  assets, further cutting expenses.

#### Data Inventory

The **Data Inventory** page provides a centralized repository containing
information about all data assets within your environment. Dedicated
asset modules allow multi-method asset coverage, such as agentless, from
various sources. Having full visibility of assets allows for timely
incident response, effective threat hunting, and attack surface
reduction.

![](media/rId4141.png){width="5.833333333333333in"
height="2.6395833333333334in"}

The data inventory asset card provides a unified view of an asset,
consolidating attributes, enhancements, and related cases, issues, and
findings. When you click an asset, the asset card opens, enabling you to
easily switch between multiple assets cards at the same time.

On each asset card, you can perform the following actions:

- Leave comments for collaboration, and perform actions on the asset,
  depending on the type.

- Share links for easy access.

- View asset data: see all relevant data and raw information connected
  to the asset.

Category, class, and type are terms used to facilitate the organization
and classification of assets.

- **Class**: represents the highest-level grouping of assets based on
  their general purpose or domain. It is a broad classification that
  defines the overall function of the assets.

  - Examples: Compute, Network, Data

- **Category**: represents a more detailed grouping within a class. It
  categorizes assets based on their normalized function or common type,
  regardless of the provider or implementation.

  - Examples: For Compute: Virtual Machine, Container

  - For Data: Bucket, Database

- **Type**: the most specific level of classification and represents the
  provider-specific name for a particular asset within a category. This
  level directly refers to the specific implementation of an asset.

  - Examples: For the Virtual Machine category: EC2 Instance (AWS),
    Compute Engine Instance (GCP).

##### Fields on the Data Inventory page

The following is a list of the fields displayed
on the **Data Inventory** page. The assets shown, and their data, depend
on your system\'s licensing.

  -----------------------------------------------------------------------
  Column                              Description
  ----------------------------------- -----------------------------------
  First Discovered                    The timestamp of when the asset was
                                      first discovered.

  Asset Name                          The name of the data asset.

  Service Type                        The specific type of database,
                                      disk, or storage bucket, including
                                      the name of the service.

  Data Profiles                       A group or category of multiple
                                      data patterns sharing similar
                                      attributes.

  Data Patterns                       The basic structure of data that is
                                      discovered in an object such as
                                      email address, IP address, phone
                                      number, name, credit card number,
                                      and bank account number.

  Last Classification Time            The timestamp of the last time that
                                      the data was scanned for sensitive
                                      records in order to identify the
                                      class and quantity of sensitive
                                      records within a data asset.

  Number of Records                   The total number of records that
                                      were found during classification.

  Is Open to World                    Indicates whether a record is
                                      exposed to any entity in the world
                                      (Yes) or protected (No).

  Category                            The category of data: database,
                                      disk, or storage bucket.

  Cloud Provider                      The name of the cloud provider:
                                      Amazon AWS, Microsoft Azure, or
                                      Google Cloud Platform (GCP).

  Region                              Displays the region as provided by
                                      the Cloud provider.

  Size                                The size of the asset.

  Number of Objects                   The number of objects stored in the
                                      asset.

  Number of Issues                    The number of issues found
                                      associated with the asset.

  Resource ID                         The resource ID of the asset.

  Account ID                          The account ID associated with the
                                      asset.
  -----------------------------------------------------------------------

##### Asset tabs

When you select Inventory \> All Assets \> Data \> All Data, a list of
all data assets appears. The following table describes the tabs shown
under **Data Inventory** when you click on any asset in the list.

  -----------------------------------------------------------------------
  Tab                                 Description
  ----------------------------------- -----------------------------------
  Overview                            The **Overview** tab provides
                                      highlights, properties, and
                                      identities with access to the
                                      resource, if any are found.

  Access                              The **Access** tab provides a list
                                      of the identities that can access
                                      the displayed asset.

  Data                                The **Data** tab provides an
                                      overview of the displayed asset and
                                      its associated risks, including the
                                      number of Assets at Risk, data
                                      stored in AWS, Azure, and GCP,
                                      Sensitive Assets, and assets marked
                                      as Open to the World.

  Objects                             The **Objects** tab provides a list
                                      of files and information pertaining
                                      to the files\' contents.
  -----------------------------------------------------------------------

You can also select one of the following to filter the asset list for
the asset type you want to display:

- Databases

- Disks

- Storage Buckets

##### Widgets and Filtering

Use the following widgets and filtering features in the
**Data Inventory** pane:

**Widgets**

- **Assets at Risk**: Displays a bar with the various risk levels. When
  you hover your mouse you can see the number of risks for each risk
  level that were found. You can also click any of the cloud platform
  icons (AWS, Azure, and GCP) to filter the results. Click again to
  remove the filter.

<!-- -->

- ![](media/rId4148.png){width="5.833333333333333in"
  height="1.4510411198600175in"}

<!-- -->

- **Sensitive Assets**: Displays the number of sensitive assets that
  were found. You can click this widget to filter the list according to
  these sensitive assets. The number of assets at risk changes
  accordingly.

<!-- -->

- ![](media/rId4151.png){width="3.2222222222222223in"
  height="2.263888888888889in"}

<!-- -->

- **Sensitive Assets Open to World**: Displays the number of sensitive
  assets that are open to the world. The number of assets at risk
  changes accordingly.

<!-- -->

- ![](media/rId4154.png){width="3.0833333333333335in"
  height="2.2777777777777777in"}

**Filtering Features**

- **Refresh**: Refreshes the data shown in the data inventory display.

- **Show filter panel**: Opens a panel where you can select specific
  fields and search for values. You can also use the filter panel to
  clear the current filter settings.

- **Table Settings Menu**: Opens a pane with layout and filters that you
  can apply.

##### Use case example: Filter panel

To use the filter panel to display all storage buckets that have credit
card numbers and are publicly available, do the following:

1.  In the **Assets Inventory** pane, under **Data**, click
    **All Data**.

2.  Open the filter panel by clicking **Show filter panel**.

- ![](media/rId4158.png){width="1.7638888888888888in"
  height="1.5138888888888888in"}

  The filter panel opens.

3.  In the **Select field** list, select **Category**. In the next
    fields, select **Contains**, and then in the **Value** field, select
    storage. Click **AND** to jump to the next field.

- ![](media/rId4161.png){width="5.833333333333333in"
  height="4.60905293088364in"}

4.  Continue adding filters as follows:

    1.  Select: **Is Open To World**, **Yes**, **AND**

    2.  Select: **Data Patterns** and enter **credit card**

- The asset list below should now display all storage buckets that have
  credit card numbers and are publicly available.

5.  Click **Save** and enter a name for the new filter. It now appears
    in the **Table Settings Menu** (three dots on upper right screen) on
    the **Saved Filters** tab.

> **Note**
>
> To clear the filters in the filter panel, click **Delete**.

#### How to review errors in Cortex Cloud Data Security

##### Review errors

To review errors in Cortex Cloud Data Security, do the following:

1.  In **Cortex Cloud Command Center**, in the lower left area, click
    Settings \> Data Sources.

2.  On the **Data Sources** screen, click a cloud service provider or
    other data source and then click the **View Details** link.
    Alternatively, you can click the **Error** button near the top of
    the screen. This button displays the data sources that have errors.

3.  In the **Cloud Instances** screen, click the **Instance Name** link.
    A screen displaying the instance name and related information opens.

4.  In the **Security Capabilities** list, click
    **Data Security Scanning** to display the **Errors** pane with the
    details of the errors that were found.

5.  Click **Add Filters** to create a filter that displays the assets
    you want to review.

6.  Click an asset row to display a popup window with information about
    the error and a raw error string that you can copy.

  -----------------------------------------------------------------------
  Column Name                         Description
  ----------------------------------- -----------------------------------
  **Asset Name**                      The technical name of the asset.

  **Error Name**                      An explanation of the error.

  **Timestamp**                       The date and time when the error
                                      was found.

  **Region**                          The geographical location of the
                                      asset with the error.

  **Asset Type**                      The type of asset, such as an
                                      Amazon S3 bucket or an RDS
                                      database.
  -----------------------------------------------------------------------

  : Error table columns

![](media/rId4167.png){width="5.833333333333333in"
height="4.076041119860018in"}

#### How to configure the scanning settings for supported services

1.  In Cortex XSIAM Command Center, in the lower left area, click
    Settings \> Data Sources.

2.  On the **Data Sources** screen, click a cloud service provider or
    other data source and then click the **View Details** link.

3.  On the **Cloud Instances** screen, click an instance name link. A
    screen displaying the instance name opens.

4.  At the bottom of the screen, under **Accounts** (AWS),
    **Subscriptions** (Azure), or **Projects** (GCP), right-click an
    item in the list and then in the context menu, select **Edit**.

5.  In the screen that opens, under
    **Data assets classification options**, you can deselect any data
    asset types.

- > **Note**

  > All the asset types are selected by default. When you deselect a
  > data asset type, it is not included when the system runs the next
  > scan operation, reducing the total scan time.

6.  Click **Save**.

- For more information about supported assets in Cortex Cloud Data
  Security, see [Supported assets in Cortex Cloud Data
  Security](#UUIDa01721f1b61d048e0fcb6929f39d81fe).

#### How to perform advanced Data Security investigations using XQL

##### Overview

Cortex Cloud Data Security centralizes data-related information into a
list of datasets, providing the foundation for comprehensive security
investigations. Using Cortex Query Language (XQL) , you can create
custom queries to extract valuable insights from these data sources
within your system. For more information, see [Get started with
XQL](#UUIDd08e1a9c8397fe101964781e65ee8407).

You can use the following data-related datasets:

  --------------------------------------------------------------------------------------
  Dataset                             Description
  ----------------------------------- --------------------------------------------------
  dspm_asset_metadata                 Contains high-level information about all data
                                      assets, including details such as their creation
                                      and modification dates, cloud service, and any
                                      tags.

  dspm_asset_table_inventory          Provides an inventory of tables and their
                                      associated fields, which is useful for analyzing
                                      data at a more granular level.

  dspm_asset_data_patterns            Tracks specific patterns of sensitive data, such
                                      as SSN or credit card numbers, found within your
                                      assets.

  dspm_asset_data_profiles            Provides a summary of the data\'s content,
                                      including counts of sensitive fields and the
                                      percentage of sensitive data found.

  data_ingestion_health               Monitors the health of data ingestion pipelines,
                                      logging failures or issues that could lead to
                                      incomplete security monitoring.

  findings                            Contains findings associated with assets
                                      discovered within your environments. For more
                                      information, see [Findings and
                                      events](#UUIDbf161f3cb4dca8f66e01758cc950c3ea).

  issues                              Contains issues generated on assets within your
                                      environments. For more information, see
                                      [Issues](#UUID0567a64a465f5995bb225155645ee2e3).
  --------------------------------------------------------------------------------------

##### Investigate Cortex Cloud Data Security

To run queries on your Cortex Cloud Data Security datasets:

1.  In Cortex XSIAM, in the navigation pane on the left, click
    **Investigation & Response**, then under **Search**, click
    **Query Builder**.

2.  Click **XQL**.

3.  You can start typing your query in the box at the top of the screen,
    or search for existing queries on the **Query Library** tab.

4.  Click **Run**. The query results appear on the **Query Results**
    tab.

> **Note**
>
> For more information, see
> [/document/preview/1282353#UUID-6b616ab5-87bc-e353-5aa5-51e6d5370560](/document/preview/1282353#UUID-6b616ab5-87bc-e353-5aa5-51e6d5370560).

##### Examples

1\. All AWS data stores that contain objects with sensitive data

    dataset = findings
    | filter xdm.finding.type_id = 80000002 and xdm.finding.is_active = true 
    | Join (dataset = asset_inventory 
        | filter xdm.asset.type.class = "Data" and xdm.asset.provider = "AWS"
        | fields xdm.asset.id as Asset_ID, xdm.asset.name as Asset_Name, xdm.asset.provider as Asset_Cloud, xdm.asset.cloud.region as Region, xdm.asset.type.name as Asset_Type) as res res.Asset_ID = xdm.finding.asset_id
    | alter Patterns = json_extract_scalar_array(xdm.finding.normalized_fields, "$['xdm.data.data_pattern']") 
    | alter Total_Sensitive_Records = json_extract_scalar(xdm.finding.normalized_fields, "$['xdm.data.statistics.records_count']")  
    | fields Asset_Name, Asset_Type, Asset_Cloud, Region, Patterns, Total_Sensitive_Records

2\. All files containing sensitive data matching the PII data profile

    dataset = dspm_asset_file_inventory 
    | arrayexpand file_data_profile_ids 
    | alter profile_id = to_integer(file_data_profile_ids) 
    | join type = left (dataset = asset_inventory 
    | fields xdm.asset.name, xdm.asset.id, xdm.asset.type.name ) as ai ai.xdm.asset.id = asset_id 
    | join type = left (dataset = classification_mgmt_data_profile 
    | filter name = "PII" 
    | fields id, name) as cmdp cmdp.id = profile_id 
    | dedup xdm.asset.id 
    | fields file_name, file_folder, file_extension_category, file_size_bytes, file_data_patterns, record_count, xdm.asset.name, xdm.asset.id, xdm.asset.type.name 

3\. All data patterns with the number of sensitive records per pattern

    dataset = dspm_asset_data_patterns 
    | comp sum(record_count) as Records by kind  
    | fields kind, Records

4\. All files containing sensitive PII data that is also public

    dataset = dspm_asset_file_inventory 
    | filter file_is_open_to_world = true 
    | arrayexpand file_data_profile_ids 
    | alter profile_id = to_integer(file_data_profile_ids) 
    | join type = left (dataset = asset_inventory 
    | fields xdm.asset.name, xdm.asset.id, xdm.asset.type.name ) as ai ai.xdm.asset.id = asset_id 
    | join type = left (dataset = classification_mgmt_data_profile 
    | filter name = "PII" 
    | fields id, name) as cmdp cmdp.id = profile_id 
    | dedup xdm.asset.id 
    | fields file_name, file_folder, file_extension_category, file_size_bytes, file_data_patterns, record_count, xdm.asset.name, xdm.asset.id, xdm.asset.type.name 

5\. Data security issues related to malware

    dataset = issues 
    | filter xdm.issue.owner = "DSPM" and xdm.issue.detection.rule_id = "DSPM_1010"
    | fields xdm.issue.name as Name, xdm.issue.severity as Severity, xdm.issue.domain as Domain, xdm.issue.category as Category, xdm.issue.observation_time as Observation_Time, xdm.issue.description as Description, xdm.issue.status.progress as Status

6\. All shadow backup files, such as database dumps or copies that are
stored in unstructured storage

    dataset = dspm_asset_file_inventory 
    | filter file_is_shadow_backup = true and file_is_deleted = false
    | fields file_name, file_folder as Folder, file_extension_category as File_Type, file_last_modification_time as Last_Modified, file_data_patterns as Data_Patterns, last_classification_time as Last_Classified_Time

7\. All assets containing the PCI data profile and data security issues

    dataset = asset_inventory 
    | join type = inner (dataset = dspm_asset_data_profiles 
    | alter int_data_profile_id = to_integer(data_profile_id) 
    |join type = inner (dataset = classification_mgmt_data_profile 
    | filter name = "PCI" 
    | fields id, name) as cm cm.id = int_data_profile_id) as da da.asset_id = xdm.asset.id 
    | join type = inner (dataset = issue_to_asset 
    | join type = left (dataset = issues 
    | fields xdm.issue.id as issue_id, xdm.issue.domain, xdm.issue.status.progress as progress, xdm.issue.is_excluded as is_excluded 
    | filter xdm.issue.domain = "POSTURE" and is_excluded != true and progress != "RESOLVED") as is is.issue_id = xdm.issue.id) as iss iss.xdm.asset.id = xdm.asset.id 
    | dedup asset_id 
    | fields xdm.asset.id, xdm.asset.type.name, xdm.asset.name

8\. All assets with a tag of key X and value Y

    dataset = asset_inventory
    | filter xdm.asset.type.class = "Data"
    | fields xdm.asset.tags, xdm.asset.id, xdm.asset.type.id
    | alter tag1 = xdm.asset.tags -> ["Dont-delete"], tag2 = xdm.asset.tags -> ["SensitiveBucket"]
    | filter tag1 = "forever" and tag2 = "True

#### How to onboard Snowflake (Posture)

##### Overview

Integrate Cortex Cloud Data Security with your Snowflake account to gain
comprehensive visibility into any data and posture risk existing in your
Snowflake environment. This integration enables automated scanning of
all assets in Snowflake, including data classification and risk
assessment.

You can add Snowflake (Posture) as a third-party data source in Cortex
Cloud Data Security .

> **Prerequisite**

- > In order to use Snowflake (Posture), you must be registered with one
  > of these cloud providers: Amazon AWS, Microsoft Azure, or Google
  > Cloud Platform (GCP).

- > Ensure you have the necessary account permissions to onboard. It is
  > recommended to use `account admin` as the role for the onboarding.

##### Configuration Step

1.  In the Cortex XSIAM Security Command Center, click Settings \> Data
    Sources.

2.  On the **Data Source** screen, click the **+ Add Data Source**
    button.

3.  On the **Add Data Source** screen, in the **Snowflake (Posture)**
    tile, click **Connect**.

4.  In the **Snowflake (Posture)** screen, enter a display name and Data
    Sharing Account Identifier.

- > **Note**

  > The account identifier can be found using the user information at
  > the bottom left. Hover over the account you wish to onboard and
  > select the copy option at the top right. The account identifier is
  > usually of the format: 

  > (organization).\[account\]

5.  (Optional) If you have a Snowflake account that is protected by a
    network policy, turn on the
    **My Snowflake account is protected by network policies** toggle
    button. The network policies are related to the IP allow list.

6.  Select a cloud platform and choose a region.

7.  (Optional) If you want to use an existing user:

    1.  Click **Show advance settings** and then turn on the
        **Use an existing user** toggle button.

    2.  Enter the user name and the login name.

8.  Click **Next**.

##### Establish Connection Step

1.  Open your Snowflake console in a new tab.  

2.  Using the copy or download icons, copy or download the script in the
    **Generated script** text box and paste it into a new worksheet in
    Snowflake.

3.  Select the entire script and select **Run all**.

4.  Once the script runs without errors, come back to the
    **Snowflake (Posture)** screen and click **Verify Connection**
    to check if the instance is detected.

##### Verify Connection Step

1.  A success or failure message appears on the screen.

2.  If a success message appears, you can do the following: 

    - View the instance\'s information in the Snowflake Posture
      instances.

    - View the assets in Asset Inventory, once the first scan is
      complete,

##### Delete a Snowflake instance

1.  Click Settings \> Data Sources.

2.  Click the **Snowflake (Posture)** bar, and then click
    **View Details**.

3.  On the **Snowflake Instances** screen, click the row of the instance
    you want to delete.

4.  In the screen that opens, click the 3-dot icon in the top right of
    the screen, and then click **Delete**.

5.  In the popup screen that opens, click **Delete**.

- The Snowflake instance is now removed, including all previous scans.

#### How to onboard Microsoft 365 (Posture)

##### Overview

You can add Microsoft 365 (Posture) as a third-party data source in
Cortex Cloud Data Security.

> **Warning**

- > You have generated a Globally Unique Identifier (GUID), also known
  > as a Universally Unique Identifier (UUID). You will need this ID for
  > the tenant you want to use for the Microsoft 365 (Posture) instance.

- > In order to use Microsoft 365 (Posture), you must be registered with
  > Microsoft Azure.

##### Configuration

1.  In the Cortex XSIAM Security Command Center, in the lower left area,
    click Settings \> Data Sources.

2.  On the **Data Sources** screen, click **+ Add Data Source**.

3.  On the **Add Data Source** screen, click the
    **Microsoft 365 (Posture)** tile and then click **Connect**.

4.  On the **Microsoft 365 Posture Instance** screen, do the following:

    1.  In the **Display Name** field, enter a name for your Microsoft
        365 (Posture) instance.

    2.  In the **Tenant ID** field, enter a tenant ID.

    3.  In the **Region** list, select a region.

5.  Click **Next**.

##### Authorization

1.  On the Microsoft 365 Posture Instance screen, if you are an
    administrator, click the **click to authorize** link.

2.  If you do not have administrator permissions, follow the
    instructions on screen and click **Close**.

The **Microsoft 365 (Posture)** instance should now appear on the
**Data Sources** screen under **3rd Party Data Sources**.

#### How to use information protection labels in Cortex Cloud Data Security

##### Overview

Information protection labels are digital tags that help your
organization classify and secure sensitive data. They identify how
sensitive a piece of information is---whether it\'s a document or an
email. Once applied, these labels can automatically trigger protective
measures like encryption to control who can access the file, or
restrictions on who can edit or share it.

Ultimately, these labels are vital for enforcing your data policies and
significantly cutting down the risk of data breaches. They ensure
sensitive information is managed correctly throughout its entire
journey, from when it\'s created to when it\'s no longer needed.

Each sensitivity label within your organization is assigned a unique
GUID. This ensures consistent policy enforcement regardless of where the
data resides or moves.

Once you have integrated Microsoft 365 with Cortex Cloud Data Security,
after scanning you will be able to identify the files having information
protection labels and view the specific GUIDs for each one.

For information about integrating Microsoft 365 (Posture), see [How to
onboard Microsoft 365 (Posture)](#UUIDdbbe0ac7a33f596968c02659da167d65).

##### How Cortex Cloud Data Security locates information protection labels

The Cortex Cloud Data Security scanner runs on your files and extracts
the information protection labels from them during the classification
process. This extraction is supported across all platforms and asset
types, both file-based and unstructured.

##### Label translation

To enable the translation of Microsoft IDs to label names, connect to
the Microsoft 365 integration.

###### Example

  --------------------------------------------------------------------------
  GUID                                   Translated Label
  -------------------------------------- -----------------------------------
  6b29fc40-ca47-1067-b31d-00dd010662da   Sensitive-Internal

  --------------------------------------------------------------------------

##### Find the labels in Cortex XSIAM Security Command Center

1.  In Cortex XSIAM Security Command Center, click Modules \> Data
    Security.

2.  Under **Objects Inventory**, click **Files**.

3.  On the **Files Inventory** screen, click **Show filter panel** to
    open the filter panel and then do the following:

    1.  In the **Select field** list, select
        **Has Information Protection Labels**.

    2.  In the next list to the right, select the equals sign (**=**).

    3.  In the next field to the right, select **Yes**.

    4.  Click anywhere in the screen outside the filter panel area.

    - Now only files with information protection labels are displayed.
      In the **Information Protection Labels** column, the IDs for these
      labels appear.

      > **Note**

      > Only If you have connected a Microsoft 365 instance to Cortex
      > Cloud, the information protection labels appear. See [How to
      > onboard Microsoft 365
      > (Posture)](#UUIDdbbe0ac7a33f596968c02659da167d65).

### Cortex Cloud Identity Security

Cortex Cloud Identity Security can help you address the security
challenges of managing identity in cloud environments.

#### What is Cortex Cloud Identity Security?

Cortex Cloud Identity Security is a set of tools, providing you the
following necessary capabilities to improve your identity estates
security posture:

- **Cloud Infrastructure Entitlement Management (CIEM):** Provides full
  and clear visibility into identities and permissions in your cloud
  environments, and helps with rightsizing permissions to achieve least
  privilege. The main idea behind the principle of least privilege is to
  make sure that only those who should have access to a cloud resource
  and actually must use it are granted that access. All unused and
  unnecessary permissions expose your organization to additional risk,
  and therefore these need to be eliminated. When all users and
  applications have been granted only the specific permissions they
  need, your organization has achieved least privilege access. Core CIEM
  capabilities also include removing unused permissions, monitoring
  administrators, and reducing risky permissions, such as human and
  non-human identities, third-party vendors, cross-account and
  cross-cloud access.

- **Identity Security Posture Management (ISPM):** Helps you prevent
  identity misconfigurations by analyzing all identities across your
  cloud providers, identity providers (IdPs), and SaaS applications. By
  collecting and analyzing information from various services, ISPM
  creates advanced insights about your identity estate, helping you
  monitor and mitigate issues such as identity misconfigurations, shadow
  admins, and excessive permissions.

- **Data Access Governance (DAG):** By combining access information with
  data-related insights generated by Cortex Cloud Data Security, Cortex
  Cloud Identity Security detects and identifies which identities can
  access sensitive data, which sensitive data types can be accessed, and
  where specifically this data is stored. DAG capabilities are used to
  remove unnecessary or unintentional access to sensitive data in order
  to reduce the risk of sensitive data exposure.

- **Identity Threat Detection and Response (ITDR):** Collects and
  analyzes real-time events from your cloud providers and IdPs in order
  to establish usage and access patterns. ITDR detects identity-related
  anomalies in real time and triggers automatic responses to keep any
  unwanted party away from your environment.

The following image shows the Cortex Cloud Identity Security dashboard:

![](media/rId4198.png){width="5.833333333333333in"
height="3.0770833333333334in"}

Cortex Cloud Identity Security runs a proprietary algorithm to calculate
effective permissions and entitlements of the identities across your
cloud service providers (AWS, Azure, and GCP) as well as permissions in
your IdPs (Entra ID). This means creating a single graphical
representation of all your cloud entitlements; taking all mechanisms
affecting permissions into account. For example:

- Relevant access policies

- Deny and allow statements

- Organizational policies across single- or multi-cloud environments

Managing access and entitlement is an essential step in reducing your
cloud attack surface. This includes mitigating identity
misconfigurations in order to eliminate infiltration risk, and
implementing least privilege access in order to minimize lateral
movement, privilege escalation, or attack impact possibilities.

Cortex Cloud Identity Security can assist you with discovering your
entire identity estate, fixing security gaps, and removing unused,
excessive and risky permissions to achieve the principle of least
privilege. Additionally, you can use Cortex Cloud Identity Security to
ensure that your environment meets any relevant compliance standards.

Cortex Cloud Identity Security can correlate identity information with
configuration data, giving you the required depth of visibility and
control. For example, if you use the Amazon S3 storage service, Cortex
Cloud Identity Security can discover and identify sensitive data, the
Cloud Network Analyzer (CNA) module can calculate true internet
exposure, and Cortex Cloud Identity Security can provide granular
insights into exactly who has access to the data and make appropriate
recommendations to enforce least-privilege access.

You can use Cortex Cloud Identity Security to evaluate the effective
permissions assigned to users, workloads, human identities, groups,
roles, cloud service accounts, applications, identity providers (IdPs),
and external accounts on your cloud provider so that you can properly
administer identity and access management (IAM) policies and enforce
access using the principle of least privilege.

Cortex Cloud Identity Security provides:

- **Visibility:** Discover your entire cloud identity estate and get a
  detailed inventory of all the identity assets in your environment. You
  can also get a detailed and precise modeling of who has permissions
  for which actions, and on which assets.

- **Posture:** Using a set of detection rules, find all privilege and
  misconfiguration security risks, with detailed reports of where
  exactly the issues are occurring and why they are important.

- **Detection and response:** Detect identity-related security events in
  real time and trigger automatic responses to make sure attackers do
  not gain access to your environment.

- **Compliance:** Test your identity estate against a wide set of
  compliance standards, and get a detailed report of what needs to be
  fixed in order for your assets to be 100% compliant.

- **Remediation:** Use Cortex Cloud Identity Security to create fixes
  for all your security and compliance issues.

#### Cortex Cloud Identity Security concepts

The following explains the principle concepts of Cortex Cloud Identity
Security:

##### Asset categories

The Cortex Cloud Identity Security inventory is organized according to
these asset categories:

- **All Identity Assets**: All Identity-related assets. Refine the
  results using the tabs:

  - **Cloud Identities**: Identities originating from cloud platforms.

  - **Enterprise Identities**: Identities managed within your
    on-premises or enterprise directories. This category supports
    ingestion from  directories such as Okta, Entra ID, Active Directory
    (AD), and Google Workspace.

  <!-- -->

  - > **Note**

    > Access to the **Weak/Compromised Password** column requires the
    > ITDR add-on.

  <!-- -->

  - **Code Identities**: Identities associated with automated processes,
    applications, and code.

- **Human Identities:** All cloud, identity provider (IdP), and platform
  users. Refine the results using the same sub-categories as
  **All Identity Assets**: **Cloud Identities**,
  **Enterprise Identities**, and **Code Identities**.

- **Non-human identities:** Machine Identities that can assume
  permissions and perform cloud Identity and Access Management (IAM)
  actions such as VMs and functions.

- **Cloud Service Accounts:** A category unifying AWS roles, Microsoft
  Azure service accounts and managed Identities, and Google Cloud
  Platform (GCP) service accounts.

- **IAM Groups:** Identity and Access Management groups.

- **IAM Policies:** Permission documents, such as AWS policies, Azure
  roles, and GCP roles.

##### Risk scores

> **Note**
>
> Only ITDR assets can have a risk score. 

On the **Enterprise Identities** tab, you are presented with the
**Risky Identities Breakdown** widget. It provides a high-level overview
of your riskiest assets at a glance. 

A risk score is a dynamic indicator of the asset's potential threats and
vulnerabilities. This score, calculated for each asset, is classified as
low, medium, or high. 

To view an asset\'s risk history, click on the asset. The asset card
opens, displaying a **Security Risk Score Trend** that illustrates
changes in its security posture over time.

##### Effective permission calculation

One of the core capabilities of Cortex Cloud Identity Security is its
ability to analyze cloud permissions. Once you have onboarded your cloud
organization, Cortex Cloud Identity Security gathers all the relevant
information necessary for calculating permissions and then calculates
the net effective permissions in your environment, which is a precise
depiction of which identity can perform which specific actions and where
can they be performed. Net effective permissions are used to provide
context for other product features such as access tables, access to
cloud resources and services count, as well as detection rules and
issues.

When assessing whether a user has access to an Amazon S3 bucket, you
must make sure that the permissions actually exist somewhere, while
there is nothing that could deny access. A user can be granted access
via a policy that is attached to the user (via direct attachment, a role
the user can assume, or a group where they\'re a member), an inline
policy, or a resource-based policy. Permissions can be denied via
service control policies (SCPs), permission boundaries, a deny statement
on a relevant policy, a deny statement on the resource-based policy and
much more. The net effective permission calculator takes all these and
more into account when determining effective permissions in your
environment.

A permission consists of five main components:

- **Source:** The identity that can perform an action. This can be a
  human identity or a non-human identity. In certain cases, permissions
  for cloud service accounts are calculated as sources as well. In some
  special cases, such as where public access is granted, or when
  permissions are granted to an entire specific cloud account, a source
  can be named "all". In such cases, notice the source's cloud account
  to identify whether the permissions are granted to the public or to
  all entities within an account.

- **Destination:** The resource on which the source can perform actions.
  In cases of wildcards, the relevant wildcard appears.

- **Policy:** The document where permissions are written, such as an IAM
  policy, Azure or GCP role, resource-based policy, or inline policy.

- **Granter:** The asset that connects the source and the policy.
  Traditionally, this can be a group or a cloud service account. In the
  case of a direct attachment, or the use of inline policy, the granter
  and the source would be the same asset. In the case of a
  resource-based policy, the granter and the destination would be the
  same asset.

- **Action:** The specific action that a source can perform on a
  granter.

##### Last access calculation

Once you have onboarded to Cortex Cloud Identity Security, information
about permission usage is collected. Cortex Cloud Identity Security
keeps track of the last time each permission was used, creating a live
picture of which permissions are used, and which are not. This
information is presented in various features in Cortex Cloud Identity
Security, helping you quickly identify permissions that are unused for
90 days or longer, and should therefore be considered for removal.

##### Excessive permission analysis

Defining AWS policies, Azure roles, or GCP roles to grant excessive
permissions is considered a deviation from identity and permissions best
practices. Excessive policies are defined as granting permissions on a
very wide range of resources or allowing the performance of any action
on resources.

The following specific scenarios are examples of excessive permissions:

- **AWS:** A policy is considered excessive when it includes any of the
  following:

  - A full wildcard, where the resource and scope are: `*`

  - A service-level action wildcard, such as `S3:*`

  - A full wildcard in a resource, meaning that an action can be done on
    all resources of a service

- **Azure:** A policy is considered excessive when a role contains a
  wildcard and is bound to an entity on a management group scope, or
  grants an action wildcard and is bound to an identity at the
  subscription level.

- **GCP:** A policy is considered excessive when binding a specific
  predefined role on the organization, folder or project level.

> **Note**
>
> When a policy is analyzed and categorized as excessive, a relevant
> finding and highlight is attached to that policy and the various
> identities being granted excessive permissions.

##### Access categorization

Access categorization provides you with a high-level view of the type of
access each identity has without your having to analyze each permission
one by one.

The basic cloud permission categories are as follows:

- **List:** Permits users to view information about the metadata of
  cloud services and resources. For example, users can get a list of all
  resources under a specific service in an account.

- **Read:** Permits users to read data found in various cloud resources.
  For example, users with Read permissions may open and read files in
  object storage, and run queries on databases.

- **Write:** Permits users to write data into cloud resources, including
  writing or deleting files and editing rows in databases.

- **Config:** Permits users to edit and configure cloud resources, such
  as editing firewall rules and adding users to groups.

- **Administrative:** Permits users to perform highly privileged actions
  such as creating a new group or deleting an organization policy.

<!-- -->

- > **Note**

  > Each action must be defined as either being administrative or not.

  > The **administrative** tag is an additional tag for administrative
  > actions, along with one of the other access level types. For
  > example, the AWS action `iam:CreateGroup` is categorized as
  > **config** and has the **administrative** tag as well.

##### Unused permissions and inactive identities

We recommend reviewing and removing all dormant identities from your
environment, as well as reducing unused permissions. Inactive identities
and unused permissions in your environment pose an unnecessary risk and
widen your security gaps against potential attacks.

- **Unused permissions:** Using the last access feature, you may find
  unused permissions, which are mentioned throughout the various
  features of Cortex Cloud Identity Security, such as the overview page
  and access tables. A permission is considered unused when at least 90
  days have passed since it was last used.

<!-- -->

- > **Important**

  > If you turn off the audit logs, even briefly, this temporarily
  > impacts the accuracy of the Last Access data, potentially showing
  > permissions as unused when actually they were active. Full accuracy
  > is restored 90 days after you re-enable the audit logs.

<!-- -->

- **Inactive identities:** Cortex Cloud Identity Security user login
  information and cloud service account usage to detect inactive users
  and inactive cloud service accounts. Per the industry standard, users
  and cloud service accounts that are considered inactive are those that
  have not been active for at least 90 days. When an asset is considered
  inactive, it is highlighted on the asset page and a relevant attribute
  appears on the asset, allowing you to query for it with the inventory.

- **Inactive Azure human identities:** For inactive Azure human
  identities on Azure, you must follow the steps described in [How to
  enable inactive human identity logs on Azure in Cortex Cloud Identity
  Security](#UUID56f4f6f576e0c17618f665e9c315ece9).

##### Account access

Two capabilities of Cortex Cloud Identity Security are analyzing and
identifying cross accounts and external access.

Getting information about permissions to your environment and access to
sensitive data, and being informed about cross accounts or external
access helps you determine and remove unauthorized access.

In Cortex Cloud Identity Security, access is labeled in one of the
following ways:

- **Same account access:** When the source and the destination are in
  the same cloud account.

- **Internal known access:** When the source and the destination are in
  different accounts, while both these accounts have been onboarded to
  Cortex Cloud Identity Security. Additionally, permissions are
  categorized as internal known access when the source is from an
  onboarded SAML/OIDC provider; for example, an onboarded Okta account.

- **Internal unknown access:** When the source and destination are in
  different accounts, while one of the accounts is not onboarded but is
  part of the onboarded organization (when not all accounts under the
  organization have been onboarded). Additionally, permissions are
  categorized as internal unknown access when the source is from a
  non-onboarded SAML/OIDC provider; for example, an onboarded Okta
  account.

- **3^rd^-party access:** When the source account is a 3^rd^-party
  vendor whose account is familiar to Cortex Cloud Identity Security.

- **External unknown access:** When the source and destination are in
  different accounts, and the source is in a non-onboarded account .
  Another example of this type of access is when the source is from an
  unknown web identity provider.

- **Public access:** When permission is granted to the public; for
  example, when an AWS role can be assumed by all users, or when an
  Amazon S3 bucket has a widely permissive resource-based policy

#### Cortex Cloud Identity Security principles

##### Cloud permission calculations

A wide variety of tools are used by security teams to grant or revoke
permissions. Cortex Cloud Identity Security takes the following
parameters into consideration when calculating effective permissions.

###### Organization policy

Using organization policies, you can enable and turn off various types
of policies across accounts and organization units. Cortex Cloud
Identity Security analyzes organization policies as part of the
permission calculation for:

- **Amazon AWS:** Service control policies (SCPs) are supported.

###### Deny statements

Deny statements can appear in the various permission tools in different
cloud providers and are taken into consideration in the effective
permissions calculation, when they appear in the following:

- **AWS:** Deny actions are supported in SCP and IAM policies.

- **GCP:** Block actions are supported in the scope of organizations,
  folders, and projects.

####### \"NotAction\" element

In a policy, actions specified under the `NotAction` policy element are
subtracted from the permissions that are granted in that policy.

The `NotAction` element is supported in AWS and Microsoft Azure.

####### Permissions boundary tool

You can use the IAM permissions boundary tool to limit the amount or
scope of permissions granted to a principal.

The permission boundaries tool is supported in AWS and Azure.

####### Resource-based policies

Resource-based policies are permissions that are configured on the
destination resource. You can use resource-based policies to grant or
deny permissions on a resource that is based on multiple parameters; for
example, allowing or preventing a certain principal from acting on a
resource.

- **AWS:** Resource-based policies are calculated for the following
  services: AWS Lambda, Amazon S3, Amazon Simple Queue Service (SQS),
  Amazon Simple Notification Service (SNS), AWS Secrets Manager, AWS Key
  Management Services (KMS), and Amazon Elastic Container Registry
  (ECR).

- **Azure:** Permissions granted of any scope are considered for
  effective permissions calculation.

- **GCP:** Resource-based policies are calculated for the following
  Google Cloud services: Cloud Storage, BigQuery, Cloud Pub/Sub, Cloud
  Key Management (KMS), Cloud Spanner, Cloud Run, Compute Engine, Cloud
  Functions, and Dataproc.

#### Cortex Cloud Identity Security use cases

Use case 1: Review and improve your identity posture

The Cortex Cloud Identity Security dashboard provides an overview of
various aspects of identity posture, which you can use to quickly assess
your identity posture and the main identity security gaps. Each widget
on the dashboard provides you with a specific context that you can use
to learn about your environment, understand the most pressing issues,
accessing the relevant pages in the product so you can remediate them.

**Identity inventory**

The row of identity inventory boxes across the top of the dashboard show
you how many assets have been discovered, according to each asset
category:

- **Human Identities**: Displays all cloud, identity provider (IdP), and
  platform users.

- **Non-human Identities**: Machine identities that can assume
  permissions and conduct cloud IAM actions. This includes, for example,
  VMs and functions.

- **Cloud Service Accounts**: A category unifying AWS roles, Azure
  service principals and managed identities, and GCP service accounts.

- **Groups**: IAM groups.

- **Policies**: Permission documents. AWS policies, and Azure and GCP
  roles.

**Top Critical Issues to Address:**

See the **Top Critical Issues to Address** area to view a refined list
of the most important identity issues to take note of in your
environment. Issues are prioritized based on the severity of detection
rules, the number of violating assets, and their association with MITRE
tactics and techniques. Use this view to quickly focus on the most
critical security gaps and strengthen your security posture.

**Identity Security Findings**

Use the **Identity Security Findings** widget to find common
misconfigurations in your environment:

- The **Inactive Identities** section shows the total number of users
  that have not logged in to the cloud environment for at least 90 days
  per cloud provider.

- The **Identities with excessive policies** section shows identities
  such as users, machines, groups, and cloud service accounts with
  excessive policies attached. The definition of excessive policy
  includes:

  - **Amazon AWS:** A policy is considered excessive if it includes a
    full wildcard (resource and scope are: `*`), or a service-level
    action wildcard (such as Amazon `S3:*`) , or a full wildcard in
    resource (meaning an action can be performed on all the resources of
    a service).

  - **Microsoft Azure:** When a role contains a wildcard and is bound to
    an entity on a management group scope, or grants an action wildcard
    and is bound to an identity at the subscription level.

  - **GCP infrastructure platform:** When binding a specific predefined
    role on the organization, folder, or project level.

**Admins Summary**

The **Admins Summary** widget provides you with valuable insight
regarding the identities that are granted administrative permissions, in
any way possible, in your environment. Admins are not necessarily found
only in your administrators group, because identities can be granted
administrative permissions in numerous ways, both intentionally or
unintentionally. Use this widget to analyze how many administrators
there are in your environment, and on which level they are granted
administrative permissions.

**Top Identities at Risk**

In the **Top Identities at Risk** widget, you can view identities with
the highest amount and severity of risks, in order to identify the
riskiest identities in your environment.

**3^rd^-Party Access**

Use the **3^rd^-Party Access** widget to analyze third-party access to
your environment. This is supported only in GCP and AWS.

For each vendor that has access to your environment, you can see:

- How many accounts the vendor has access to.

- How many different cloud services this vendor can access. 

- Which level of access the vendor has in your environment according to
  access levels.

Use case 2: Use identity issues to improve your identity posture

You can find your identity issues in one of the following ways:

- By filtering the issues page according to issues detected by Cortex
  Cloud Identity Security.

- By following the identity issues link under the Cortex Cloud Identity
  Security module menu.

When opening each identity security issue, you are provided with
relevant evidence, such as an explanation about the issue, what\'s
causing it, why it is important and what you can do to fix it.
Additionally, you are provided with detailed information about the risky
permissions, misconfigurations, or any other detail relevant to
understanding and solving the issue. For more information, see [Use case
5: Remediate identity security and compliance
issues](#X17b3587efad51c355f14a0b7e00c9d35bf83c91).

Use case 3: Review your cloud identities

The identity inventory is built on scanning and discovering all your
cloud assets after having completed your onboarding to Cortex Cloud
Identity Security. Your identity inventory comprises five categories:

- **Human Identities**: Displays all cloud, IDP, and platform users.

- **Non-human Identities**: Machine identities that can assume
  permissions and conduct cloud IAM actions. This includes, for example,
  VMs and functions.

- **Cloud Service Accounts** A category unifying AWS roles, Azure
  service accounts and managed identities, and GCP service accounts.

- **Groups**: IAM groups.

- **Policies**: Permission documents, AWS policies, and Azure and GCP
  roles.

Each asset has related attributes that you can use to analyze your
inventory data to gain insights about your environment. Attributes can
be information collected directly from the cloud, or calculated by
Cortex Cloud Identity Security to provide you with more context about
your assets.

There is an **Access to Resources** attribute for identities that sums
up the amount of resources that an identity has access to, that a cloud
service account grants access to, or that a group grants access to. For
wildcard permissions, only resources that are considered assets on the
platform are counted. Wildcard permissions for other resources are
counted as one resource.

Use case 4: Review and rightsize an identity's permissions

You can review an identity\'s access by using the access table, which is
found on the **Access** tab of an asset, and appears for the following
assets:

- Identities (human and non-human)

- Cloud service accounts

- Groups

- Cloud destinations (assets on which IAM actions can be performed)

Since each asset plays a different role in a permission (a human
identity performs actions, while a group grants permissions), each asset
is therefore associated with a slightly different table, showing
relevant information about the permission relevant to the asset.

Note that some assets can have more than one role in permissions. For
example, a non-human identity can be both a source and a destination.
For that reason, such assets get two tables. For example, a cloud
service account has the following two tables:

- What can this Cloud Service account do, and to whom does it grant
  permissions?

- Who can access this asset?

For each row, which represents a direct relationship between a source, a
destination and a granter,  the access table shows additional
information about the relevant permission, such as:

- Which access levels are granted.

- How many unused and excessive permissions are granted. Clicking on the
  number of unused or excessive permissions opens a new window, showing
  a detailed list of all these permissions.

- What is the account access type?

- Which sensitive data labels are found on the permissions destination
  (where relevant)?

Additionally, the destination assets overview page shows a list of
identities that can access them. This table displays the top 100 most
permissive identities for the asset, ordered according to the latest
access that was performed on this asset.

Use case 5: Remediate identity security and compliance issues

Identity issues include specific evidence, meant to provide you with the
relevant information to help you understand:

- What is the issue?

- Where is it occurring?

- Why is it important? What risk is this posing to your environment?

- Which MITRE tactics and methods are involved with this issue?

- How can you approach fixing this issue?

Follow the evidence information and instructions to analyze and
remediate the issues.

Use case 6: Review and mitigate 3^rd^-party access

For various reasons, you may choose to grant access to your account to a
third-party vendor. However, are you monitoring for over-privileged
third-party vendors? Are you removing unused permissions granted to
third-party vendors? Use the following capabilities to ensure that no
excess access is granted to third-party vendors, using the following
capabilities:

- **Dashboard widget:** Use the **3^rd^-Party Access** dashboard widget
  to view all vendors with access to your environment. You can see how
  many resources each vendor can access, and at which access levels.

- **Access tables:** Filter a destinations access table on the
  "third-party vendor" account access to view all third-party vendors
  that can access the destination. You can now see what each vendor can
  do with the asset, whether each vendor has been granted excessive
  access, and if there are any unused permissions that can be removed.

Use case 7: Asset relationships

One of the main pillars behind managing identity security is
understanding the relationships that identity assets have with one
another. In order to understand how an identity is granted its
permissions, you first need to fully understand which groups the asset
is a member of, which cloud service accounts it can impersonate, and if
it has any policy attachments or inline policies. On the **Identity**
tab of an asset, on the **Relationships** subtab, Cortex Cloud Identity
Security displays all the relationships associated with an identity
asset. All the relationships a given asset has with other identity
assets are displayed in a table.

- **Example 1**: To view the groups associated with a user:

  1.  In the **Identity Security** module, under
      **Identity Asset Inventory**, select an asset type.

  2.  In the list on the right, click an asset whose associated groups
      you want to display.

  3.  In the pane that opens, on the **Identity** tab, on the
      **Relationships** subtab, under **Groups**, a list is displayed
      containing each group name and its access levels for the user.

- **Example 2**: To view the identities that can impersonate a service
  account:

  1.  In the **Identity Security** module, under
      **Identity Asset Inventory**, select **Cloud Service Accounts**.

  2.  In the list on the right, click a cloud service account whose
      information you want to display.

  3.  On the **Identity** tab, on the **Relationships** subtab, under
      **Identities**, a list is displayed containing identities that are
      able to impersonate cloud service accounts.

#### How to manage RBAC and SBAC in Cortex Cloud Identity Security

##### Grant role-based access control (RBAC) to a user

Role-based access control (RBAC) helps manage access to Cortex
XSIAM components and Cortex Query Language (XQL) datasets, so that
users, based on their roles, are granted the minimal access required to
accomplish their tasks.

There are two out-of-the-box roles in Cortex Cloud Identity Security
that you can use to grant access only to the areas that are relevant for
those working with Cortex Cloud Identity Security:

- **Identity Security Administrator**: Has full access to all general
  administrator and Identity Security capabilities.

- **Identity Security Viewer**: Can view most Identity Security features
  and edit reports.

For information about managing access for Cortex Cloud Identity Security
users, see [Set up users and
roles](#UUID9e92a76abab5467188e24c5c28db2fe7).

> **Important**
>
> You can use the Cortex Cloud Identity Security RBAC roles to define
> access to the various sections and functionalities of Cortex Cloud
> Identity Security, but these roles do not directly control the
> specific data a user sees within those sections. Data visibility is
> further refined and limited by scope-based access control (SBAC)
> capabilities.

##### How scope-based access control (SBAC) works in Cortex Cloud Identity Security

Scope-based access control (SBAC) refines RBAC permissions by granting
access only to the relevant data that a user requires for their
designated role. Users having Access Management permission apply scopes
in Cortex XSIAM to limit the data and content that users can be granted
access to. These are divided into different scoping areas, including
Assets, Cases and Issues, and Endpoints, which can be applied as
relevant to the enforcement area or entity. For more information about
user scopes, see [Manage user
scope](#UUID071cdbb66c6a6afe3a671fa79991a0a8).

###### Access table display behavior

The access table of an asset is displayed to users whose scope includes
that specific asset. However, if this access table also lists other
assets that are not within the user\'s defined scope, the entire table
is still visible in order to ensure that the user has a full
understanding of the asset being reviewed. In such cases, if the user
attempts to click on an asset that falls outside their scope, an empty
asset page is displayed.

For more information about assets, see
[/document/preview/1278203#UUID-0fa830aa-bf98-79c4-4715-55d1d5deb0c8](/document/preview/1278203#UUID-0fa830aa-bf98-79c4-4715-55d1d5deb0c8).

###### Define SBAC policies

In the Cortex Cloud Identity Security area, we strongly recommend using
scopes such as Cloud Provider type, Account, or Region when defining
your SBAC policies for the Cortex Cloud Identity Security module. Using
scopes that are based on asset types (such as restricting according to
specific EC2 instances or Amazon S3 buckets) as your primary or sole
scope can influence the effectiveness of your SBAC policies for the
following reasons:

- **Interconnected permissions**: Permissions in cloud environments
  often involve more than one asset type. For example, a single
  permission might grant access to an Amazon S3 bucket or to an EC2
  instance also includes an related IAM (execution) role of the
  instance. This is why limiting the user scope to a specific asset type
  is not recommended  when permissions are involved.

- **Partial visibility**: Cortex Cloud Identity Security displays a
  permission if even one of the assets involved in that permission is
  not part of the user\'s defined scope. This ensures that users have
  sufficient context, even if not all associated assets are within their
  direct view.

###### Work with SBAC-related datasets

For investigating Identity Security permission data, Cortex XSIAM
provides one principal dataset: `ciem_permissions_with_last_access`.

For more information about this dataset, see [How to perform advanced
Identity Security investigations using
XQL](#UUID016e38f0db99d08836853d92a3c791e8). This dataset supports your
defined SBAC policies. Users accessing this dataset will be able to see
permission data that falls within their assigned scope.

#### How to achieve the principle of least privilege access

##### Overview

Cortex Cloud Identity Security uses audit logs to detect unused
permissions. The Review Unused Permissions feature can help you analyze
audit logs in order to identify and revoke excessive permissions. This
allows you to generate precise IAM policies based on actual usage,
reducing your attack surface and strengthening your overall security
posture. You can customize the time frame for used permissions according
to your specific operational needs.

The Review Unused Permissions feature is supported for these platform
entities:

- **Amazon AWS:**

  - IAM roles

  - IAM groups

- **Microsoft Azure:**

  - Service principals

  - IAM groups

Cortex Cloud Identity Security does the following:

- Analyzes last access data in order to detect the permissions that are
  being used.

<!-- -->

- > **Note**

  > In the case of Amazon AWS, Cortex Cloud Identity Security also uses
  > AWS Identity and Access Management (IAM) Access Advisor insights to
  > expand the coverage of supported actions.

<!-- -->

- Recommends the removal of unused permissions, displaying recommended
  actions, such as **Keep** and **Remove**.

- Generates downloadable policies in:

  - **Amazon AWS:** IAM Policy (JSON), HashiCorp® Terraform,
    CloudFormation

  - **Microsoft Azure:** Role Definition and Role Assignment (JSON),
    HashiCorp® Terraform

##### Reviewing Unused Permissions

1.  In the Cortex Cloud Identity Security module, under
    **Identity Asset Inventory**, on the **Cloud Identities** tab,
    select an identity in the list whose permissions you want to review.

2.  On the **Overview** tab, in the **Review Unused Permissions** area,
    click **Analyze Permissions Usage**, and select a time period in the
    list.

3.  Click **Start Analysis**.

4.  On the **Permission Checkup Results** screen, a summary of
    permissions usage is displayed according to the time period you
    selected, with the suggested **Remove** number in red and the
    recommended **Keep** number in blue.

5.  If you want to proceed with seeing the recommended changes and how
    you could reduce unused permissions, click Adjust Policy, and select
    one of these formats in the list:

    - JSON

    - Terraform

    - Cloud Formation

6.  A code block with the format you chose now appears. You can do one
    of the following:

    - Click **Download File** to save a copy of the file.

    - Click **Copy to clipboard **and then paste the code into a file of
      your choice.

7.  You can now click **Back to Checkup Result** to return to the
    previous screen. You can review the policy list to see and consider
    the **Cortex Recommendation** column, which displays either
    **Remove** or **Keep** for each policy file.

> **Important**
>
> If you turn off the audit logs, even briefly, this temporarily impacts
> the accuracy of the Last Access data, potentially showing permissions
> as unused when actually they were active. Full accuracy is restored 90
> days after you re-enable the audit logs.

#### How to enable inactive human identity logs on Azure in Cortex Cloud Identity Security

To enable inactive human identity logs on the Microsoft Azure platform
in Cortex Cloud Identity Security, you must first configure diagnostic
settings for the **SignInLog** log types. These log types provide
information regarding how long human identities have been signed in.

To configure the **SignInLog** log types, do the following:

1.  Open the Azure console.

2.  Navigate to the **Diagnostic settings** screen.

3.  In the **Logs** area, under **Categories**, select the following
    categories that are related to sign-in logs:

    - **SigninLogs**

    - **NonInteractiveUserSigninLogs**

    - **ServicePrincipalSigninLogs**

    - **ManagedIdentitySigninLogs**

    - **ADFSSigninLogs**

4.  Click **Save**.

> **Note**
>
> For more information, see [Ingest logs from Microsoft Azure Event
> Hub](#UUIDeea2dc8d25e9ba4921be3e9584adb07c).

#### How to perform advanced Identity Security investigations using XQL

##### Overview

Cortex Cloud Identity Security centralizes identity-related information
into a list of datasets, providing the foundation for comprehensive
security investigations. Using Cortex Query Language (XQL) , security
practitioners can create custom queries to extract valuable insights
from these data sources within your system. For more information, see
[Get started with XQL](#UUIDd08e1a9c8397fe101964781e65ee8407).

You can use the following identity-related datasets:

  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  Dataset                             Description
  ----------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------
  ciem_permissions_with_last_access   Contains the permissions of each identity that is discovered in your environments, including the time of their last access when applicable.

  asset_inventory                     Contains an inventory of all the assets that are discovered in your environments. For more information, see
                                      [/document/preview/1278203#UUID-0fa830aa-bf98-79c4-4715-55d1d5deb0c8](/document/preview/1278203#UUID-0fa830aa-bf98-79c4-4715-55d1d5deb0c8).

  issues                              Contains the issues that are related to the assets in your environments. For more information, see
                                      [/document/preview/1434529#UUID-a581c7be-bb45-20cd-9592-9535eca1df63](/document/preview/1434529#UUID-a581c7be-bb45-20cd-9592-9535eca1df63).

  findings                            Contains the findings that are associated with the assets that are found in your environments. For more information, see [Findings and
                                      events](#UUIDbf161f3cb4dca8f66e01758cc950c3ea).
  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

##### Investigate Cortex Cloud Identity Security

To run queries on your Cortex Cloud Identity Security datasets:

1.  In Cortex XSIAM, in the navigation pane on the left, click
    **Investigation & Response**, then under **Search**, click
    **Query Builder**.

2.  Click **XQL**.

3.  You can start typing your query in the box at the top of the screen,
    or search for existing queries on the **Query Library** tab.

4.  Click **Run**. The results appear on the **Query Results** tab.

> **Note**
>
> For more information, see
> [/document/preview/1282353#UUID-6b616ab5-87bc-e353-5aa5-51e6d5370560](/document/preview/1282353#UUID-6b616ab5-87bc-e353-5aa5-51e6d5370560).

##### Examples

Here are some examples of identity-related queries you can run in Cortex
XSIAM to investigate your identity posture:

1\. Count the number of admin sources per account

    dataset = ciem_permissions_with_last_access 
    | filter action_access_isadministrative in(true, TRUE) 
    | dedup source_cloud_resource_uai, source_cloud_account_id 
    | comp count(source_cloud_resource_uai) as admins_count by source_cloud_account_id  
    | sort desc admins_count

2\. Azure service principals granting write permissions on the
subscription level

    dataset =  ciem_permissions_with_last_access
    | filter dest_cloud_type = "AZURE" and action_access_level contains "Write" and grantedby_level_type = "AZURE_SUBSCRIPTION" and grantedby_cloud_entity_type = "service principal"
    | fields source_cloud_resource_name, source_cloud_resource_type, grantedby_cloud_entity_name, grantedby_level_name, grantedby_level_type

3\. Group permissions on production assets

    dataset = ciem_permissions_with_last_access
    | filter dest_cloud_type = "GCP" and action_access_level = "config" and source_cloud_resource_type = "user" and grantedby_cloud_entity_type = "group" and wildcard_match("prod.*", dest_cloud_resource_name)
    | fields source_cloud_resource_name, grantedby_cloud_entity_name, dest_cloud_resource_name, dest_cloud_resource_type

4\. Users without MFA and sensitive S3 and EC2 permissions

    dataset =  ciem_permissions_with_last_access
    | filter source_cloud_type = "aws" and source_cloud_resource_type = "user" and action_access_level contains "Config" and dest_cloud_service_name in ("s3", "ec2")
    | join (dataset = asset_inventory) as assets source_cloud_resource_uai = assets.xdm.asset.id
    | filter lowercase(json_extract_scalar(xdm.asset.normalized_fields, "$['xdm.identity.has_mfa']")) = "false"

5\. Azure VM with data write permissions on the subscription levels

    dataset = ciem_permissions_with_last_access
    | filter source_cloud_type = "azure" and source_cloud_resource_type = "virtualMachines" and (lowercase(action_access_level) contains "config" or lowercase(action_access_level) contains "write") and dest_cloud_resource_type ~= "^storageAccounts/blobServices" and grantedby_level_type = "AZURE_SUBSCRIPTION"

6\. Policies granting wildcard permissions

    dataset =  ciem_permissions_with_last_access| filter dest_cloud_resource_name ~= "^\*$" and grantedby_cloud_policy_type in ("AWS_CUSTOMER_MANAGED_POLICY", "AWS_MANAGED_POLICY")| dedup grantedby_cloud_policy_id| fields grantedby_cloud_policy_id as policy_arn

7\. Administrative roles open to third-party vendors and external
unknown accounts

    dataset =  ciem_permissions_with_last_access
    | filter grantedby_cloud_entity_type = "role" and action_access_isadministrative = true and account_access in ("EXTERNAL_UNKNOWN", "THIRD_PARTY_VENDOR")
    | fields grantedby_cloud_entity_name, grantedby_cloud_entity_account_name, source_cloud_account_name, account_access

8\. Show identities with unused permissions

    dataset = ciem_permissions_with_last_access 
    | filter last_access_time != null and timestamp_diff(current_time(), last_access_time, "DAY") > 90 and source_cloud_resource_name !~= "^\*$"
    | dedup source_cloud_resource_name, source_cloud_account_id, action_name, dest_cloud_resource_name, last_access_time
    | fields  source_cloud_resource_name, source_cloud_account_id, action_name, dest_cloud_resource_name, last_access_time

9\. Unused permissions by lambda functions

    dataset = ciem_permissions_with_last_access 
    | filter source_cloud_service_name= "lambda" and source_cloud_resource_type = "function" and source_cloud_region = "Virginia" and is_last_access_supported = true 
    | alter days_since_used = timestamp_diff(current_time(), last_access_time, "DAY") 
    | filter days_since_used > 90
    | fields source_cloud_resource_uai, source_cloud_resource_name, days_since_used, action_name, action_access_level 

10\. Get all the non-admin sources that can assume an admin role

    dataset = ciem_permissions_with_last_access 
    | filter action_name = "sts:AssumeRole"
    | fields source_cloud_resource_uai, dest_cloud_resource_uai, dest_cloud_resource_id, dest_cloud_account_id 
    | filter source_cloud_resource_uai not in(dataset = ciem_permissions_raw 
    | filter action_access_isadministrative in(true, TRUE) 
    | dedup source_cloud_resource_uai 
    | fields source_cloud_resource_uai) 
    | fields source_cloud_resource_uai as source, dest_cloud_resource_uai as dest_uai, dest_cloud_resource_id as dest_id, dest_cloud_account_id as dest_account_id 
    | join(dataset = ciem_permissions_raw 
    | filter grantedby_cloud_entity_type = "role" 
    | filter action_access_isadministrative in(true, TRUE) 
    | dedup grantedby_cloud_entity_id 
    | fields grantedby_cloud_entity_account_id, grantedby_cloud_entity_id) as admin_roles (dest_id = admin_roles.grantedby_cloud_entity_id or (dest_id ~= "^\*$" and dest_account_id = admin_roles.grantedby_cloud_entity_account_id)) 
    | fields source

11\. Administrative permissions granted to EC2 instances that can access
multiple services

    dataset = ciem_permissions_with_last_access
    | filter source_cloud_resource_type = "instance" and source_cloud_service_name = "EC2" and action_access_isadministrative = true
    | comp values(action_name) as actions by source_cloud_resource_uai, source_cloud_resource_name, source_cloud_account_id, grantedby_cloud_entity_name
    | join (dataset = asset_inventory) as assets source_cloud_resource_uai = assets.xdm.asset.id
    | alter access_to_services = to_integer(json_extract_scalar(xdm.asset.normalized_fields, "$['xdm.identity.access_statistics.services']"))
    | filter access_to_services >= 10
    | fields source_cloud_resource_name, source_cloud_resource_uai, access_to_services, grantedby_cloud_entity_name

### Cortex Advanced Email Security

#### Cortex Advanced Email Security module overview

> **Prerequisite**
>
> The following are prerequisites for using the Cortex XSIAM Advanced
> Email Security module.

+-----------------------------------+-----------------------------------+
| > REQUIREMENT                     | > DESCRIPTION                     |
+===================================+===================================+
| > Setup and Permissions           | > Ensure Analytics is activated   |
|                                   | > before enabling the Cortex      |
|                                   | > Advanced Email Security module. |
+-----------------------------------+-----------------------------------+
| > Licenses and Add-ons            | > Cortex Advanced Email Security  |
|                                   | > add-on.                         |
+-----------------------------------+-----------------------------------+

The Cortex Advanced Email Security module provides a scalable detection,
investigation, and response layer over cloud-hosted email environments.
It connects directly to supported email platforms via secure API
integrations to ingest rich message-level and identity-related
telemetry.

Unlike legacy approaches that rely on inline enforcement, this module
operates passively, requiring no mail flow changes, and is optimized for
modern, distributed email infrastructures. After the module is
connected, it continuously collects data across messages, artifacts
(e.g., links, attachments), user identities, and authentication
metadata. This data is processed through a multi-layered analysis engine
designed to surface early-stage threats, campaign patterns, and
high-risk behaviors.

This document provides detailed technical guidance for onboarding,
configuring, and operating the module. It is intended for security
administrators and operators with access to email platform APIs, and
familiarity with foundational email security concepts for example,
SPF/DKIM/DMARC, MIME structure, phishing tactics.

##### Key capabilities and functional highlights

The Cortex Advanced Email Security module is composed of the following
core components:

API-based email ingestion

Our API-based email ingestion method ensures comprehensive data
collection with minimal operational overhead.

- Collects email metadata (headers, subject, sender/recipient data),
  message content, URLs, attachments, and authentication verdicts.

- Operates independently of journaling or MTA/MX path modifications.

- Performs scoped mailbox ingestion based on directory mapping or
  security group tagging.

Detection framework

The detection engine combines traditional heuristics, rule-based logic,
and large language model (LLM) analysis for deeper message
understanding.

- **Heuristic and behavior-based rules:** Covers impersonation, display
  name spoofing, domain lookalikes, BEC-style behavior, suspicious
  attachment types, and link patterns.

- **LLM-powered message analysis:** Uses large language models to detect
  intent, linguistic anomalies, tone manipulation, urgency patterns, and
  topic impersonation. This enables identification of sophisticated
  phishing emails that bypass static indicators.

- **Policy controls:** Enables admins to adjust detection thresholds,
  suppress known benign behaviors, or configure alert generation on
  specific categories, for example, URL reputation hits, newly
  registered domains.

Phishing reporting integration

Phishing attempt reports are collected in a dedicated inbox. Reported
messages are then ingested  as additional input to the detection
pipeline and optionally correlated with existing threats.

Issue enrichment

Issues are enriched with the following:

- User identity metadata, behavioral baselines, and artifact reputation
  scores.

- Additional context such as risk level, detection rationale, and
  correlated entities to support faster triage.

Response mechanisms

When the module identifies an email threat, it initiates a series of
response mechanisms to neutralize the threat and protect users.
Automated and manual actions include message removal, sender blocking,
allowlisting, tagging false positives. Action execution is tracked per
message and per user, with rollback capability where supported.

Case management and correlation

The module groups email issues into cases based on shared indicators or
behavioral similarities (e.g., identical links across multiple users,
same impersonation theme). This enables centralized investigation of
broader campaigns.

Command Center dashboard

The Email Command Center provides real-time visualization of email
threat activity, issue trends, policy effectiveness, and user-based risk
profiles.

Cross-module correlation (optional)

In environments with extended visibility (e.g., endpoint, identity),
issues are enriched with cross-domain signals to support attack path
reconstruction and unified incident handling.

##### Supported email platforms and services

The module supports cloud-native email platforms that expose secure APIs
for mailbox telemetry, user directory access, and optional remediation
actions.

**Supported integration capabilities include:**

- Read-access to user mailboxes

- Header and authentication metadata

- Access to reported phishing addresses

- Mailbox/user scoping via directory service

- Remediation permissions (delete, move, tag)

**Unsupported environments:**

- On-premise Exchange or SMTP-only deployments

- Hybrid email architectures with incomplete API visibility

- IMAP/POP-based collection (protocol-only)

For detailed setup instructions and platform-specific capabilities,
refer to the Deployment and Configuration section.

#### Cortex Advanced Email Security module architecture and data flow

The Cortex Advanced Email Security module is composed of several logical
components, deployed in a cloud-native architecture. These components
work together to ingest, analyze, and respond to email-borne threats.

![](media/rId4267.png){width="5.833333333333333in"
height="3.5729166666666665in"}

Data collector

The data collector connects to the email platform via secure APIs to
ingest message metadata, content, URLs, attachments, authentication
verdicts, and user context (for example, group membership, privilege
level). Collection occurs on a continuous basis with support for
incremental deltas where applicable.

Detection engines

The module supports a multi-layered detection architecture composed of
three distinct detection engines, each focused on a different analytical
layer:

- Artifact-based engine

  - Analyzes discrete components embedded in the email such as file
    attachments and URLs.

  - Leverages hash matching, sandbox integration (where available), and
    URL reputation systems to identify known or behaviorally malicious
    artifacts.

- Metadata Analytics engine

  - Evaluates risk based on email metadata, sender-recipient
    relationship history, header anomalies, and identity context (for
    example, VIP status, role, group associations).

  - Detects impersonation, spoofing, newly seen senders, and anomalous
    communication patterns based on statistical baselining and heuristic
    rules.

  - Surfaces signals associated with business email compromise (BEC),
    supply chain impersonation, and domain lookalikes.

- LLM-based engine

  - Processes the plain-text and HTML content of the email using large
    language models.

  - Extracts semantic signals such as urgency, intent, emotional tone,
    and topic-based impersonation(for example, finance, HR, IT support).

  - Feeds these high-level attributes into a broader social graph used
    to understand message deviation from historical tone and role-based
    communication patterns.

  - Enhances detection of sophisticated phishing and text-only social
    engineering attacks that evade traditional signatures.

Issue processing and correlation layer

This layer normalizes output from the detection engines into a
standardized issue format. It then correlates multiple issues into cases
where shared indicators, for example, sender, URL, or theme, are
identified. This layer also assigns a Score (using SmartScore) and
enrichment metadata for downstream workflows.

Response engine

This engine executes response actions either automatically based on
policy or manually via analyst intervention. It supports message
removal, sender blocking, and false positive handling where platform
permissions allow. All actions are logged with timestamp, executor, and
result status.

User interface and admin console

The module includes a web-based management interface for the following:

- Viewing Issues and case timelines

- Investigating threat artifacts

- Configuring detection policies

- Managing exclusions and remediation rules

- Monitoring dashboard statistics and risky user profiles

#### Getting started with the Cortex Advanced Email Security module

> **Prerequisite**
>
> Before you configure the Cortex Advanced Email Security module, ensure
> you have the following:

- > Admin-level access to the target email platform

- > API permissions to read mailbox data, manage remediation (if
  > desired), and access user directories

- > Dedicated service account (recommended) for integration purposes
  > (response actions)

- > List of domains and mailboxes to be protected (to be used during the
  > wizard configuration)

- > Access to an internal phishing reporting mailbox (to collect
  > user-reported phishing - optional)

**Deployment workflow overview**

A typical deployment follows the following sequence.

1.  Provisioning

    - Authenticate to Microsoft 365 as admin

    - Grant API access scopes to Cortex Advanced Email Security module

    - Select domains/mailboxes to protect

2.  Verification

    - Confirm data ingestion

    - Generate sample test email for issuing validation

    - Review initial dashboard population

3.  Configuration

    - Define phishing report address (optional)

    - Set up issue exclusions and remediation rules

4.  Operation

    - Begin issue triage and investigation using issues table and email
      card view

    - Fine-tune detection rules over time

    - Monitor response actions and refine policies

#### Deploy and configure the Email Security module

To start using the Cortex Advanced Email Security module, configure the
Microsoft O365 integration and then configure the module.

##### Integrate Microsoft 365 with the Cortex Advanced Email Security Module

Deploy the Cortex Advanced Email Security module by configuring
integration permissions and settings for Microsoft 365.

API Permissions and Setup

Deploy the Cortex Advanced Email Security module to collect data from
your organization\'s email network and to generate issues when
suspicious activity is detected. To use the Cortex Advanced Email
Security module, activate it and then configure the integration
permissions and add the email collector as a data source to Cortex
XSIAM.

1.  From Settings \> Cortex XSIAM License, select
    **Cortex Advanced Email Security Module**, and click **Enable**.

2.  Configure the Microsoft 365 email collector. For more information,
    see
    [/document/preview/1065749#UUID-89498da3-9d86-883e-09bc-b02807d45884](/document/preview/1065749#UUID-89498da3-9d86-883e-09bc-b02807d45884).

Configure Quick Actions

Define remediation actions to be run for the email security issues.

> **Note**
>
> To configure a quick action, you must first create an application in
> Microsoft O365.

To configure each set of actions, do the following:

1.  Go to **Marketplace** and select the content pack that corresponds
    to the action(s) you want to add.

+-----------------------+-----------------------+-----------------------+
| Quick action          | Content pack          | Integration           |
+=======================+=======================+=======================+
| Block Sender          | Microsoft Exchange    | EWS Extension Online  |
|                       | Online                | Powershell v3         |
| Unblock Sender        |                       |                       |
+-----------------------+-----------------------+-----------------------+
| Delete Email          | Microsoft Exchange    | O365 - Security And   |
|                       | Online                | Compliance - Content  |
| Undelete Email        |                       | Search v2             |
+-----------------------+-----------------------+-----------------------+
| Send Email to         | Microsoft Graph Mail  | Microsoft Graph Mail  |
| Recipients - Office   |                       | Single User           |
| 365                   |                       |                       |
+-----------------------+-----------------------+-----------------------+

2.  Select the integration.

3.  Select **Add Instance**.

4.  Configure the connection using the credentials from Microsoft O365.

5.  **Test** the connection, and then **Save**.

After you onboard your domains and configure the quick actions, Cortex
XSIAM manage your protected domains in Modules \> Email Security \>
Email Security Configuration.

##### Configure the Cortex Advanced Email Security module

> **Note**
>
> Requires the Email Security module.

Use the **Email Security** configuration page to manage your protected
domains, allow list, and phishing email addresses. To access the page,
navigate to Modules \> Email Security \> Email Security Configuration.
You have the following options.

- **Protected Domains**: All the domains you added to the collector for
  your organization.

- **Block List**: All blocked indicators related to emails, including
  URLs, attachment file hashes, or sender email addresses that are
  flagged as malicious.

<!-- -->

- Right click a row to edit, delete, disable, and copy each block list
  rule. In this section, you can add indicators you want to include in
  your block list.

  1.  Click **Add**.

  2.  In **Create Block List Rule**, select the type - URL, Hash, or
      Email Address.

  3.  Type the indicator, add any comments you want, and click **Done**.

<!-- -->

- **Allow List**: All the trusted indicators related to emails,
  including URLs, attachment file hashes, and sender email addresses.
  These exclusions also appear in the **Issue Exclusions** list under
  **Exceptions Configuration**.

<!-- -->

- Right click a row to edit, delete, disable, and copy each allow list
  rule. In this section, you can add indicators you want to exclude from
  generating issues.

  To add indicators:

  The new indicator is added to the **Allow List** and to the general
  **Issue Exclusions** tables.

  1.  Click **Add**.

  2.  In **Create Allow List Rule**, select the type : **URL**,
      **Email Sender**, or **Email Attachment**.

  3.  Type the indicator, add any comments you want, and click **Done**.

  > **Note**

  > You can add email indicators to the Allow List also in Exceptions
  > Configuration \> Issue Exclusions. However, if you add multiple
  > indicators in a rule using **Issue Exclusions** under
  > **Exceptions Configuration**, you cannot edit the rule in the Email
  > Security Allow List. (in review by Guy)

<!-- -->

- **Phishing Email Address**: Configure email boxes for collecting the
  emails that users report as phishing.

#### Cortex Advanced Email Security threat detection and issues

The Cortex Advanced Email Security module supports a wide range of
detection types, designed to identify malicious, suspicious, or
policy-violating emails. These detections are generated by the
artifact-based, metadata-driven, and LLM-powered engines described in
the Architecture and Data Flow section.

##### Threat detection categories

All analytics-based detections are documented in the external Analytics
Issue Reference, including the following:

- Issue name

- Trigger conditions

- Associated MITRE TTPs (where applicable)

- Recommended response actions

In addition to Analytics listed in the reference, the module supports
the following extended categories:

- WF Analysis issues: Generated based on WildFire verdicts
  (malicious/suspicious) for file attachments, where integration is
  enabled.

- AURL issues: Based on Advanced URL analysis verdicts (for example,
  detected phishing kit, dynamic redirects, credential harvesting
  behavior).

- IOC-Based issues: Triggered when an email contains known malicious
  indicators (SHA256, domain, URL, or sender) that match internal or
  external blocklists.

- User-Reported Phishing issues : Generated when users forward emails to
  a designated phishing report address. These issues can be generated
  independently or correlated with other detection logic if matches are
  found.

Each issue type may be subject to additional correlation and aggregation
into case entities based on shared characteristics, for example, sender,
artifact, theme, etc.

##### Email security issue metadata and fields

Each issue contains a structured set of metadata fields that provide
forensic and contextual insight for downstream investigation. Below is a
breakdown of key issue fields available via the console, APIs, or case
export.

  --------------------------------------------------------------------------
  Attribute               Field Name                 Description
  ----------------------- -------------------------- -----------------------
  Issue Name              issue_name                 High-level issue
                                                     classification

  Issue Description       issue_description          Human-readable
                                                     description of the
                                                     threat

  Message ID              internet_message_id        Unique ID of the email
                                                     message

  Conversation ID         conversation_id            Thread/conversation
                                                     identifier

  Email Created Date      created_date               Timestamp when the
                                                     message was sent

  Subject                 subject                    Subject line of the
                                                     email

  Email Recipient(s)      recipients.name,           All TO recipients of
                          recipients.email           the email

  CC Recipient(s)         cc_recipients.name,        All CC recipients
                          cc_recipients.email        

  BCC Recipient(s)        bcc_recipients.name,       All BCC recipients
                          bcc_recipients.email       

  From Address            from.address               Displayed From: email
                                                     address

  From Display Name       from.name                  Display name shown in
                                                     From field

  Sender Address          sender.address             Actual sender address
                                                     (SMTP-level)

  Sender Name             sender.name                Display name of sender
                                                     (SMTP envelope)

  Return-Path             return_path_data.address   Return path address
                                                     (SMTP envelope)

  Attachment SHA256       attachments.hash_str       Hashes of attached
                                                     files

  Attachment Name         attachments.name           Filenames of attached
                                                     files

  URLs                    url_verdicts.url_name      URLs extracted from the
                                                     message body

  Internet Message        internet_message_headers   Full set of original
  Headers                                            headers
  --------------------------------------------------------------------------

> **Note**
>
> Depending on data collection mode and platform capabilities, not all
> fields may be populated for every message. API and export
> documentation provides further clarification on optional vs required
> fields.

##### Email security issue correlation mechanism

The issue correlation layer is responsible for linking related issues
into cohesive cases. Correlation is performed using the following logic.

- Sender-based correlation: Issues from the same sender with similar
  delivery patterns across multiple recipients.

- Artifact-based correlation: Issues with shared attachment hashes,
  URLs, or domains.

- User-based correlation: Issues involving the same recipient or
  identity in a short time window.

Correlated issues are grouped into a single case object with unified
investigation timelines and shared contextual insights (for example,
conversation metadata, risky user involvement, cumulative score).

##### Email Security Analytics Rules

The Email Security Analytics Rules page offers a consolidated view of
all Analytics BIOC and XDR Analytics rules used in the Cortex Advanced
Email Security module to keep your email domains secure. You can see
every Analytics rule that could generate an email security issue and
take action to customize the rules for your organization.

Within this unified table, you can leverage powerful capabilities to
manage and investigate Analytics rules effectively.

- Get an understanding of all the rules that generated an issue in one
  place.

- Filter rules by name or description for seamless integration with
  issue investigations.

- Filter rules by any column, including \"Variant Severities\" to
  quickly locate rule variants associated with specific severity
  criteria.

- Order by any column, enabling you to prioritize and evaluate issues
  based on severity, name, modification time, and other critical
  factors.

- Fine-tune your XDR Analytics rules by disabling or enabling specific
  ones.

- View more information for a selected analytics rule, including all its
  variants, and pivot to the [Cortex Analytics
  Reference](https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM/Cortex-XSIAM-Analytics-Alert-Reference-by-Alert-name/Cortex-XSIAM-Analytics-Alert-Reference)
  for the specific rule.

The Email Security **Analytics Rules** page is in Modules \> Email
Security \> Email Security Detection Rules.

The page displays the following properties of Analytics rules:

- Modification Time: When the rule was last changed.

- Name

- Severity: Severity of the basic variant.

- Severity Variations: Number of different variants for the rule,
  including their respective severities.

- Status

- Type: XDR Analytics or XDR Analytics BIOC

- Tags: Detector tag

- Description

- Mitre Att&ck Tactic

- Mitre Att&ck Technique

- \# of Issues: Number of issues generated by the rule in all its
  variants.

- Activation Prerequisites

- Creation Time

- Global Rule ID

Use the right click menu for the following actions:

- Disable or enable a rule to customize issue generation based on the
  Analytics rule.

- View all the email security issues that were generated by applying
  this rule.

- Show or hide all rows with a specific rule.

- View the rule with all its variants, including their respective
  descriptions, tags, and severities in the **View Analytics Rule**
  screen.

  - For more information about the MITRE ATT&CK techniques and tactics,
    click the tag to display its explanation in the MITRE ATT&amp;CK
    database.

  - For more information about the rule, click **More information** to
    display the Analytics Alert Reference.

#### Investigate and respond to email security issues

> **Note**
>
> Requires the Cortex Advanced Email Security module.

The Cortex Advanced Email Security module monitors all incoming,
outgoing, and draft emails, and generates issues on suspicious emails.
If a user sends a large number of emails or if the same email is sent
multiple times to the users in the organization, the issues are stitched
under one issue in the **Email Security Issues** table as a multiple
event.

To view the **Email Security Issues** table that displays all the issues
that contain a detected threat related to emails and to investigate the
issues, go to Modules \> Email Security \> Email Security Issues.

In addition to all the actions available to issues in general, there are
options that are specific to the Cortex Advanced Email Security module:

View the email security issue card

Click an email security issue to open the email security card where you
can investigate the email issue, take any actions required, and see the
remediation suggestions.

From the three dot menu, you can open the issue in a new tab, pivot to
the causality view, and copy the issue URL.

At the top of the card, you can view information about the issue
including the severity, detection tags, category, and detection method.
In the tabs, you can see more information about the cause of the issue,
take any actions required, and see the remediation suggestions. 

Overview

Displays a description of the issue and provides key information, such
as the assignee, status, action taken, and time that the issue was
created and updated.

You can also see the following:

- MITRE ATT&amp;CK tactics used: Click **View All** to see the tactics
  and techniques.

- Affected assets

- Linked Cases: Number of cases linked to the issue and their severity.
  Click to see the cases to which the issue is linked.

War Room

A comprehensive collection of all investigation actions, artifacts, and
collaboration. It is a chronological journal of the issue investigation.
For information, see [Use the War Room in an
investigation](#UUID2c0cd753c167d7894913ae53aec73a42).

Work Plan

A visual representation of the running playbook that is assigned to the
issue. For more information, see [Use the Work Plan in an
investigation](#UUID3b7e55c261ead80a61a75412eec0a2f7).

Investigate the email issue causality chain

The Email Issue causality view offers an interactive visualization of
the email security issue generation. It displays the connected the
events in the process execution chain to provide immediate, actionable
insights into the cause and effect of email security issues.

To open the causality view, right click an email security issue and
click **Investigate Causality Chain**.

The following sections describe the different areas of the causality
view:

Causality chain

View the components of the events that generated the issue, including IP
address and username of the sender, the alerts that were triggered by
the email, and the name of the recipient user or distribution list.
Hover over each node to find out more about the components of the
causality chain. Click each node to see more details about it in the
**Issue Overview** on the left and in the **Events** table under the
Causality chain.

![](media/rId4292.png){width="5.833333333333333in"
height="3.0406244531933506in"}

When you open the causality card for multi-event issues, you can see all
the emails and the events that contributed to the triggering of this
issue. Click each node to investigate the different components that make
up the issues.

- Emails stitched together: Displayed in multiple events, it groups
  together all the events that contributed to the attack.

<!-- -->

- Click each envelope in the view to see the details of each event
  separately in the **Issue Overview** and the **Events** table.

<!-- -->

- IP address: Hover to view the number of emails seen from this address
  and the number of users who used it.

<!-- -->

- Click to view the geolocation and the Blocklist status in the
  **Issue Overview** and the details for the events in the **Events**
  table.

<!-- -->

- Sender username: Hover to view the organizations and the user emails
  that received emails from this user.

<!-- -->

- Click to view the details of the user in the **Issue Overview** and
  the issues from this domain and activities by the user in the
  **Events** table.

<!-- -->

- Sent emails: Displays the findings for the email event. The number of
  issues triggered by this email is displayed above the envelope.

<!-- -->

- Click the number to see the issues generated by the event in a
  carousel in the **Issue Overview**.

  Click the envelope to see the email details in the **Events** table.

  Click the eye icon to view the email.

  - Attachments: Number of attachments in the email.

  <!-- -->

  - Click the number to see each file.

    Click on each file to see the affected endpoints.

    Click each endpoint to see the affected endpoints and related issues
    in the **Events** table.

  <!-- -->

  - Links: Number of links in the file.

  <!-- -->

  - Click the number to view each attachment.

    Click each attachment to see its details in the **Issue Overview**
    and the **Events** table.

<!-- -->

- Recipients: Number of users who received this email.

<!-- -->

- Click the number to see all the user names.

  Click each recipient to see their details in the **Issue Overview**
  and their issues and past activities in the **Events** table.

Issue Overview

The overview displays detailed information for each email. Every time
you click a node in the Causality chain on the right, the information in
this pane is updated.

- A summary of the email details including the subject, number of users
  who have opened the email, attachment count, and the attack tactics.
  To see the full email message, click the eye icon.

<!-- -->

- In multiple event issues, this panel displays a summary of the issues,
  identities, endpoints, and attack types involved in the attack. When
  you click each event in the causality chain, this panel displays the
  email details common to each event.

<!-- -->

- For multiple events, this panel displays the mail Indicators like
  attachment, URL, IP address, and email subject that are shared between
  the emails stitched together in the issue.

- **Affected Identities**: A summary of the users affected by this issue
  and the risk score.

<!-- -->

- Click **View All** to see all the identities in the **Events** table.

<!-- -->

- **Affected endpoints**: A summary of the endpoints affected by this
  issue and the risk score.

<!-- -->

- Click **View All** to see all the endpoints in the **Events** table.

<!-- -->

- **Causality issues**: Top issues that were generated by the email
  detection and their risk scores.

<!-- -->

- Click **View All** to see all the causality issues in the **Events**
  table.

  For every issue that\'s not Informational, click on three dots to
  **Run Automations**.

<!-- -->

- Issue Tags that represent the detected MITRE ATT&amp;CK tactics.

Events table

The **Events** table displays up to 100,000 related events for the
process node which matches the issue criteria. Every time you click a
node in the causality chain or in **Issue Overview**, the information in
the table is updated to display the details of the findings.

Run email security automations specific to email security

The extra quick actions that are available with the Cortex Advanced
Email Security module are:

- **Block Sender Office 365**: Blocks the senders of the emails included
  in the issue.

- **Unblock Sender Office 365**: Unblocks the senders of the emails
  included in the issue.

- **Delete Email - Office 365**: Deletes the email

- **Undelete Email - Office 365**: Recovers the emails in the issue.

- **Send Email to Recipients - Office 365**: Sends an email to the
  recipients with the parameters you select.

For each quick action, do the following:

1.  Right click the issue, click Run Automation \> Select Automation.

2.  Select the relevant details or type and click **OK**.

This sends the request to Microsoft Office 365. The verdict on the
request is displayed in the War Room of the issue.

#### Automate remediation for the Cortex Advanced Email Security module

Improve remediation efficiency by responding automatically through
actions that are triggered through the Cortex Advanced Email Security
module. For more information, see [Automation in Cortex
XSIAM](#UUID5227be4a84c78144050433f8b3bfdaf2).

#### Email Command Center

> **Note**
>
> Requires the Cortex Advanced Email Security module.

The **Email Command Center** provides an interactive overview of your
email security status that offers comprehensive visibility and control
over email security threats and responses in your organization. With
real-time insights and actionable intelligence, you can stay ahead of
threats and make informed decisions with ease and confidence.

In the face of sophisticated AI-driven phishing attacks and other social
engineering tactics, the Email Command Center is essential for ensuring
organizational security. It moves beyond isolated email analysis to
offer a holistic view of potential attack chains, enabling proactive
protection and rapid response. With drill-down capabilities, reveal
detailed metrics and insights for deeper analysis and proactive threat
management.

Access the Email Command Center in Modules \> Email Security.

Select a time frame for a visualization of the different components that
make up the current risk status of your domains. You can select between
Last 24 hours, 7 days, or 30 days.

The Email Command Center is made up of the following components:

Cortex Advanced Email Security flow diagram

The diagram on the left displays general information about the email
security status of your organization.

- Configured email collectors for your organization: If a collector
  isn\'t functioning properly, its node is displayed in red. If all the
  collectors malfunction, the dynamic graphic representation of data
  collection and analysis becomes static and turns gray.

- General email metrics: Numbers of scanned emails, identified
  attachments, and links.

  - Click **Attachments** to display the **Files Breakdown** table on
    the right.

  - Click **Links** to display the **URL Reputation** table on the
    right.

- Cases Generated: Number of cases generated based on issues and
  insights, with a breakdown of the severities of the issues. Click
  **Cases Generated** to display the **Top Cases by Smartscore** table
  on the right.

- Breakdown of cases that were generated manually and by automation.

Trends and metrics

The tables displayed on the top right provide more information about the
general insights.

- **Trending Attack Vectors:** Details the type of identified attacks in
  the issues, with a description and the number of issues associated
  with each attack type. The percentage represents the change from the
  previous time frame, where red is an increase in attacks and green is
  a decrease. For example, if the attack count for the last 30 days is
  6, and the percentage is 50%, in the previous 30 day time frame, there
  were 4 attacks, and in the current 30 day time frame there were 2
  additional attacks.

<!-- -->

- Click a row to display the Issues table filtered by the specific
  attack type.

<!-- -->

- **Top Cases by Smartscore:** Presents the top ten cases listed in
  order of descending smartscore, with a description and the number of
  impacted endpoints and users. The smartscore is displayed in a box
  with colors that represent the severity.

<!-- -->

- Click a row to see the case in detail.

<!-- -->

- **URL Reputation:** Groups the links according to category, and
  provides the number of identified links in the current time frame and
  the number of links in the previous time frame. Each category is made
  up of a number of different types of link, grouped together under a
  descriptive title. The numbers inside the parentheses represent the
  number of malicious links. Click a row to see the issues that are
  generated from the emails that contain the links in the category.

- **Files Breakdown:** Categorizes the files according to file family
  type, and provides the number of attached files in the current time
  frame and the number of attached files in the previous time frame.
  Each family type is made up of a number of different file types,
  grouped together under a descriptive title. The numbers inside the
  parentheses represent the number of malicious files. Click a row to
  see the issues that are generated from the emails that contain the
  file types in the file family.

Dynamic insight widgets

The widgets displayed on the bottom right provide information and enable
drilldown to different parts of the system.

- **Issues Over Time:** Graphs the number of issues at each given point
  in the selected time frame. The dotted line represents the average
  moving trend.

- **Mailboxes:** Aggregation of all the mailboxes in the domains that
  are configured on the collector for your organization.

- **Risky Users:** The number of users that were detected as being
  risky. The percentage represents the increase or decrease compared to
  the previous time frame.

<!-- -->

- This widget also displays the top five risky users in descending order
  of risk score, together with their title in the organization, and the
  number of risky emails per user. If you have the ITDR module, the
  normalized risk score is displayed, and the email numbers and the risk
  score will be color coded to represent the severity of the risk.

  Click a user to open the **User** view.

### Exposure management

#### Exposure Management in Cortex XSIAM

> **Note**
>
> Requires the Exposure Management add-on.

Exposure Management inCortex XSIAM is a collection of features,
capabilities, integrations, and content designed to help defenders
holistically assess, consolidate, prioritize, and proactively respond to
exposures in their organization.

- **Comprehensive Visibility **

<!-- -->

- Through a robust set of Cortex sensors and third-party integrations,
  along with the Cortex XSIAM data stitching and normalization engine,
  Exposure Management provides a normalized, deduplicated view of
  exposures across multiple different sources.

<!-- -->

- **Actionable Prioritization**

<!-- -->

- Exposure Management Precision Filtering, compensating control
  identification, and the Exposure Management Command Center enable
  defenders to view their risks through a number of different dimensions
  and start each day with only the most critical cases. Fix-oriented
  case grouping makes it easier to maximize the impact of security and
  IT team's remediation efforts by identifying common remediation
  actions to address the largest number of prioritized vulnerabilities.

<!-- -->

- **Automation-first Remediation**

<!-- -->

- Platform automation capabilities and specialized exposure management
  content enable teams to augment their existing triage workflows, and
  in permissible situations, automate them entirely. Automation content
  comes ready out of the box to take actions such as:

  - Send notifications through a number of business and developer
    focused tools

  - Create tickets in third-party IT management software

  - Leverage AI-embedded remediation owner discovery

  - Take fully automated remediation actions through available control
    surfaces

##### Supported data sources

Cortex Exposure Management gathers vulnerability data from the sources
listed below.

Palo Alto Networks sensors:

- Cortex Agent

- Cortex Attack Surface Management

- Cortex Attack Surface Testing

- Cortex Cloud Agentless Scanner

- Cortex Container Registry Scanner

- Cortex Serverless Function Scanner

- Cortex Network Scanner

Third party sensors

- Qualys

- Tenable

#### Get started with Exposure Management

Complete the steps in this section to set up Exposure Management and
begin to customize it to meet your organization\'s unique requirements.
All of these steps are optional, but recommended.

+-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Step                  | Description           | More information                                                                                                                                                         |
+=======================+=======================+==========================================================================================================================================================================+
| Step 1: Configure the | These sensors scan    | - [Attack Surface Testing](https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM/Cortex-XSIAM-Premium-Documentation/Attack-Surface-Testing)                            |
| Cortex Network        | your environment and  |                                                                                                                                                                          |
| Scanner and other     | ingest                | - [Cortex XDR agents](https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM/Cortex-XSIAM-Premium-Documentation/Install-Cortex-XDR-agents)                              |
| Palo Alto Networks    | vulnerabilities so    |                                                                                                                                                                          |
| sensors               | you can review,       | - Cortex Cloud Agentless Scanner                                                                                                                                         |
|                       | prioritize, and take  |                                                                                                                                                                          |
|                       | action on them from   | - [Cortex Container Registry                                                                                                                                             |
|                       | one central location. |   Scanner](https://docs-cortex.paloaltonetworks.com/r/Cortex-CLOUD/Cortex-Cloud-Runtime-Security-Documentation/Container-Registry-Scanning?tocId=A1wbGhw8nwawgz7D2FOuJg) |
|                       |                       |                                                                                                                                                                          |
|                       |                       | - [Cortex Serverless Function                                                                                                                                            |
|                       |                       |   Scanner:](https://docs-cortex.paloaltonetworks.com/r/Cortex-CLOUD/Cortex-Cloud-Runtime-Security-Documentation/Set-up-serverless-function-protection)                   |
+-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Step 2: Configure     | Exposure Management   | [Onboard a new data source](https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM/Cortex-XSIAM-Documentation/Adding-a-new-data-source-or-instance)                     |
| third-party scanners  | can ingest            |                                                                                                                                                                          |
|                       | vulnerabilities from  |                                                                                                                                                                          |
|                       | Tenable and Qualys    |                                                                                                                                                                          |
|                       | scanners.             |                                                                                                                                                                          |
+-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Step 3: Enable Attack | AST validates that    | [Attack Surface Testing](/document/preview/1159839#UUID-f51b3d35-97a1-6c82-7e42-35adad945865)                                                                            |
| Surface Testing (AST) | vulnerabilities are   |                                                                                                                                                                          |
|                       | exposed to the        |                                                                                                                                                                          |
|                       | internet and provides |                                                                                                                                                                          |
|                       | additional context    |                                                                                                                                                                          |
|                       | for compensating      |                                                                                                                                                                          |
|                       | controls.             |                                                                                                                                                                          |
+-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Step 4: Review        | Review the            | [Vulnerability policies](#UUIDd48badaed793601045c70fe385a252e4)                                                                                                          |
| vulnerability         | out-of-the-box        |                                                                                                                                                                          |
| policies              | vulnerability         |                                                                                                                                                                          |
|                       | policies and create   |                                                                                                                                                                          |
|                       | custom policies to    |                                                                                                                                                                          |
|                       | define which          |                                                                                                                                                                          |
|                       | vulnerabilities       |                                                                                                                                                                          |
|                       | trigger creation of   |                                                                                                                                                                          |
|                       | an issue or other     |                                                                                                                                                                          |
|                       | actions.              |                                                                                                                                                                          |
+-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Step 5: Review attack | Attack surface rules  | [Attack surface rules](https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM/Cortex-XSIAM-Premium-Documentation/Attack-surface-rules)                                  |
| surface rules         | determine which       |                                                                                                                                                                          |
|                       | attack surface        |                                                                                                                                                                          |
|                       | management (ASM)      |                                                                                                                                                                          |
|                       | findings create       |                                                                                                                                                                          |
|                       | issues. Review the    |                                                                                                                                                                          |
|                       | default enabled       |                                                                                                                                                                          |
|                       | attack surface rules  |                                                                                                                                                                          |
|                       | and enable or modify  |                                                                                                                                                                          |
|                       | rules as needed.      |                                                                                                                                                                          |
+-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Step 6: Set up asset  | Asset groups can be   | [Asset Groups](#UUIDa299007a63312a26ae182d415c512454)                                                                                                                    |
| groups                | used to:              |                                                                                                                                                                          |
|                       |                       |                                                                                                                                                                          |
|                       | - define the scope of |                                                                                                                                                                          |
|                       |   vulnerability       |                                                                                                                                                                          |
|                       |   policies            |                                                                                                                                                                          |
|                       |                       |                                                                                                                                                                          |
|                       | - configure           |                                                                                                                                                                          |
|                       |   scope-based access  |                                                                                                                                                                          |
|                       |   control (SBAC), so  |                                                                                                                                                                          |
|                       |   users only see      |                                                                                                                                                                          |
|                       |   vulnerabilities for |                                                                                                                                                                          |
|                       |   the assets they own |                                                                                                                                                                          |
+-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Step 7: Enable issue  | Install the Exposure  | [Deploy ASM and Exposure Management enrichment and remediation automation functionality](#UUID6f2e43234dcfd8a6b883e9954ffbee49)                                          |
| enrichment and        | Management Content    |                                                                                                                                                                          |
| remediation           | pack to enable        |                                                                                                                                                                          |
| automation            | remediation owner     |                                                                                                                                                                          |
|                       | information to be     |                                                                                                                                                                          |
|                       | added to some issues  |                                                                                                                                                                          |
|                       | automatically and     |                                                                                                                                                                          |
|                       | automated remediation |                                                                                                                                                                          |
|                       | of some ASM issues.   |                                                                                                                                                                          |
+-----------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

#### Exposure Management Command Center

The Exposure Management Command Center dashboard provides a dynamic,
overall view of your exposure management operation with visualizations,
key performance indicators, and actionable data that is useful to both
executives and vulnerability management teams.

You can click on many elements in the command center to drill down to
more focused dashboards or pages displaying data that is filtered by
your selection.

![](media/rId4317.png){width="5.833333333333333in"
height="3.3979166666666667in"}

The table below describes each section of the visualization, from left
to right.

+-----------------------------------+-------------------------------------------------------------+
| Section                           | Description                                                 |
+===================================+=============================================================+
| Sources                           | Each vulnerability data source is displayed along with      |
|                                   | number of vulnerabilities findings.                         |
|                                   |                                                             |
|                                   | Click on this section to open the [Source Coverage and      |
|                                   | Optimization](#X8ca64a0647a3a1297afffa873a191d96f90ea20)    |
|                                   | page, which displays details about the overlap in           |
|                                   | vulnerabilities across the sources.                         |
+-----------------------------------+-------------------------------------------------------------+
| Vulnerabilities                   | The total number of vulnerability findings from all         |
|                                   | sources.                                                    |
+-----------------------------------+-------------------------------------------------------------+
| Unique Vulnerabilities            | The total number of vulnerability findings after            |
|                                   | deduplication.                                              |
|                                   |                                                             |
|                                   | Deduplication removes duplicate findings, which are defined |
|                                   | as findings for the same CVE on the same asset.             |
|                                   |                                                             |
|                                   | Click on Unique Vulnerabilities to display the              |
|                                   | [Prioritization](#Xed687d022985affdf04dec40c259692d76a8c21) |
|                                   | page, which shows how findings are deduplicated,            |
|                                   | prioritized, and grouped into cases.                        |
+-----------------------------------+-------------------------------------------------------------+
| Cases                             | The number of cases created after the system has            |
|                                   | prioritized the findings, created vulnerability issues, and |
|                                   | groups the issues into cases.                               |
|                                   |                                                             |
|                                   | Vulnerability issues are grouped into cases based on the    |
|                                   | fix for resolving the vulnerability. Issues with the same   |
|                                   | fix are grouped together into a single case.                |
+-----------------------------------+-------------------------------------------------------------+
| Active Cases                      | Number of active cases, broken down into the following      |
|                                   | categories:                                                 |
|                                   |                                                             |
|                                   | - Require Attention: Cases with the status **New**.         |
|                                   |                                                             |
|                                   | - In Progress: Cases with the status **In Progress**        |
|                                   |                                                             |
|                                   | Click on any of these Active Cases categories to display    |
|                                   | the list of cases along with case details, status, and      |
|                                   | recommended actions.                                        |
+-----------------------------------+-------------------------------------------------------------+
| Resolved Cases                    | Total number of resolved cases, number of resolved cases by |
|                                   | severity, and resolved cases broken down into the following |
|                                   | categories:                                                 |
|                                   |                                                             |
|                                   | - Resolved: Cases with any **Resolved** status except       |
|                                   |   **Accepted Risk**.                                        |
|                                   |                                                             |
|                                   | - Accepted Risk: Cases with the status                      |
|                                   |   **Resolved - Accepted Risk**.                             |
|                                   |                                                             |
|                                   | Click on either of these Resolved Cases categories to       |
|                                   | display the list of cases along with case details, status,  |
|                                   | and additional information.                                 |
+-----------------------------------+-------------------------------------------------------------+

The following table explains the data points displayed along the bottom
of the Exposure Management Command Center.

  -----------------------------------------------------------------------
  Data Point                          Description
  ----------------------------------- -----------------------------------
  Vulnerable Assets                   Number of assets with one or more
                                      active vulnerability issues.

  Active Cases                        Number of cases in an active
                                      status, broken down by case
                                      severity.

  Mean Time to Resolve                Mean of the creation date to the
                                      date when the case was assigned a
                                      terminal closed status, broken down
                                      by case severity.
  -----------------------------------------------------------------------

The following sections describe the focused dashboards that appear when
clicking on specific elements in the command center.

Source Coverage & Optimization

The **Source Coverage & Optimization** page shows a breakdown of the
vulnerability findings from each source and the overlap in findings
between third-party sources and Palo Alto Networks sources. The data and
and visualizations on this page show you which of your sources are most
effective and help determine if you can consolidate vulnerability tools.

  -----------------------------------------------------------------------
  Section                             Description
  ----------------------------------- -----------------------------------
  Vulnerabilities Before              Total number of vulnerability
  Deduplication                       findings from all sources before
                                      deduplication.

  Overlap with \<source\>             Highest amount of vulnerability
                                      overlap between Palo Alto Networks
                                      sources and a third-party product.
                                      The label **HIGH** indicates a
                                      greater than 30% overlap between
                                      the Palo Alto Networks and this
                                      third-party vendor. 

  Findings bar                        Number of vulnerability findings
                                      from Palo Alto Network sources, not
                                      deduplicated. Hover over the
                                      different sections of the bar to
                                      see the breakdown of findings come
                                      from each Palo Alto Networks
                                      source.

  Overlap                             List of third-party sources and the
                                      number of vulnerability findings
                                      from each source that overlap with
                                      Palo Alto Networks sources.

  Findings                            Total number of vulnerability
                                      findings from each third-party
                                      source.
  -----------------------------------------------------------------------

Prioritization

The **Prioritization** page breaks down how Cortex XSIAM starts with the
total number of raw vulnerability findings in your environment and
deduplicates, prioritizes, and consolidates them into a manageable
number of cases that require attention. Percentages that appear next to
some values indicate the change over the last 30 days. The table below
explains each part of visualization, from left to right.

+-----------------------------------+---------------------------------------+
| Section                           | Description                           |
+===================================+=======================================+
| Vulnerabilities                   | The total number of vulnerability     |
|                                   | findings across all sources.          |
+-----------------------------------+---------------------------------------+
| Duplicative Findings              | Number of duplicate findings that     |
|                                   | were eliminated. Duplicate findings   |
|                                   | are findings for the same CVE on the  |
|                                   | same asset.                           |
+-----------------------------------+---------------------------------------+
| Unique Vulnerabilities            | The number of vulnerability findings  |
|                                   | after deduplication.                  |
+-----------------------------------+---------------------------------------+
| Not Internet Exposed              | These are the low-priority findings   |
|                                   | that did not result in the creation   |
| Low Business Impact               | of an issue. The reason for           |
|                                   | deprioritization is provided along    |
| No Known Public Exploits          | with the count.                       |
|                                   |                                       |
| Low and Medium CVSS Base Score    | - **Not Internet Exposed**: ASM and   |
|                                   |   CNA data indicates that these       |
| Deprioritized by Policy           |   vulnerabilities are not exposed to  |
|                                   |   the internet.                       |
|                                   |                                       |
|                                   | - **Low Business Impact**: The asset  |
|                                   |   group for the vulnerability is dev, |
|                                   |   test, internal, or low business     |
|                                   |   criticality.                        |
|                                   |                                       |
|                                   | - **No Known Public Exploits**: These |
|                                   |   vulnerabiliities have an EPSS score |
|                                   |   less than 80% or other public data  |
|                                   |   indicating the vulnerability        |
|                                   |   hasn\'t been exploited.             |
|                                   |                                       |
|                                   | - **Low and Medium CVSS Base Score**: |
|                                   |   CVSS severity is Low or Medium.     |
|                                   |                                       |
|                                   | - **Deprioritized by Policy**: These  |
|                                   |   vulnerabilities were deprioritized  |
|                                   |   by custom policies created by your  |
|                                   |   organization. Typically this is any |
|                                   |   policy that specifies not to create |
|                                   |   an issue for a specific type of     |
|                                   |   vulnerability.                      |
+-----------------------------------+---------------------------------------+
| Open Issues                       | The number of open vulnerability      |
|                                   | issues.                               |
+-----------------------------------+---------------------------------------+
| Issues Consolidated into Cases    | Number of issues that were            |
|                                   | consolidated into open cases. Issues  |
|                                   | are grouped together into cases based |
|                                   | on whether they share the same fix.   |
+-----------------------------------+---------------------------------------+
| Cases                             | Total number of vulnerability cases   |
|                                   | after vulnerability issues were       |
|                                   | grouped into cases.                   |
+-----------------------------------+---------------------------------------+
| Require Attention                 | Number of cases with the status       |
|                                   | **New**. Click to pivot to a filtered |
|                                   | view of the cases that includes       |
|                                   | detailed information to help you      |
|                                   | investigate and remediate each case.  |
+-----------------------------------+---------------------------------------+
| In Progress                       | Number of cases with the status       |
|                                   | I**n Progress**. Click to pivot to a  |
|                                   | filtered view of the cases that       |
|                                   | includes detailed information to help |
|                                   | you investigate and remediate each    |
|                                   | case.                                 |
+-----------------------------------+---------------------------------------+
| Resolved                          | Number of cases with the status       |
|                                   | **Closed - Remediated** or            |
|                                   | **Closed - No Longer Observed**.      |
+-----------------------------------+---------------------------------------+
| Accepted Risk                     | Number of cases with the status       |
|                                   | **Accepted Risk.**                    |
+-----------------------------------+---------------------------------------+

#### Compensating Controls

Compensating controls are alternative measures put in place to mitigate
or reduce risk on an asset when remediation cannot or will not be
implemented right away. While compensating controls do not completely
eliminate risk, they provide protection and enhance mitigation
capabilities for security teams to effectively manage those risks.

Cortex XSIAM automatically detects compensating controls on your assets
and assesses their effectiveness, providing valuable information you can
use to accomplish the following:

- **Prioritize issues and determine remediation urgency:** By evaluating
  the presence (or absence) of compensating controls, you can more
  effectively prioritize issues and determine urgency levels. An issue
  with a compensating control may be lower priority or less urgent than
  one without.

- **Reduce the impact of vulnerabilities:** Understanding the
  effectiveness of compensating controls enables you to minimize the
  potential impact of vulnerabilities.

- **Identify security posture gaps:** Detecting compensating controls
  and control coverage enables you to quickly identify and address gaps
  or weaknesses in your security posture.

Compensating control information is displayed on all vulnerability
issues, providing you with insights into how these controls are
mitigating potential risks on that asset. You can view and filter
vulnerability issues based on the detected controls and the detected
control coverage, and view detailed information about each of the
compensating controls on the vulnerability issue details panel.

##### Detected Compensating Controls

Cortex XSIAM detects the following compensating controls:

- Cortex Agents: Cortex XSIAM detects whether an Cortex agent is present
  on the asset.

While not technically a compensating control, Attack Surface Testing is
a mechanism you can use to detect whether a vulnerability can be
exploited and whether an existing control is effective.

##### Detected Compensating Control Coverage

Compensating control coverage refers to how effective a control is in
protecting an asset from a risk attack. Based on the detected
compensating controls and assessment of how effective those controls
are, Cortex XSIAM assigns each vulnerability issue one of the
**Detected Control Coverage **values described in the table below.

+-------------------------------+-------------------------+-----------------------+
| **Detected control coverage** | **Applicable Controls** | **Description**       |
+:==============================+:========================+:======================+
| Exploitability was confirmed  | Attack Surface Testing  | The issue has a       |
|                               | (AST)                   | Confirmed Vulnerable  |
|                               |                         | AST result.           |
|                               |                         |                       |
|                               |                         | This value does not   |
|                               |                         | necessarily mean      |
|                               |                         | there is no control   |
|                               |                         | present, but if a     |
|                               |                         | control is present,   |
|                               |                         | it appears to allow   |
|                               |                         | for exploitation.     |
+-------------------------------+-------------------------+-----------------------+
| No controls were found        | All                     | No AST result and no  |
|                               |                         | other control         |
|                               |                         | findings.             |
+-------------------------------+-------------------------+-----------------------+
| Known control found with      | Cortex Agent            | Cortex Agent was      |
| unknown coverage              |                         | determined to be      |
|                               |                         | installed on the      |
|                               |                         | asset reporting the   |
|                               |                         | issue.                |
+-------------------------------+-------------------------+-----------------------+
| Unknown control detected with | AST                     | The issue has an      |
| apparent mitigation           |                         | inconclusive AST      |
|                               |                         | result. This          |
|                               |                         | indicates that an     |
|                               |                         | unknown control is    |
|                               |                         | present and appears   |
|                               |                         | to mitigate a         |
|                               |                         | specific risk.        |
+-------------------------------+-------------------------+-----------------------+

##### View compensating control information for vulnerability issues

The **Vulnerability Issues** table includes fields for
**Detected Controls** and **Detected Control Coverage **for each
vulnerability issue, so you can filter and sort on these fields. The
issue details provides additional information about each detected
control and coverage.

1.  Navigate to Posture Management \> Vulnerability Management \>
    Vulnerability Issues.

2.  On the Vulnerability Issues page, compensating controls information
    can be found in the following columns:

    - **Detected Controls:** This field lists all compensating controls
      detected for this issue. Possible values:

      - **Cortex Agent**

      - **No Control Detected**

    - **Detected Control Coverage**: This field summarizes the
      effectiveness of the control.

3.  Click on an issue to display the issue details. Compensating
    controls information appears on the **Overview** tab on the issue
    details panel.

#### Cortex Network Scanner

The Cortex Network Scanner is a powerful application designed to
identify and analyze devices, services, and vulnerabilities in your
internal network.

##### What is Cortex Network Scanner?

The Cortex Network Scanner, a key component of the Exposure Management
portfolio, is a robust tool for internal network vulnerability
assessment. The scanner efficiently identifies live hosts and
vulnerabilities using various methods, including remote and
authenticated local checks. Distributed as a Broker VM applet, it
integrates seamlessly into your existing infrastructure.

Cortex Network Scanner provides the following key capabilities:

- **Asset discovery**

<!-- -->

- Cortex Network Scanner identifies responsive hosts within a specified
  IP range, covering both on-premises and cloud-hosted assets.

<!-- -->

- **Vulnerability scanning**

<!-- -->

- Cortex Network Scanner supports authenticated and non-authenticated
  scanning:

  - Non-authenticated scans use various vulnerability tests to detect
    vulnerabilities in the target system based on system responses
    without requiring credentials, including sending tailored packets to
    target hosts.

  - Authenticated scans use the supplied credentials to authenticate
    into a target host and identify vulnerabilities by performing deeper
    tests, including detailed software enumeration and service
    detection.

<!-- -->

- **Customizable and targeted scanning options**

  - Select from different scan profiles for quick turnaround or deeper
    assessments.

  - Specify different network configurations to adapt to different
    environments, such as alive test methods, ports to scan, schedules,
    and performance settings.

  - Scan for specific vulnerabilities quickly across your asset
    inventory.

- **Integration with the Cortex
  XSIAM inventory and vulnerability management**

<!-- -->

- Scan results are seamlessly integrated into the inventory and
  vulnerability management views in Cortex XSIAM, providing a
  centralized view of all discovered assets, vulnerabilities, and
  issues.

##### Get started with Cortex Network Scanner

To set up and configure Cortex Network Scanner for the first time,
perform the following tasks.

1.  Review the [Deployment
    recommendations](#Xbf20ff99b1064c5509d7ec92962d190f6876a64) and
    complete any prerequisites.

2.  [Deploy a Broker VM](#UUIDa2b1b832d74850d81f427e175514c501)

3.  Activate Cortex Network Scanner

- Cortex Network Scanner is distributed as an applet on a Cortex Broker
  VM. Follow the instructions at [this
  link](#Xef303cfa6072dd684fe8b66a9da3cec938f4a6b) to activate the
  Broker VM, and install Cortex Network Scanner on that Broker VM.

4.  [Add a network](#UUID724aea219986e3808ede91cc0a151f23) (Optional)

5.  [Add credentials for authenticated
    scans](#UUID3e2de033f4e52c092bacf1c640deb703) (Optional)

6.  [Create a new
    scan](/document/preview/1376643#UUID-a89c8892-9b41-0a1d-b4cc-8a0fa941135b)

After completing these set-up and configuration tasks, you can and view
issues and findings from scans and manage scans.

###### Deployment recommendations

Broker VM recommendations

Network vulnerability scanning is a resource-intensive task. To ensure
optimal and consistent scan performance, we recommend the following:

- Ensure that your Broker VM has at least 4 CPU cores and 8Gb of RAM.

- Have dedicated Broker VMs for Cortex Network Scanner (or at least
  minimize the number of other applets running concurrently) to preserve
  sufficient resources for scanning.

> **Note**
>
> The current version of the Cortex Network Scanner does not support
> load distribution and balancing. Vulnerability assessment scans can
> take time, and currently you can assign only one scanner per scan
> task. To scan the entire network we recommend splitting your scanning
> activity into smaller tasks to preserve performance.
>
> **Note**
>
> The Cortex Network Scanner applet is not supported for FedRAMP
> customers.

Firewall and other security control recommendations

The Cortex Network Scanner uses various methods to actively detect,
probe and assess detected services on all or most TCP and UDP ports. The
nature of vulnerability scanning conflicts with security controls such
as firewalls and IPS that are meant to block such activity. When
deploying Broker VMs that run the Cortex Network Scanner (further -
Scanners), we recommend taking one or both of the following actions:

- \[Recommended\] Deploy scanners strategically within each target
  security zone or segment (e.g., firewall-configured segments). This
  ensures scanner traffic remains local to the segment and avoids
  crossing the firewall or other network security device.

- Configure security policy rules on the firewall and other network
  security controls that prevent the blocking of traffic from Cortex
  Network Scanner. Follow the guidelines for your security controls and
  keep rules as narrow as possible. For Palo Alto Networks NGFW, you
  must allow traffic from the scanner to the target, using
  "`Application”` (App-ID) and "`Service`" (port) set to "`any`".

Authenticated scan recommendations

Authenticated scans can collect more detailed information about target
assets, and detect vulnerabilities that are not detectable with purely
remote non-authenticated scans. If credentials are provided for the
authenticated scan, the Cortex Network Scanner will attempt to login
into the target machines using the provided account.

To set up a successful authenticated scan:

- Provide correct credentials for SMB (Windows-bases systems) and SSH
  service (Unix-based systems).

- Make sure related traffic (SMB or SSH) is allowed from the scanner to
  the target host.

- Configure the account with permissions that allow remote logins.

See [Add credentials for authenticated
scans](#UUID3e2de033f4e52c092bacf1c640deb703) for more information about
setting up authenticated scans.

Preventing false-positive Cortex XDR alerts

Some scanning activity (e.g. open port enumeration or local checks with
authenticated scans) can trigger alerts on endpoint protection
solutions, such as Cortex XDR. That is expected because the same
techniques are used by the attackers. To avoid causing false positive
alerts, be sure to add scanner source IP addresses into the exclusions.

Recommendations for Windows-based hosts

To ensure successful scans on Windows-based hosts, configure the
following services and registry settings:

- Under Services, enable the Remote Registry on startup.

<!-- -->

- ![](media/rId4333.png){width="4.375in" height="2.8875in"}

<!-- -->

- Navigate to the active network connection under Ethernet Properties \>
  Networking and make sure
  **File and Printer Sharing for Microsoft Networks** is enabled.

<!-- -->

- ![](media/rId4336.png){width="5.180555555555555in"
  height="6.736111111111111in"}

<!-- -->

- If not part of a Windows domain, In the registry (regedit.exe), check
  that DWORD LocalAccountTokenFilterPolicy is set to 1.

<!-- -->

- Set-ItemProperty -Path
  \'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\\'
  -Name \'LocalAccountTokenFilterPolicy\' -Value 1

  ![](media/rId4339.png){width="4.375in" height="3.9429680664916886in"}

Configure the following Windows Firewall settings:

- Make sure ports 149, 445, and other services you want to scan are
  allowed in the firewall rules.

###### Activate Cortex Network Scanner

The Cortex Network Scanner identifies and analyzes devices, services,
and vulnerabilities in your internal network. It discovers responsive
hosts within specified IP ranges, including on-premises and cloud
environments. The scanner supports both non-authenticated and
authenticated vulnerability scanning, with authenticated scans providing
deeper insights through credential-based access. Scan results are
seamlessly integrated into the inventory and vulnerability management
views in Cortex XSIAM, providing a centralized view of all discovered
assets, vulnerabilities, and issues.

Cortex Network Scanner is installed as an applet on a Broker VM.

> **Note**
>
> Requires the Exposure Management add-on.
>
> **Important**
>
> The Cortex Network Scanner applet is not supported for FedRAMP
> customers.
>
> **Prerequisites**

- > Review the Cortex Network Scanner [deployment
  > recommendations](#UUID0e3d8fa156b2bf50af7d5ae47716dfff) and complete
  > any prerequisites.

- > [Set up and configure Broker
  > VM](https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM/Cortex-XSIAM-Premium-Documentation/Set-up-and-configure-Broker-VM)

**How to activate Cortex Network Scanner**

1.  Navigate to Settings \> Configurations \> Data Broker \> Broker VMs.

2.  Right click the Broker VM, and select Add App \> Network Scanner.

3.  After the applet has installed, the scanner should automatically
    connect to the tenant. If the connection is successful, you'll see a
    green dot next to **Network Scanner** in the Apps column of the
    Broker VMs table.

- A red dot indicates that an error occurred and the scanner is not
  connected.

  ![](media/rId4345.png){width="4.375in" height="0.9953116797900262in"}

4.  (Optional) Click on the network scanner in the table to display
    details about the scanner or to deactivate it.

5.  Validate the installation. Navigate to Settings \> Configurations \>
    Network Scanners \> Network Scanners and find your new scanner in
    the list.

- The **Network Scanners** page displays all your deployed and
  configured scanners, along with additional details about each of them.

  ![](media/rId4348.png){width="4.375in" height="1.00625in"}

After setting up a Broker VM and activating Cortex Network Scanner,
refer to [Get started with Cortex Network
Scanner](#UUID0e3d8fa156b2bf50af7d5ae47716dfff) for information about
adding networks, adding credentials for authenticated scans, and
configuring scans.

##### Add a network

When performing scans, Cortex Network Scanner primarily operates at the
IP level, identifying assets as IP hosts. This means it recognizes and
interacts with devices based on their unique IP addresses within the
scanned network.

In certain environments, you might encounter overlapping or duplicate
private IP ranges. For example, your New York and London branch offices
could both be using the private network 172.16.1.0/20. If both offices
are located behind Network Address Translation (NAT), a server in London
and an employee\'s laptop in New York can legitimately have the same IP
address (e.g., 172.16.1.100) without causing conflicts in their
respective local networks. This is because NAT translates these private
IP addresses to unique public IP addresses when they communicate outside
their local network, effectively isolating the private IP spaces.

However, the scan results from the scans are being aggregated at the
asset level, taking into the account that the same host can have
multiple IP addresses or change the IP address during the asset's
lifecycle. To avoid confusion and mixing up the scan results at the
asset level, you can configure a separate network for each location.

You can also add networks for better scan organization.

**How to add a network**

1.  Navigate to Settings \> Configurations \> Network Scanning \>
    Networks and click **+ Add Network**.

2.  Enter a **Name** and **Description**.

After you\'ve added a network, you can specify that network when
configuring a scan.

##### Add credentials for authenticated scans

An authenticated scan provides a more comprehensive view of system
vulnerabilities by examining the target both externally, via the
network, and internally, using valid user credentials. For an
authenticated scan, the scanner logs into the target system using
pre-configured user credentials, which are used to authenticate to
various services on the target.

> **Prerequisites**
>
> Before initiating an authenticated scan, complete the following
> prerequisites on your target hosts:

1.  > Create dedicated service accounts.

- > We highly recommend creating dedicated service accounts on your
  > target devices specifically for the network scanner. Avoid using
  > existing administrative accounts or personal user accounts. This
  > practice enhances security by limiting the potential impact if the
  > credentials are ever compromised and allows for granular control and
  > auditing of scanner activities.

2.  > Ensure that required access rights are configured and remote
    > access is enabled.

- > The service accounts must have the necessary permissions to collect
  > system information and perform vulnerability checks remotely.
  > Additionally, the respective remote access protocols must be enabled
  > on the target devices.

  > For Windows Targets (SMB/WinRM): Follow the guidelines in the [Get
  > started with Cortex Network
  > Scanner](#UUID0e3d8fa156b2bf50af7d5ae47716dfff) section.

  > For Linux Targets: The service account must have permissions to
  > execute commands via SSH.

  - > Ensure the SSH daemon (sshd) is running on the target device.

  - > Verify that password authentication (or public key authentication,
    > if configured) is enabled for the service account in the
    > sshd_config file (located typically at /etc/ssh/sshd_config).

3.  > Verify firewall and network security device configuration.

- > Remote access traffic must not be blocked by any firewalls
  > (host-based or network-based) or other network security devices
  > (e.g., intrusion prevention systems, network access control).

  > For Windows Targets:

  - > Windows Defender Firewall: Ensure inbound rules are configured to
    > allow traffic for \"File and Printer Sharing\" (TCP ports
    > 139, 445) and/or \"Windows Remote Management\" (TCP port 5985 for
    > HTTP, 5986 for HTTPS).

  - > Network Firewalls: If there\'s a network firewall between the
    > scanner and the target, ensure that TCP ports 139, 445, 5985, and
    > 5986 are open for communication from the scanner\'s IP address to
    > the target\'s IP address.

  > For Linux Targets

  - > Host-based Firewall (e.g., ufw, firewalld): Ensure that SSH
    > traffic (TCP port 22) is allowed. For example, using
    > `ufw: sudo ufw allow ssh`.

  - > Network Firewalls: Ensure that TCP port 22 is open for
    > communication from the scanner\'s IP address to the target\'s IP
    > address.

The scanner will try credentials on all targets with a corresponding
service, for example SSH credentials will be tried if the scanner
detects an SSH server. Note that the scan results might be limited by
the permissions associated with these user accounts.

**How to add credentials for authenticated scans**

Add and save the credentials to be used for authenticated scans on the
**Credential Management** page.

1.  Navigate to Settings \> Configurations \> Network Scanners \>
    Credential Management.

- The Credential Management page lists all of your saved credentials.

2.  Click **+ Add Credentials** in the upper right.

3.  Provide information in the following fields:

    - **Name**: provide a descriptive name for this set of credentials.

    - **Description**: optionally, provide a description.

    - **Service**: Select one of the service and credential types from
      the dropdown menu and add the credentials:

      - **SSH (Username/Password)**:  Requires username, password, port.

      - **SSH (Username/SSH Key):**  Requires username, passphrase
        (optional), port. You will also upload your private SSH key in
        PEM or OpenSSH format.

      - **SMB**:  Requires username and password.

4.  Click **Save Credential**. Your new credentials will appear in the
    list on the **Credential Management** page.

> **Note**
>
> You cannot edit saved credentials, but you can delete them and create
> new ones as needed.

##### Create a scan

After installing Cortex Network Scanner, create one or more scans that
you schedule to run periodically or run on demand. The following topics
describe scan templates, the steps to create and schedule a scan, and
the advanced scan settings.

###### Scan templates

Scan templates define the sets of vulnerability tests and checks that a
scan will perform. There are two types of scan templates:

- **Discovery Scans**:  Identify active hosts in the network and gather
  high-level information about them. While capable of detecting certain
  vulnerabilities, Discovery Scans are primarily designed for high-level
  network inventory assessments. They help determine the scope of work
  for more detailed scans.

- **Vulnerability Assessment Scans**: Conduct comprehensive tests on
  active network hosts to identify vulnerabilities. These scans provide
  detailed information on running services, OS versions, installed
  software, and detected vulnerabilities. They are more thorough and
  take longer to run than Discovery Scans. Additionally, if credentials
  are provided, Vulnerability Assessment Scans can authenticate into
  target hosts to perform local checks and tests, yielding more accurate
  and detailed information.

<!-- -->

- One important type of Vulnerability Assessment Scan is the
  **Focused Vulnerability Scan**, which allows you to scan for specific
  vulnerabilities, including emerging threats and zero-day
  vulnerabilities.

![](media/rId4355.png){width="4.375in" height="2.876561679790026in"}

###### Create a Discovery scan

Discovery scans identify active hosts in the network and gather
high-level information about them.

1.  Navigate to Settings \> Configurations \> Network Scanners \> Scan
    Management, and click **+ Create Scan**.

2.  Select a Discovery scan template.

3.  Provide the following information on the **General** page of the
    Create Scan wizard, and then click **Next**.

    - **Name**

    - **Description** (optional)

    - **Scan Scheduling**: Select from the following:

      - **Does Not Repeat** to manually run the scan

      - **Daily** to schedule the days and times to run the scan.

      <!-- -->

      - Schedule **Quiet Hours** to limit scanning to specific times of
        the day and prevent scanning from interfering with business
        operation. Scanning will be paused during quiet hours and
        automatically resume afterwards. Quiet hours do not apply to
        manually launched scans.

    - **Select Saved Credentials**: You can select previously saved
      credentials or you can click the link to go to the Credential
      Management page to add new credentials.

    <!-- -->

    - You can select only one set of credentials per type of service,
      for example, you could select one set of SSH credentials and one
      set of SMB credentials (for Windows hosts).

4.  Provide the following information on the **Target** page of the
    Create Scan wizard, then click **Next**.

    - **Network**: Select a network to be scanned.

    - **Network Scanner**: Select the Cortex Network Scanner to be used
      for this scan.

    - **Manually Add Targets**: List the targets to be scanned. Targets
      can be IP addresses, IP ranges, CIDR ranges, or hostnames.

    <!-- -->

    - The Cortex Network Scanner will use the DNS server configured in
      the network settings of the Broker VM for hostname resolution.

    <!-- -->

    - **Manually Exclude Targets**: (Optional) List the targets to be
      excluded from the scan.

5.  After specifying the targets, click **Next** to configure advanced
    settings or **Save Scan** to save the scan with the default advanced
    settings and exit the Create Scan wizard.

6.  Configure the **Advanced** settings, including **Discovery**,
    **Assessment**, and **Perfomance** settings. See [Advanced
    settings](#sectionidm234947016750689) for details about these
    settings.

- > **Tip**

  > Most use cases can use the default advanced settings.

7.  Click **Save Scan**.

###### Create a Vulnerability Assessment scan

Vulnerability Assessment scans conduct comprehensive tests on active
network hosts to identify vulnerabilities. The following steps apply to
all the Vulnerability Assessment scans except Focused Vulnerability
Scan. See Create a Focused Vulnerability Scan for those instructions.

1.  Navigate to Settings \> Configurations \> Network Scanners \> Scan
    Management, and click **+ Create Scan**.

2.  Select a Vulnerability Assessment scan template.

3.  Provide the following information on the **General** page of the
    Create Scan wizard, and then click **Next**.

    - **Name**

    - **Description** (optional)

    - **Scan Scheduling**: Select from the following:

      - **Does Not Repeat** to manually run the scan

      - **Daily** to schedule the days and times to run the scan.

      <!-- -->

      - Schedule **Quiet Hours** to limit scanning to specific times of
        the day and prevent scanning from interfering with business
        operation. Scanning will be paused during quiet hours and
        automatically resume afterwards. Quiet hours do not apply to
        manually launched scans.

    - **Select Saved Credentials**: You can select previously saved
      credentials or click the link to go to the Credential Management
      page to add new credentials.

    <!-- -->

    - You can select only one set of credentials per type of service,
      for example, you could select one set of SSH credentials and one
      set of SMB credentials (for Windows hosts).

4.  Provide the following information on the **Target** page of the
    Create Scan wizard, then click **Next**.

    - **Network**:

    - **Network Scanner**: Select the Cortex Network Scanner to be used
      for this scan.

    - **Manually Add Targets**: List the targets to be scanned. Targets
      can be IP addresses, IP ranges, CIDR ranges, or hostnames.

    <!-- -->

    - The Cortex Network Scanner will use the DNS server configured in
      the network settings of the Broker VM for hostname resolution.

    <!-- -->

    - **Manually Exclude Targets**: (Optional) List the targets to be
      excluded from the scan.

5.  After specifying the targets, click **Next** to configure advanced
    settings or **Save Scan** to save the scan with the default advanced
    settings and exit the Create Scan wizard.

6.  Configure the **Advanced** settings, including **Discovery**,
    **Assessment**, and **Perfomance** settings. See [Advanced
    settings](#sectionidm234947016750689) for details about these
    settings.

- > **Tip**

  > Most use cases can use the default advanced settings.

7.  Click **Save Scan**.

###### Create a Focused Vulnerability Scan

A **Focused Vulnerability Scan** scans your network for specific
vulnerabilities.

1.  Navigate to Settings \> Configurations \> Network Scanners \> Scan
    Management, and click **+ Create Scan**.

2.  Select the **Focused Vulnerability Scan** template under
    **Vulnerability Assessments**.

3.  Select the vulnerabilities to scan for on the **Test** page of the
    Create Scan wizard. Search the list for vulnerabilities and check
    the checkbox of the ones to scan for.

- After you\'ve selected vulnerabilities, click **Next**.

  ![](media/rId4361.png){width="4.375in" height="2.5375in"}

4.  Provide the following information on the **General** page of the
    Create Scan wizard, and then click **Next**.

    - **Name**

    - **Description** (optional)

    - **Scan Scheduling**: Select from the following:

      - **Does Not Repeat** to manually run the scan

      - **Daily** to schedule the days and times to run the scan.

      <!-- -->

      - Schedule **Quiet Hours** to limit scanning to specific times of
        the day and prevent scanning from interfering with business
        operation. Scanning will be paused during quiet hours and
        automatically resume afterwards. Quiet hours do not apply to
        manually launched scans.

    - **Select Saved Credentials**: Select previously saved credentials
      or click the link to go to the **Credential Management** page to
      add new credentials.

    <!-- -->

    - You can select only one set of credentials per type of service,
      for example, you could select one set of SSH credentials and one
      set of SMB credentials (for Windows hosts).

5.  Provide the following information on the **Target** page of the
    Create Scan wizard, then click **Next**.

    - **Network**: Select the network to be scanned.

    - **Network Scanner**: Select the Cortex Network Scanner to be used
      for this scan.

    - **Manually Add Targets**: List the targets to be scanned. Targets
      can be IP addresses, IP ranges, CIDR ranges, or hostnames.

    <!-- -->

    - The Cortex Network Scanner will use the DNS server configured in
      the network settings of the Broker VM for hostname resolution.

    <!-- -->

    - **Manually Exclude Targets**: (Optional) List the targets to be
      excluded from the scan.

6.  After specifying the targets, click **Next** to configure advanced
    settings or **Save Scan** to save the scan with the default advanced
    settings and exit the Create Scan wizard.

7.  Configure the **Advanced** settings, including **Discovery**,
    **Assessment**, and **Perfomance** settings. See [Advanced
    settings](#sectionidm234947016750689) for details about these
    settings.

- > **Tip**

  > Most use cases can use the default advanced settings.

8.  Click **Save Scan**.

###### Advanced settings

The following sections describe the advanced scan settings. Most Cortex
Network Scanner use cases can use default settings.

Discovery settings

+-----------------------+-----------------------+-----------------------+
| Discovery setting     | Description           | Default               |
+=======================+=======================+=======================+
| Host Detection Method | - ICMP Ping           | > **Tip**             |
|                       |                       | >                     |
|                       | <!-- -->              | > ICMP Ping provides  |
|                       |                       | > the quickest        |
|                       | - Uses Internet       | > discovery scan and  |
|                       |   Control Message     | > is good for initial |
|                       |   Protocol (ICMP)     | > discovery and       |
|                       |   echo requests to    | > scoping, however in |
|                       |   determine if a host | > the modern          |
|                       |   is reachable and    | > enterprise          |
|                       |   responsive on the   | > environment ICMP    |
|                       |   network.            | > response can be     |
|                       |                       | > blocked by the      |
|                       | <!-- -->              | > firewall or         |
|                       |                       | > endpoint security   |
|                       | - TCP-ACK Service     | > rules. Using        |
|                       |   Ping                | > additional methods  |
|                       |                       | > increases the       |
|                       | <!-- -->              | > accuracy of the     |
|                       |                       | > host discovery,     |
|                       | - Sends TCP ACK       | > although makes the  |
|                       |   packets to specific | > scan take a longer  |
|                       |   ports to check for  | > time. The best      |
|                       |   acknowledgment      | > approach is to use  |
|                       |   responses,          | > a combination of    |
|                       |   indicating an       | > several methods to  |
|                       |   active host with    | > keep the balance    |
|                       |   open ports.         | > between accuracy    |
|                       |                       | > and speed.          |
|                       | <!-- -->              |                       |
|                       |                       | The default setting   |
|                       | - TCP-SYN Service     | is ICMP, TCP_ACK,     |
|                       |   Ping                | ARP.                  |
|                       |                       |                       |
|                       | <!-- -->              |                       |
|                       |                       |                       |
|                       | - Initiates a TCP     |                       |
|                       |   handshake by        |                       |
|                       |   sending SYN packets |                       |
|                       |   to target ports and |                       |
|                       |   waits for SYN-ACK   |                       |
|                       |   responses to        |                       |
|                       |   identify active     |                       |
|                       |   hosts.              |                       |
|                       |                       |                       |
|                       | <!-- -->              |                       |
|                       |                       |                       |
|                       | - ARP Ping            |                       |
|                       |                       |                       |
|                       | <!-- -->              |                       |
|                       |                       |                       |
|                       | - Uses ARP requests   |                       |
|                       |   to directly query   |                       |
|                       |   the network for     |                       |
|                       |   active hosts by     |                       |
|                       |   mapping IP          |                       |
|                       |   addresses to their  |                       |
|                       |   corresponding MAC   |                       |
|                       |   addresses.          |                       |
+-----------------------+-----------------------+-----------------------+
| Port List             | List of ports that    | The default settings  |
|                       | will be used to       | enables discovery     |
|                       | identify alive hosts  | scanning on the most  |
|                       | (changing this        | commonly responding   |
|                       | setting does not      | services.             |
|                       | change the ports to   |                       |
|                       | be scanned for        |                       |
|                       | vulnerabilities).     |                       |
+-----------------------+-----------------------+-----------------------+
| Order in Which to     | Options are random,   | Sequential            |
| Scan Hosts            | reversed, or          |                       |
|                       | sequential.           |                       |
+-----------------------+-----------------------+-----------------------+

Assessment settings

+-----------------------+---------------------------+------------------------------------------+
| Assessment setting    | Description               | Default                                  |
+=======================+===========================+==========================================+
| Ports to Scan         | Choose one one of the     | The default is                           |
|                       | pre-defined port lists to | **Common TCP ports, top 100 UDP ports**, |
|                       | scan for vulnerabilities. | which was determined by the Palo Alto    |
|                       |                           | Networks security research team.         |
+-----------------------+---------------------------+------------------------------------------+
| Include or Exclude    | This setting allows you   | None                                     |
| Ports                 | to precisely control      |                                          |
|                       | which TCP and UDP ports   |                                          |
|                       | are scanned by either     |                                          |
|                       | adding them to be         |                                          |
|                       | included or excluded from |                                          |
|                       | your selected port list.  |                                          |
|                       |                           |                                          |
|                       | **Inclusion Logic:** If   |                                          |
|                       | you add a port to the     |                                          |
|                       | inclusion list that is    |                                          |
|                       | already present in your   |                                          |
|                       | selected port list, it    |                                          |
|                       | will not result in a      |                                          |
|                       | duplicate entry or change |                                          |
|                       | the existing scan         |                                          |
|                       | behavior for that port.   |                                          |
|                       |                           |                                          |
|                       | **Exclusion Precedence:** |                                          |
|                       | The exclude option takes  |                                          |
|                       | precedence. If a port is  |                                          |
|                       | present in both your      |                                          |
|                       | selected port list and    |                                          |
|                       | the \"Exclude Port        |                                          |
|                       | list\", it will be        |                                          |
|                       | excluded from the scan.   |                                          |
|                       | This ensures that any     |                                          |
|                       | explicitly excluded port  |                                          |
|                       | will not be scanned,      |                                          |
|                       | regardless of its         |                                          |
|                       | presence in an inclusion  |                                          |
|                       | list.                     |                                          |
+-----------------------+---------------------------+------------------------------------------+
| Non-authenticated     | When this option is       | Disabled                                 |
| Test Only             | enabled, the scanner will |                                          |
|                       | only perform tests that   |                                          |
|                       | do not require            |                                          |
|                       | authentication on the     |                                          |
|                       | target machine. No login  |                                          |
|                       | attempts will be made     |                                          |
|                       | whatsoever.               |                                          |
+-----------------------+---------------------------+------------------------------------------+
| Trust Service Banners | When selected, the        | Selected                                 |
|                       | scanner trusts remote     |                                          |
|                       | host banners and only     |                                          |
|                       | launches plugins against  |                                          |
|                       | services they have been   |                                          |
|                       | designed to check. This   |                                          |
|                       | default behavior          |                                          |
|                       | optimizes scanning        |                                          |
|                       | performance and avoids    |                                          |
|                       | false positives.          |                                          |
+-----------------------+---------------------------+------------------------------------------+
| Expand vHosts         | If selected, the scanner  | Enabled                                  |
|                       | will expand the list of   |                                          |
|                       | target hosts with values  |                                          |
|                       | gathered from sources     |                                          |
|                       | such as reverse-lookup    |                                          |
|                       | queries and VT checks for |                                          |
|                       | SSL/TLS certificates.     |                                          |
+-----------------------+---------------------------+------------------------------------------+
| Enable Advanced       | When selected, this       | Disabled                                 |
| Windows Scanning      | option activates an       |                                          |
|                       | enhanced scanning mode    |                                          |
|                       | that attempts to start    |                                          |
|                       | the Remote Registry       |                                          |
|                       | service and uses WMI for  |                                          |
|                       | file searches on Windows  |                                          |
|                       | targets during            |                                          |
|                       | authenticated scans. This |                                          |
|                       | improves vulnerability    |                                          |
|                       | detection but may lead to |                                          |
|                       | alerts or blocks from     |                                          |
|                       | endpoint protection       |                                          |
|                       | solutions (e.g., Cortex   |                                          |
|                       | XDR). Configure necessary |                                          |
|                       | exclusions in your        |                                          |
|                       | endpoint protection       |                                          |
|                       | policies.                 |                                          |
+-----------------------+---------------------------+------------------------------------------+

Performance settings

  -----------------------------------------------------------------------
  Performance setting     Description             Default
  ----------------------- ----------------------- -----------------------
  Test Timeout (Seconds)  Timeout per test.       5 seconds

  Wait Time Between       Number of seconds the   5 seconds
  Requests (Seconds)      security check will     
                          wait before sending     
                          another request.        

  Max Hosts to Test       Maximum number of hosts 30
  Simultaneously          to test at the same     
                          time. This value must   
                          be computed given your  
                          bandwidth, the number   
                          of hosts you want to    
                          test, your amount of    
                          memory, and the         
                          performance of your     
                          processors.             

  Max Simultaneous Tests  The maximum number of   4
  per Host                tests that will run     
                          against each            
                          host. Caution:          
                          launching too many      
                          tests simultaneously    
                          could disable the       
                          remote host.            

  Test Result Timeout     Maximum number of       3600 seconds
  (Seconds)               seconds for scanner to  
                          perform the scan.       

  Number of Test Retries  Maximum number of       5
  After a Timeout         retries after a         
                          timeout.                

  Open Socket Max         Number of unsuccessful  5
  Attempts                retries to open the     
                          socket  before setting  
                          the port to closed.     
  -----------------------------------------------------------------------

##### Manage scans

The **Scan Management page** lists all your configured scans along with
important information about each scan, including scan progress. From
this page you can perform most scan management operations.

1.  Navigate to Settings \> Configurations \> Network Scanners \> Scan
    Management.

2.  Right-click on a scan in the list to perform the following actions:

+-----------------------------------+-----------------------------------+
| Action                            | Description                       |
+===================================+===================================+
| **Launch Scan**                   | Start the scan.                   |
|                                   |                                   |
|                                   | Note that scheduled scans start   |
|                                   | automatically. Manually launching |
|                                   | a scan will run it without quiet  |
|                                   | hour restrictions and will cause  |
|                                   | it to skip any scheduled scan, if |
|                                   | the runtimes overlap.             |
+-----------------------------------+-----------------------------------+
| **Edit Scan**                     | Modify the scan settings.         |
+-----------------------------------+-----------------------------------+
| **Cancel Scan**                   | Cancel an actively running scan.  |
|                                   | Changes the Scan Progress field   |
|                                   | to Canceling and then Canceled.   |
+-----------------------------------+-----------------------------------+
| **Pause Scan**                    | Pause an actively running scan.   |
|                                   | Changes the Scan Progress field   |
|                                   | to Pausing and then Paused.       |
+-----------------------------------+-----------------------------------+
| **Resume Scan**                   | Resume a paused scan.             |
+-----------------------------------+-----------------------------------+
| **Delete Scan**                   | Remove scan from scan list.       |
+-----------------------------------+-----------------------------------+

3.  (Optional) Click on a scan to display the scan history, including
    the status of every historical scan, whether a scan is currently
    running and the progress, scan duration, and the number of dead,
    alive, and completed hosts.

Scan Progress values

The following table explains the Scan Progress field values on the Scan
Management page.

  -----------------------------------------------------------------------
  Scan Progress value                 Description
  ----------------------------------- -----------------------------------
  New                                 Scan has never been run.

  Completed                           The last scan completed
                                      successfully.

  Canceled                            The last scan was canceled.

  Canceling                           Scan is in the process of being
                                      canceled.

  Failed                              The last scan failed.

  Paused                              The scan was manually paused or
                                      automatically paused because of
                                      configured quiet hours.

  Pausing                             Scan is in the process of being
                                      paused.
  -----------------------------------------------------------------------

##### View issues triggered by network scanner findings

Cortex Network Scanner creates findings when it observes CVEs on scanned
assets. Cortex XSIAM will create issues if any of those findings match
vulnerability issue policies. To view issues that were triggered by
network scanner findings, perform these steps:

1.  Navigate to Posture Management \> Vulnerability Management \>
    Vulnerability Issues.

2.  Filter the list of vulnerability issues on
    **Source = Network Scanner**.

In general, Cortex Network Scanner findings are part of the overall
Cortex XSIAM inventory and vulnerability management views and workflows.

### Vulnerability management

#### Vulnerability management in Cortex XSIAM

Managing vulnerabilities effectively is crucial to proactively
maintaining the security, integrity, and availability of IT
infrastructure. Cortex XSIAM provides a comprehensive vulnerability
management platform, helping you identify, assess, prioritize, and
remediate security vulnerabilities across your entire IT infrastructure
including endpoints, code, and cloud.

Cortex XSIAM leverages advanced detection techniques, real-time threat
intelligence, and automated workflows to streamline the vulnerability
management process. This allows your security team to focus on the most
critical issues, reduce risk exposure, and ensure compliance with
industry standards and regulations.

Cortex XSIAM helps identify and prevent vulnerabilities across the
entire application lifecycle, while prioritizing risk for your
cloud-native environments. Integrate vulnerability management into any
CI process, while continuously monitoring, identifying, and preventing
risks to all the hosts and images in your environment. Cortex XSIAM
combines vulnerability detection with an always up-to-date threat feed
and knowledge about your runtime deployments to prioritize risks
specifically for your environment.

> **Note**
>
> Cortex XSIAM vulnerability management provides the ability to identify
> and assess runtime vulnerabilities in every asset across traditional
> IT and cloud environments. For vulnerabilities detected in your
> software development lifecycle through application security scans,
> refer to the
> [#UUIDf760c2261e3a4b3bf35ca5318425ad6f](#UUIDf760c2261e3a4b3bf35ca5318425ad6f)documentation.

##### Cortex XSIAM vulnerability concepts

###### Vulnerability

A vulnerability is a CVE or other known software security weakness that
can occur in a network or system. Vulnerabilities are typically defined
by the National Vulnerability Database (NVD) and other established
security information sources, such as Github Security Advisory or RedHat
Security Advisory.

> **Note**
>
> CVE is an acronym for Common Vulnerabilities and Exposures, which is a
> list of publicly disclosed security threats. We often use the term
> \"CVE\" to refer to a vulnerability that has been a assigned a CVE ID.
> Cortex XSIAM identifies CVEs and non-CVE vulnerabilities.

###### Vulnerability findings

A vulnerability finding is a specific instance of a vulnerability that
was discovered in your system through a vulnerability scan. Findings
include both actionable and informational context, including information
about the asset on which the vulnerability was discovered. Some findings
might be critical and should be addressed as soon as possible, others
are less important and won't require any action at all. Cortex XSIAM
applies vulnerability policies to findings to prioritize them and create
issues for the ones that are most critical to remediate.

###### Vulnerability issues

Cortex XSIAM creates a vulnerability issue when a specific instance of a
vulnerability in your environment matches a vulnerability policy. Each
issue has a priority, assignee, progress status associated with it.
Issues also provide contextual information about the asset on which the
issue is found, exploitability, and other information required for
remediation and mitigation.

##### Vulnerability Management dashboard

Vulnerability management analysts and managers can use the
**Vulnerability Management** dashboard to visualize their most pressing
risks, changes to risk over time, and remediation progress.

Navigate to **Posture Management \> Vulnerability Management ** and
select **View Full Dashboard** to see the detailed view.

#### Vulnerability policies

A vulnerability policy defines the action you want to take for a
specific set of vulnerability findings that match your policy criteria.
Cortex XSIAM provides a set of predefined vulnerability policies based
on CVSS severity, EPSS severity, and vulnerabilities confirmed through
Attack Surface Testing. You can also create custom policies based on
your unique business requirements. Custom policies allow you to focus on
the risks that matter most to your organization. Some examples of custom
vulnerability policies include the following:

- A policy that creates issues with a severity of **critical** for
  findings that have a CVSS score of 9 or more

- A policy that creates issues with a severity of **low** for findings
  that appear on dev servers

- A policy that specifies not to create issues for findings on assets in
  the asset group **Leased to customers**

- A policy which creates issues with a severity of **critical** for
  vulnerabilities that appear on the CISA KEV list **and** are in the
  asset group called **Production Servers**, regardless of CVSS score.

- A policy that prevents an image that contains code with a CVE with an
  EPSS score greater than 90% from being deployed to the Kubernetes
  cluster

Each time a new vulnerability finding is discovered, the system compares
that finding to your vulnerability policies to determine whether one of
the policies is a match. Vulnerability policies have an evaluation
order, which means the system starts by evaluating the finding against
the first policy. If it does not match, the second policy is evaluated
for a match. As soon as a finding matches a policy, no further policies
are evaluated for that finding.

The following sections describe the elements that make up a
vulnerability policy:

##### Policy conditions and scope

Vulnerability policy conditions and scope define the specific set of
findings that a policy applies to. You define the conditions by
configuring a filter with criteria for including and excluding findings.
You define scope by creating one or more Asset Groups and adding assets
to those groups in the Assets view. Once the Asset Groups are created
you may select one or more of them in the policy creation process, this
will limit the scope of that policy to only the assets in the chosen
asset groups.

##### Policy actions

Policy actions are the actions the policy will perform automatically on
vulnerability findings that match the policy conditions and scope. There
are two types of policy actions, issue creation and prevention.

Issue creation actions

Issue creation actions either create an issue and set the issue severity
for matching findings or or ignore matching findings and do not create
an issue.

Prevention actions

Prevention actions prevent vulnerabilities from being introduced into
your systems by failing a build or blocking deployment. Available
actions are described in the table below.

  --------------------------------------------------------------------------
  Type of prevention      Action                  Description
  action                                          
  ----------------------- ----------------------- --------------------------
  Kubernetes pod actions  Block new deployments   New deployments are
                                                  blocked by the Kubernetes
                                                  Admission Controller when
                                                  vulnerabilities matching
                                                  the policy conditions are
                                                  detected in an image. This
                                                  requires that the agent be
                                                  installed and activated.

  Kubernetes pod actions  Do nothing              No action will be taken
                                                  for matching findings on
                                                  Kubernetes clusters with
                                                  Kubernetes Admission
                                                  Controller activated.

  Build actions           Fail the build          Fails the build in your
                                                  CI/CD system when an
                                                  attempt is made to check
                                                  in code that includes a
                                                  vulnerability that matches
                                                  the policy conditions.
                                                  This requires that the
                                                  agent be installed and
                                                  activated on your CI/CD
                                                  system.

  Build actions           Do nothing              No action will be taken
                                                  for matching findings from
                                                  code repository assets
                                                  where the agent is
                                                  activated.
  --------------------------------------------------------------------------

##### Policy order

The order of policies in the policy list is important. Policies are
executed in order from top to bottom, and the first policy that matches
a finding determines the action on that finding. After that first match,
no other policies are evaluated. We recommend placing your most
important and most specific policies toward the top of the list and
wider-reaching, more generic policies towards the bottom of the policy
list.

Policy 0 is the **Globally Ignored CVEs, Assets, and Asset Groups**
policy. It includes a list of CVEs and assets for which Cortex XSIAM
will not create vulnerability issues. You can update the
**Globally Ignored CVEs, Assets, and Asset Groups** policy by adding or
removing CVEs, asset groups, and assets, but you cannot move the policy
down list to change order.

##### Create a vulnerability policy

Before creating a policy, be sure to review the information in the
[Vulnerability Policies](#UUIDd48badaed793601045c70fe385a252e4) section.

1.  Navigate to Posture Management \> Rules & Policies \> Policies \>
    Vulnerability Management.

2.  Click **+Add Policy** and select one of the options:

    - **Create a policy for issue creation**

    - **Create a policy for prevention**

3.  Add a **Policy Name** and, optionally, a **Description**, and then
    click Next.

4.  Set the policy conditions by creating a query that defines the
    specific findings for which the policy will create issues. Your
    policy can specify which findings to include and which to exclude.

- Preview the list of findings that match your policy. If the results
  look correct, click **Next**.

5.  Define the policy scope by selecting one or more asset groups from
    the dropdown menu. If you don\'t choose an asset group, the policy
    will apply to all assets.

- If you want to create a new asset group,
  click** Create New Asset Group** to open the **Asset Groups** page in
  a new browser tab. Click **+ Add Group** and follow the instructions
  in the wizard. After you\'ve created the new asset group, go back to
  your original tab and finish creating your policy with new asset
  group.

  Click **Next**.

6.  Choose the action that will be executed on the findings that match
    the policy. If you select
    **Create an issue for each matching finding**, you must also select
    the issue severity that will be applied to those issues. You can
    base the severity of the issue on the severity of the underlying CVE
    by selecting **Use Default CVE Severity** in the dropdown menu.

7.  Click **Done**.

- The policy wizard will close, and you will be redirected back to the
  **Vulnerability Policies** page.

8.  Set the order of evaluation for the policy.

- By default new policies are added to bottom of the policy list. To
  move a policy up or down in the list, click and hold the arrows in the
  **Name **column and drag the policy to the desired position in the
  list.

  We recommend placing wider-reaching, more generic policies towards the
  bottom of the policy list, and more specific policies towards the top
  of the list.

  Click **Save**.

##### Update the Ignored CVEs, Asset Groups, and Assets policy

Policy number 0 in the policy list is the
**Ignored CVEs, Asset Groups, and Assets** policy.  This policy contains
a list of vulnerabilities and assets for which Cortex XSIAM will not
create vulnerability issues. Findings will still be created for these
vulnerabilities and assets, and you can review those on the
**Vulnerabilities **and** Vulnerable Assets** pages. You can update the
**Ignored CVEs, Asset Groups, and Assets** policy at any time by using
the following steps to add or remove assets, asset groups, and CVEs.

1.  Navigate to Posture Management \> Rules & Policies \> Policies \>
    Vulnerability Management.

2.  The first policy in the policy list is the
    **Ignored CVEs, Asset Groups, and Assets** policy. Click on that
    policy to open the policy wizard.

3.  Add or remove vulnerabilities, asset groups, and assets as needed.
    Click **Next**.

    - To add CVEs, asset groups, or assets, use the search bar in each
      section to find the value you are looking for, and select it to
      add it to the list.

    - To remove CVEs, asset groups, or assets, click the **X** to the
      right of each item in the list.

4.  Review the **Results Preview** to see the list of findings that will
    not generate issues. If the list looks correct, click **Done**.

##### Modify a vulnerability policy

1.  Navigate to Posture Management \> Rules & Policies \> Vulnerability
    Management.

2.  Select either the **Issue Creation** or **Prevention **tab,
    depending on the type of policy you want to modify.

3.  Click on the name of the policy in the policy list to open the
    policy wizard. You can also right-click anywhere in the row and
    select **Edit**.

4.  Follow the steps in the wizard to update the policy.

##### Enable or disable a vulnerability policy

After disabling a policy, no new issues will be created or actions taken
for new findings that match the policy.

1.  Navigate to Posture Management \> Rules & Policies \> Vulnerability
    Management.

2.  Select either the Issue Creation or Prevention tab, depending on the
    type of policy you want to modify.

3.  Right-click anywhere in the row for that policy and select
    **Enable** or **Disable**.

#### Investigate and remediate vulnerabilities

Cortex XSIAM provides several ways to view and track vulnerability data
so you can monitor, investigate, and remediate vulnerabilities in your
environment.

##### View all Vulnerabilities

The **Vulnerabilites **page displays all your vulnerabilities grouped by
CVE or other vulnerability ID. This view shows you how prevalent each
vulnerability is in your environment. The **Vulnerabilities **page
includes key information about each vulnerability, with links to the
related lists of instances (also called findings), related issues, and
impacted assets.

Go to Posture Management \> Vulnerability Management \> Vulnerabilities.

##### View vulnerability issues

The **Vulnerability Issues** page displays all vulnerability issues
along with critical vulnerability intelligence and context so you can
assign an issue to an owner, investigate, remediate, and track progress.
Click on an issue in the table to display the issue details.

Go to Posture Management \> Vulnerability Management \> Vulnerability
Issues.

##### View All Vulnerability Findings

A vulnerability finding is a specific instance of a vulnerability that
was discovered in your environment. The **All Vulnerability Findings**
page lists every instance of every vulnerability that was discovered in
your environment.

Go to Posture Management \> Vulnerability Management \> Vulnerability
Issues and click the **All Vulnerability Findings** button.

##### View vulnerable assets

The** Vulnerable Assets** page displays all assets with a vulnerability
finding. This view enables you to prioritize vulnerabilities by asset
and asset type and focus on assets most critical to fix. The
**Vulnerable Assets** list provides links to the findings and issues for
each asset. Click on an asset in the table to see the asset details.

Go to Posture Management \> Vulnerability Management \> Vulnerable
Assets.

#### Vulnerability Intelligence

Vulnerability Intelligence is a real-time feed that contains
vulnerability data and threat intelligence from a variety of certified
upstream sources. This feed continuously pulls data from known
vulnerability databases, official vendor feeds and commercial providers
to provide the most accurate vulnerability detection results.

In addition to the information collected from official feeds,
Vulnerability Intelligence is enriched with data curated by a dedicated
research team. Our security researchers monitor cloud and open-source
projects to identify security issues through automated and manual means.
As a result, we can detect new vulnerabilities that were only recently
disclosed, and even vulnerabilities that were quietly patched.

Vulnerability Intelligence provides comprehensive, actionable
information including the following:

- CVE metadata, such as description, impact, severity, and CVSS v2/v3
  Scores

- CPE and product information, such as affected packages, versions, and
  OS

- Exploit intelligence, such as Exploit Availability, maturity,
  exploitability and EPSS scores

**How to view Vulnerability Intelligence**

1.  Navigate to Posture Management \> Vulnerability Management \>
    Vulnerability Intelligence.

2.  (Optional) Click a row in the** Vulnerability Intelligence** table
    to view detailed information about the vulnerability.

- The details page has an **Overview **tab, which provides information
  about the vulnerability and an **Affected Software** tab, which shows
  information about all the software packages impacted by the
  vulnerability.

#### Recast CVSS scores and CVSS severities

In some situations, you might decide that a specific vulnerability poses
a different level of risk to your environment than what is reflected in
the original CVSS score or CVSS severity. In Cortex XSIAM you can
override the CVSS score or severity within the platform. Customizing
CVSS scores and severities enables you to align your risk management
approach with your unique context and priorities.

When a CVSS score or severity is recast, the change is applied
platform-wide, updating both existing and new vulnerability findings.
This ensures consistency in how vulnerabilities are assessed and managed
across the organization. After the CVSS score or severity is updated,
the system automatically updates all affected findings within about one
hour.

You can view the original CVSS score and severity and new values on the
vulnerability details page in Vulnerability Intelligence.

**How to recast the CVSS score and CVSS severity of a vulnerability**

1.  Navigate to Posture Management \> Vulnerability Management \>
    Vulnerability Intelligence.

2.  Use the filters to find the vulnerability in
    the** Vulnerability Intelligence** table.

3.  Click in the row for the vulnerability to open the vulnerability
    details panel.

4.  Click the Options icon in the upper right corner and select
    **Override Severity or CVSS**.

5.  Enter the new severity and score, and then click **Save**.

##### View vulnerabilities with overridden CVSS severities and scores

Perform these steps to display the complete list of vulnerabilities with
overridden CVSS severities and CVSS scores.

1.  Navigate to Posture Management \> Vulnerability Management \>
    Vulnerability Intelligence.

2.  Click the **Show Overridden CVSS** button in the upper right corner.

- You could also use the filter **Severity Source**
  *Contains ***Custom Override** to display the list of vulnerabilities
  with overrides.

